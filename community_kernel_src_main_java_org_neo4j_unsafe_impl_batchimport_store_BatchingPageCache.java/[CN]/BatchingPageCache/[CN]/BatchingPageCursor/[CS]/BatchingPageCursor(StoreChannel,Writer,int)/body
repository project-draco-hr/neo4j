{
  this.channel=channel;
  this.writer=writer;
  this.pageSize=pageSize;
  bufferPool=new SimplePool<>(2,new Factory<ByteBuffer>(){
    @Override public ByteBuffer newInstance(){
      try {
        return ByteBuffer.allocateDirect(pageSize);
      }
 catch (      OutOfMemoryError e) {
        return ByteBuffer.allocate(pageSize);
      }
    }
  }
);
  this.currentBuffer=bufferPool.acquire();
  highestKnownPageId=channel.size() / pageSize;
}
