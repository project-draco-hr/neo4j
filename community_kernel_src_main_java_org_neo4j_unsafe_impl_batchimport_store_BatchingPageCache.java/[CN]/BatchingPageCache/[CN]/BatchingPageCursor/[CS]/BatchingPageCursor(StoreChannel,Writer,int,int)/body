{
  this.channel=channel;
  this.writer=writer;
  this.pageSize=pageSize;
  this.buffers=new ByteBuffer[bufferCount];
  for (int i=0; i < buffers.length; i++) {
    try {
      buffers[i]=ByteBuffer.allocateDirect(pageSize);
    }
 catch (    OutOfMemoryError e) {
      buffers[i]=ByteBuffer.allocate(pageSize);
    }
  }
  this.bufferPool=new SimplePool<>(buffers);
  this.currentBuffer=bufferPool.acquire();
  this.highestKnownPageId=channel.size() / pageSize;
}
