{
  this.channel=channel;
  this.writer=writer;
  this.pageSize=pageSize;
  this.mode=mode;
  this.bufferRing=new Ring<>(2,new Factory<ByteBuffer>(){
    @Override public ByteBuffer newInstance(){
      return ByteBuffer.allocateDirect(pageSize);
    }
  }
);
  this.currentBuffer=bufferRing.next();
  highestKnownPageId=channel.size() / pageSize;
}
