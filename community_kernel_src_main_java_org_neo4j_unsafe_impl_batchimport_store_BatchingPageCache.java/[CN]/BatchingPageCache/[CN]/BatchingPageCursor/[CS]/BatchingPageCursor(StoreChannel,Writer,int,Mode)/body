{
  this.channel=channel;
  this.writer=writer;
  this.pageSize=pageSize;
  this.mode=mode;
  bufferPool=new SimplePool<>(2,new Factory<ByteBuffer>(){
    @Override public ByteBuffer newInstance(){
      return ByteBuffer.allocateDirect(pageSize);
    }
  }
);
  this.currentBuffer=bufferPool.acquire();
  highestKnownPageId=channel.size() / pageSize;
}
