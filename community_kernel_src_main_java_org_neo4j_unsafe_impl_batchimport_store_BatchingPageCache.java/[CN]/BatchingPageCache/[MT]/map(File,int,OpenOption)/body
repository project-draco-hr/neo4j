{
  if (openOptions.length != 0) {
    throw new UnsupportedOperationException("BatchingPageCache does not support any OpenOptions");
  }
  StoreChannel channel=fs.open(file,"rw");
  Writer writer=file.getName().contains(StoreFactory.COUNTS_STORE) ? SYNCHRONOUS.create(channel,monitor) : writerFactory.create(channel,monitor);
  BatchingPagedFile pageFile=new BatchingPagedFile(channel,writer,individualizedPageSize(file,pageSize),new Closeable(){
    @Override public void close() throws IOException {
      BatchingPagedFile pageFile=pagedFiles.remove(file);
      if (pageFile == null) {
        throw new IllegalArgumentException(file.toString());
      }
    }
  }
);
  pagedFiles.put(file,pageFile);
  return pageFile;
}
