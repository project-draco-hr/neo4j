{
  int size=(int)min(batchSize,highId - id);
  NodeRecord[] batch=new NodeRecord[size];
  boolean seenReservedId=false;
  for (int i=0; i < size; i++) {
    cursor.next(id++);
    NodeRecord newRecord=record.clone();
    batch[i]=newRecord;
    seenReservedId|=IdValidator.isReservedId(newRecord.getId());
  }
  batch=removeRecordWithReservedId(batch,seenReservedId);
  return batch.length > 0 ? batch : null;
}
