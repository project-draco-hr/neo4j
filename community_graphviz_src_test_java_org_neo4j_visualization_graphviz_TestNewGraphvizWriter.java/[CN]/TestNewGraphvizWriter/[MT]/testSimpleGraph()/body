{
  Transaction tx=neo.beginTx();
  try {
    final Node emil=neo.createNode();
    emil.setProperty("name","Emil Eifr??m");
    emil.setProperty("age",30);
    final Node tobias=neo.createNode();
    tobias.setProperty("name","Tobias \"thobe\" Ivarsson");
    tobias.setProperty("age",23);
    tobias.setProperty("hours",new int[]{10,10,4,4,0});
    final Node johan=neo.createNode();
    johan.setProperty("!<>)","!<>)");
    johan.setProperty("name","!<>Johan '\\n00b' !<>Svensson");
    final Relationship emilKNOWStobias=emil.createRelationshipTo(tobias,type.KNOWS);
    emilKNOWStobias.setProperty("since","2003-08-17");
    final Relationship johanKNOWSemil=johan.createRelationshipTo(emil,type.KNOWS);
    final Relationship tobiasKNOWSjohan=tobias.createRelationshipTo(johan,type.KNOWS);
    final Relationship tobiasWORKS_FORemil=tobias.createRelationshipTo(emil,type.WORKS_FOR);
    OutputStream out=new ByteArrayOutputStream();
    GraphvizWriter writer=new GraphvizWriter();
    writer.emit(out,Walker.crosscut(emil.traverse(Order.DEPTH_FIRST,StopEvaluator.END_OF_GRAPH,ReturnableEvaluator.ALL,type.KNOWS,Direction.BOTH,type.WORKS_FOR,Direction.BOTH),type.KNOWS,type.WORKS_FOR));
    tx.success();
    System.out.println(out.toString());
  }
  finally {
    tx.finish();
  }
}
