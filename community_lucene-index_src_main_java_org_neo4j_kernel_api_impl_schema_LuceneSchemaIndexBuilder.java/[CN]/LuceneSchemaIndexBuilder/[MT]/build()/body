{
  return isReadOnly() ? new ReadOnlyDatabaseSchemaIndex(storageBuilder.build(),indexConfig,samplingConfig,new ReadOnlyIndexPartitionFactory()) : new WritableDatabaseSchemaIndex(storageBuilder.build(),indexConfig,samplingConfig,new WritableIndexPartitionFactory(writerConfigFactory));
}
