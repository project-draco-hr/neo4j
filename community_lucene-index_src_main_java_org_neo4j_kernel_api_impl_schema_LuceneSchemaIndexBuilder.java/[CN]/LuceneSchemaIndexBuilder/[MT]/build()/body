{
  return isReadOnly() ? new ReadOnlyLuceneSchemaIndex(storageBuilder.build(),indexConfig,samplingConfig,new ReadOnlyIndexPartitionFactory()) : new WritableLuceneSchemaIndex(storageBuilder.build(),indexConfig,samplingConfig,new WritableIndexPartitionFactory(writerConfigFactory));
}
