{
  log.info("Using database at " + databaseStoreDirectory);
  if (databaseProperties == null) {
    databaseProperties=new HashMap<String,String>();
  }
  putIfAbsent(databaseProperties,ShellSettings.remote_shell_enabled.name(),Settings.TRUE);
  putIfAbsent(databaseProperties,GraphDatabaseSettings.keep_logical_logs.name(),Settings.TRUE);
  try {
    databaseProperties.put(UdcSettings.udc_source.name(),"server");
  }
 catch (  NoClassDefFoundError e) {
  }
  return factory.createDatabase(databaseStoreDirectory,databaseProperties);
}
