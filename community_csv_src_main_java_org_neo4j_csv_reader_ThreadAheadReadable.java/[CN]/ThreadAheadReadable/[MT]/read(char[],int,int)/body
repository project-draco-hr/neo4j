{
  assertHealthy();
  while (!hasReadAhead) {
    parkAWhile();
    assertHealthy();
  }
  if (eof) {
    return -1;
  }
  int bytesToCopy=min(readAheadBuffer.remaining(),length);
  arraycopy(readAheadArray,readAheadBuffer.position(),buffer,offset,bytesToCopy);
  readAheadBuffer.position(readAheadBuffer.position() + bytesToCopy);
  if (newSourceDescription != null) {
    sourceDescription=newSourceDescription;
    for (    SourceMonitor monitor : sourceMonitors) {
      monitor.notify(newSourceDescription);
    }
    newSourceDescription=null;
  }
  hasReadAhead=false;
  LockSupport.unpark(this);
  return bytesToCopy == 0 ? -1 : bytesToCopy;
}
