{
  IndexDescriptor descriptor;
  Transaction tx=db.beginTx();
  try {
    StatementOperations ctx=ctxProvider.getCtxForWriting().asStatementOperations();
    StatementState state=ctxProvider.statementForReading();
    descriptor=new IndexDescriptor(ctx.labelGetForName(state,label.name()),ctx.propertyKeyGetForName(state,propertyKey));
    tx.success();
  }
  finally {
    tx.finish();
  }
  flipper.setFlipTarget(mock(IndexProxyFactory.class));
  return new IndexPopulationJob(descriptor,PROVIDER_DESCRIPTOR,populator,flipper,storeView,format(":%s(%s)",label.name(),propertyKey),stateHolder,new SingleLoggingService(logger));
}
