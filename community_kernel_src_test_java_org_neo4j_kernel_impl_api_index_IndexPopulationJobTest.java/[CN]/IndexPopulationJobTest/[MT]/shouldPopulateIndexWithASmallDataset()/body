{
  String value="Mattias";
  long node1=createNode(map(name,value),FIRST);
  createNode(map(name,value),SECOND);
  createNode(map(age,31),FIRST);
  long node4=createNode(map(age,35,name,value),FIRST);
  IndexPopulationJob job=newIndexPopulationJob(FIRST,name,populator,new FlippableIndexProxy());
  job.run();
  verify(populator).create();
  verify(populator).add(node1,value);
  verify(populator).add(node4,value);
  verify(populator).verifyDeferredConstraints(indexStoreView);
  verify(populator).close(true);
  verifyNoMoreInteractions(populator);
  assertEquals(2,indexCount(FIRST,name));
  assertEquals(0,indexCount(FIRST,age));
  assertEquals(0,indexCount(SECOND,name));
  assertEquals(0,indexCount(SECOND,age));
  assertDoubleLongEquals(1,2,indexSample(FIRST,name));
  assertDoubleLongEquals(0,0,indexSample(FIRST,age));
  assertDoubleLongEquals(0,0,indexSample(SECOND,name));
  assertDoubleLongEquals(0,0,indexSample(SECOND,age));
}
