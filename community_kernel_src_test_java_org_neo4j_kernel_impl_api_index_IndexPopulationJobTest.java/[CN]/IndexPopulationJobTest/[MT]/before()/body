{
  db=(ImpermanentGraphDatabase)new TestGraphDatabaseFactory().newImpermanentDatabase();
  ctxSupplier=db.getDependencyResolver().resolveDependency(ThreadToStatementContextBridge.class);
  counts=db.getDependencyResolver().resolveDependency(NeoStoreSupplier.class).get().getCounts();
  stateHolder=new KernelSchemaStateStore(DevNullLoggingService.DEV_NULL.getMessagesLog(KernelSchemaStateStore.class));
  indexStoreView=newStoreView();
  try (Transaction tx=db.beginTx()){
    Statement statement=ctxSupplier.get();
    labelId=statement.schemaWriteOperations().labelGetOrCreateForName(FIRST.name());
    statement.schemaWriteOperations().labelGetOrCreateForName(SECOND.name());
    statement.close();
    tx.success();
  }
 }
