{
  db=(ImpermanentGraphDatabase)new TestGraphDatabaseFactory().newImpermanentDatabase();
  ctxProvider=db.getDependencyResolver().resolveDependency(ThreadToStatementContextBridge.class);
  counts=db.getDependencyResolver().resolveDependency(NeoStoreProvider.class).evaluate().getCounts();
  populator=mock(IndexPopulator.class);
  stateHolder=new KernelSchemaStateStore(DevNullLoggingService.DEV_NULL);
  indexStoreView=newStoreView();
  try (Transaction tx=db.beginTx()){
    Statement statement=ctxProvider.instance();
    labelId=statement.schemaWriteOperations().labelGetOrCreateForName(FIRST.name());
    statement.schemaWriteOperations().labelGetOrCreateForName(SECOND.name());
    statement.close();
    tx.success();
  }
 }
