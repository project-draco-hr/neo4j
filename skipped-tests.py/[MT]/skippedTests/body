def skippedTests(basedir, expirationAge):
    for (dirpath, dirs, files) in os.walk(os.curdir):
        for testXml in each((os.path.join(dirpath, f) for f in files if (f.startswith('TEST-') and f.endswith('.xml')))):
            testcases = ET.parse(testXml).findall('./testcase')
            if (testcases is None):
                continue
            for testcase in testcases:
                skipped = testcase.find('./skipped')
                if (skipped is None):
                    continue
                message = skipped.get('message', 'NO MESSAGE!')
                if message.lower().startswith('not a test'):
                    continue
                match = DATE.search(message)
                if match:
                    (y, m, d) = (match.group('y'), match.group('m'), match.group('d'))
                    date = datetime.date(int(y), int(m), int(d))
                    delta = (datetime.date.today() - date)
                    if (delta < expirationAge):
                        continue
                    message = ('Expired %s days ago! %s' % (delta.days, message))
                classname = testcase.get('classname', '')
                testname = testcase.get('name', '')
                yield {'class': classname, 'test': testname, 'message': message, }
