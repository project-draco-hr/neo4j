{
  params.put(FileSystemAbstraction.class,CommonFactories.defaultFileSystemAbstraction());
  this.nodeStore=new NodeStore(path + "/neostore.nodestore.db",params);
  this.relStore=new RelationshipStore(path + "/neostore.relationshipstore.db",params);
  RelationshipTypeStore relTypeStore=new RelationshipTypeStore(path + "/neostore.relationshiptypestore.db",params,IdType.RELATIONSHIP_TYPE);
  this.relTypeStore=relTypeStore;
  this.typeNames=wrapStore(relTypeStore.getNameStore());
  if (new File(path + "/neostore.propertystore.db").exists()) {
    PropertyStore propStore=new PropertyStore(path + "/neostore.propertystore.db",params);
    this.propStore=propStore;
    this.propIndexStore=wrapStore(propStore.getIndexStore());
    this.propKeys=wrapStore(propStore.getIndexStore().getKeyStore());
    this.stringStore=wrapStore(propStore.getStringStore());
    this.arrayStore=wrapStore(propStore.getArrayStore());
  }
 else {
    this.propStore=null;
    this.propIndexStore=null;
    this.propKeys=null;
    this.stringStore=null;
    this.arrayStore=null;
  }
  this.closable=true;
}
