{
  params.put(FileSystemAbstraction.class,CommonFactories.defaultFileSystemAbstraction());
  NodeStore nodeStore;
  RelationshipStore relStore;
  RelationshipTypeStore relTypeStore;
  PropertyStore propStore=null;
  this.nodeStore=wrapStore(nodeStore=new NodeStore(path + "/neostore.nodestore.db",params));
  this.relStore=wrapStore(relStore=new RelationshipStore(path + "/neostore.relationshipstore.db",params));
  this.relTypeStore=wrapStore(relTypeStore=new RelationshipTypeStore(path + "/neostore.relationshiptypestore.db",params,IdType.RELATIONSHIP_TYPE));
  this.typeNameStore=wrapStore(relTypeStore.getNameStore());
  if (new File(path + "/neostore.propertystore.db").exists()) {
    this.propStore=wrapStore(propStore=new PropertyStore(path + "/neostore.propertystore.db",params));
    this.propIndexStore=wrapStore(propStore.getIndexStore());
    this.propKeyStore=wrapStore(propStore.getIndexStore().getKeyStore());
    this.stringStore=wrapStore(propStore.getStringStore());
    this.arrayStore=wrapStore(propStore.getArrayStore());
  }
 else {
    this.propStore=null;
    this.propIndexStore=null;
    this.propKeyStore=null;
    this.stringStore=null;
    this.arrayStore=null;
  }
  this.closable=true;
  nodeStore.makeStoreOk();
  relStore.makeStoreOk();
  if (propStore != null)   propStore.makeStoreOk();
  relTypeStore.makeStoreOk();
}
