{
  String indexName=indexes.newInstance();
  String key="Name";
  String value="Builder";
  long node=helper.createNode(MapUtil.map(key,value));
  helper.addNodeToIndex(indexName,key,value,node);
  helper.addNodeToIndex(indexName,"Gender","Male",node);
  String entity=gen().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=" + key+ ":Build~0.1%20AND%20Gender:Male").entity();
  @SuppressWarnings("unchecked") Collection<LinkedHashMap<String,String>> hits=(Collection<LinkedHashMap<String,String>>)JsonHelper.readJson(entity);
  LinkedHashMap<String,String> nodeMapUnordered=hits.iterator().next();
  entity=gen().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=" + key+ ":Build~0.1%20AND%20Gender:Male&order=score").entity();
  hits=(Collection<LinkedHashMap<String,String>>)JsonHelper.readJson(entity);
  LinkedHashMap<String,String> nodeMapOrdered=hits.iterator().next();
  for (  Map.Entry<String,String> unorderedEntry : nodeMapUnordered.entrySet()) {
    assertEquals("wrong entry for key: " + unorderedEntry.getKey(),unorderedEntry.getValue(),nodeMapOrdered.get(unorderedEntry.getKey()));
  }
  assertTrue("There should be only one extra value for the ordered map",nodeMapOrdered.size() == nodeMapUnordered.size() + 1);
}
