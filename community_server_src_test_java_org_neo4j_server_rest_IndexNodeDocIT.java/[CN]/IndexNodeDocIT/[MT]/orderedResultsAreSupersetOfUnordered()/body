{
  String indexName="bobTheIndex";
  String key="Name";
  String value="Builder";
  long node=helper.createNode(MapUtil.map(key,value));
  helper.addNodeToIndex(indexName,key,value,node);
  helper.addNodeToIndex(indexName,"Gender","Male",node);
  String entity=gen().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=Name:Build~0.1%20AND%20Gender:Male").entity();
  Collection<?> hits=(Collection<?>)JsonHelper.readJson(entity);
  LinkedHashMap<String,String> nodeMapUnordered=(LinkedHashMap)hits.iterator().next();
  entity=gen().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=Name:Build~0.1%20AND%20Gender:Male&order=score").entity();
  hits=(Collection<?>)JsonHelper.readJson(entity);
  LinkedHashMap<String,String> nodeMapOrdered=(LinkedHashMap)hits.iterator().next();
  for (  Map.Entry<String,String> unorderedEntry : nodeMapUnordered.entrySet()) {
    assertEquals("wrong entry for key: " + unorderedEntry.getKey(),unorderedEntry.getValue(),nodeMapOrdered.get(unorderedEntry.getKey()));
  }
  assertTrue("There should be only one extra value for the ordered map",nodeMapOrdered.size() == nodeMapUnordered.size() + 1);
}
