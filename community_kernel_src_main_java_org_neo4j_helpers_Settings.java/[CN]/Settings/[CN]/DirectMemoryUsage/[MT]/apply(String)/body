{
  long bytes;
  if (value.contains("%")) {
    try {
      String digitsOnly=value.replace("%","").trim();
      double percentage=Double.parseDouble(digitsOnly) / 100;
      if (percentage > 0 && percentage <= 1) {
        bytes=(long)Math.min(percentage * availableRAM,freeRAM);
      }
 else {
        throw new IllegalArgumentException("Invalid memory fraction, expected a value between 0.0% and 100.0%.");
      }
    }
 catch (    NumberFormatException e) {
      throw new IllegalArgumentException("Invalid memory fraction, expected a value between 0.0% and 100.0%.");
    }
  }
 else {
    bytes=BYTES.apply(value);
  }
  return Math.round(Math.min(bytes,freeRAM * 0.95));
}
