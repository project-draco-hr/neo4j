{
  RecordSet<RelationshipRecord> chain=new RecordSet<RelationshipRecord>();
  chain.add(record);
  RelationshipRecord currentRecord=record;
  long nextRelId;
  while (currentRecord.inUse() && (nextRelId=direction.fieldFor(nodeId,currentRecord).relOf(currentRecord)) != none) {
    currentRecord=recordStore.forceGetRecord(nextRelId);
    chain.add(currentRecord);
  }
  return chain;
}
