{
  RecordSet<RelationshipRecord> chain=new RecordSet<RelationshipRecord>();
  chain.add(record);
  RelationshipRecord currentRecord=record;
  long nextRelId=direction.fieldFor(nodeId,currentRecord).relOf(currentRecord);
  while (currentRecord.inUse() && !direction.fieldFor(nodeId,currentRecord).endOfChain(currentRecord)) {
    currentRecord=recordStore.forceGetRecord(nextRelId);
    chain.add(currentRecord);
    nextRelId=direction.fieldFor(nodeId,currentRecord).relOf(currentRecord);
  }
  return chain;
}
