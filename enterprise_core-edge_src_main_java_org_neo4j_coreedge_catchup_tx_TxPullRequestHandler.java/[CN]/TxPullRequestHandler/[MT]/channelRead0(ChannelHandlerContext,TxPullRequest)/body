{
  long startTxId=Math.max(msg.txId(),TransactionIdStore.BASE_TX_ID);
  long endTxId=startTxId;
  if (transactionIdStore.getLastCommittedTransactionId() > startTxId) {
    try (IOCursor<CommittedTransactionRepresentation> cursor=logicalTransactionStore.getTransactions(startTxId + 1)){
      while (cursor.next()) {
        ctx.write(ResponseMessageType.TX);
        CommittedTransactionRepresentation tx=cursor.get();
        endTxId=tx.getCommitEntry().getTxId();
        ctx.write(new TxPullResponse(storeId,tx));
      }
      ctx.flush();
    }
   }
  ctx.write(ResponseMessageType.TX_STREAM_FINISHED);
  ctx.write(new TxStreamFinishedResponse(endTxId));
  ctx.flush();
  monitor.increment();
  protocol.expect(NextMessage.MESSAGE_TYPE);
}
