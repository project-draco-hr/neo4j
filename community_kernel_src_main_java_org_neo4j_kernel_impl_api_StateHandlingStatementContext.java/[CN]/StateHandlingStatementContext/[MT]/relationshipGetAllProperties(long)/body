{
  if (state.relationshipIsAddedInThisTx(relationshipId)) {
    return state.getRelationshipPropertyDiffSets(relationshipId).getAdded().iterator();
  }
  if (state.relationshipIsDeletedInThisTx(relationshipId)) {
    throw new IllegalStateException("Relationship " + relationshipId + " has been deleted");
  }
  return state.getRelationshipPropertyDiffSets(relationshipId).apply(delegate.relationshipGetAllProperties(relationshipId));
}
