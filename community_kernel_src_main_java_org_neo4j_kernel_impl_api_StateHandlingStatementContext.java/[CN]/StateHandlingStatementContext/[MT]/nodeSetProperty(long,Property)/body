{
  try {
    Property existingProperty=nodeGetProperty(nodeId,property.propertyKeyId());
    if (existingProperty.isNoProperty()) {
      auxStoreOps.nodeAddStoreProperty(nodeId,property);
    }
 else {
      auxStoreOps.nodeChangeStoreProperty(nodeId,existingProperty,property);
    }
    state.nodeReplaceProperty(nodeId,existingProperty,property);
    return existingProperty;
  }
 catch (  PropertyNotFoundException e) {
    throw new IllegalArgumentException("Property used for setting should not be NoProperty",e);
  }
}
