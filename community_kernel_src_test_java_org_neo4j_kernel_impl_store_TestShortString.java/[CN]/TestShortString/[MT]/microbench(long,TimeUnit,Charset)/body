{
  long successes=0, failures=0, errors=0;
  long remaining=time=unit.toMillis(time);
  while (remaining > 0) {
    List<String> strings=randomStrings(1000,charset,15);
    long start=System.currentTimeMillis();
    for (    String string : strings) {
      String result=roundtrip(string);
      if (result != null) {
        if (string.equals(result)) {
          successes++;
        }
 else {
          errors++;
          System.out.printf("Expected: %s, got: %s%n",string,result);
        }
      }
 else {
        failures++;
      }
    }
    remaining-=System.currentTimeMillis() - start;
  }
  time-=remaining;
  System.out.printf("=== %s ===%n",charset.name());
  System.out.printf("%s successful, %s non-convertable, %s misconverted%n",successes,failures,errors);
  long total=successes + failures + errors;
  System.out.printf("%.3f conversions per ms%n",total / (double)time);
  System.out.printf("%.2f%% success rate%n",100 * (successes / ((double)(total))));
}
