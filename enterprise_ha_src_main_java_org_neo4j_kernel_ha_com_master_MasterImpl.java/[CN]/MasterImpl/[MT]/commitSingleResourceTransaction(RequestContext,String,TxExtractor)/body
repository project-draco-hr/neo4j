{
  assertCorrectEpoch(context);
  resumeTransaction(context);
  try {
    final long txId=spi.applyPreparedTransaction(resource,txGetter.extract());
    Predicate<Long> upUntilThisTx=new Predicate<Long>(){
      @Override public boolean accept(      Long item){
        return item < txId;
      }
    }
;
    return packResponse(context,txId,upUntilThisTx);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    suspendTransaction(context);
  }
}
