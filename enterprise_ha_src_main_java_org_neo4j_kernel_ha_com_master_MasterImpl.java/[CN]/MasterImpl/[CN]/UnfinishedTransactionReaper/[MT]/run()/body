{
  try {
    Map<RequestContext,TimestampedLockClient> safeTransactions;
synchronized (slaveLockState) {
      safeTransactions=new HashMap<>(slaveLockState);
    }
    for (    Map.Entry<RequestContext,TimestampedLockClient> entry : safeTransactions.entrySet()) {
      long time=entry.getValue().timeLastSuspended.get();
      if ((time != 0 && System.currentTimeMillis() - time >= unfinishedTransactionThresholdMillis) || entry.getValue().finishAsap()) {
        long displayableTime=(time == 0 ? 0 : (System.currentTimeMillis() - time));
        String oldTxDescription=format("old tx %s: %s at age %s ms",entry.getKey(),entry.getValue().getLockClient(),displayableTime);
        try {
          finishTransaction0(entry.getKey());
          msgLog.info("Rolled back " + oldTxDescription);
        }
 catch (        Throwable t) {
          msgLog.warn("Unable to roll back " + oldTxDescription,t);
        }
      }
    }
  }
 catch (  Throwable t) {
    msgLog.warn("Exception running " + getClass().getName() + ", although will continue...",t);
  }
}
