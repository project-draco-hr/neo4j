{
  byte[] headerBytes=new byte[3];
  channel.get(headerBytes,headerBytes.length);
  byte valueType=(byte)((headerBytes[0] & 0x1C) >> 2);
  byte entityType=(byte)((headerBytes[0] & 0x2) >> 1);
  boolean entityIdNeedsLong=(headerBytes[0] & 0x1) > 0;
  byte indexNameId=(byte)(headerBytes[1] & 0x3F);
  boolean startNodeNeedsLong=(headerBytes[1] & 0x80) > 0;
  boolean endNodeNeedsLong=(headerBytes[1] & 0x40) > 0;
  byte keyId=headerBytes[2];
  if (indexCommandHeader == null) {
    indexCommandHeader=new IndexCommandHeader();
  }
  return indexCommandHeader.set(valueType,entityType,entityIdNeedsLong,indexNameId,startNodeNeedsLong,endNodeNeedsLong,keyId);
}
