{
  Map<String,LogBufferFactory> logWriters=createLogWriters(tempConfig);
  Map<String,LogBuffer> logFiles=new HashMap<>();
  try {
    while (transactions.hasNext()) {
      Triplet<String,Long,TxExtractor> next=transactions.next();
      System.out.println("Applying transactions for datasource " + next.first() + "@"+ next.second());
      LogBuffer log=getOrCreateLogBuffer(logFiles,logWriters,next.first(),next.second(),tempConfig);
      next.third().extract(log);
      System.out.println("Applying transactions for datasource " + next.first() + " done.");
    }
  }
  finally {
    for (    LogBuffer buf : logFiles.values()) {
      buf.force();
      buf.getFileChannel().close();
    }
  }
}
