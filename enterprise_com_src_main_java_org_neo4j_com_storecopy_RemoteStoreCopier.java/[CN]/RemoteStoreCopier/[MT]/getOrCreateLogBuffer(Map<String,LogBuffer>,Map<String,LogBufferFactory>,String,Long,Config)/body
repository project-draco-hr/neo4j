{
  LogBuffer buffer=buffers.get(dsName);
  if (buffer == null) {
    if (logWriters.containsKey(dsName)) {
      buffer=logWriters.get(dsName).createActiveLogFile(config,txId - 1);
      buffers.put(dsName,buffer);
    }
 else {
      throw new IllegalStateException("Got transaction for unknown data source, unable to safely copy " + "files. Offending data source was '" + dsName + "', please make sure this data source is "+ "available on the classpath.");
    }
  }
  return buffer;
}
