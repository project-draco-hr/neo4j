{
  while (true) {
    Relationship nextRel=fetchNextRelOrNull();
    if (nextRel == null) {
      return null;
    }
    if (!sharedVisitedRels.add(nextRel.getId())) {
      continue;
    }
    Node result=nextRel.getOtherNode(this.lastParentTraverserNode);
    if (this.visitedNodes.containsKey(result)) {
      continue;
    }
    Path.Builder parentPath=this.visitedNodes.get(lastParentTraverserNode).path;
    LevelData levelData=new LevelData(result,currentDepth,parentPath.push(nextRel));
    this.visitedNodes.put(result,levelData);
    this.nextNodes.add(result);
    return levelData;
  }
}
