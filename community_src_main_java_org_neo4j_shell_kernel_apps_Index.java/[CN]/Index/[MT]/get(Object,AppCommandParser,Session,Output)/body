{
  String key=parser.arguments().get(0);
  String value=parser.arguments().get(1);
  @SuppressWarnings("unchecked") Iterable<Node> result=(Iterable<Node>)indexService.getClass().getMethod("getNodes",String.class,Object.class).invoke(indexService,key,(Object)value);
  boolean doCd=parser.options().containsKey("cd");
  boolean doLs=parser.options().containsKey("ls");
  String commandToRun=parser.options().get("c");
  Collection<String> commandsToRun=new ArrayList<String>();
  boolean specialCommand=false;
  if (doCd || doLs) {
    specialCommand=true;
    if (doCd) {
      commandsToRun.add("cd -a $n");
    }
 else     if (doLs) {
      commandsToRun.add("ls $n");
    }
  }
 else   if (commandToRun != null) {
    commandsToRun.addAll(Arrays.asList(commandToRun.split(Pattern.quote("&&"))));
  }
  for (  Node node : result) {
    printAndInterpretTemplateLines(commandsToRun,false,!specialCommand,node,getServer(),session,out);
  }
}
