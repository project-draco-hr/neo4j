{
  if (!stateHolder.incrementActiveClients()) {
    throw new LockClientAlreadyClosedException(String.format("%s is already closed",this));
  }
  try {
    PrimitiveLongObjectMap<LockResource> localLocks=localShared(resourceType);
    LockResource resource=localLocks.get(resourceId);
    if (resource.releaseReference() != 0) {
      return;
    }
    localLocks.remove(resourceId);
    manager.releaseReadLock(new LockResource(resourceType,resourceId),lockTransaction);
  }
  finally {
    stateHolder.decrementActiveClients();
  }
}
