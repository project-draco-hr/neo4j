{
  if (newMaxSize < 1) {
    throw new IllegalArgumentException("newMaxSize=" + newMaxSize);
  }
  if (newMaxSize >= size()) {
    maxSize=newMaxSize;
  }
 else {
    maxSize=newMaxSize;
    java.util.Iterator<Map.Entry<K,E>> itr=cache.entrySet().iterator();
    while (itr.hasNext() && cache.size() > maxSize) {
      E element=itr.next().getValue();
      itr.remove();
      elementCleaned(element);
    }
  }
}
