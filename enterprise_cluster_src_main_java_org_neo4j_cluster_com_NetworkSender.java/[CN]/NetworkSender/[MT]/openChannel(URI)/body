{
  SocketAddress address=new InetSocketAddress(clusterUri.getHost(),clusterUri.getPort() == -1 ? config.defaultPort() : clusterUri.getPort());
  ChannelFuture channelFuture=clientBootstrap.connect(address);
  try {
    if (channelFuture.await(5,TimeUnit.SECONDS) && channelFuture.getChannel().isConnected()) {
      msgLog.info(me + " opened a new channel to " + address);
      return channelFuture.getChannel();
    }
    String msg="Client could not connect to " + address;
    throw new ChannelOpenFailedException(msg);
  }
 catch (  InterruptedException e) {
    msgLog.warn("Interrupted",e);
    Thread.currentThread().interrupt();
    throw new ChannelOpenFailedException(e);
  }
}
