{
  Transaction tx;
  try {
    tx=getTransaction();
  }
 catch (  SystemException e) {
    throw new RuntimeException(e);
  }
  return tx != null ? ((TransactionImpl)tx).getState() : TransactionState.NO_STATE;
}
