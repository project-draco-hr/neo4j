{
  try {
    Iterable<List<TxLog.Record>> danglingRecordList=txLog.getDanglingRecords();
    for (    List<TxLog.Record> tx : danglingRecordList) {
      for (      TxLog.Record rec : tx) {
        if (rec.getType() == TxLog.BRANCH_ADD) {
          RecoveredBranchInfo branchId=new RecoveredBranchInfo(rec.getBranchId());
          if (branches.containsKey(branchId)) {
            continue;
          }
          branches.put(branchId,false);
        }
      }
    }
  }
 catch (  IOException e) {
    throw logAndReturn("Failed to start transaction manager: Unable to recover pending branches.",new TransactionFailureException("Unable to start TM",e));
  }
}
