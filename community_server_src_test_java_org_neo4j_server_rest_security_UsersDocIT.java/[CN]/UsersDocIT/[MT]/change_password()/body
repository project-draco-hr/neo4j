{
  startServerWithConfiguredUser();
  String originalToken=HTTP.POST(authURL(),HTTP.RawPayload.quotedJson("{'username':'neo4j','password':'secret'}")).get("authorization_token").asText();
  RESTDocsGenerator.ResponseEntity response=gen.get().noGraph().expectedStatus(200).payload(quotedJson("{'password':'secret', 'new_password':'qwerty'}")).post(server.baseUri().resolve("/user/neo4j/password").toString());
  JsonNode data=JsonHelper.jsonNode(response.entity());
  String newToken=data.get("authorization_token").asText();
  assertThat(newToken,equalTo(originalToken));
  assertThat(newToken.length(),not(0));
  assertEquals(200,HTTP.POST(authURL(),HTTP.RawPayload.quotedJson("{'username':'neo4j','password':'qwerty'}")).status());
  assertEquals(422,HTTP.POST(authURL(),HTTP.RawPayload.quotedJson("{'username':'neo4j','password':'secret'}")).status());
}
