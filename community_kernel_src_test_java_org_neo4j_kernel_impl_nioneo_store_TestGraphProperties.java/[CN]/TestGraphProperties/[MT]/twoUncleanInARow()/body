{
  String storeDir=TargetDirectory.forTest(TestGraphProperties.class).directory("nonclean",true).getAbsolutePath();
  assertEquals(0,Runtime.getRuntime().exec(new String[]{"java","-cp",System.getProperty("java.class.path"),ProduceUncleanStore.class.getName(),storeDir,"true"}).waitFor());
  assertEquals(0,Runtime.getRuntime().exec(new String[]{"java","-cp",System.getProperty("java.class.path"),ProduceUncleanStore.class.getName(),storeDir,"true"}).waitFor());
  assertEquals(0,Runtime.getRuntime().exec(new String[]{"java","-cp",System.getProperty("java.class.path"),ProduceUncleanStore.class.getName(),storeDir,"true"}).waitFor());
  GraphDatabaseSPI db=(GraphDatabaseSPI)new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(storeDir).newGraphDatabase();
  assertEquals("Some value",db.getNodeManager().getGraphProperties().getProperty("prop"));
  db.shutdown();
}
