{
  if (tx == null)   throw new IllegalStateException("Transaction not started");
  if (success)   tx.success();
  tx.finish();
  tx=null;
}
