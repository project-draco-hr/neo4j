{
  NodeImpl startNode;
  try {
    startNode=nodeManager.getNodeForProxy(startNodeId,LockType.WRITE);
  }
 catch (  NotFoundException e) {
    throw new EntityNotFoundException(EntityType.NODE,startNodeId,e);
  }
  try {
    return nodeManager.createRelationship(nodeManager.newNodeProxyById(startNodeId),startNode,nodeManager.newNodeProxyById(endNodeId),relationshipTypeId).getId();
  }
 catch (  NotFoundException e) {
    throw new EntityNotFoundException(EntityType.NODE,endNodeId,e);
  }
}
