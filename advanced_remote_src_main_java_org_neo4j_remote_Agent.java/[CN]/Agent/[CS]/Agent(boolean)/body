{
  if (attached) {
    jarfile=null;
    listMethod=null;
    attachMethod=null;
    simpleAttachMethod=null;
    loadMethod=null;
    throw new StartupException("TODO: Implement this!");
  }
 else {
    jarfile=new File(getClass().getProtectionDomain().getCodeSource().getLocation().toURI()).getAbsolutePath();
    try {
      Class<?> vmClass=Class.forName("com.sun.tools.attach.VirtualMachine");
      listMethod=vmClass.getMethod("list");
      attachMethod=vmClass.getMethod("attach",Class.forName("com.sun.tools.attach.VirtualMachineDescriptor"));
      simpleAttachMethod=vmClass.getMethod("attach",String.class);
      loadMethod=vmClass.getMethod("loadAgent",String.class,String.class);
    }
 catch (    Exception e) {
      throw new StartupException("Remote Graph Database Agent requires Java 6");
    }
  }
}
