{
  TypeReference[] typeReference=new TypeReference[]{null};
  expression.accept(new BaseExpressionVisitor(){
    @Override public void load(    LocalVariable variable){
      typeReference[0]=variable.type();
    }
  }
);
  if (typeReference[0] == null) {
    throw new IllegalStateException("Did never load an expression to the stack");
  }
  return typeReference[0];
}
