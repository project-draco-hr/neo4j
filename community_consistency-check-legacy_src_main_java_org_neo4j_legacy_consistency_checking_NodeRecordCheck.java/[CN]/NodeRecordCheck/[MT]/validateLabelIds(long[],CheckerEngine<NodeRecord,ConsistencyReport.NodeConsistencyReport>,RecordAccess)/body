{
  for (  long labelId : labelIds) {
    engine.comparativeCheck(records.label((int)labelId),this);
  }
  boolean outOfOrder=false;
  for (int i=1; i < labelIds.length; i++) {
    if (labelIds[i - 1] > labelIds[i]) {
      engine.report().labelsOutOfOrder(labelIds[i - 1],labelIds[i]);
      outOfOrder=true;
    }
  }
  if (outOfOrder) {
    sort(labelIds);
  }
  for (int i=1; i < labelIds.length; i++) {
    if (labelIds[i - 1] == labelIds[i]) {
      engine.report().labelDuplicate(labelIds[i]);
    }
  }
}
