{
  Map<Integer,Pair<Long,Integer>> debugData=new TreeMap<Integer,Pair<Long,Integer>>();
  MachineInfo master=null;
  int lowestSeq=Integer.MAX_VALUE;
  long highestTxId=-1;
  for (  MachineInfo info : getAllMachines().values()) {
    debugData.put(info.machineId,new Pair<Long,Integer>(info.latestTxId,info.sequenceId));
    if (info.latestTxId >= highestTxId) {
      highestTxId=info.latestTxId;
      if (info.sequenceId < lowestSeq) {
        master=info;
        lowestSeq=info.sequenceId;
      }
    }
  }
  System.out.println("getMaster " + (master != null ? master.machineId : "none") + " based on "+ debugData);
  return master;
}
