def __init__(self, asciidoc_py=None):
    '\n        Locate and import asciidoc.py.\n        Initialize instance attributes.\n        '
    self.options = Options()
    self.attributes = {}
    self.messages = []
    cmd = os.environ.get('ASCIIDOC_PY')
    if cmd:
        if (not os.path.isfile(cmd)):
            raise AsciiDocError(('missing ASCIIDOC_PY file: %s' % cmd))
    elif asciidoc_py:
        cmd = asciidoc_py
        if (not os.path.isfile(cmd)):
            raise AsciiDocError(('missing file: %s' % cmd))
    else:
        for fname in ['asciidoc.py', 'asciidoc.pyc', 'asciidoc']:
            cmd = find_in_path(fname)
            if cmd:
                break
        else:
            for cmd in ['asciidoc.py', 'asciidoc.pyc', 'asciidoc']:
                if os.path.isfile(cmd):
                    break
            else:
                raise AsciiDocError('failed to locate asciidoc')
    self.cmd = os.path.realpath(cmd)
    self.__import_asciidoc()
