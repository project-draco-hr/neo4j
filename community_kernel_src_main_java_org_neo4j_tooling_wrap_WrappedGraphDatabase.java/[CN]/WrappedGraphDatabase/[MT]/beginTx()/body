{
  if (graphdb instanceof AbstractGraphDatabase) {
    return (WrappedTransaction)super.beginTx();
  }
  boolean openTx;
  try {
    onBeginTransaction();
    openTx=true;
  }
 catch (  TransactionNotAllowedException exception) {
    exception.throwCause();
    openTx=false;
  }
  return new WrappedTransaction(this,openTx ? graphdb.beginTx() : null);
}
