{
  if (wait) {
    waitForSyncConnected();
  }
  String rootPath=getRoot();
  String haServerPath=rootPath + "/" + HA_SERVERS_CHILD+ "/"+ machineId;
  try {
    byte[] serverData=getZooKeeper(true).getData(haServerPath,false,null);
    ByteBuffer buffer=ByteBuffer.wrap(serverData);
    int backupPort=buffer.getInt();
    byte length=buffer.get();
    char[] chars=new char[length];
    buffer.asCharBuffer().get(chars);
    String result=String.valueOf(chars);
    log("Read HA server:" + result + " (for machineID "+ machineId+ ") from zoo keeper");
    return new Machine(machineId,0,0,0,result,backupPort);
  }
 catch (  KeeperException e) {
    throw new ZooKeeperException("Couldn't find the HA server: " + rootPath,e);
  }
catch (  InterruptedException e) {
    throw new ZooKeeperException("Interrupted",e);
  }
}
