{
  this.storeDir=conf.get(GraphDatabaseSettings.store_dir);
  machineId=conf.get(server_id);
  backupPort=conf.get(OnlineBackupSettings.online_backup_server);
  clusterServer=NetworkInstance.URI_PROTOCOL + "://" + conf.get(ClusterSettings.cluster_server).getHost(defaultServer())+ ":"+ conf.get(ClusterSettings.cluster_server).getPort();
  haServer="ha://" + conf.get(HaSettings.ha_server).getHost(defaultServer()) + ":"+ conf.get(ClusterSettings.cluster_server).getPort();
  clusterName=conf.get(ClusterSettings.cluster_name);
  allowCreateCluster=conf.get(ClusterSettings.allow_init_cluster);
  asMachine=new Machine(machineId,0,0,0,haServer,backupPort.getPort());
  this.servers=conf.get(HaSettings.coordinators);
  this.sessionTimeout=conf.get(HaSettings.zk_session_timeout);
  sequenceNr="not initialized yet";
  try {
    watcher=new WatcherImpl();
    zooKeeper=new ZooKeeper(getServersAsString(),getSessionTimeout(),watcher);
    watcher.flushUnprocessedEvents(zooKeeper);
  }
 catch (  IOException e) {
    throw new ZooKeeperException("Unable to create zoo keeper client",e);
  }
}
