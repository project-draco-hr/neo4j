{
  try {
    watcher.shutdown();
    this.shutdown=true;
    invalidateMaster();
    cachedMaster=NO_MACHINE;
    getZooKeeper(false).close();
    msgLog.logMessage("zoo client shut down");
  }
 catch (  InterruptedException e) {
    throw new ZooKeeperException("Error closing zookeeper connection",e);
  }
}
