{
  final URL url=new File("/bar/baz.csv").toURI().toURL();
  final GraphDatabaseAPI gdb=mock(GraphDatabaseAPI.class);
  final DependencyResolver mockResolver=mock(DependencyResolver.class);
  when(gdb.getDependencyResolver()).thenReturn(mockResolver);
  final Config config=new Config(MapUtil.stringMap(GraphDatabaseSettings.load_csv_file_url_root.name(),"/var/lib/neo4j/import"));
  when(mockResolver.resolveDependency(eq(Config.class))).thenReturn(config);
  URL accessURL=URLAccessRules.fileAccess().validate(gdb,url);
  URL expected=new File("/var/lib/neo4j/import/bar/baz.csv").toURI().toURL();
  assertEquals(expected,accessURL);
}
