{
  final URL url=new URL("file:///bar/baz.csv");
  final GraphDatabaseAPI gdb=mock(GraphDatabaseAPI.class);
  final DependencyResolver mockResolver=mock(DependencyResolver.class);
  when(gdb.getDependencyResolver()).thenReturn(mockResolver);
  final Config config=new Config(MapUtil.stringMap(GraphDatabaseSettings.allow_file_urls.name(),"false"));
  when(mockResolver.resolveDependency(eq(Config.class))).thenReturn(config);
  try {
    URLAccessRules.fileAccess().validate(gdb,url);
    fail("expected exception not thrown ");
  }
 catch (  URLAccessValidationError error) {
    assertThat(error.getMessage(),equalTo("configuration property 'allow_file_urls' is false"));
  }
}
