{
  Outcome outcome=currentRole.handler.handle(incomingMessage,state,log);
  boolean newLeaderWasElected=leaderChanged(outcome,state.leader());
  state.update(outcome);
  sendMessages(outcome);
  handleTimers(outcome);
  handleLogShipping(outcome);
  driveMembership(outcome);
  volatileLeader.set(outcome.getLeader());
  if (newLeaderWasElected) {
    notifyLeaderChanges(outcome);
  }
  return outcome;
}
