{
  stream.accept(new RecordStream.Visitor(){
    @Override public void visit(    Record record) throws IOException {
      out.handleRecordMessage(record);
    }
    @Override public void addMetadata(    String key,    Object value){
      successMetadata.put(key,value);
    }
  }
);
}
