{
  final PrimitiveLongObjectMap<List<DuplicateCluster>> duplicateClusters=Primitive.longObjectMap();
  for (long headRecordId=0; headRecordId < store.getHighestPossibleIdInUse(); ++headRecordId) {
    PropertyRecord record=store.forceGetRecord(headRecordId);
    if (!record.inUse() || record.getPrevProp() != -1) {
      continue;
    }
    long propertyId=headRecordId;
    while (propertyId != Record.NO_NEXT_PROPERTY.intValue()) {
      record=store.getRecord(propertyId);
      List<PropertyBlock> propertyBlocks=record.getPropertyBlocks();
      scanForDuplicates(propertyId,propertyBlocks);
      propertyId=record.getNextProp();
    }
    final long localHeadRecordId=headRecordId;
    localDuplicateClusters.visitEntries(new PrimitiveIntObjectVisitor<DuplicateCluster,RuntimeException>(){
      @Override public boolean visited(      int key,      DuplicateCluster duplicateCluster){
        List<DuplicateCluster> clusters=duplicateClusters.get(localHeadRecordId);
        if (clusters == null) {
          clusters=new ArrayList<>();
          duplicateClusters.put(localHeadRecordId,clusters);
        }
        clusters.add(duplicateCluster);
        return false;
      }
    }
);
    seenPropertyKeys.clear();
    localDuplicateClusters.clear();
  }
  return duplicateClusters;
}
