{
  if (duplicateClusters.isEmpty()) {
    return;
  }
  try (IndexLookup indexLookup=new IndexLookup(schemaStore,schemaIndexProvider);IndexedConflictsResolver indexedConflictsResolver=new IndexedConflictsResolver(duplicateClusters,indexLookup,nodeStore,propertyStore)){
    if (indexLookup.hasAnyIndexes()) {
      nodeStore.scanAllRecords(indexedConflictsResolver);
    }
  }
   PropertyKeyTokenStore keyTokenStore=propertyStore.getPropertyKeyTokenStore();
  try {
    NonIndexedConflictResolver resolver=new NonIndexedConflictResolver(keyTokenStore,propertyStore);
    duplicateClusters.visitEntries(resolver);
  }
 catch (  InnerIterationIOException e) {
    throw e.getCause();
  }
}
