{
  if (duplicateClusters.isEmpty()) {
    return;
  }
  if (!isIndexStorageEmpty(storeDir)) {
    try (IndexLookup indexLookup=new IndexLookup(schemaStore,schemaIndexProvider);IndexedConflictsResolver indexedConflictsResolver=new IndexedConflictsResolver(duplicateClusters,indexLookup,nodeStore,propertyStore)){
      if (indexLookup.hasAnyIndexes()) {
        nodeStore.scanAllRecords(indexedConflictsResolver);
      }
    }
   }
  PropertyKeyTokenStore keyTokenStore=propertyStore.getPropertyKeyTokenStore();
  NonIndexedConflictResolver resolver=new NonIndexedConflictResolver(keyTokenStore,propertyStore);
  duplicateClusters.visitEntries(resolver);
}
