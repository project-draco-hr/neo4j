{
  long latestTxId=TransactionIdStore.BASE_TX_ID;
  while (condition.getAsBoolean()) {
    TransactionRepresentation representation=factory.nextTransaction(latestTxId);
    try {
      Commitment commitment=transactionAppender.append(representation,LogAppendEvent.NULL);
      commitment.publishAsCommitted();
      latestTxId=commitment.transactionId();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
