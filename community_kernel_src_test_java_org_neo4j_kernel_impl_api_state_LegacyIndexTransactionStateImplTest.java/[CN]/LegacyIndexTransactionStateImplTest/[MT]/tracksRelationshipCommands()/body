{
  LegacyIndexTransactionStateImpl state=newLegacyIndexTxState();
  state.removeRelationship("index1",1,"key1","value1");
  state.addRelationship("index1",1,"key2","value2",11,11);
  state.removeRelationship("index1",2,"key1","value3");
  state.addRelationship("index1",3,"key2","value4",22,22);
  state.addRelationship("index2",4,"key1","value5",33,33);
  IndexDefineCommand indexDefinedCommand=new IndexDefineCommand();
  indexDefinedCommand.getOrAssignIndexNameId("index1");
  indexDefinedCommand.getOrAssignIndexNameId("index2");
  indexDefinedCommand.getOrAssignKeyId("key1");
  indexDefinedCommand.getOrAssignKeyId("key2");
  Set<Command> expectedCommands=new HashSet<>(Arrays.asList(indexDefinedCommand,removeRelationship(1,1,1,"value1"),addRelationship(1,1,2,"value2",11,11),removeRelationship(1,2,1,"value3"),addRelationship(1,3,2,"value4",22,22),addRelationship(2,4,1,"value5",33,33)));
  assertEquals(expectedCommands,extractCommands(state));
}
