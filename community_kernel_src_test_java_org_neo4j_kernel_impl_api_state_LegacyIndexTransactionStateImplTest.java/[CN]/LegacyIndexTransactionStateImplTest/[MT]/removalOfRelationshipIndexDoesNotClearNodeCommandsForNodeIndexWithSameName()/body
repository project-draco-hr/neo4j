{
  LegacyIndexTransactionStateImpl state=newLegacyIndexTxState();
  state.addNode("index",1,"key","value");
  state.addRelationship("index",1,"key","value",11,11);
  state.deleteIndex(IndexEntityType.Relationship,"index");
  IndexDefineCommand indexDefinedCommand=new IndexDefineCommand();
  indexDefinedCommand.getOrAssignIndexNameId("index");
  indexDefinedCommand.getOrAssignKeyId("key");
  IndexCommand.DeleteCommand delete=new IndexCommand.DeleteCommand();
  delete.init(1,IndexEntityType.Relationship.id());
  Set<Command> expectedCommands=new HashSet<>(Arrays.asList(indexDefinedCommand,delete,addNode(1,1,1,"value")));
  assertEquals(expectedCommands,extractCommands(state));
}
