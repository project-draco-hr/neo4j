{
  MasterClientFactory candidate=protocolToFactoryMapping.get(protocolVersion);
  if ((candidate != null) && (currentVersion == null || currentVersion.compareTo(protocolVersion) <= 0)) {
    currentFactory=candidate;
    currentVersion=protocolVersion;
  }
  return candidate;
}
