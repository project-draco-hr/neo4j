{
  this.log=logging.getMessagesLog(getClass());
  this.invalidEpochHandler=invalidEpochHandler;
  protocolToFactoryMapping=new HashMap<>(3,1);
  protocolToFactoryMapping.put(MasterClient201.PROTOCOL_VERSION,new F201(logging,readTimeout,lockReadTimeout,channels,chunkSize));
  protocolToFactoryMapping.put(MasterClient210.PROTOCOL_VERSION,new F210(logging,readTimeout,lockReadTimeout,channels,chunkSize));
  protocolToFactoryMapping.put(MasterClient214.PROTOCOL_VERSION,new F214(logging,readTimeout,lockReadTimeout,channels,chunkSize));
}
