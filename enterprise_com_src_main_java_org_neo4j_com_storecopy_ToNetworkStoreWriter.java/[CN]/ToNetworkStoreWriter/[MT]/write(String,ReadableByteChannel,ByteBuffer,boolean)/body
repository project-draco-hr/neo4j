{
  char[] chars=path.toCharArray();
  targetBuffer.writeShort(chars.length);
  Protocol.writeChars(targetBuffer,chars);
  targetBuffer.writeByte(hasData ? 1 : 0);
  BlockLogBuffer buffer=new BlockLogBuffer(targetBuffer,bufferMonitor);
  int totalWritten=2 + chars.length * 2 + 1;
  if (hasData) {
    totalWritten+=buffer.write(data);
    buffer.close();
  }
  return totalWritten;
}
