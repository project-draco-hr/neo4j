{
  IndexUpdatesValidator validator=newIndexUpdatesValidatorWithMockedDependencies();
  NodeRecord before=new NodeRecord(11);
  NodeRecord after=new NodeRecord(12);
  after.setId(5);
  NodeCommand command=new NodeCommand().init(before,after);
  TransactionRepresentation tx=new PhysicalTransactionRepresentation(Arrays.<Command>asList(command));
  ValidatedIndexUpdates updates=validator.validate(tx,INTERNAL);
  assertNotSame(updates,ValidatedIndexUpdates.NONE);
  LazyIndexUpdates expectedUpdates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,emptyPropCommands,groupedById(command));
  verify(indexingService).validate(eq(expectedUpdates));
}
