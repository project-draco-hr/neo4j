{
  IndexUpdatesValidator validator=newIndexUpdatesValidatorWithMockedDependencies();
  NodeCommand deleteNode1=deleteNode(1);
  NodeCommand deleteNode2=deleteNode(1);
  TransactionRepresentation tx=new PhysicalTransactionRepresentation(Arrays.<Command>asList(deleteNode1,deleteNode2));
  ValidatedIndexUpdates validatedUpdates=validator.validate(tx,INTERNAL);
  assertNotSame(ValidatedIndexUpdates.NONE,validatedUpdates);
  LazyIndexUpdates expectedUpdates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,emptyPropCommands,groupedById(deleteNode1,deleteNode2));
  verify(indexingService).validate(expectedUpdates);
}
