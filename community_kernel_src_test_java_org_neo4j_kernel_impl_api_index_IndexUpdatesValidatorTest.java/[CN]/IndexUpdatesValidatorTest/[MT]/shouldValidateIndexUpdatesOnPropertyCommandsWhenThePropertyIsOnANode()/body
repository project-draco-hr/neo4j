{
  IndexUpdatesValidator validator=newIndexUpdatesValidatorWithMockedDependencies();
  PropertyRecord before=new PropertyRecord(11);
  PropertyRecord after=new PropertyRecord(12);
  after.setNodeId(42);
  PropertyCommand command=new PropertyCommand().init(before,after);
  TransactionRepresentation tx=new PhysicalTransactionRepresentation(Arrays.<Command>asList(command));
  ValidatedIndexUpdates updates=validator.validate(tx,INTERNAL);
  assertNotSame(updates,ValidatedIndexUpdates.NONE);
  LazyIndexUpdates expectedUpdates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,emptyNodeCommands,groupedByNodeId(command));
  verify(indexingService).validate(expectedUpdates);
}
