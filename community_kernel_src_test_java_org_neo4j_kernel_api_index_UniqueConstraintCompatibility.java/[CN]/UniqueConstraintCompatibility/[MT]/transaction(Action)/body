{
  int progress=0;
  try (Transaction tx=db.beginTx()){
    for (    Action action : actions) {
      action.apply(tx);
      progress++;
    }
  }
 catch (  Throwable ex) {
    StringBuilder sb=new StringBuilder("Transaction failed:\n\n");
    for (int i=0; i < actions.length; i++) {
      String mark=progress == i ? " failed --> " : "            ";
      sb.append(mark).append(actions[i]).append('\n');
    }
    ex.addSuppressed(new AssertionError(sb.toString()));
    throw ex;
  }
}
