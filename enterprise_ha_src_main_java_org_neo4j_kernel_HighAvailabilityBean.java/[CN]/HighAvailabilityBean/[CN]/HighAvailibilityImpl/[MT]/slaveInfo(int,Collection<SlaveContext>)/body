{
  List<SlaveTransaction> txInfo=new ArrayList<SlaveTransaction>();
  for (  SlaveContext context : contexts) {
    Map<String,Long> lastTransactions=new HashMap<String,Long>();
    for (    Tx tx : context.lastAppliedTransactions()) {
      lastTransactions.put(tx.getDataSourceName(),tx.getTxId());
    }
    txInfo.add(new SlaveTransaction(context.getEventIdentifier(),lastTransactions));
  }
  ConnectionInformation connection=db.getBroker().getConnectionInformation(machineId);
  JMXServiceURL jmxServiceURL=connection.getJMXServiceURL();
  return new SlaveInfo(jmxServiceURL == null ? null : jmxServiceURL.toString(),connection.getInstanceId(),machineId,false,connection.getLastCommitedTransactionId(),txInfo.toArray(new SlaveTransaction[txInfo.size()]));
}
