{
  Machine machine=new Machine();
  PackStream.Packer packer=machine.packer();
  packer.pack(asMap("one",1,"two",2));
  packer.flush();
  PackValue value=newUnpacker(machine.output()).unpack();
  assertThat(value.isMap(),equalTo(true));
  Map<String,PackValue> map=value.mapValue();
  assertThat(map.size(),equalTo(2));
  assertThat(map.containsKey("one"),equalTo(true));
  assertThat(map.containsKey("two"),equalTo(true));
  assertThat(map.get("one").isInteger(),equalTo(true));
  assertThat(map.get("two").isInteger(),equalTo(true));
  assertThat(map.get("one").longValue(),equalTo(1L));
  assertThat(map.get("two").longValue(),equalTo(2L));
}
