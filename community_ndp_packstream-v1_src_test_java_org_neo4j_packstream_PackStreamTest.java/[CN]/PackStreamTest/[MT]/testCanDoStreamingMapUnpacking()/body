{
  Machine machine=new Machine();
  PackStream.Packer packer=machine.packer();
  packer.packMapHeader(2);
  packer.pack("name");
  packer.pack("Bob");
  packer.pack("cat_ages");
  packer.packListHeader(2);
  packer.pack(4.3);
  packer.pack(true);
  packer.flush();
  PackStream.Unpacker unpacker=newUnpacker(machine.output());
  long size=unpacker.unpackMapHeader();
  String k1=unpacker.unpackText();
  String v1=unpacker.unpackText();
  String k2=unpacker.unpackText();
  long innerSize=unpacker.unpackListHeader();
  double d=unpacker.unpackDouble();
  boolean e=unpacker.unpackBoolean();
  assertEquals(2,size);
  assertEquals(2,innerSize);
  assertEquals("name",k1);
  assertEquals("Bob",v1);
  assertEquals("cat_ages",k2);
  assertEquals(4.3,d,0.0001);
  assertEquals(true,e);
}
