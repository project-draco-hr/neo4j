{
  GraphDatabaseAPI db=(GraphDatabaseAPI)new TestGraphDatabaseFactory().newImpermanentDatabaseBuilder().setConfig(GraphDatabaseSettings.execution_guard_enabled,Settings.TRUE).newGraphDatabase();
  db.beginTx();
  db.getGuard().startOperationsCount(MAX_VALUE);
  db.createNode();
  db.createNode();
  db.createNode();
  Guard.OperationsCount ops1=db.getGuard().stop();
  assertEquals(3,ops1.getOpsCount());
  db.getGuard().startOperationsCount(MAX_VALUE);
  Node n0=db.getNodeById(0);
  Node n1=db.getNodeById(1);
  Node n2=db.getNodeById(2);
  Guard.OperationsCount ops2=db.getGuard().stop();
  assertEquals(3,ops2.getOpsCount());
  db.getGuard().startOperationsCount(MAX_VALUE);
  n0.createRelationshipTo(n1,withName("REL"));
  Guard.OperationsCount ops3=db.getGuard().stop();
  assertEquals(2,ops3.getOpsCount());
  db.getGuard().startOperationsCount(MAX_VALUE);
  for (  Path position : Traversal.description().breadthFirst().relationships(withName("REL")).traverse(n0)) {
    ignore(position);
  }
  Guard.OperationsCount ops4=db.getGuard().stop();
  assertEquals(3,ops4.getOpsCount());
  db.shutdown();
}
