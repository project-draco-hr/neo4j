{
  long remainingSamples=sampleSize;
  final SkipOracle oracle=frequencySkipOracle(frequency);
  final Set<Object> values=new HashSet<>();
  try (TermEnum terms=searcher.getIndexReader().terms()){
    while (remainingSamples > 0 && terms.next()) {
      Term term=terms.term();
      if (!NODE_ID_KEY.equals(term.field())) {
        values.add(term.text());
        remainingSamples--;
      }
      for (int toSkip=oracle.skip(); toSkip > 0 && terms.next(); ) {
        if (!NODE_ID_KEY.equals(terms.term().field())) {
          toSkip--;
        }
      }
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  return ((double)values.size()) / ((double)sampleSize);
}
