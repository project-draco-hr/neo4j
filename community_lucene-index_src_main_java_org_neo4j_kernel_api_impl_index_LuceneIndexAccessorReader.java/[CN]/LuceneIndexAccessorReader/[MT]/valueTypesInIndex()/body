{
  Set<Class> types=new HashSet<>();
  try (TermEnum terms=luceneIndexReader().terms()){
    while (terms.next()) {
      String field=terms.term().field();
      if (!NODE_ID_KEY.equals(field)) {
switch (ValueEncoding.fromKey(field)) {
case Number:
          types.add(Number.class);
        break;
case String:
      types.add(String.class);
    break;
case Array:
  types.add(Array.class);
break;
case Bool:
types.add(Boolean.class);
break;
}
}
}
}
 catch (IOException ex) {
throw new RuntimeException(ex);
}
return types;
}
