{
  NonUniqueIndexSampler sampler=new NonUniqueIndexSampler(bufferSizeLimit);
  org.apache.lucene.index.IndexReader indexReader=luceneIndexReader();
  try (TermEnum terms=indexReader.terms()){
    while (terms.next()) {
      Term term=terms.term();
      if (!NODE_ID_KEY.equals(term.field())) {
        String value=term.text();
        int frequency=terms.docFreq();
        sampler.include(value,frequency);
      }
      checkCancellation();
    }
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  sampler.result(result);
  return indexReader.numDocs();
}
