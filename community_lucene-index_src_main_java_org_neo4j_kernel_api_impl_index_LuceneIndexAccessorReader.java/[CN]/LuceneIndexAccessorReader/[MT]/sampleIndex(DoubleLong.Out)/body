{
  NonUniqueIndexSampler sampler=new NonUniqueIndexSampler(bufferSizeLimit);
  for (  LeafReaderContext readerContext : luceneIndexReader().leaves()) {
    try {
      Terms terms=readerContext.reader().terms(NODE_ID_KEY);
      if (terms != null) {
        TermsEnum termsEnum=terms.iterator();
        int frequency=termsEnum.docFreq();
        BytesRef termsRef;
        while ((termsRef=termsEnum.next()) != null) {
          sampler.include(termsRef.utf8ToString(),frequency);
          checkCancellation();
        }
      }
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  return sampler.result(result);
}
