{
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  fsa.mkdir(testDir.directory());
  RaftTestGroup raftTestGroup=new RaftTestGroup(1,2,3,4);
  long startingLogIndex=123L;
  int numberOfEntriesBeforeRotation=5;
  OnDiskRaftMembershipState<RaftTestMember> state=new OnDiskRaftMembershipState<>(fsa,testDir.directory(),numberOfEntriesBeforeRotation,mock(Supplier.class),new RaftTestMarshal(),NullLogProvider.getInstance());
  startingLogIndex=putSomeStateIn(raftTestGroup,startingLogIndex,numberOfEntriesBeforeRotation,state);
  OnDiskRaftMembershipState<RaftTestMember> restored=new OnDiskRaftMembershipState<>(fsa,testDir.directory(),numberOfEntriesBeforeRotation,mock(Supplier.class),new RaftTestMarshal(),NullLogProvider.getInstance());
  assertEquals(startingLogIndex,restored.logIndex());
}
