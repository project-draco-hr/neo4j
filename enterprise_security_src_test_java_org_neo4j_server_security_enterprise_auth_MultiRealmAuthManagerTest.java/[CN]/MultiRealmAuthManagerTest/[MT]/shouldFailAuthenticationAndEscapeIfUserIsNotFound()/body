{
  manager.start();
  AuthSubject authSubject=manager.login(authToken("unknown\n\t\r\"haxx0r\"","abc123"));
  AuthenticationResult result=authSubject.getAuthenticationResult();
  assertThat(result,equalTo(AuthenticationResult.FAILURE));
  logProvider.assertExactly(error("Login fail for user `%s`","unknown\\n\\t\\r\\\"haxx0r\\\""));
}
