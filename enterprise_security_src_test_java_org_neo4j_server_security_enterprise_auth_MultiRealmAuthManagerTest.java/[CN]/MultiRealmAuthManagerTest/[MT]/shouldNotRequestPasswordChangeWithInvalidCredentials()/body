{
  users.create(newUser("neo","abc123",true));
  manager.start();
  setMockAuthenticationStrategyResult("neo","abc123",AuthenticationResult.SUCCESS);
  setMockAuthenticationStrategyResult("neo","wrong",AuthenticationResult.FAILURE);
  AuthSubject authSubject=manager.login(authToken("neo","wrong"));
  assertThat(authSubject.getAuthenticationResult(),equalTo(AuthenticationResult.FAILURE));
}
