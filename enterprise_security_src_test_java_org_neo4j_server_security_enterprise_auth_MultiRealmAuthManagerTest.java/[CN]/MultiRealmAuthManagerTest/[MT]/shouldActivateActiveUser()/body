{
  final User user=newUser("jake","abc123",false);
  users.create(user);
  manager.start();
  when(authStrategy.authenticate(user,"abc123")).thenReturn(AuthenticationResult.SUCCESS);
  userManager.activateUser("jake");
  setMockAuthenticationStrategyResult("jake","abc123",AuthenticationResult.SUCCESS);
  AuthSubject authSubject=manager.login(authToken("jake","abc123"));
  assertThat(authSubject.getAuthenticationResult(),equalTo(AuthenticationResult.SUCCESS));
}
