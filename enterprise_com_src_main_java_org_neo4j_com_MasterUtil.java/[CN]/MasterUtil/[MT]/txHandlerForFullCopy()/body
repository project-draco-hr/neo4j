{
  return new TxHandler(){
    private final Set<String> visitedDataSources=new HashSet<String>();
    @Override public void accept(    Triplet<String,Long,TxExtractor> tx,    XaDataSource dataSource){
      if (visitedDataSources.add(tx.first())) {
        dataSource.setLastCommittedTxId(tx.second() - 1);
      }
    }
  }
;
}
