{
  List<Triplet<String,Long,TxExtractor>> stream=new ArrayList<Triplet<String,Long,TxExtractor>>();
  XaDataSourceManager dsManager=((AbstractGraphDatabase)graphDb).getConfig().getTxModule().getXaDataSourceManager();
  final XaDataSource dataSource=dsManager.getXaDataSource(dataSourceName);
  if (dataSource == null) {
    throw new RuntimeException("No data source '" + dataSourceName + "' found");
  }
  LogExtractor extractor=getTransactionStreamForDatasource(dataSource,startTx,endTx,stream,MasterUtil.ALL);
  StoreId storeId=((NeoStoreXaDataSource)dsManager.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME)).getStoreId();
  return new Response<Void>(null,storeId,createTransactionStream(Collections.singletonList(dataSourceName),stream,Collections.singletonList(extractor)));
}
