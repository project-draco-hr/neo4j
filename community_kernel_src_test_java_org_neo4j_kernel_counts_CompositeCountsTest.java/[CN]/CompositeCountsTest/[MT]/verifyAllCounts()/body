{
  NeoStore stores=db.resolveDependency(NeoStoreProvider.class).evaluate();
  List<CountsRecordState.Difference> differences=computeCounts(stores).verify(stores.getCounts());
  if (!differences.isEmpty()) {
    StringBuilder error=new StringBuilder();
    for (    CountsRecordState.Difference difference : differences) {
      if (difference.key() instanceof RelationshipKey) {
        RelationshipKey key=(RelationshipKey)difference.key();
        if (key.startLabelId() != ReadOperations.ANY_LABEL && key.endLabelId() != ReadOperations.ANY_LABEL) {
          continue;
        }
      }
      error.append("\n\t").append(difference);
    }
    if (error.length() > 0) {
      fail(error.toString());
    }
  }
}
