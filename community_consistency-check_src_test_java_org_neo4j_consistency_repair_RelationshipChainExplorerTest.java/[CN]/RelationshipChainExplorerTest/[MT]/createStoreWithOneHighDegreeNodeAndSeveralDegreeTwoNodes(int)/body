{
  File storeDirectory=storeLocation.directory();
  GraphDatabaseService database=new GraphDatabaseFactory().newEmbeddedDatabase(storeDirectory.getPath());
  Transaction transaction=database.beginTx();
  try {
    Node denseNode=database.createNode();
    for (int i=0; i < nDegreeTwoNodes; i++) {
      Node degreeTwoNode=database.createNode();
      Node leafNode=database.createNode();
      if (i % 2 == 0) {
        denseNode.createRelationshipTo(degreeTwoNode,TestRelationshipType.CONNECTED);
      }
 else {
        degreeTwoNode.createRelationshipTo(denseNode,TestRelationshipType.CONNECTED);
      }
      degreeTwoNode.createRelationshipTo(leafNode,TestRelationshipType.CONNECTED);
    }
    transaction.success();
  }
  finally {
    transaction.finish();
  }
  database.shutdown();
  PageCache pageCache=pageCacheRule.getPageCache(new DefaultFileSystemAbstraction(),new Config());
  return new StoreAccess(pageCache,storeDirectory.getPath());
}
