{
  final File firstFile=new File(directory.directory(),"file1");
  final File secondFile=new File(directory.directory(),"file2");
  PhysicalWritableLogChannel channel=new PhysicalWritableLogChannel(new PhysicalLogVersionedStoreChannel(fs.open(firstFile,"rw"),1));
  byte byteValue=(byte)4;
  short shortValue=(short)10;
  int intValue=3545;
  long longValue=45849589L;
  float floatValue=45849.332f;
  double doubleValue=458493343D;
  byte[] byteArrayValue=new byte[]{1,4,2,5,3,6};
  char[] charArrayValue=new char[]{'4','5','6','7'};
  channel.put(byteValue);
  channel.putShort(shortValue);
  channel.putInt(intValue);
  channel.putLong(longValue);
  channel.force();
  channel.setChannel(new PhysicalLogVersionedStoreChannel(fs.open(secondFile,"rw"),2));
  channel.putFloat(floatValue);
  channel.putDouble(doubleValue);
  channel.put(byteArrayValue,byteArrayValue.length);
  channel.put(charArrayValue,charArrayValue.length);
  channel.close();
  ByteBuffer firstFileContents=readFile(firstFile);
  assertEquals(byteValue,firstFileContents.get());
  assertEquals(shortValue,firstFileContents.getShort());
  assertEquals(intValue,firstFileContents.getInt());
  assertEquals(longValue,firstFileContents.getLong());
  ByteBuffer secondFileContents=readFile(secondFile);
  assertEquals(floatValue,secondFileContents.getFloat(),0.0f);
  assertEquals(doubleValue,secondFileContents.getDouble(),0.0d);
  byte[] readByteArray=new byte[byteArrayValue.length];
  secondFileContents.get(readByteArray);
  assertArrayEquals(byteArrayValue,readByteArray);
  char[] readCharArray=new char[charArrayValue.length];
  secondFileContents.asCharBuffer().get(readCharArray);
  assertArrayEquals(charArrayValue,readCharArray);
}
