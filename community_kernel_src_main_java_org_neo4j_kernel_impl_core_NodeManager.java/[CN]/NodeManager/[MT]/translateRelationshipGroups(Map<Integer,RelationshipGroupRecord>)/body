{
  Map<String,RelationshipGroupRecord> groups=new HashMap<String,RelationshipGroupRecord>();
  RelationshipType[] types=new RelationshipType[rawGroups.size()];
  int i=0;
  for (  Map.Entry<Integer,RelationshipGroupRecord> entry : rawGroups.entrySet()) {
    RelationshipType type;
    try {
      type=getRelationshipTypeById(entry.getKey());
    }
 catch (    TokenNotFoundException e) {
      throw new InvalidRecordException(entry.getValue() + " refers to missing relationship type " + entry.getKey());
    }
    groups.put(type.name(),entry.getValue());
    types[i++]=type;
  }
  return Pair.of(types,groups);
}
