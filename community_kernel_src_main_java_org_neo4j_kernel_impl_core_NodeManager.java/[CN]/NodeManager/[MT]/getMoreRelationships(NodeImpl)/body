{
  long nodeId=node.getId();
  long position=node.getRelChainPosition();
  Pair<Map<DirectionWrapper,Iterable<RelationshipRecord>>,Long> rels=persistenceManager.getMoreRelationships(nodeId,position);
  node.setRelChainPosition(rels.other());
  ArrayMap<String,RelIdArray> newRelationshipMap=new ArrayMap<String,RelIdArray>();
  Map<Long,RelationshipImpl> relsMap=new HashMap<Long,RelationshipImpl>(150);
  for (  Map.Entry<DirectionWrapper,Iterable<RelationshipRecord>> entry : rels.first().entrySet()) {
    receiveRelationships(entry.getValue(),newRelationshipMap,relsMap,entry.getKey());
  }
  return Pair.of(newRelationshipMap,relsMap);
}
