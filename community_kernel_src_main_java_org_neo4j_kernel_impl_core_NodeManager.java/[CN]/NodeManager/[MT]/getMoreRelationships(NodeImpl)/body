{
  long nodeId=node.getId();
  RelationshipChainPosition position=node.getRelChainPosition();
  Pair<Iterable<RelationshipRecord>,Iterable<RelationshipRecord>> rels=persistenceManager.getMoreRelationships(nodeId,position);
  ArrayMap<String,DirectionedRelIdArray> newRelationshipMap=new ArrayMap<String,DirectionedRelIdArray>();
  Map<Long,RelationshipImpl> relsMap=new HashMap<Long,RelationshipImpl>(150);
  receiveRelationships(rels.first(),newRelationshipMap,relsMap,DirectionWrapper.OUT);
  receiveRelationships(rels.other(),newRelationshipMap,relsMap,DirectionWrapper.IN);
  return Pair.of(newRelationshipMap,relsMap);
}
