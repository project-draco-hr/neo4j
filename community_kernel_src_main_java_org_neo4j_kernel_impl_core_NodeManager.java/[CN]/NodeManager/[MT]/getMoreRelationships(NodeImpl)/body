{
  long nodeId=node.getId();
  long position=node.getRelChainPosition();
  Triplet<Iterable<RelationshipRecord>,Iterable<RelationshipRecord>,Long> rels=persistenceManager.getMoreRelationships(nodeId,position);
  node.setRelChainPosition(rels.third());
  ArrayMap<String,RelIdArray> newRelationshipMap=new ArrayMap<String,RelIdArray>();
  Map<Long,RelationshipImpl> relsMap=new HashMap<Long,RelationshipImpl>(150);
  receiveRelationships(rels.first(),newRelationshipMap,relsMap,Direction.OUTGOING);
  receiveRelationships(rels.second(),newRelationshipMap,relsMap,Direction.INCOMING);
  return Pair.of(newRelationshipMap,relsMap);
}
