{
  Integer typeId=null;
  if (type != null) {
    typeId=relTypeHolder.getIdByName(type.name());
    if (typeId == null) {
      return 0;
    }
  }
  return persistenceManager.getRelationshipCount(nodeImpl.getId(),type == null ? -1 : typeId.intValue(),direction);
}
