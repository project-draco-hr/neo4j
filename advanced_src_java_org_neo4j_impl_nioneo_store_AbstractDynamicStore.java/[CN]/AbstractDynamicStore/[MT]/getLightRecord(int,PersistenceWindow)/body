{
  DynamicRecord record=new DynamicRecord(blockId);
  Buffer buffer=window.getOffsettedBuffer(blockId);
  byte inUse=buffer.get();
  if (inUse != Record.IN_USE.byteValue()) {
    throw new InvalidRecordException("Block not inUse[" + inUse + "] blockId["+ blockId+ "]");
  }
  record.setInUse(true);
  int prevBlock=buffer.getInt();
  record.setPrevBlock(prevBlock);
  int dataSize=getBlockSize() - BLOCK_HEADER_SIZE;
  int nrOfBytes=buffer.getInt();
  int nextBlock=buffer.getInt();
  if (nextBlock != Record.NO_NEXT_BLOCK.intValue() && nrOfBytes < dataSize || nrOfBytes > dataSize) {
    throw new InvalidRecordException("Next block set[" + nextBlock + "] current block illegal size["+ nrOfBytes+ "/"+ dataSize+ "]");
  }
  record.setLength(nrOfBytes);
  record.setNextBlock(nextBlock);
  record.setIsLight(true);
  return record;
}
