{
  FileChannel fileChannel=getFileChannel();
  int recordSize=getBlockSize();
  long fileSize=fileChannel.size();
  long highId=fileSize / recordSize;
  ByteBuffer byteBuffer=ByteBuffer.allocate(1);
  for (long i=highId; i > 0; i--) {
    fileChannel.position(i * recordSize);
    if (fileChannel.read(byteBuffer) > 0) {
      byteBuffer.flip();
      byte inUse=byteBuffer.get();
      byteBuffer.clear();
      if (inUse != 0) {
        return (int)i;
      }
    }
  }
  return 0;
}
