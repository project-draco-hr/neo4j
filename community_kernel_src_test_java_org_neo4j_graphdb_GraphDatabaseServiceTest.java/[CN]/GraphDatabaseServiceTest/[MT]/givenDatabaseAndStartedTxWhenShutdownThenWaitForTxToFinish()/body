{
  final GraphDatabaseService db=new TestGraphDatabaseFactory().newImpermanentDatabase();
  final CountDownLatch started=new CountDownLatch(1);
  Executors.newSingleThreadExecutor().submit(new Runnable(){
    @Override public void run(){
      try (Transaction tx=db.beginTx()){
        started.countDown();
        try {
          Thread.sleep(2000);
        }
 catch (        InterruptedException e) {
          throw new RuntimeException(e);
        }
        db.createNode();
        tx.success();
      }
 catch (      Throwable e) {
        e.printStackTrace();
      }
    }
  }
);
  started.await();
  db.shutdown();
}
