{
  final GraphDatabaseService db=new TestGraphDatabaseFactory().newImpermanentDatabase();
  try (Transaction tx=db.beginTx()){
    try (Transaction nested=db.beginTx()){
      tx.terminate();
      try {
        db.createNode();
        fail("Failed to throw TransactionTerminateException");
      }
 catch (      TransactionTerminatedException ignored) {
      }
    }
   }
   db.shutdown();
}
