{
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(storeDir);
  try {
    new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(storeDir).setConfig(GraphDatabaseSettings.read_only,Settings.TRUE).newGraphDatabase();
    fail();
  }
 catch (  RuntimeException e) {
    assertThat(e.getCause().getCause(),instanceOf(StoreLockException.class));
  }
 finally {
    db.shutdown();
  }
}
