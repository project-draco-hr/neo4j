{
  InMemoryLogChannel channel=new InMemoryLogChannel();
  CommandWriter writer=new CommandWriter(channel);
  NeoStoreRecord before=new NeoStoreRecord();
  NeoStoreRecord after=new NeoStoreRecord();
  after.setNextProp(42);
  writer.visitNeoStoreCommand(new Command.NeoStoreCommand(before,after));
  PhysicalLogCommandReaderV3_0 reader=new PhysicalLogCommandReaderV3_0();
  Command command=reader.read(channel);
  assertTrue(command instanceof Command.NeoStoreCommand);
  Command.NeoStoreCommand neoStoreCommand=(Command.NeoStoreCommand)command;
  assertEquals(before.getNextProp(),neoStoreCommand.getBefore().getNextProp());
  assertEquals(after.getNextProp(),neoStoreCommand.getAfter().getNextProp());
}
