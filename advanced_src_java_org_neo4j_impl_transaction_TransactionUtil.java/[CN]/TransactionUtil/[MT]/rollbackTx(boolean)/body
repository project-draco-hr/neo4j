{
  if (!txStarted) {
    return;
  }
  Object txId=null;
  try {
    UserTransaction ut=TransactionFactory.getUserTransaction();
    txId=getTransactionId(ut);
    if (ut.getStatus() != Status.STATUS_NO_TRANSACTION) {
      ut.rollback();
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Unable to rollback operation",e);
  }
 finally {
    txEnded(false,txId);
  }
}
