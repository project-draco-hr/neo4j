{
  String recordFormat=configuredRecordFormat(config);
  RecordFormats formats=loadRecordFormat(recordFormat);
  if (formats != null) {
    logService.getInternalLog(RecordFormatSelector.class).warn("Selected " + recordFormat.getClass().getName() + " record format.");
    return formats;
  }
  Iterable<RecordFormats.Factory> formatFactories=Service.load(RecordFormats.Factory.class);
  Iterator<RecordFormats.Factory> factoryIterator=formatFactories.iterator();
  RecordFormats recordFormats=factoryIterator.hasNext() ? factoryIterator.next().newInstance() : DEFAULT_AUTOSELECT_FORMAT;
  logService.getInternalLog(RecordFormatSelector.class).warn("Selected " + recordFormats.getClass().getName() + " record "+ "format.");
  return recordFormats;
}
