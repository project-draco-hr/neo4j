{
  for (  NodePropertyUpdate update : this.updates) {
    long nodeId=update.getNodeId();
switch (update.getUpdateMode()) {
case ADDED:
case CHANGED:
      writer.updateDocument(LuceneDocumentStructure.newTermForChangeOrRemove(nodeId),LuceneDocumentStructure.documentRepresentingProperty(nodeId,update.getValueAfter()));
    break;
case REMOVED:
  writer.deleteDocuments(LuceneDocumentStructure.newTermForChangeOrRemove(nodeId));
break;
default :
throw new IllegalStateException("Unknown update mode " + update.getUpdateMode());
}
}
}
