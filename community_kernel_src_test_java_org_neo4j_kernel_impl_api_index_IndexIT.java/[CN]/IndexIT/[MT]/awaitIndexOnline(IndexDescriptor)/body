{
  StatementContext ctx=readOnlyContext();
  long start=System.currentTimeMillis();
  while (true) {
    if (ctx.getIndexState(indexRule) == InternalIndexState.ONLINE) {
      break;
    }
    if (start + 1000 * 10 < System.currentTimeMillis()) {
      throw new RuntimeException("Index didn't come online within a reasonable time.");
    }
  }
}
