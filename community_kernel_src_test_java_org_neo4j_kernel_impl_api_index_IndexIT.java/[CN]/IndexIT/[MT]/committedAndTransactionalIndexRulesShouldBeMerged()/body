{
  long labelId=5, propertyKey=8;
  Transaction tx=db.beginTx();
  StatementContext statement=ctxProvider.getCtxForWriting();
  IndexDescriptor existingRule=statement.addIndexRule(labelId,propertyKey);
  statement.close();
  tx.success();
  tx.finish();
  tx=db.beginTx();
  statement=ctxProvider.getCtxForWriting();
  long propertyKey2=10;
  IndexDescriptor addedRule=statement.addIndexRule(labelId,propertyKey2);
  Set<IndexDescriptor> indexRulesInTx=asSet(statement.getIndexRules(labelId));
  statement.close();
  tx.success();
  tx.finish();
  assertEquals(asSet(existingRule,addedRule),indexRulesInTx);
}
