{
  Node oldReferenceNode=null;
  try {
    oldReferenceNode=getGraphDb().getReferenceNode();
  }
 catch (  RuntimeException e) {
  }
  try {
    GraphDbModule graphDbModule=((EmbeddedGraphDatabase)getGraphDb()).getConfig().getGraphDbModule();
    Node newReferenceNode=getGraphDb().createNode();
    graphDbModule.setReferenceNodeId(newReferenceNode.getId());
    assertEquals(newReferenceNode,getGraphDb().getReferenceNode());
    newReferenceNode.delete();
    if (oldReferenceNode != null) {
      graphDbModule.setReferenceNodeId(oldReferenceNode.getId());
      assertEquals(oldReferenceNode,getGraphDb().getReferenceNode());
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("" + e);
  }
}
