{
  Person person;
  int numberOfStatuses;
  Transaction transaction=graphDb.beginTx();
  try {
    person=getRandomPersonWithFriends();
    numberOfStatuses=20;
    for (int i=0; i < numberOfStatuses; i++) {
      Person friend=getRandomFriendOf(person);
      friend.addStatus("Dum-deli-dum...");
    }
    transaction.success();
  }
  finally {
    transaction.finish();
  }
  transaction=graphDb.beginTx();
  ArrayList<StatusUpdate> updates;
  try {
    updates=fromIterableToArrayList(person.friendStatuses());
    assertThat(updates.size(),equalTo(numberOfStatuses));
    assertUpdatesAreSortedByDate(updates);
  }
  finally {
    transaction.finish();
  }
}
