{
  StatementOperationParts parts=delegate.newStatementOperations();
  CachingStatementOperations cachingContext=new CachingStatementOperations(parts.entityReadOperations(),parts.schemaReadOperations(),persistenceCache,schemaCache);
  parts=parts.override(null,null,cachingContext,null,cachingContext,null,null);
  AuxiliaryStoreOperations auxStoreOperations=parts.resolve(AuxiliaryStoreOperations.class);
  auxStoreOperations=new LegacyAutoIndexAuxStoreOps(auxStoreOperations,propertyKeyTokenHolder,nodeManager.getNodePropertyTrackers(),nodeManager.getRelationshipPropertyTrackers(),nodeManager);
  StateHandlingStatementOperations stateHandlingContext=new StateHandlingStatementOperations(parts.entityReadOperations(),parts.schemaReadOperations(),auxStoreOperations,constraintIndexCreator);
  ConstraintEnforcingEntityWriteOperations constraintEnforcingEntityWriteOperations=new ConstraintEnforcingEntityWriteOperations(stateHandlingContext,stateHandlingContext,stateHandlingContext);
  parts=parts.override(null,null,stateHandlingContext,constraintEnforcingEntityWriteOperations,stateHandlingContext,stateHandlingContext,new SchemaStateConcern(schemaState));
  return parts;
}
