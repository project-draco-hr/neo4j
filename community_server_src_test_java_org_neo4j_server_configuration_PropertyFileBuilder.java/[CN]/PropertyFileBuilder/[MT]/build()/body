{
  File file=new File(directory,"config");
  Map<String,String> properties=MapUtil.stringMap(Configurator.DATABASE_LOCATION_PROPERTY_KEY,directory.getAbsolutePath(),Configurator.RRDB_LOCATION_PROPERTY_KEY,directory.getAbsolutePath(),Configurator.MANAGEMENT_PATH_PROPERTY_KEY,webAdminUri,Configurator.REST_API_PATH_PROPERTY_KEY,webAdminDataUri);
  if (portNo != null)   properties.put(Configurator.WEBSERVER_PORT_PROPERTY_KEY,portNo);
  if (dbTuningPropertyFile != null)   properties.put(Configurator.DB_TUNING_PROPERTY_FILE_KEY,dbTuningPropertyFile);
  for (  Tuple t : nameValuePairs)   properties.put(t.name,t.value);
  ServerTestUtils.writePropertiesToFile(properties,file);
  return file;
}
