{
  if (parameters == null) {
    parameters=new HashMap<String,Object>();
  }
  CypherParser parser=new CypherParser();
  ExecutionResult result;
  Query compiledQuery=parser.parse(query);
  ExecutionEngine engine=new ExecutionEngine(neo4j);
  result=engine.execute(compiledQuery,parameters);
  if (format != null && format.equals(DATA_TABLE)) {
    return new JSONTableRepresentation(result);
  }
  return new CypherResultRepresentation(result);
}
