{
  LogBufferFactory fac=CommonFactories.defaultLogBufferFactory();
  FileChannel channel=new RandomAccessFile("target/var/foobar2","rw").getChannel();
  LogBuffer buffer=fac.create(channel);
  assertEquals(DirectMappedLogBuffer.class,buffer.getClass());
  buffer.putInt(1).putInt(2).putInt(3);
  FileChannel channel2=new RandomAccessFile("target/var/foobar3","rw").getChannel();
  FileChannel dup=fac.combine(channel2,buffer);
  ByteBuffer readInMe=ByteBuffer.allocate(4);
  dup.read(readInMe);
  readInMe.flip();
  assertEquals(1,readInMe.getInt());
  readInMe.flip();
  buffer.force();
  dup.read(readInMe);
  readInMe.flip();
  assertEquals(2,readInMe.getInt());
  readInMe.flip();
  buffer.putInt(4).putInt(5).putInt(6);
  dup.read(readInMe);
  readInMe.flip();
  assertEquals(3,readInMe.getInt());
  readInMe.flip();
  dup.close();
  buffer.force();
}
