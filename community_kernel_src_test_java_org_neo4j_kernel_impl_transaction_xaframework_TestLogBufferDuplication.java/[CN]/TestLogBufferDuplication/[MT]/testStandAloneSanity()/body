{
  ByteBuffer original=ByteBuffer.allocate(20);
  original.putInt(1).putInt(2);
  CloseableByteBuffer closeableOriginal=CloseableByteBuffer.wrap(original);
  closeableOriginal.flip();
  assertEquals(1,closeableOriginal.getInt());
  assertEquals(2,original.getInt());
  assertEquals(8,closeableOriginal.position());
  assertEquals(8,closeableOriginal.limit());
  closeableOriginal.limit(20).position(8);
  original.putInt(3);
  closeableOriginal.putInt(4).flip();
  CloseableByteBuffer dup=closeableOriginal.duplicate();
  assertEquals(1,dup.getInt());
  closeableOriginal.close();
  assertEquals(2,dup.getInt());
  assertEquals(3,dup.getInt());
  assertEquals(4,dup.getInt());
}
