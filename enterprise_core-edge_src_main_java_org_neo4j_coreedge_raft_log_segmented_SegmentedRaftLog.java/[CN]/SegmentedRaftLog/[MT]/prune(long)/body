{
  long pruneIndex=segmentedRaftLogPruner.getIndexToPruneFrom(safeIndex,state.segments);
  SegmentFile oldestNotDisposed=state.segments.prune(pruneIndex);
  state.prevIndex=oldestNotDisposed.header().prevIndex();
  state.prevTerm=oldestNotDisposed.header().prevTerm();
  return state.prevIndex;
}
