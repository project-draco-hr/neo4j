{
  master=mock(Master.class);
  availabilityGuard=new AvailabilityGuard(new FakeClock(),NullLog.getInstance());
  lockManager=new CommunityLockManger();
  local=spy(lockManager.newClient());
  LockResult lockResultOk=new LockResult(LockStatus.OK_LOCKED);
  TransactionStreamResponse<LockResult> responseOk=new TransactionStreamResponse<>(lockResultOk,null,TransactionStream.EMPTY,ResourceReleaser.NO_OP);
  whenMasterAcquireShared().thenReturn(responseOk);
  whenMasterAcquireExclusive().thenReturn(responseOk);
  client=newSlaveLocksClient(lockManager,true);
}
