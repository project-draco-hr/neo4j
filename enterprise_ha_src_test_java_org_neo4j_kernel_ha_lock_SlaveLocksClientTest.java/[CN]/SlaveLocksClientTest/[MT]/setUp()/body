{
  master=mock(Master.class);
  RequestContextFactory requestContextFactory=mock(RequestContextFactory.class);
  AvailabilityGuard availabilityGuard=new AvailabilityGuard(new FakeClock());
  Locks lockManager=new CommunityLockManger();
  local=spy(lockManager.newClient());
  LockResult lockResultOk=new LockResult(LockStatus.OK_LOCKED);
  TransactionStreamResponse<LockResult> responseOk=new TransactionStreamResponse<>(lockResultOk,null,TransactionStream.EMPTY,ResourceReleaser.NO_OP);
  when(master.acquireSharedLock(any(RequestContext.class),any(Locks.ResourceType.class),Matchers.<long[]>anyVararg())).thenReturn(responseOk);
  when(master.acquireExclusiveLock(any(RequestContext.class),any(Locks.ResourceType.class),Matchers.<long[]>anyVararg())).thenReturn(responseOk);
  client=new SlaveLocksClient(master,local,lockManager,requestContextFactory,availabilityGuard,1000);
}
