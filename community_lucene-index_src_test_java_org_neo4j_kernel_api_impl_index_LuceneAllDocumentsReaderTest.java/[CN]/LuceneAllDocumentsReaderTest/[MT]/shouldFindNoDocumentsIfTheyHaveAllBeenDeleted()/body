{
  final String[] elements={"A","B","C"};
  final IndexReader indexReader=mock(IndexReader.class);
  when(indexReader.isDeleted(anyInt())).thenAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      if ((int)invocation.getArguments()[0] >= elements.length) {
        throw new IllegalArgumentException("Doc id out of range");
      }
      return true;
    }
  }
);
  LuceneAllDocumentsReader reader=new LuceneAllDocumentsReader(new SearcherManagerStub(new SearcherStub(indexReader,elements)));
  Iterator<Document> iterator=reader.iterator();
  assertFalse(iterator.hasNext());
}
