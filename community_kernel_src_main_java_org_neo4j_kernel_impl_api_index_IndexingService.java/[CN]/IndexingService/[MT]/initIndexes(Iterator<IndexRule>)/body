{
  for (  IndexRule indexRule : loop(indexRules)) {
    long ruleId=indexRule.getId();
    IndexDescriptor descriptor=createDescriptor(indexRule);
    IndexProxy indexProxy=null;
    InternalIndexState initialState=provider.getInitialState(ruleId);
    logger.info("initIndexes: " + descriptor.toString() + "["+ initialState.name()+ "]");
switch (initialState) {
case ONLINE:
      indexProxy=createOnlineIndexProxy(ruleId,descriptor);
    break;
case POPULATING:
  indexProxy=createRecoveringIndexProxy(ruleId,descriptor);
break;
case FAILED:
indexProxy=createFailedIndexProxy(ruleId,descriptor);
break;
}
indexes.put(ruleId,indexProxy);
}
}
