{
  serviceRunning=false;
  Collection<IndexContext> indexesToStop=new ArrayList<IndexContext>(indexes.values());
  indexes.clear();
  Collection<Future<Void>> indexStopFutures=new ArrayList<Future<Void>>();
  for (  IndexContext index : indexesToStop)   indexStopFutures.add(index.close());
  for (  Future<Void> future : indexStopFutures)   awaitIndexFuture(future);
}
