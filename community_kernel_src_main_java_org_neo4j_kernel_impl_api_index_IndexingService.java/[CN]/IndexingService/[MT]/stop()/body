{
  serviceRunning=false;
  Collection<IndexProxy> indexesToStop=new ArrayList<IndexProxy>(indexes.values());
  indexes.clear();
  Collection<Future<Void>> indexStopFutures=new ArrayList<Future<Void>>();
  for (  IndexProxy index : indexesToStop)   indexStopFutures.add(index.close());
  for (  Future<Void> future : indexStopFutures)   awaitIndexFuture(future);
}
