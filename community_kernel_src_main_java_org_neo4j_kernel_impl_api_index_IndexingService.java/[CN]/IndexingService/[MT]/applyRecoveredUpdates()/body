{
  List<RecoveredTx> recoveredTransactions=currentRecoveredTransactions();
  logger.debug("Applying recovered updates: " + recoveredTransactions);
  monitor.applyingRecoveredData(recoveredTransactions);
  if (!recoveredTransactions.isEmpty()) {
    for (    RecoveredTx recoveredTx : recoveredTransactions) {
      try (IndexUpdaterMap updaterMap=indexMapReference.createIndexUpdaterMap(IndexUpdateMode.RECOVERY,recoveredTx.transactionId)){
        for (        IndexUpdater updater : updaterMap) {
          updater.remove(recoveredTx.recoveredNodeIds);
        }
        for (        long nodeId : recoveredTx.recoveredNodeIds) {
          Iterable<NodePropertyUpdate> updates=storeView.nodeAsUpdates(nodeId);
          applyUpdates(updates,updaterMap);
          monitor.appliedRecoveredData(updates);
        }
      }
     }
  }
  disposeRecoveredTransactions();
}
