{
  FlippableIndexProxy flipper=new FlippableIndexProxy();
  IndexPopulator populator=getPopulatorFromProvider(ruleId);
  PopulatingIndexProxy populatingIndex=new PopulatingIndexProxy(scheduler,descriptor,populator,flipper,storeView,updateableSchemaState,logging);
  flipper.setFlipTarget(singleProxy(populatingIndex));
  flipper.flip();
  flipper.setFlipTarget(new IndexProxyFactory(){
    @Override public IndexProxy create(){
      return new OnlineIndexProxy(descriptor,getOnlineAccessorFromProvider(ruleId));
    }
  }
);
  IndexProxy result=contractCheckedProxy(flipper,false);
  return serviceDecoratedProxy(ruleId,result);
}
