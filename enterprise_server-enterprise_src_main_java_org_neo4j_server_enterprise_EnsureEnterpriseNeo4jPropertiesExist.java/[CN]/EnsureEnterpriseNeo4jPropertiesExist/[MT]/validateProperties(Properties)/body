{
  String dbMode=configProperties.getProperty(Configurator.DB_MODE_KEY,DatabaseMode.SINGLE.name());
  dbMode=dbMode.toUpperCase();
  if (dbMode.equals(DatabaseMode.SINGLE.name())) {
    return true;
  }
  if (!dbMode.equals(DatabaseMode.HA.name())) {
    failureMessage=String.format("Illegal value for %s \"%s\" in %s",Configurator.DB_MODE_KEY,dbMode,Configurator.NEO_SERVER_CONFIG_FILE_KEY);
    return false;
  }
  String dbTuningFilename=configProperties.getProperty(Configurator.DB_TUNING_PROPERTY_FILE_KEY);
  if (dbTuningFilename == null) {
    failureMessage=String.format("High-Availability mode requires %s to be set in %s",Configurator.DB_TUNING_PROPERTY_FILE_KEY,Configurator.NEO_SERVER_CONFIG_FILE_KEY);
    return false;
  }
 else {
    File dbTuningFile=new File(dbTuningFilename);
    if (!dbTuningFile.exists()) {
      failureMessage=String.format("No database tuning file at [%s]",dbTuningFile.getAbsoluteFile());
      return false;
    }
 else {
      Properties dbTuning=new Properties();
      try {
        InputStream tuningStream=new FileInputStream(dbTuningFile);
        try {
          dbTuning.load(tuningStream);
        }
  finally {
          tuningStream.close();
        }
      }
 catch (      IOException e) {
        failureMessage=e.getMessage();
        return false;
      }
      String machineId=null;
      try {
        machineId=getSinglePropertyFromCandidates(dbTuning,ClusterSettings.server_id.name(),CONFIG_KEY_OLD_SERVER_ID,"<not set>");
        if (Integer.parseInt(machineId) < 0) {
          throw new NumberFormatException();
        }
      }
 catch (      NumberFormatException e) {
        failureMessage=String.format("%s in %s needs to be a non-negative integer, not %s",ClusterSettings.server_id.name(),dbTuningFilename,machineId);
        return false;
      }
catch (      IllegalArgumentException e) {
        failureMessage=String.format("%s in %s",e.getMessage(),dbTuningFilename);
        return false;
      }
    }
  }
  return true;
}
