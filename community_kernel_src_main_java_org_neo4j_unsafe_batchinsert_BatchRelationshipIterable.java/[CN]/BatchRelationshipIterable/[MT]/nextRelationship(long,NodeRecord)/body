{
  RelationshipRecord relRecord=relStore.getRecord(relId);
  long firstNode=relRecord.getFirstNode();
  long secondNode=relRecord.getSecondNode();
  long nextRel;
  if (firstNode == nodeId) {
    nextRel=relRecord.getFirstNextRel();
  }
 else   if (secondNode == nodeId) {
    nextRel=relRecord.getSecondNextRel();
  }
 else {
    throw new InvalidRecordException("Node[" + nodeId + "] not part of firstNode["+ firstNode+ "] or secondNode["+ secondNode+ "]");
  }
  return nextRel;
}
