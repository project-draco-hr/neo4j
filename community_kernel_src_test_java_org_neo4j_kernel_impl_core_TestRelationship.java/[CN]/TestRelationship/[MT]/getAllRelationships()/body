{
  Set<Relationship> existingRelationships=addToCollection(at(getGraphDb()).getAllRelationships(),new HashSet<Relationship>());
  Set<Relationship> createdRelationships=new HashSet<>();
  Node node=getGraphDb().createNode();
  for (int i=0; i < 100; i++) {
    createdRelationships.add(node.createRelationshipTo(getGraphDb().createNode(),MyRelTypes.TEST));
  }
  newTransaction();
  Set<Relationship> allRelationships=new HashSet<>();
  allRelationships.addAll(existingRelationships);
  allRelationships.addAll(createdRelationships);
  int count=0;
  for (  Relationship rel : at(getGraphDb()).getAllRelationships()) {
    assertTrue("Unexpected rel " + rel + ", expected one of "+ allRelationships,allRelationships.contains(rel));
    count++;
  }
  assertEquals(allRelationships.size(),count);
}
