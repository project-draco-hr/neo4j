{
  Set<Relationship> existingRelationships=Iterables.addToCollection(getGraphDb().getAllRelationships(),new HashSet<>());
  Set<Relationship> createdRelationships=new HashSet<>();
  Node node=getGraphDb().createNode();
  for (int i=0; i < 100; i++) {
    createdRelationships.add(node.createRelationshipTo(getGraphDb().createNode(),MyRelTypes.TEST));
  }
  newTransaction();
  Set<Relationship> allRelationships=new HashSet<>();
  allRelationships.addAll(existingRelationships);
  allRelationships.addAll(createdRelationships);
  int count=0;
  for (  Relationship rel : getGraphDb().getAllRelationships()) {
    assertTrue("Unexpected rel " + rel + ", expected one of "+ allRelationships,allRelationships.contains(rel));
    count++;
  }
  assertEquals(allRelationships.size(),count);
}
