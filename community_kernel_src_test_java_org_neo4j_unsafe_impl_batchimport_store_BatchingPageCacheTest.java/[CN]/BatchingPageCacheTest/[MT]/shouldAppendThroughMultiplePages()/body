{
  int numberOfRecords=100;
  PageCache pageCache=new BatchingPageCache(FS,numberOfRecords,1,SYNCHRONOUS,NO_MONITOR);
  File file=directory.file("store");
  PagedFile pagedFile=pageCache.map(file,recordSize * recordsPerPage);
  try (PageCursor cursor=pagedFile.io(0,PagedFile.PF_EXCLUSIVE_LOCK)){
    cursor.next();
    for (int i=0; i < numberOfRecords; i++) {
      if (i > 0 && i % recordsPerPage == 0) {
        cursor.next();
      }
      writeRecord(cursor,i);
    }
  }
   pageCache.close();
  assertRecordsAreCorrect(file,numberOfRecords);
}
