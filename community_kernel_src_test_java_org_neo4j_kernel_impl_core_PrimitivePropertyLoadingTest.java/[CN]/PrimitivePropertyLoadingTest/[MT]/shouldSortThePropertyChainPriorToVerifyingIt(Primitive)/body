{
  DefinedProperty property2=Property.booleanProperty(2,true);
  DefinedProperty property1=Property.booleanProperty(1,false);
  DefinedProperty property3=Property.booleanProperty(3,true);
  List<DefinedProperty> values=Arrays.asList(property2,property1,property3);
  @SuppressWarnings("unchecked") CacheLoader<Iterator<DefinedProperty>> loader=mock(CacheLoader.class);
  when(loader.load(entityId)).thenReturn(values.iterator());
  when(loader.load(-1)).thenReturn(values.iterator());
  CacheUpdateListener updateListener=CacheUpdateListener.NO_UPDATES;
  PropertyChainVerifier chainVerifier=mock(PropertyChainVerifier.class);
  ArgumentCaptor<DefinedProperty[]> verifiedProperties=ArgumentCaptor.forClass(DefinedProperty[].class);
  ArgumentCaptor<Primitive> verifiedEntity=ArgumentCaptor.forClass(Primitive.class);
  dataPoint.getProperties(loader,updateListener,chainVerifier);
  verify(chainVerifier).verifySortedPropertyChain(verifiedProperties.capture(),verifiedEntity.capture());
  DefinedProperty[] verifiedPropertiesValue=verifiedProperties.getValue();
  assertTrue(Arrays.equals(verifiedPropertiesValue,new DefinedProperty[]{property1,property2,property3}));
}
