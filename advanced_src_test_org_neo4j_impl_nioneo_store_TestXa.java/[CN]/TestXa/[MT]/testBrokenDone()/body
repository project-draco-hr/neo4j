{
  try {
    Xid xid=new XidImpl(new byte[4],new byte[4]);
    XAResource xaRes=xaCon.getXaResource();
    xaRes.start(xid,XAResource.TMNOFLAGS);
    int node1=ds.nextId(Node.class);
    xaCon.getNodeConsumer().createNode(node1);
    int node2=ds.nextId(Node.class);
    xaCon.getNodeConsumer().createNode(node2);
    int n1prop1=ds.nextId(PropertyStore.class);
    xaCon.getNodeConsumer().addProperty(node1,n1prop1,index("prop1"),"string1");
    xaRes.end(xid,XAResource.TMSUCCESS);
    xaRes.prepare(xid);
    xaRes.commit(xid,false);
    copyLogicalLog();
    ds.close();
    deleteLogicalLogIfExist();
    renameCopiedLogicalLog();
    ds=new NeoStoreXaDataSource("neo","nioneo_logical.log",lockManager,lockReleaser,eventManager);
    xaCon=(NeoStoreXaConnection)ds.getXaConnection();
    xaRes=xaCon.getXaResource();
    assertEquals(1,xaRes.recover(XAResource.TMNOFLAGS).length);
    xaCon.clearAllTransactions();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("" + e);
  }
}
