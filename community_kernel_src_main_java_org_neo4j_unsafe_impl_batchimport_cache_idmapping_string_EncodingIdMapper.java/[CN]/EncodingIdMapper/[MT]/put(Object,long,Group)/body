{
  int groupId=group.id();
  boolean newGroup=false;
  if (currentIdGroup == null) {
    newGroup=true;
  }
 else {
    if (groupId < currentIdGroup.id()) {
      throw new IllegalStateException("Nodes for any specific group must be added in sequence " + "before adding nodes for any other group");
    }
    newGroup=groupId != currentIdGroup.id();
  }
  if (newGroup) {
    endPreviousGroup();
  }
  long code=encoder.encode(inputId);
  dataCache.set(id,code);
  dataStats.register(id);
  radix.registerRadixOf(code);
  if (newGroup) {
    if (idGroupsCursor >= idGroups.length) {
      idGroups=Arrays.copyOf(idGroups,idGroups.length * 2);
    }
    idGroups[idGroupsCursor++]=currentIdGroup=new IdGroup(group,dataStats.highestIndex());
  }
}
