{
  IndexPopulation population=populations.remove(descriptor);
  boolean populationHasAlreadyFailed=population == null;
  if (populationHasAlreadyFailed) {
    return;
  }
  if (t instanceof IndexPopulationFailedKernelException) {
    Throwable cause=t.getCause();
    if (cause instanceof IndexEntryConflictException) {
      t=cause;
    }
  }
  if (!(t instanceof IndexEntryConflictException)) {
    log.error(format("Failed to populate index: [%s]",population.indexUserDescription),t);
  }
  population.flipToFailed(t);
  try {
    population.populator.markAsFailed(failure(t).asString());
    population.populator.close(false);
  }
 catch (  Throwable e) {
    log.error(format("Unable to close failed populator for index: [%s]",population.indexUserDescription),e);
  }
}
