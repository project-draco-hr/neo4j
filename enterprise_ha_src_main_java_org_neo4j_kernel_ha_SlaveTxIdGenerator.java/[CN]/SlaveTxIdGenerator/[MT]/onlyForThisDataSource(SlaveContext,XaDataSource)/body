{
  Pair<String,Long> txForDs=null;
  for (  Pair<String,Long> tx : slaveContext.lastAppliedTransactions()) {
    if (tx.first().equals(dataSource.getName())) {
      txForDs=tx;
      break;
    }
  }
  if (txForDs == null) {
    throw new RuntimeException("Apparently " + slaveContext + " didn't have the XA data source we are commiting ("+ dataSource.getName()+ ")");
  }
  return new SlaveContext(slaveContext.getSessionId(),slaveContext.machineId(),slaveContext.getEventIdentifier(),new Pair[]{txForDs});
}
