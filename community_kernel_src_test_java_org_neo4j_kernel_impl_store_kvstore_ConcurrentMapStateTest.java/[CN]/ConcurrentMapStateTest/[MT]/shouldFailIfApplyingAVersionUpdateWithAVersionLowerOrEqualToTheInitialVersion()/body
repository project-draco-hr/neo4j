{
  long initialVersion=42;
  when(store.version()).thenReturn(initialVersion);
  ConcurrentMapState<?> state=new ConcurrentMapState<>(store,file);
  try {
    state.updater(initialVersion,lock);
    fail("should have thrown");
  }
 catch (  IllegalStateException ex) {
    assertEquals("Cannot apply update with given version " + initialVersion + " when base version is "+ initialVersion,ex.getMessage());
  }
}
