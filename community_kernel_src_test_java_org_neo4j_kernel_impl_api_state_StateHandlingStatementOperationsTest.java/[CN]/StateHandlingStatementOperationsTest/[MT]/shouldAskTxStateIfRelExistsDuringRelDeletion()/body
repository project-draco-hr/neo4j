{
  long relationshipId=42;
  TransactionState txState=mock(TransactionState.class);
  KernelStatement statement=mock(KernelStatement.class);
  when(statement.hasTxStateWithChanges()).thenReturn(true);
  when(statement.txState()).thenReturn(txState);
  StoreReadLayer storeReadLayer=mock(StoreReadLayer.class);
  when(storeReadLayer.relationshipExists(relationshipId)).thenReturn(true);
  StateHandlingStatementOperations context=newTxStateOps(storeReadLayer);
  context.relationshipDelete(statement,relationshipId);
  verify(txState,atLeastOnce()).relationshipIsAddedInThisTx(relationshipId);
  verify(txState).relationshipIsDeletedInThisTx(relationshipId);
  verify(storeReadLayer).relationshipExists(relationshipId);
}
