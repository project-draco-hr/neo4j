{
  final long relationshipId=42;
  KernelStatement statement=mock(KernelStatement.class);
  when(statement.hasTxStateWithChanges()).thenReturn(true);
  when(statement.txState()).thenReturn(new TxState());
  StoreStatement storeStatement=mock(StoreStatement.class);
  when(statement.getStoreStatement()).thenReturn(storeStatement);
  when(storeStatement.acquireSingleRelationshipCursor(relationshipId)).thenReturn(asRelationshipCursor(relationshipId,0,0,1,PropertyCursor.EMPTY));
  StoreReadLayer store=mock(StoreReadLayer.class);
  Mockito.doAnswer(new Answer(){
    @Override public Object answer(    InvocationOnMock invocationOnMock) throws Throwable {
      ((RelationshipVisitor)invocationOnMock.getArguments()[1]).visit(relationshipId,0,0,1);
      return null;
    }
  }
).when(store).relationshipVisit(anyLong(),any(RelationshipVisitor.class));
  StateHandlingStatementOperations context=newTxStateOps(store);
  context.relationshipDelete(statement,relationshipId);
  context.relationshipDelete(statement,relationshipId);
}
