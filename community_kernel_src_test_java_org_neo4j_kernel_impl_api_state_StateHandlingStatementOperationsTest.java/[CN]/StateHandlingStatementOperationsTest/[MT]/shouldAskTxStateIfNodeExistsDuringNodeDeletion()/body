{
  long nodeId=42;
  TransactionState txState=mock(TransactionState.class);
  KernelStatement statement=mock(KernelStatement.class);
  when(statement.hasTxStateWithChanges()).thenReturn(true);
  when(statement.txState()).thenReturn(txState);
  StoreReadLayer storeReadLayer=mock(StoreReadLayer.class);
  when(storeReadLayer.nodeExists(nodeId)).thenReturn(true);
  StateHandlingStatementOperations context=newTxStateOps(storeReadLayer);
  context.nodeDelete(statement,nodeId);
  verify(txState).nodeIsAddedInThisTx(nodeId);
  verify(txState).nodeIsDeletedInThisTx(nodeId);
  verify(storeReadLayer).nodeExists(nodeId);
}
