{
  System.out.println("backing up to running EmbeddedGraphDatabase instance");
  EmbeddedGraphDatabase bNeo=Util.startNeoInstance(location);
  Backup backupComp=new Neo4jBackup(neo,bNeo);
  backupComp.enableFileLogger();
  backupComp.doBackup();
  Util.stopNeo(bNeo);
  bNeo=Util.startNeoInstance(location);
  Transaction bTx=bNeo.beginTx();
  try {
    List<Relationship> rels=new ArrayList<Relationship>();
    for (    Relationship rel : bNeo.getReferenceNode().getRelationships()) {
      rels.add(rel);
    }
    assertEquals(relCount,rels.size());
    bTx.success();
  }
  finally {
    bTx.finish();
  }
  Util.stopNeo(bNeo);
}
