{
  long faultyIndexId=1;
  long validIndexId=2;
  EOFException error=new EOFException("/some/path/somewhere");
  LuceneSchemaIndexProvider provider=newFaultySchemaIndexProvider(faultyIndexId,error);
  InternalIndexState initialState=provider.getInitialState(faultyIndexId);
  assertEquals(InternalIndexState.FAILED,initialState);
  try {
    provider.getPopulationFailure(validIndexId);
    fail("Exception expected");
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(IllegalStateException.class));
  }
}
