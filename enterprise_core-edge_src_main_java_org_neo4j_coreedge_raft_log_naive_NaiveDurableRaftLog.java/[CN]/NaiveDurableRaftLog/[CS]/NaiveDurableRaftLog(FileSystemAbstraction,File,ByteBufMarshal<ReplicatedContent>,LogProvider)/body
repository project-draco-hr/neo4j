{
  this.fileSystem=fileSystem;
  this.directory=directory;
  this.marshal=marshal;
  directory.mkdirs();
  try {
    entriesChannel=fileSystem.open(new File(directory,"entries.log"),"rw");
    contentChannel=fileSystem.open(new File(directory,"content.log"),"rw");
    metaChannel=fileSystem.open(new File(directory,"meta.log"),"rw");
    readMetadata();
    appendIndex=prevIndex + entriesChannel.size() / ENTRY_RECORD_LENGTH;
    contentOffset=contentChannel.size();
    log=logProvider.getLog(getClass());
    log.info("Raft log created. appendIndex: %d",appendIndex);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
