{
  GraphDatabaseAPI graphDb=(GraphDatabaseAPI)new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(directory).setConfig(configuration(true)).newGraphDatabase();
  try {
    generateInitialData(graphDb);
    StoreAccess stores=new StoreAccess(graphDb);
    nodeId=stores.getNodeStore().getHighId();
    relId=stores.getRelationshipStore().getHighId();
    propId=stores.getPropertyStore().getHighId();
    stringPropId=stores.getStringStore().getHighId();
    arrayPropId=stores.getArrayStore().getHighId();
    relTypeId=(int)stores.getRelationshipTypeStore().getHighId();
    propKeyId=(int)stores.getPropertyKeyStore().getHighId();
  }
  finally {
    graphDb.shutdown();
  }
}
