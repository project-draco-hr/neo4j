{
  CompletableFuture<Boolean> caughtUp=membershipWaiter.waitUntilCaughtUpMember(raft.state());
  try {
    caughtUp.get(joinCatchupTimeout,MILLISECONDS);
  }
 catch (  ExecutionException e) {
    log.error("Server failed to join cluster",e.getCause());
    throw e.getCause();
  }
catch (  InterruptedException|TimeoutException e) {
    String message=format("Server failed to join cluster within catchup time limit [%d ms]",joinCatchupTimeout);
    log.error(message,e);
    throw new RuntimeException(message,e);
  }
 finally {
    caughtUp.cancel(true);
  }
}
