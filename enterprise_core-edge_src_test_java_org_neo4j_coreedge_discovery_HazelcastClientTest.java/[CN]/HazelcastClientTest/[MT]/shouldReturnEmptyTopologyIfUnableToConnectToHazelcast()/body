{
  HazelcastConnector connector=mock(HazelcastConnector.class);
  LogProvider logProvider=mock(LogProvider.class);
  Log log=mock(Log.class);
  when(logProvider.getLog(any(Class.class))).thenReturn(log);
  HazelcastInstance hazelcastInstance=mock(HazelcastInstance.class);
  when(connector.connectToHazelcast()).thenThrow(new IllegalStateException());
  when(hazelcastInstance.getSet(anyString())).thenReturn(new HazelcastSet());
  HazelcastClient client=new HazelcastClient(connector,logProvider);
  com.hazelcast.core.Cluster cluster=mock(Cluster.class);
  when(hazelcastInstance.getCluster()).thenReturn(cluster);
  Set<Member> members=asSet(makeMember(1),makeMember(2));
  when(cluster.getMembers()).thenReturn(members);
  ClusterTopology topology=client.currentTopology();
  assertEquals(0,topology.coreMembers().size());
  verify(log).info(startsWith("Failed to read cluster topology from Hazelcast."),any(IllegalStateException.class));
}
