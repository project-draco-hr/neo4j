{
  HazelcastConnector connector=mock(HazelcastConnector.class);
  HazelcastClient client=new HazelcastClient(connector,NullLogProvider.getInstance(),ADDRESS);
  HazelcastInstance hazelcastInstance=mock(HazelcastInstance.class);
  when(connector.connectToHazelcast()).thenReturn(hazelcastInstance);
  when(hazelcastInstance.getSet(anyString())).thenReturn(new HazelcastSet());
  com.hazelcast.core.Cluster cluster=mock(Cluster.class);
  when(hazelcastInstance.getCluster()).thenReturn(cluster);
  when(hazelcastInstance.getExecutorService(anyString())).thenReturn(new StubExecutorService());
  Set<Member> members=asSet(makeMember(1),makeMember(2));
  when(cluster.getMembers()).thenReturn(members);
  ClusterTopology topology=client.currentTopology();
  assertEquals(members.size(),topology.coreMembers().size());
}
