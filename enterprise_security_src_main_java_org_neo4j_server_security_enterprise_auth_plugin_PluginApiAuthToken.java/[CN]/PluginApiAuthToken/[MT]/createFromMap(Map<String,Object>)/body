{
  String scheme=org.neo4j.kernel.api.security.AuthToken.safeCast(org.neo4j.kernel.api.security.AuthToken.SCHEME_KEY,authTokenMap);
  String principal=org.neo4j.kernel.api.security.AuthToken.safeCast(PRINCIPAL,authTokenMap);
  String credentials=null;
  if (scheme.equals(org.neo4j.kernel.api.security.AuthToken.BASIC_SCHEME)) {
    credentials=org.neo4j.kernel.api.security.AuthToken.safeCast(CREDENTIALS,authTokenMap);
  }
 else {
    Object credentialsObject=authTokenMap.get(CREDENTIALS);
    if (credentialsObject instanceof String) {
      credentials=(String)credentialsObject;
    }
  }
  Map<String,Object> parameters=org.neo4j.kernel.api.security.AuthToken.safeCastMap(PARAMETERS,authTokenMap);
  return PluginApiAuthToken.of(principal,credentials != null ? credentials.toCharArray() : null,parameters);
}
