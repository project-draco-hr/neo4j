{
  for (Iterator<MandatoryPropertyConstraintRule> rules=new SchemaStorage(schemaStore).schemaRules(MandatoryPropertyConstraintRule.class); safeHasNext(rules); ) {
    MandatoryPropertyConstraintRule rule=rules.next();
    int[] keys=nodes.get(rule.getLabel());
    if (keys == null) {
      keys=new int[]{rule.getPropertyKey()};
    }
 else {
      keys=Arrays.copyOf(keys,keys.length + 1);
      keys[keys.length - 1]=rule.getPropertyKey();
    }
    nodes.put(rule.getLabel(),keys);
  }
}
