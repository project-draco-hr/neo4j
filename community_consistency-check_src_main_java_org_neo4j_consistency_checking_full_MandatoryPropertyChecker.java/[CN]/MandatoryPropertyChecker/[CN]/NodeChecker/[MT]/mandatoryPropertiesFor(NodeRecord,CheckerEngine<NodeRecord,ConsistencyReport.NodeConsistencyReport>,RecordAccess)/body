{
  PrimitiveIntSet keys=null;
  for (  Long label : getListOfLabels(record,records,engine)) {
    int[] propertyKeys=mandatory.get(label.intValue());
    if (propertyKeys != null) {
      if (keys == null) {
        keys=Primitive.intSet(capacity);
      }
      for (      int key : propertyKeys) {
        keys.add(key);
      }
    }
  }
  return keys;
}
