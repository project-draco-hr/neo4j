{
  final Optional<StoreType> optional=meta.storeType();
  if (optional.isPresent()) {
    final StoreType type=optional.get();
    final File file=meta.file();
    final String fileName=file.getName();
    if (type == StoreType.COUNTS) {
      final String left=StoreFile.COUNTS_STORE_LEFT.fileName(StoreFileType.STORE);
      final String right=StoreFile.COUNTS_STORE_RIGHT.fileName(StoreFileType.STORE);
      assertThat(fileName,anyOf(equalTo(left),equalTo(right)));
    }
 else {
      final String expected=type.getStoreFile().fileName(StoreFileType.STORE);
      assertThat(fileName,equalTo(expected));
      assertTrue("File does not exist " + file.getAbsolutePath(),fsRule.get().fileExists(file));
    }
    final int recordSize=meta.recordSize();
    assertTrue(recordSize == RecordFormat.NO_RECORD_SIZE || recordSize > 0);
  }
 else {
    fail("Assumed all files to have a store type");
  }
}
