{
  DatabaseHealth databaseHealth=mock(DatabaseHealth.class);
  RecordStorageEngine engine=start(recordStorageEngine(databaseHealth));
  try {
    Exception applicationError=executeFailingTransaction(engine);
    verify(databaseHealth).panic(applicationError);
  }
  finally {
    shutdown(engine);
  }
}
