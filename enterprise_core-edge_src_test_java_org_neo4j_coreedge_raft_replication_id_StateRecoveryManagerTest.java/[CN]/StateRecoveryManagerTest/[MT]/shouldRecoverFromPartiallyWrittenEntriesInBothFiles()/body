{
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  fsa.mkdir(testDir.directory());
  StateRecoveryManager manager=new TestOnlyStateRecoveryManager(fsa);
  writeSomeLongsIn(fsa,fileA(),3,4);
  writeSomeLongsIn(fsa,fileB(),5,6);
  writeSomeGarbage(fsa,fileA());
  writeSomeGarbage(fsa,fileB());
  final StateRecoveryManager.RecoveryStatus recovered=manager.recover(fileA(),fileB());
  assertEquals(fileA(),recovered.previouslyInactive());
  assertEquals(fileB(),recovered.previouslyActive());
}
