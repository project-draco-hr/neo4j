{
  try {
    Map<String,Object> args=jsonToMap(data);
    if (!args.containsKey("command")) {
      throw new IllegalArgumentException("Missing 'command' parameter in arguments.");
    }
    ScriptSession scriptSession=getSession(args);
    log.info(scriptSession.toString());
    List<String> resultLines=scriptSession.evaluate((String)args.get("command"));
    return Response.ok(JsonHelper.createJsonFrom(resultLines)).header("Content-Type",MediaType.APPLICATION_JSON).build();
  }
 catch (  IllegalArgumentException e) {
    return Response.status(Status.BAD_REQUEST).build();
  }
}
