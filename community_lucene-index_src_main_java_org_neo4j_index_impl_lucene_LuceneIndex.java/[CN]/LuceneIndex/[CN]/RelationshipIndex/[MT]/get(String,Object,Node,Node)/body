{
  super.assertInTransaction();
  BooleanQuery query=new BooleanQuery();
  if (key != null && valueOrNull != null) {
    query.add(type.get(key,valueOrNull),Occur.MUST);
  }
  addIfNotNull(query,startNodeOrNull,KEY_START_NODE_ID);
  addIfNotNull(query,endNodeOrNull,KEY_END_NODE_ID);
  return query(query,null,null,null);
}
