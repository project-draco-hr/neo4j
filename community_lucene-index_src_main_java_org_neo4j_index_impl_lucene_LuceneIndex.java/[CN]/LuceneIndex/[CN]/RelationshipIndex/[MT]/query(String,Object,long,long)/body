{
  QueryContext context=queryOrQueryObjectOrNull != null && queryOrQueryObjectOrNull instanceof QueryContext ? (QueryContext)queryOrQueryObjectOrNull : null;
  BooleanQuery query=new BooleanQuery();
  if ((context != null && context.getQueryOrQueryObject() != null) || (context == null && queryOrQueryObjectOrNull != null)) {
    query.add(type.query(key,context != null ? context.getQueryOrQueryObject() : queryOrQueryObjectOrNull,context),Occur.MUST);
  }
  addIfAssigned(query,startNode,KEY_START_NODE_ID);
  addIfAssigned(query,endNode,KEY_END_NODE_ID);
  return query(query,null,null,context);
}
