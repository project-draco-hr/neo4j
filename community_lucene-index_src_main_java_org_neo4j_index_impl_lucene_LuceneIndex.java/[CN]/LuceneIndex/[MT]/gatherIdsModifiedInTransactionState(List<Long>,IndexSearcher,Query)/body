{
  if (simpleTransactionStateIds.isEmpty() && fulltextTransactionStateSearcher == null) {
    return PrimitiveLongCollections.emptySet();
  }
  Hits hits=null;
  int fulltextSize=0;
  if (fulltextTransactionStateSearcher != null) {
    hits=new Hits(fulltextTransactionStateSearcher,query,null,null,false);
    fulltextSize=hits.length();
    if (simpleTransactionStateIds.isEmpty() && fulltextSize == 0) {
      return PrimitiveLongCollections.emptySet();
    }
  }
  PrimitiveLongSet set=longSet(simpleTransactionStateIds.size() + fulltextSize);
  for (  Long id : simpleTransactionStateIds) {
    set.add(id);
  }
  for (int i=0; i < fulltextSize; i++) {
    set.add(idFromDoc(hits.doc(i)));
  }
  return set;
}
