{
  if (!config.get(GraphDatabaseSettings.auth_enabled)) {
    throw new IllegalStateException("Attempted to build BasicAuthManager even though " + "configuration setting auth_enabled=false");
  }
  final Path userStoreFile=getUserStoreFile(config);
  final UserRepository userRepository=new FileUserRepository(userStoreFile,logProvider);
  final PasswordPolicy passwordPolicy=new BasicPasswordPolicy();
  return new BasicAuthManager(userRepository,passwordPolicy,systemUTC());
}
