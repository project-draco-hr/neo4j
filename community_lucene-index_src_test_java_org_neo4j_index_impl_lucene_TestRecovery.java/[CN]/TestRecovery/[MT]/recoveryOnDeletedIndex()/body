{
  createIndex();
  Process process=Runtime.getRuntime().exec(new String[]{"java","-cp",System.getProperty("java.class.path"),AddThenDeleteInAnotherTxAndQuit.class.getName(),getDbPath().getPath()});
  assertEquals(0,new ProcessStreamHandler(process,true).waitForResult());
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(getDbPath().getPath());
  Transaction transaction=db.beginTx();
  assertFalse(db.index().existsForNodes("index"));
  assertNotNull(db.index().forNodes("index2").get("key","value").getSingle());
  transaction.finish();
  db.shutdown();
}
