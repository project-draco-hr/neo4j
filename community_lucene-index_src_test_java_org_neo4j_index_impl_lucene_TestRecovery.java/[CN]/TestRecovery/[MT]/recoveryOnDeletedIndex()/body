{
  GraphDatabaseService db=newGraphDbService();
  db.index().forNodes("index");
  db.shutdown();
  Process process=Runtime.getRuntime().exec(new String[]{"java","-Djava.awt.headless=true","-cp",System.getProperty("java.class.path"),AddThenDeleteInAnotherTxAndQuit.class.getName(),getDbPath().getPath()});
  assertEquals(0,new ProcessStreamHandler(process,false).waitForResult());
  db=new GraphDatabaseFactory().newEmbeddedDatabase(getDbPath().getPath());
  assertFalse(db.index().existsForNodes("index"));
  assertNotNull(db.index().forNodes("index2").get("key","value").getSingle());
  db.shutdown();
}
