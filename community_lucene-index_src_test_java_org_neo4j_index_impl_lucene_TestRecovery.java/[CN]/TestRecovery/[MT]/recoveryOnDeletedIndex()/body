{
  createIndex();
  Process process=runJava(AddThenDeleteInAnotherTxAndQuit.class,getDbPath().getPath());
  assertEquals(0,new ProcessStreamHandler(process,false).waitForResult());
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(getDbPath().getPath());
  Transaction transaction=db.beginTx();
  assertFalse(db.index().existsForNodes("index"));
  assertNotNull(db.index().forNodes("index2").get("key","value").getSingle());
  transaction.finish();
  db.shutdown();
}
