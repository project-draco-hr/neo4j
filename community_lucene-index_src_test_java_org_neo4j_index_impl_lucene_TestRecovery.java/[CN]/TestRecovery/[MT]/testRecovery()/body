{
  GraphDatabaseService graphDb=newGraphDbService();
  Index<Node> nodeIndex=graphDb.index().forNodes("node-index");
  Index<Relationship> relIndex=graphDb.index().forRelationships("rel-index");
  RelationshipType relType=DynamicRelationshipType.withName("recovery");
  graphDb.beginTx();
  Node node=graphDb.createNode();
  Node otherNode=graphDb.createNode();
  Relationship rel=node.createRelationshipTo(otherNode,relType);
  nodeIndex.add(node,"key1","string value");
  nodeIndex.add(node,"key2",12345);
  relIndex.add(rel,"key1","string value");
  relIndex.add(rel,"key2",12345);
  graphDb.shutdown();
  final GraphDatabaseService newGraphDb=new GraphDatabaseFactory().newEmbeddedDatabase(getDbPath().getPath());
  newGraphDb.shutdown();
}
