{
  GraphDatabaseService graphDb=newGraphDbService();
  Transaction transaction=graphDb.beginTx();
  try {
    Node node=graphDb.createNode();
    Node otherNode=graphDb.createNode();
    Relationship rel=node.createRelationshipTo(otherNode,withName("recovery"));
    graphDb.index().forNodes("node-index").add(node,"key1","string value");
    graphDb.index().forNodes("node-index").add(node,"key2",12345);
    graphDb.index().forRelationships("rel-index").add(rel,"key1","string value");
    graphDb.index().forRelationships("rel-index").add(rel,"key2",12345);
    transaction.success();
  }
  finally {
    transaction.finish();
    graphDb.shutdown();
  }
  new GraphDatabaseFactory().newEmbeddedDatabase(getDbPath().getPath()).shutdown();
}
