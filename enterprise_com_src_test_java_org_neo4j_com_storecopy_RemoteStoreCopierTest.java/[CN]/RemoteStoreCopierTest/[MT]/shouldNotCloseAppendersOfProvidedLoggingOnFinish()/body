{
  String dir=new File(testDir.directory(),"dir").getAbsolutePath();
  Config config=new Config(stringMap(store_dir.name(),dir));
  ConsoleLogger console=new ConsoleLogger(StringLogger.SYSTEM);
  Logging logging=LogbackWeakDependency.tryLoadLogbackService(config,null,new Monitors());
  StoreCopyClient copier=spy(new StoreCopyClient(config,loadKernelExtensions(),console,logging,fs));
  when(copier.logConfigFileName()).thenReturn("neo4j-logback.xml");
  Response response=mock(Response.class);
  StoreCopyClient.StoreCopyRequester requester=mock(StoreCopyClient.StoreCopyRequester.class);
  when(requester.copyStore(any(StoreWriter.class))).thenReturn(response);
  copier.copyStore(requester,CancellationRequest.NEVER_CANCELLED);
  LoggerContext context=ReflectionUtil.getPrivateField(logging,"loggerContext",LoggerContext.class);
  List<Appender<ILoggingEvent>> appenders=asList(context.getLogger("org.neo4j").iteratorForAppenders());
  assertThat(appenders,not(empty()));
}
