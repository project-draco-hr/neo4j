{
  ClusterMember currentInstance=createClusterMember(1,HighAvailabilityModeSwitcher.UNKNOWN);
  when(observedClusterMembers.getAliveMembers()).thenReturn(Collections.singletonList(currentInstance));
  when(observedClusterMembers.getCurrentMember()).thenReturn(currentInstance);
  when(stateMachine.getCurrentState()).thenReturn(HighAvailabilityMemberState.MASTER);
  ClusterMember self=clusterMembers.getCurrentMember();
  assertEquals(HighAvailabilityModeSwitcher.MASTER,self.getHARole());
}
