{
  ClusterMember currentInstance=createClusterMember(1,HighAvailabilityModeSwitcher.SLAVE);
  ClusterMember otherInstance=createClusterMember(2,HighAvailabilityModeSwitcher.MASTER);
  List<ClusterMember> members=Arrays.asList(currentInstance,otherInstance);
  when(observedClusterMembers.getMembers()).thenReturn(members);
  when(observedClusterMembers.getCurrentMember()).thenReturn(null);
  when(stateMachine.getCurrentState()).thenReturn(HighAvailabilityMemberState.SLAVE);
  assertNull(clusterMembers.getCurrentMember());
  assertEquals(members,clusterMembers.getMembers());
}
