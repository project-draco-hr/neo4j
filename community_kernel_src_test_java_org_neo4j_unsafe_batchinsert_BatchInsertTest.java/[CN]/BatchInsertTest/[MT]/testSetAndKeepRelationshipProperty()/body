{
  BatchInserter inserter=newBatchInserter();
  long from=inserter.createNode(Collections.<String,Object>emptyMap());
  long to=inserter.createNode(Collections.<String,Object>emptyMap());
  long theRel=inserter.createRelationship(from,to,DynamicRelationshipType.withName("TestingPropsHere"),MapUtil.map("foo","bar"));
  inserter.setRelationshipProperty(theRel,"foo2","bar2");
  Map<String,Object> props=inserter.getRelationshipProperties(theRel);
  assertEquals(2,props.size());
  assertEquals("bar",props.get("foo"));
  assertEquals("bar2",props.get("foo2"));
  inserter.shutdown();
  inserter=newBatchInserter();
  props=inserter.getRelationshipProperties(theRel);
  assertEquals(2,props.size());
  assertEquals("bar",props.get("foo"));
  assertEquals("bar2",props.get("foo2"));
  inserter.setRelationshipProperty(theRel,"foo","bar3");
  props=inserter.getRelationshipProperties(theRel);
  assertEquals("bar3",props.get("foo"));
  assertEquals(2,props.size());
  assertEquals("bar3",props.get("foo"));
  assertEquals("bar2",props.get("foo2"));
  inserter.shutdown();
  inserter=newBatchInserter();
  props=inserter.getRelationshipProperties(theRel);
  assertEquals("bar3",props.get("foo"));
  assertEquals(2,props.size());
  assertEquals("bar3",props.get("foo"));
  assertEquals("bar2",props.get("foo2"));
  inserter.shutdown();
}
