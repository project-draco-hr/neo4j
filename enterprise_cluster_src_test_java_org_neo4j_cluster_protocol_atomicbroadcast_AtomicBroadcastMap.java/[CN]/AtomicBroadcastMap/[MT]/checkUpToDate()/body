{
  int tries=100;
  while (lastCommand != null && tries > 0) {
    try {
      this.wait(5000);
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
    }
    tries--;
  }
  if (tries == 0)   throw new IllegalStateException("Timed out waiting for state to be synchronized");
}
