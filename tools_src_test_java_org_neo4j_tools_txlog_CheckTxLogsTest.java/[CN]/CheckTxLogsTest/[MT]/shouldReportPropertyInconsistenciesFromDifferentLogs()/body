{
  File log1=logFile(1);
  File log2=logFile(2);
  File log3=logFile(3);
  writeTxContent(log1,0,new Command.NodeCommand(new NodeRecord(42,false,false,-1,-1,1),new NodeRecord(42,true,false,42,-1,1)),new Command.PropertyCommand(propertyRecord(5,true,-1,-1,777),propertyRecord(5,true,-1,-1,777)),new Command.NodeCommand(new NodeRecord(1,true,true,2,-1,1),new NodeRecord(1,true,false,-1,-1,1)));
  writeTxContent(log2,0,new Command.PropertyCommand(propertyRecord(24,false,-1,-1),propertyRecord(24,true,-1,-1,777)));
  writeTxContent(log3,0,new Command.PropertyCommand(propertyRecord(24,false,-1,-1),propertyRecord(24,true,-1,-1,777)),new Command.NodeCommand(new NodeRecord(42,true,true,42,-1,1),new NodeRecord(42,true,true,42,10,1)),new Command.PropertyCommand(propertyRecord(5,true,-1,-1,777,888),propertyRecord(5,true,-1,9,777,888,999)));
  CapturingInconsistenciesHandler handler=new CapturingInconsistenciesHandler();
  CheckTxLogs checker=new CheckTxLogs(System.out,fsRule.get());
  boolean success=checker.scan(new PhysicalLogFiles(storeDirectory,fsRule.get()),handler,PROPERTY);
  assertFalse(success);
  assertEquals(2,handler.recordInconsistencies.size());
  RecordInconsistency inconsistency1=handler.recordInconsistencies.get(0);
  PropertyRecord seenRecord1=(PropertyRecord)inconsistency1.committed.record();
  PropertyRecord currentRecord1=(PropertyRecord)inconsistency1.current.record();
  assertEquals(24,seenRecord1.getId());
  assertTrue(seenRecord1.inUse());
  assertEquals(24,currentRecord1.getId());
  assertFalse(currentRecord1.inUse());
  assertEquals(2,inconsistency1.committed.logVersion());
  assertEquals(3,inconsistency1.current.logVersion());
  RecordInconsistency inconsistency2=handler.recordInconsistencies.get(1);
  PropertyRecord seenRecord2=(PropertyRecord)inconsistency2.committed.record();
  PropertyRecord currentRecord2=(PropertyRecord)inconsistency2.current.record();
  assertEquals(5,seenRecord2.getId());
  assertEquals(777,seenRecord2.getPropertyBlock(0).getSingleValueInt());
  assertEquals(5,currentRecord2.getId());
  assertEquals(777,currentRecord2.getPropertyBlock(0).getSingleValueInt());
  assertEquals(888,currentRecord2.getPropertyBlock(1).getSingleValueInt());
  assertEquals(1,inconsistency2.committed.logVersion());
  assertEquals(3,inconsistency2.current.logVersion());
}
