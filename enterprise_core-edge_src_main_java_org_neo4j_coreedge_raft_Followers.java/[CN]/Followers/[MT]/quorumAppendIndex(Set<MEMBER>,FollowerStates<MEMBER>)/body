{
  TreeMap<Long,Integer> appendedCounts=new TreeMap<>();
  for (  MEMBER member : votingMembers) {
    long txId=states.get(member).getMatchIndex();
    Integer currentCount=appendedCounts.get(txId);
    if (currentCount == null) {
      appendedCounts.put(txId,1);
    }
 else {
      appendedCounts.put(txId,currentCount + 1);
    }
  }
  int total=0;
  for (  Map.Entry<Long,Integer> entry : appendedCounts.descendingMap().entrySet()) {
    total+=entry.getValue();
    if (MajorityIncludingSelfQuorum.isQuorum(votingMembers.size(),total)) {
      return entry.getKey();
    }
  }
  return -1;
}
