{
  if (masterClient != null) {
    return masterClient;
  }
  MachineInfo master=zooClient.getMaster();
  if (master != null && master.getMachineId() == machineId) {
    throw new ZooKeeperException("I am master, so can't call getMaster() here",new Exception());
  }
  invalidateMaster();
  if (master != null) {
    createMaster(master.getMachineId());
  }
 else {
    createMaster(-1);
  }
  return masterClient;
}
