{
  if (upToLogVersion == INITIAL_LOG_VERSION) {
    return;
  }
  threshold.init();
  long upper=upToLogVersion - 1;
  boolean exceeded=false;
  while (upper >= 0) {
    File file=files.getLogFileForVersion(upper);
    if (!fileSystem.fileExists(file)) {
      return;
    }
    if (fileSystem.getFileSize(file) > LOG_HEADER_SIZE && threshold.reached(file,upper,logFileInformation)) {
      exceeded=true;
      break;
    }
    upper--;
  }
  if (!exceeded) {
    return;
  }
  long lower=upper;
  while (fileSystem.fileExists(files.getLogFileForVersion(lower - 1))) {
    lower--;
  }
  if (upper == upToLogVersion - 1) {
    upper--;
  }
  for (long version=lower; version <= upper; version++) {
    fileSystem.deleteFile(files.getLogFileForVersion(version));
  }
}
