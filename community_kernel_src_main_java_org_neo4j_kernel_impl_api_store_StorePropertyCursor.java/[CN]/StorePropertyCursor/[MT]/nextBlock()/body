{
  if (remainingBlocksToRead > 0) {
    cursor.setOffset(cursor.getOffset() + remainingBlocksToRead * 8);
    remainingBlocksToRead=0;
  }
  int offset=cursor.getOffset();
  if (offset - offsetAtBeginning < PropertyStore.RECORD_SIZE) {
    try {
      do {
        cursor.setOffset(offset);
        header=cursor.getLong();
      }
 while (cursor.shouldRetry());
    }
 catch (    IOException e) {
      throw new UnderlyingStorageException(e);
    }
    type=PropertyType.getPropertyType(header,true);
    if (type != null) {
      seekingForFirstBlock=false;
      keyId=(int)(header & KEY_BITMASK);
      blocks=remainingBlocksToRead=type.calculateNumberOfBlocksUsed(header) - 1;
      return true;
    }
  }
  if (seekingForFirstBlock) {
    throw new NotFoundException("Property record with id " + currentRecordId + " not in use");
  }
 else {
    cursor.close();
    cursor=null;
    return false;
  }
}
