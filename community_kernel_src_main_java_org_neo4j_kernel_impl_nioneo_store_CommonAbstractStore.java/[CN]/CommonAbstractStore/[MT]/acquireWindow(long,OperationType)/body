{
  if (!isInRecoveryMode() && (position > getHighId() || !storeOk)) {
    throw new InvalidRecordException("Position[" + position + "] requested for high id["+ getHighId()+ "], store is ok["+ storeOk+ "] recovery["+ isInRecoveryMode()+ "]",causeOfStoreNotOk);
  }
  try {
    return windowPool.acquire(position,type);
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException("Could not acquire " + type + " window for position "+ position,e);
  }
}
