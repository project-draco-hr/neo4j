{
  this.storageFileName=fileName;
  this.configuration=configuration;
  this.idGeneratorFactory=idGeneratorFactory;
  this.pageCache=pageCache;
  this.fileSystemAbstraction=fileSystemAbstraction;
  this.idType=idType;
  this.stringLogger=stringLogger;
  this.versionMismatchHandler=versionMismatchHandler;
  this.readOnly=configuration.get(Configuration.read_only);
  try {
    checkStorage();
    checkVersion();
    loadStorage();
  }
 catch (  Exception e) {
    releaseFileLockAndCloseFileChannel();
    throw launderedException(e);
  }
}
