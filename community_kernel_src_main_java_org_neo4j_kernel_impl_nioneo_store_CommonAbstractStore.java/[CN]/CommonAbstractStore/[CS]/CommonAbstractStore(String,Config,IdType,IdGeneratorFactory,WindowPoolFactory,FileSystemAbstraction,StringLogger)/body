{
  this.storageFileName=fileName;
  this.configuration=configuration;
  this.idGeneratorFactory=idGeneratorFactory;
  this.windowPoolFactory=windowPoolFactory;
  this.fileSystemAbstraction=fileSystemAbstraction;
  this.idType=idType;
  this.stringLogger=stringLogger;
  grabFileLock=configuration.get(Configuration.grab_file_lock);
  try {
    checkStorage();
    checkVersion();
    loadStorage();
  }
 catch (  Exception e) {
    releaseFileLockAndCloseFileChannel();
    throw launderedException(e);
  }
}
