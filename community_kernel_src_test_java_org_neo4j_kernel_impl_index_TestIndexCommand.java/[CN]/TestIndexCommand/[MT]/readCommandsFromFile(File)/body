{
  FileInputStream in=null;
  ReadableByteChannel reader=null;
  List<XaCommand> commands;
  try {
    in=new FileInputStream(file);
    reader=in.getChannel();
    ByteBuffer buffer=ByteBuffer.allocate(10000);
    commands=new ArrayList<XaCommand>();
    while (true) {
      XaCommand command=readCommand(reader,buffer);
      if (command == null) {
        break;
      }
      commands.add(command);
    }
  }
  finally {
    if (in != null)     in.close();
    if (reader != null)     reader.close();
  }
  return commands;
}
