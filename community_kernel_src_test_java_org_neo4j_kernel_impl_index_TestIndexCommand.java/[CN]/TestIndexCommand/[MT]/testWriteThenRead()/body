{
  List<XaCommand> commands=new ArrayList<XaCommand>();
  IndexDefineCommand definitions=new IndexDefineCommand();
  commands.add(definitions);
  commands.add(definitions.create(indexName1,Node.class,someConfig));
  commands.add(definitions.add(indexName1,Node.class,nodeId1,key1,stringValue1));
  commands.add(definitions.add(indexName1,Node.class,nodeId1,key2,stringValue2));
  commands.add(definitions.addRelationship(indexName2,Relationship.class,relId1,key3,intValue,nodeId2,nodeId3));
  commands.add(definitions.remove(indexName1,Node.class,nodeId2,key1,stringValue1));
  commands.add(definitions.delete(indexName2,Relationship.class));
  File file=writeCommandsToFile(commands);
  List<XaCommand> readCommands=readCommandsFromFile(file);
  Iterator<XaCommand> commandIterator=commands.iterator();
  for (  XaCommand readCommand : readCommands) {
    assertEquals(commandIterator.next(),readCommand);
  }
  file.delete();
}
