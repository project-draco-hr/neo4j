{
  RaftMachine raft=mock(RaftMachine.class);
  when(raft.isLeader()).thenReturn(true);
  RoleProcedure proc=new CoreRoleProcedure(raft);
  RawIterator<Object[],ProcedureException> result=proc.apply(null,null);
  assertEquals(RoleProcedure.Role.LEADER.name(),single(result)[0]);
}
