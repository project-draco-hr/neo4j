{
  clusterManager=new ClusterManager(clusterOfSize(2),TargetDirectory.forTest(getClass()).cleanDirectory("deleteRecords"),stringMap());
  clusterManager.start();
  ClusterManager.ManagedCluster cluster=clusterManager.getDefaultCluster();
  cluster.await(ClusterManager.allSeesAllAsAvailable());
  HighlyAvailableGraphDatabase master=cluster.getMaster();
  HighlyAvailableGraphDatabase slave=cluster.getAnySlave();
  Relationship rel;
  Transaction tx=slave.beginTx();
  try {
    rel=slave.createNode().createRelationshipTo(slave.createNode(),withName("FOO"));
    tx.success();
  }
  finally {
    tx.finish();
  }
  Transaction transaction=master.beginTx();
  try {
    assertNotNull(master.getRelationshipById(rel.getId()));
  }
  finally {
    transaction.finish();
  }
  tx=slave.beginTx();
  try {
    rel.delete();
    tx.success();
  }
  finally {
    tx.finish();
  }
  slave.shutdown();
  master.shutdown();
}
