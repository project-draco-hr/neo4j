{
  Map<String,String> inputParams=new HashMap<String,String>();
  inputParams.put(GraphDatabaseSettings.read_only.name(),"true");
  FileSystemAbstraction fileSystemAbstraction=new CannedFileSystemAbstraction(false,null,null,true);
  StoreLocker storeLocker=new StoreLocker(new Config(inputParams),fileSystemAbstraction);
  try {
    storeLocker.checkLock(target.directory("unused",true));
    fail();
  }
 catch (  StoreLockException e) {
    String msg="Unable to lock store as store dir does not exist and instance is in read-only mode";
    assertThat(e.getMessage(),is(msg));
  }
}
