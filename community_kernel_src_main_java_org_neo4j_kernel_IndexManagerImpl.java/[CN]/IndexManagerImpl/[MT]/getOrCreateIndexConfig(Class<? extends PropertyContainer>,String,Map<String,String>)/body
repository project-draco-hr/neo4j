{
  Pair<Map<String,String>,Boolean> result=findIndexConfig(cls,indexName,suppliedConfig,config.getParams());
  if (result.other()) {
    ExecutorService executorService=Executors.newSingleThreadExecutor();
    try {
      executorService.submit(new IndexCreatorJob(cls,indexName,result.first())).get();
    }
 catch (    ExecutionException ex) {
      throw new TransactionFailureException("Index creation failed for " + indexName + ", "+ result.first(),ex.getCause());
    }
catch (    InterruptedException ex) {
      Thread.interrupted();
    }
 finally {
      executorService.shutdownNow();
    }
  }
  return result.first();
}
