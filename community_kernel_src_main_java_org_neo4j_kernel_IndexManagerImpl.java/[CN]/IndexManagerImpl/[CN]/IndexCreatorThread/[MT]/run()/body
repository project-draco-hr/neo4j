{
  String provider=config.get(PROVIDER);
  String dataSourceName=getIndexProvider(provider).getDataSourceName();
  XaDataSource dataSource=graphDbImpl.getConfig().getTxModule().getXaDataSourceManager().getXaDataSource(dataSourceName);
  IndexXaConnection connection=(IndexXaConnection)dataSource.getXaConnection();
  Transaction tx=graphDbImpl.tx().begin();
  try {
    javax.transaction.Transaction javaxTx=graphDbImpl.getConfig().getTxModule().getTxManager().getTransaction();
    javaxTx.enlistResource(connection.getXaResource());
    connection.createIndex(cls,indexName,config);
    tx.success();
  }
 catch (  Exception e) {
    this.exception=e;
  }
 finally {
    try {
      tx.finish();
    }
 catch (    Exception e) {
      this.exception=e;
    }
  }
}
