{
  db=(GraphDatabaseAPI)new TestEnterpriseGraphDatabaseFactory().newImpermanentDatabase();
  internalRealm=new InternalFlatFileRealm(new InMemoryUserRepository(),new InMemoryRoleRepository(),new BasicPasswordPolicy(),new RateLimitedAuthenticationStrategy(systemUTC(),3));
  manager=new MultiRealmAuthManager(internalRealm,Collections.singletonList(internalRealm));
  manager.init();
  manager.start();
  userManager=manager.getUserManager();
  userManager.newUser("noneSubject","abc",false);
  userManager.newUser("pwdSubject","abc",true);
  userManager.newUser("adminSubject","abc",false);
  userManager.newUser("schemaSubject","abc",false);
  userManager.newUser("readWriteSubject","abc",false);
  userManager.newUser("readSubject","123",false);
  userManager.addUserToRole("adminSubject",ADMIN);
  userManager.addUserToRole("schemaSubject",ARCHITECT);
  userManager.addUserToRole("readWriteSubject",PUBLISHER);
  userManager.addUserToRole("readSubject",READER);
  userManager.newRole("empty");
  noneSubject=manager.login(authToken("noneSubject","abc"));
  pwdSubject=manager.login(authToken("pwdSubject","abc"));
  readSubject=manager.login(authToken("readSubject","123"));
  writeSubject=manager.login(authToken("readWriteSubject","abc"));
  schemaSubject=manager.login(authToken("schemaSubject","abc"));
  adminSubject=manager.login(authToken("adminSubject","abc"));
  db.execute("UNWIND range(0,2) AS number CREATE (:Node {number:number})");
}
