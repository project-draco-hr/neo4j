{
  AvailableMemoryCalculator memory=mock(AvailableMemoryCalculator.class);
  when(memory.availableHeapMemory()).thenReturn(10 * MEGA);
  NumberArrayFactory factory=new NumberArrayFactory.Auto(memory,10 * KILO);
  LongArray array=factory.newLongArray(1 * KILO,0);
  array.set(1 * KILO - 10,12345);
  assertTrue(array instanceof HeapLongArray);
  assertEquals(12345,array.get(1 * KILO - 10));
}
