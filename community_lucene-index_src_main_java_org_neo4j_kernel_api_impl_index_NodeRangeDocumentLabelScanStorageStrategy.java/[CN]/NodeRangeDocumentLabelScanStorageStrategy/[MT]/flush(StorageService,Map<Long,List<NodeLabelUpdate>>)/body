{
  for (  Document document : updatedDocuments(storage,updates)) {
    if (isEmpty(document)) {
      storage.deleteDocuments(format.rangeTerm(document));
    }
 else {
      storage.updateDocument(format.rangeTerm(document),document);
    }
  }
  storage.refreshSearcher();
}
