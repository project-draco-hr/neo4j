{
  final Collection<File> files=new ArrayList<File>();
  final Collection<SnapshotDeletionPolicy> snapshots=new ArrayList<SnapshotDeletionPolicy>();
  for (  Map.Entry<IndexIdentifier,Pair<IndexWriter,AtomicBoolean>> writer : indexWriters.entrySet()) {
    SnapshotDeletionPolicy deletionPolicy=(SnapshotDeletionPolicy)writer.getValue().first().getConfig().getIndexDeletionPolicy();
    File indexDirectory=getFileDirectory(baseStorePath,writer.getKey());
    for (    String fileName : deletionPolicy.snapshot(SNAPSHOT_ID).getFileNames()) {
      files.add(new File(indexDirectory,fileName));
    }
    snapshots.add(deletionPolicy);
  }
  files.add(providerStore.getFile());
  return new ClosableIterable<File>(){
    public Iterator<File> iterator(){
      return files.iterator();
    }
    public void close(){
      for (      SnapshotDeletionPolicy deletionPolicy : snapshots) {
        try {
          deletionPolicy.release(SNAPSHOT_ID);
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
      }
    }
  }
;
}
