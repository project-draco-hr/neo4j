{
  Pair<IndexSearcherRef,AtomicBoolean> searcher=indexSearchers.get(identifier);
  if (searcher == null) {
    searcher=synchGetIndexSearcher(identifier,false);
  }
 else {
synchronized (searcher) {
      if (searcher.first().isClosed()) {
        searcher=synchGetIndexSearcher(identifier,false);
      }
 else       if (searcher.other().get()) {
        IndexWriter writer=getIndexWriter(identifier);
        searcher=refreshSearcher(searcher,writer);
        if (searcher != null) {
          indexSearchers.put(identifier,searcher);
        }
      }
    }
  }
  if (incRef) {
    searcher.first().incRef();
  }
  return searcher.first();
}
