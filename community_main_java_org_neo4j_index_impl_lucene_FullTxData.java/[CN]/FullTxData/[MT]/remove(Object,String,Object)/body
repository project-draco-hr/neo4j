{
  try {
    ensureLuceneDataInstantiated();
    long id=entityId instanceof Long ? (Long)entityId : ((RelationshipId)entityId).id;
    Document document=LuceneDataSource.findDocument(index.type,searcher(),id);
    if (document != null) {
      index.type.removeFromDocument(document,key,value);
      if (LuceneDataSource.documentIsEmpty(document)) {
        writer.deleteDocuments(index.type.idTerm(id));
      }
 else {
        writer.updateDocument(index.type.idTerm(id),document);
      }
    }
    invalidateSearcher();
    return this;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
