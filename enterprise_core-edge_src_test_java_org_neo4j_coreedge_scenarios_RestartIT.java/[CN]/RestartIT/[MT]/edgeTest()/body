{
  Cluster cluster=clusterRule.withNumberOfCoreMembers(2).withNumberOfEdgeMembers(1).startCluster();
  final GraphDatabaseService coreDB=cluster.awaitLeader(5000).database();
  try (Transaction tx=coreDB.beginTx()){
    Node node=coreDB.createNode(label("boo"));
    node.setProperty("foobar","baz_bat");
    tx.success();
  }
   cluster.addCoreMemberWithId(2).start();
  cluster.shutdown();
  for (  CoreClusterMember core : cluster.coreMembers()) {
    ConsistencyCheckService.Result result=new ConsistencyCheckService().runFullConsistencyCheck(core.storeDir(),Config.defaults(),ProgressMonitorFactory.NONE,FormattedLogProvider.toOutputStream(System.out),new DefaultFileSystemAbstraction(),false);
    assertTrue("Inconsistent: " + core,result.isSuccessful());
  }
  for (  EdgeClusterMember edge : cluster.edgeMembers()) {
    ConsistencyCheckService.Result result=new ConsistencyCheckService().runFullConsistencyCheck(edge.storeDir(),Config.defaults(),ProgressMonitorFactory.NONE,FormattedLogProvider.toOutputStream(System.out),new DefaultFileSystemAbstraction(),false);
    assertTrue("Inconsistent: " + edge,result.isSuccessful());
  }
}
