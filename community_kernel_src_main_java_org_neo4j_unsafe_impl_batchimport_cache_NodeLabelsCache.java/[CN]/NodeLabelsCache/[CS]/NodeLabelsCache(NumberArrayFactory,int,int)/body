{
  this.cache=cacheFactory.newDynamicLongArray(chunkSize,0);
  this.spillOver=cacheFactory.newDynamicLongArray(chunkSize / 5,0);
  this.bitsPerLabel=max(Integer.SIZE - numberOfLeadingZeros(highLabelId),1);
  int worstCaseLongsNeeded=((bitsPerLabel * (highLabelId + 1)) - 1) / Long.SIZE + 1;
  this.labelScratch=new long[worstCaseLongsNeeded];
  this.labelBits=bitsFromLongs(labelScratch);
}
