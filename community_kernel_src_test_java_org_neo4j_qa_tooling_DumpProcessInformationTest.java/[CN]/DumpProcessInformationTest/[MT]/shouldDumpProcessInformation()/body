{
  File directory=testDirectory.directory("dump");
  String java=ProcessUtil.getJavaExecutable().toString();
  Process process=getRuntime().exec(new String[]{java,"-cp",ProcessUtil.getClassPath(),DumpableProcess.class.getName(),SIGNAL});
  awaitSignal(process);
  DumpProcessInformation dumper=new DumpProcessInformation(NullLogProvider.getInstance(),directory);
  Collection<Pair<Long,String>> pids=dumper.getJPids(containsString(DumpableProcess.class.getSimpleName()));
  assumeThat(pids.size(),greaterThan(0));
  Pair<Long,String> pid=single(pids);
  File threaddumpFile=dumper.doThreadDump(pid);
  process.destroy();
  assertTrue(fileContains(threaddumpFile,"traceableMethod",DumpableProcess.class.getName()));
}
