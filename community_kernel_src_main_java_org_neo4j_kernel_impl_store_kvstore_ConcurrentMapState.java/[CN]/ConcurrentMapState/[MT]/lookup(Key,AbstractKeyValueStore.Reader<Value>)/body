{
  byte[] value=changes.get(key);
  if (value != null) {
    return valueReader.parseValue(new BigEndianByteArrayBuffer(value));
  }
  ValueFetcher<Key,Value> lookup=new ValueFetcher<>(keys,key,valueReader);
  try {
    if (store.scan(lookup,lookup)) {
      return lookup.value;
    }
  }
 catch (  RuntimeException e) {
    throw new IOException("Lookup failure for key=" + key,e);
  }
  return valueReader.defaultValue();
}
