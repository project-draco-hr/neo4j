{
  try {
    Pair<File,KeyValueStoreFile> next=rotation.next(file,headers,keys.filter(dataProvider()));
    return new ConcurrentMapState<>(rotation,keys,next.other(),next.first());
  }
  finally {
    store.close();
  }
}
