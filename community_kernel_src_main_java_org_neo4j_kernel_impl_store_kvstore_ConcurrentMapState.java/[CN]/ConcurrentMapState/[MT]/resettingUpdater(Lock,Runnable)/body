{
  if (hasChanges()) {
    throw new IllegalStateException("Cannot reset when there are changes!");
  }
  return new EntryUpdater<Key>(lock){
    @Override public void apply(    Key key,    ValueUpdate update) throws IOException {
      ensureOpen();
      applyUpdate(store,changes,key,update,true);
    }
    @Override public void close(){
      try {
        closeAction.run();
      }
  finally {
        super.close();
      }
    }
  }
;
}
