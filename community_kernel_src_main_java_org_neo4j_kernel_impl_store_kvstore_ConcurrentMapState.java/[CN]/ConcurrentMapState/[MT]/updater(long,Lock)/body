{
  if (version <= previousVersion) {
    throw new IllegalStateException("Cannot apply update with given version " + version + " when base version is "+ previousVersion);
  }
  update(highestAppliedVersion,version);
  return new Updater<>(lock,store,changes,appliedChanges);
}
