{
  try (Transaction tx=db.beginTx()){
    db.index().forNodes("index");
    tx.success();
  }
   String storeDir=db.getStoreDir();
  shutdownDB();
  Process process=Runtime.getRuntime().exec(new String[]{"java","-cp",System.getProperty("java.class.path"),AddThenDeleteInAnotherTxAndQuit.class.getName(),storeDir});
  assertEquals(0,new ProcessStreamHandler(process,false).waitForResult());
  startDB();
  try (Transaction tx=db.beginTx()){
    assertFalse(db.index().existsForNodes("index"));
    assertNotNull(db.index().forNodes("index2").get("key","value").getSingle());
  }
 }
