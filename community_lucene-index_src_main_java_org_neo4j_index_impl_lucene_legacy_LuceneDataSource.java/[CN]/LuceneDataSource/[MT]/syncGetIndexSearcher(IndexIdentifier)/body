{
  try {
    IndexReference searcher=indexSearchers.get(identifier);
    if (searcher == null) {
      IndexWriter writer=newIndexWriter(identifier);
      IndexReader reader=DirectoryReader.open(writer,true);
      IndexSearcher indexSearcher=newIndexSearcher(identifier,reader);
      searcher=new IndexReference(identifier,indexSearcher,writer);
      indexSearchers.put(identifier,searcher);
    }
 else {
synchronized (searcher) {
        searcher=refreshSearcherIfNeeded(searcher);
      }
    }
    searcher.incRef();
    return searcher;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
