{
  if (log == null) {
    throw new IllegalArgumentException("log cannot be null ");
  }
  Config config=new Config(emptyMap(),asList(ServerSettings.class,GraphDatabaseSettings.class));
  config.setLogger(log);
  if (configFile != null && configFile.exists()) {
    config.augment(loadFromFile(log,configFile));
  }
  config.augment(loadFromFile(log,legacyConfigFile));
  overrideEmbeddedDefaults(config);
  applyUserOverrides(config,configOverrides);
  return config;
}
