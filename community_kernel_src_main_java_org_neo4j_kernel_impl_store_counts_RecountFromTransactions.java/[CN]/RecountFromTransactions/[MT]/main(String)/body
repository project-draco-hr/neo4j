{
  if (args.length != 1) {
    System.err.println("Expecting exactly one argument describing the path to the store");
    System.exit(1);
  }
  final FileSystemAbstraction fs=new DefaultFileSystemAbstraction();
  File path=new File(args[0]);
  if (!fs.isDirectory(path)) {
    System.err.println(args[0] + " is not a directory.");
    System.exit(1);
  }
  TransactionStream transactions=new TransactionStream(fs,path);
  if (transactions.firstTransactionId() != 1 || !transactions.isContiguous()) {
    System.err.println("Transaction stream is not contiguous:" + transactions.rangeString("\n\t"));
    System.exit(1);
  }
  File nodeStore=new File(path,"recount-from-tx");
  try (StandalonePageCache pages=createPageCache(fs,"recount-from-tx")){
    StoreFactory factory=new StoreFactory(fs,path,pages,StringLogger.DEV_NULL,new Monitors());
    CountsRecordState counts=rebuildCounts(transactions);
    DumpCountsStore dump=new DumpCountsStore(System.out,factory);
    System.out.println("Expected counts:");
    counts.accept(dump);
    verifyCounts(factory,counts,dump);
  }
  finally {
    deleteStore(fs,nodeStore);
    deleteStore(fs,nodeLabelStore(nodeStore));
  }
}
