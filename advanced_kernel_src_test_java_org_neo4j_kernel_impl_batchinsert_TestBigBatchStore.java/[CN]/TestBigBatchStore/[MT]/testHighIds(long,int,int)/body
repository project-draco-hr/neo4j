{
  if (!machineIsOkToRunThisTest(testName.getMethodName(),requiredHeapMb)) {
    return;
  }
  long idBelow=highMark - minus;
  setHighId(IdType.NODE,idBelow);
  setHighId(IdType.RELATIONSHIP,idBelow);
  setHighId(IdType.PROPERTY,idBelow);
  setHighId(IdType.ARRAY_BLOCK,idBelow);
  setHighId(IdType.STRING_BLOCK,idBelow);
  String propertyKey="name";
  int intPropertyValue=123;
  String stringPropertyValue="Long string, longer than would fit in shortstring";
  long[] arrayPropertyValue=new long[]{1021L,321L,343212L};
  long nodeBelowTheLine=db.createNode(map(propertyKey,intPropertyValue));
  assertEquals(idBelow,nodeBelowTheLine);
  long nodeAboveTheLine=db.createNode(map(propertyKey,stringPropertyValue));
  long relBelowTheLine=db.createRelationship(nodeBelowTheLine,nodeAboveTheLine,this,map(propertyKey,arrayPropertyValue));
  assertEquals(idBelow,relBelowTheLine);
  long relAboveTheLine=db.createRelationship(nodeAboveTheLine,nodeBelowTheLine,this,null);
  assertEquals(highMark,relAboveTheLine);
  assertEquals(highMark,nodeAboveTheLine);
  assertEquals(intPropertyValue,db.getNodeProperties(nodeBelowTheLine).get(propertyKey));
  assertEquals(stringPropertyValue,db.getNodeProperties(nodeAboveTheLine).get(propertyKey));
  assertTrue(Arrays.equals(arrayPropertyValue,(long[])db.getRelationshipProperties(relBelowTheLine).get(propertyKey)));
  assertEquals(asSet(asList(relBelowTheLine,relAboveTheLine)),asIds(db.getRelationships(idBelow)));
  db.shutdown();
  db=new BatchInserterImpl(PATH);
  assertEquals(asSet(asList(relBelowTheLine,relAboveTheLine)),asIds(db.getRelationships(idBelow)));
  db.shutdown();
  GraphDatabaseService edb=new EmbeddedGraphDatabase(PATH);
  assertEquals(nodeAboveTheLine,edb.getNodeById(highMark).getId());
  assertEquals(relBelowTheLine,edb.getNodeById(idBelow).getSingleRelationship(this,Direction.OUTGOING).getId());
  assertEquals(relAboveTheLine,edb.getNodeById(idBelow).getSingleRelationship(this,Direction.INCOMING).getId());
  assertEquals(asSet(asList(edb.getRelationshipById(relBelowTheLine),edb.getRelationshipById(relAboveTheLine))),asSet(asCollection(edb.getNodeById(idBelow).getRelationships())));
  edb.shutdown();
  db=new BatchInserterImpl(PATH);
}
