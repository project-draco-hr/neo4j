{
  AvailableMemoryCalculator memory=mock(AvailableMemoryCalculator.class);
  when(memory.availableHeapMemory()).thenReturn(1 * MEGA);
  when(memory.availableOffHeapMemory()).thenReturn(10 * MEGA);
  LongArrayFactory factory=new LongArrayFactory.AutoLongArrayFactory(memory,10 * KILO);
  LongArray array=factory.newLongArray(1 * MEGA);
  assertTrue(array instanceof OffHeapLongArray);
}
