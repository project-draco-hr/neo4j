{
  Collection<Triplet<Integer,Long,Integer>> debugData=new ArrayList<Triplet<Integer,Long,Integer>>();
  Machine master=null;
  int lowestSeq=Integer.MAX_VALUE;
  long highestTxId=-1;
  for (  Machine info : machines) {
    debugData.add(Triplet.of(info.getMachineId(),info.getLastCommittedTxId(),info.getSequenceId()));
    if (info.getLastCommittedTxId() != -1 && info.getLastCommittedTxId() >= highestTxId) {
      if (info.getLastCommittedTxId() > highestTxId || info.wasCommittingMaster() || (!master.wasCommittingMaster() && info.getSequenceId() < lowestSeq)) {
        master=info;
        lowestSeq=info.getSequenceId();
        highestTxId=info.getLastCommittedTxId();
      }
    }
  }
  log("getMaster " + (master != null ? master.getMachineId() : "none") + " based on "+ debugData);
  return master != null ? master : Machine.NO_MACHINE;
}
