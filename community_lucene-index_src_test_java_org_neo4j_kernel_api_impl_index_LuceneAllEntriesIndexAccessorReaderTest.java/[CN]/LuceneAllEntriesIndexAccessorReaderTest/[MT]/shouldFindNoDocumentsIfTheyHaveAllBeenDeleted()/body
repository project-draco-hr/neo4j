{
  final Long[] nodeIds={12L,34L,567L};
  final IndexReader indexReader=mock(IndexReader.class);
  when(indexReader.isDeleted(anyInt())).thenAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      if ((int)invocation.getArguments()[0] >= nodeIds.length) {
        throw new IllegalArgumentException("Doc id out of range");
      }
      return true;
    }
  }
);
  LuceneAllEntriesIndexAccessorReader reader=new LuceneAllEntriesIndexAccessorReader(new SearcherManagerStub(new SearcherStub(indexReader,nodeIds)),new LuceneDocumentStructure());
  Iterator<Long> iterator=reader.iterator();
  Collection<Long> actualNodeIds=IteratorUtil.asCollection(iterator);
  assertTrue(actualNodeIds.isEmpty());
}
