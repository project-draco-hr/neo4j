{
  stream.accept(new RecordStream.Visitor(){
    @Override public void visit(    Record record) throws Exception {
      handler.onRecord(record);
    }
    @Override public void addMetadata(    String key,    Object value){
      metadata.put(key,value);
    }
  }
);
}
