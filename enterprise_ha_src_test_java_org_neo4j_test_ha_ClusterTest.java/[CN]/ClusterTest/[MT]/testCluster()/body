{
  ClusterManager clusterManager=new ClusterManager(fromXml(getClass().getResource("/threeinstances.xml").toURI()),TargetDirectory.forTest(getClass()).directory("testCluster",true),MapUtil.stringMap(HaSettings.ha_server.name(),":6001-6005",HaSettings.tx_push_factor.name(),"2"));
  clusterManager.start();
  clusterManager.getDefaultCluster().await(ClusterManager.allSeesAllAsAvailable());
  GraphDatabaseAPI master=clusterManager.getDefaultCluster().getMaster();
  Transaction tx=master.beginTx();
  Node node=master.createNode();
  long nodeId=node.getId();
  node.setProperty("foo","bar");
  tx.success();
  tx.finish();
  node=clusterManager.getDefaultCluster().getAnySlave().getNodeById(nodeId);
  Assert.assertThat(node.getProperty("foo").toString(),CoreMatchers.equalTo("bar"));
  clusterManager.stop();
}
