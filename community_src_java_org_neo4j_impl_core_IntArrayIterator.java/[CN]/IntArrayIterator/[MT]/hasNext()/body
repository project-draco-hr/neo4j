{
  if (nextElement != null) {
    return true;
  }
  do {
    if (currentTypeIterator.hasNext()) {
      int nextId=currentTypeIterator.next();
      try {
        Relationship possibleElement=nodeManager.getRelationshipById(nextId);
        if (direction == Direction.INCOMING && possibleElement.getEndNode().equals(fromNode)) {
          nextElement=possibleElement;
          return true;
        }
 else         if (direction == Direction.OUTGOING && possibleElement.getStartNode().equals(fromNode)) {
          nextElement=possibleElement;
          return true;
        }
 else         if (direction == Direction.BOTH) {
          nextElement=possibleElement;
          return true;
        }
      }
 catch (      Throwable t) {
        log.log(Level.FINE,"Unable to get relationship " + nextId,t);
      }
    }
    while (!currentTypeIterator.hasNext() && typeIterator.hasNext()) {
      currentTypeIterator=typeIterator.next();
    }
  }
 while (currentTypeIterator.hasNext());
  return nextElement != null;
}
