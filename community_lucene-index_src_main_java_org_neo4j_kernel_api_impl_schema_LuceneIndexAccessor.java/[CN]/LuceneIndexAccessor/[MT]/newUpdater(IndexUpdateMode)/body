{
  if (luceneIndex.isReadOnly()) {
    throw new UnsupportedOperationException("Can't create updated for read only index.");
  }
switch (mode) {
case ONLINE:
    return new LuceneIndexUpdater(writer,false);
case RECOVERY:
  return new LuceneIndexUpdater(writer,true);
default :
throw new IllegalArgumentException("Unsupported update mode: " + mode);
}
}
