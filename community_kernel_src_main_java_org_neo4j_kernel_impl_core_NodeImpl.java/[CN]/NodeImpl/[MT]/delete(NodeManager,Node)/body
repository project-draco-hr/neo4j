{
  nodeManager.acquireLock(proxy,LockType.WRITE);
  boolean success=false;
  TransactionState tx=nodeManager.getTransactionState();
  try {
    ArrayMap<Integer,PropertyData> skipMap=tx.getOrCreateCowPropertyRemoveMap(this);
    ArrayMap<Integer,PropertyData> removedProps=nodeManager.deleteNode(this,tx);
    if (removedProps.size() > 0) {
      for (      Integer index : removedProps.keySet()) {
        skipMap.put(index,removedProps.get(index));
      }
    }
    success=true;
  }
  finally {
    nodeManager.releaseLock(proxy,LockType.WRITE,tx);
    if (!success) {
      nodeManager.setRollbackOnly();
    }
  }
}
