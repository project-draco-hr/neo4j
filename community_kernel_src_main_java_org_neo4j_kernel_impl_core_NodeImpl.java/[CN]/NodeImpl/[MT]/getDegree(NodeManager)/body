{
  int count=0;
  TransactionState state=nm.getTransactionState();
  boolean hasStateChanges=state.hasChanges();
  if (!hasStateChanges || !state.getCreatedNodes().contains(getId())) {
    count=nm.getRelationshipCount(this,null,DirectionWrapper.BOTH);
  }
  if (hasStateChanges) {
    count+=degreeFromTxState(nm,DirectionWrapper.BOTH);
  }
  return count;
}
