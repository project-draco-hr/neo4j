{
  PrimitiveLongSet result=Primitive.longSet(relationships.length * 3);
  for (  RelIdArray ids : relationships) {
    for (    DirectionWrapper direction : DirectionWrapper.values()) {
      long firstId=direction.firstId(ids);
      if (firstId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
        result.add(firstId);
      }
    }
  }
  return result;
}
