{
  ensureRelationshipMapNotNull(nodeManager);
  List<RelIdIterator> relTypeList=new LinkedList<RelIdArray.RelIdIterator>();
  boolean hasModifications=nodeManager.getLockReleaser().hasRelationshipModifications(this);
  for (  RelationshipType type : types) {
    RelIdArray src=getRelIdArray(type.name());
    RelIdArray remove=null;
    RelIdArray add=null;
    if (hasModifications) {
      remove=nodeManager.getCowRelationshipRemoveMap(this,type.name());
      add=nodeManager.getCowRelationshipAddMap(this,type.name());
    }
    relTypeList.add(RelIdArray.from(src != null ? src : new RelIdArray.EmptyRelIdArray(type.name()),add,remove).iterator(direction));
  }
  return relTypeList;
}
