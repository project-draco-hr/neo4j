{
  ensureRelationshipMapNotNull(nodeManager,direction,NO_RELATIONSHIP_TYPES,loader);
  boolean hasMore=hasMoreRelationshipsToLoad(direction,NO_RELATIONSHIP_TYPES);
  int numberOfRelIdArrays=relationships.length;
  RelIdIterator[] result=new RelIdIterator[numberOfRelIdArrays];
  for (int i=0; i < numberOfRelIdArrays; i++) {
    RelIdArray src=relationships[i];
    RelIdIterator iterator=src.iterator(direction);
    result[i]=iterator;
  }
  if (result.length == 0) {
    return PrimitiveLongCollections.emptyIterator();
  }
  return new RelationshipIterator(result,this,direction,NO_RELATIONSHIP_TYPES,nodeManager,hasMore,true,loader);
}
