{
  if (offset + length > data.length) {
    throw new IOException("Asked to write " + length + " bytes, but there is only "+ (data.length - offset)+ " bytes available in data provided.");
  }
  int index=0;
  while (index < length) {
    if (buffer.remaining() == 0) {
      flush();
    }
    int amountToWrite=Math.min(buffer.remaining(),length - index);
    buffer.put(data,offset + index,amountToWrite);
    index+=amountToWrite;
  }
  return this;
}
