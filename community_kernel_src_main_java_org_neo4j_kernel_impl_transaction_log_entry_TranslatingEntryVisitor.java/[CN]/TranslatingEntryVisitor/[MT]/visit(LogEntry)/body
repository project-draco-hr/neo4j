{
  if (startEntry == null) {
    if (logEntry == null || logEntry.getType() != TX_START) {
      throw new IOException("Unable to find start entry");
    }
    startEntry=(LogEntryStart)logEntry;
  }
  if (logEntry.getVersion() != CURRENT_LOG_ENTRY_VERSION) {
    if (entries == null) {
      entries=new LinkedList<>();
    }
    entries.add(logEntry);
    if (logEntry.getType() == TX_1P_COMMIT) {
      entries=translator.apply(entries);
      for (      LogEntry entry : entries) {
        entry.accept(handler);
      }
      entries=null;
    }
  }
 else {
    logEntry.accept(handler);
  }
  return true;
}
