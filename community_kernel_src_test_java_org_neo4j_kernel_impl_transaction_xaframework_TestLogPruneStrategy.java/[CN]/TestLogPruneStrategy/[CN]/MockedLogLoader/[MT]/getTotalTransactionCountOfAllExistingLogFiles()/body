{
  if (getHighestLogVersion() == 0) {
    return 0;
  }
  long upper=getHighestLogVersion() - 1;
  long lower=upper;
  while (lower >= 0) {
    File file=getFileName(lower - 1);
    if (!FS.fileExists(file)) {
      break;
    }
 else {
      lower--;
    }
  }
  return (int)(getLastCommittedTxId() - getFirstCommittedTxId(lower));
}
