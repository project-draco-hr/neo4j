{
  if (getHighestLogVersion() == 0)   return 0;
  long upper=getHighestLogVersion() - 1;
  long lower=upper;
  while (lower >= 0) {
    File file=new File(getFileName(lower - 1));
    if (!file.exists())     break;
 else     lower--;
  }
  return (int)(getLastCommittedTxId() - getFirstCommittedTxId(lower));
}
