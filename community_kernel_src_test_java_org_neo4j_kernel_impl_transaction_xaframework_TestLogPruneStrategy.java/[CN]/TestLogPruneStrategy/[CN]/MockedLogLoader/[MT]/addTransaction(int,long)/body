{
  InMemoryLogBuffer tempLogBuffer=new InMemoryLogBuffer();
  XidImpl xid=new XidImpl(getNewGlobalId(DEFAULT_SEED,0),RESOURCE_XID);
  LogIoUtils.writeStart(tempLogBuffer,identifier,xid,-1,-1,date,Long.MAX_VALUE);
  LogIoUtils.writeCommand(tempLogBuffer,identifier,new TestXaCommand(commandSize));
  LogIoUtils.writeCommit(false,tempLogBuffer,identifier,++tx,date);
  LogIoUtils.writeDone(tempLogBuffer,identifier);
  tempLogBuffer.read(activeBuffer);
  if (!timestamps.containsKey(version)) {
    timestamps.put(version,date);
  }
  boolean rotate=(activeBuffer.capacity() - activeBuffer.remaining()) >= logSize;
  if (rotate) {
    rotate();
  }
  return rotate;
}
