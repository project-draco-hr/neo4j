{
  InMemoryLogBuffer tempLogBuffer=new InMemoryLogBuffer();
  LogIoUtils.writeStart(tempLogBuffer,identifier,new XidImpl(XidImpl.getNewGlobalId(),RESOURCE_XID),-1,-1,date,Long.MAX_VALUE);
  LogIoUtils.writeCommand(tempLogBuffer,identifier,new TestXaCommand(commandSize));
  LogIoUtils.writeCommit(false,tempLogBuffer,identifier,++tx,date);
  LogIoUtils.writeDone(tempLogBuffer,identifier);
  tempLogBuffer.read(activeBuffer);
  if (!timestamps.containsKey(version))   timestamps.put(version,date);
  boolean rotate=(activeBuffer.capacity() - activeBuffer.remaining()) >= logSize;
  if (rotate)   rotate();
  return rotate;
}
