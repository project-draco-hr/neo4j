{
  int fileCount=5;
  MockedLogLoader log=new MockedLogLoader(LogPruneStrategies.nonEmptyFileCount(FS,fileCount));
  for (int i=0; i < 100; i++) {
    log.addTransactionsUntilRotationHappens();
    long from=Math.max(0,log.getHighestLogVersion() - fileCount);
    assertLogsRangeExists(log,from,log.getHighestLogVersion() - 1);
  }
}
