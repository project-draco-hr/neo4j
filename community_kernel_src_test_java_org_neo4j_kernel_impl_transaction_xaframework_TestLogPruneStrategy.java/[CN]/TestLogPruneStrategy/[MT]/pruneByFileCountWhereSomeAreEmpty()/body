{
  MockedLogLoader log=new MockedLogLoader(LogPruneStrategies.nonEmptyFileCount(FS,3));
  log.addTransactionsUntilRotationHappens();
  assertLogsRangeExists(log,0,0);
  log.rotate();
  assertLogsRangeExists(log,0,1,empty(1));
  log.rotate();
  assertLogsRangeExists(log,0,2,empty(1,2));
  log.addTransactionsUntilRotationHappens();
  assertLogsRangeExists(log,0,3,empty(1,2));
  log.addTransactionsUntilRotationHappens();
  assertLogsRangeExists(log,0,4,empty(1,2));
  log.rotate();
  assertLogsRangeExists(log,0,5,empty(1,2,5));
  log.addTransactionsUntilRotationHappens();
  assertLogsRangeExists(log,3,6,empty(5));
}
