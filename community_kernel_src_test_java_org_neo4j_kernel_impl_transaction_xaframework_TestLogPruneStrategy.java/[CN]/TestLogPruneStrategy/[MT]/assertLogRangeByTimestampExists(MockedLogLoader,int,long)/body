{
  long lowerLimit=lastTimestamp - millisToKeep;
  for (long version=log.getHighestLogVersion() - 1; version >= 0; version--) {
    Long firstTimestamp=log.getFirstStartRecordTimestamp(version + 1);
    if (firstTimestamp == null) {
      break;
    }
    assertTrue("Log " + version + " should've been deleted by now. first of "+ (version + 1)+ ":"+ firstTimestamp+ ", highestVersion:"+ log.getHighestLogVersion()+ ", lowerLimit:"+ lowerLimit+ ", timestamp:"+ lastTimestamp,firstTimestamp >= lowerLimit);
  }
}
