{
  if (thread != null) {
    if (thread != Thread.currentThread()) {
      throw new IllegalStateException("Closing on different thread.");
    }
    lock.unlock();
    thread=null;
  }
}
