{
  boolean interrupted=false;
  for (long timeout=10; !lock.tryLock(); timeout=Math.min(1000,timeout * 2)) {
    try {
      if (lock.tryLock(timeout,TimeUnit.MILLISECONDS)) {
        return;
      }
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
      interrupted=true;
    }
  }
  if (interrupted) {
    Thread.currentThread().interrupt();
  }
}
