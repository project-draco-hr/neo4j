{
  if (buffer == null) {
    newBuffer();
  }
 else   if (buffer.writableBytes() < size) {
    flush();
  }
  if (!chunkOpen) {
    currentChunkHeaderOffset=buffer.writerIndex();
    buffer.writerIndex(buffer.writerIndex() + CHUNK_HEADER_SIZE);
    chunkOpen=true;
  }
  return this;
}
