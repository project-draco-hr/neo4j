{
  ensureOpen();
  readWriteLock.lock();
  try {
    List<IndexPartition> partitions=getPartitions();
    if (hasSinglePartition(partitions)) {
      return new SimpleLuceneLabelScanWriter(getFirstPartition(partitions),format,heldLock);
    }
    throw new UnsupportedOperationException();
  }
  finally {
    readWriteLock.unlock();
  }
}
