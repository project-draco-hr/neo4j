{
  Transaction tx=graphDb.beginTx();
  try {
    Node thomas=graphDb.createNode();
    thomas.setProperty("name","Thomas Anderson");
    thomas.setProperty("age",29);
    Node referenceNode=graphDb.getReferenceNode();
    referenceNode.createRelationshipTo(thomas,RelTypes.NEO_NODE);
    Node trinity=graphDb.createNode();
    trinity.setProperty("name","Trinity");
    Relationship rel=thomas.createRelationshipTo(trinity,RelTypes.KNOWS);
    rel.setProperty("age","3 days");
    Node morpheus=graphDb.createNode();
    morpheus.setProperty("name","Morpheus");
    morpheus.setProperty("rank","Captain");
    morpheus.setProperty("occupation","Total badass");
    thomas.createRelationshipTo(morpheus,RelTypes.KNOWS);
    rel=morpheus.createRelationshipTo(trinity,RelTypes.KNOWS);
    rel.setProperty("age","12 years");
    Node cypher=graphDb.createNode();
    cypher.setProperty("name","Cypher");
    cypher.setProperty("last name","Reagan");
    trinity.createRelationshipTo(cypher,RelTypes.KNOWS);
    rel=morpheus.createRelationshipTo(cypher,RelTypes.KNOWS);
    rel.setProperty("disclosure","public");
    Node smith=graphDb.createNode();
    smith.setProperty("name","Agent Smith");
    smith.setProperty("version","1.0b");
    smith.setProperty("language","C++");
    rel=cypher.createRelationshipTo(smith,RelTypes.KNOWS);
    rel.setProperty("disclosure","secret");
    rel.setProperty("age","6 months");
    Node architect=graphDb.createNode();
    architect.setProperty("name","The Architect");
    smith.createRelationshipTo(architect,RelTypes.CODED_BY);
    tx.success();
  }
  finally {
    tx.finish();
  }
}
