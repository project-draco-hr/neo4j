{
  Transaction transaction=graphDb.beginTx();
  try {
    Node neoNode=getNeoNode();
    int numberOfFriends=0;
    StringBuilder output=new StringBuilder(String.format("%s's friends:\n",neoNode.getProperty("name")));
    Traverser friendsTraverser=getFriends(neoNode);
    for (    Node friendNode : friendsTraverser) {
      output.append(String.format("At depth %d => %s\n",friendsTraverser.currentPosition().depth(),friendNode.getProperty("name")));
      numberOfFriends++;
    }
    output.append(String.format("Number of friends found: %d\n",numberOfFriends));
    return output.toString();
  }
  finally {
    transaction.finish();
  }
}
