{
  PropertyStore propStore=getPropertyStore();
  Map<String,Object> properties=new HashMap<>();
  while (nextProp != Record.NO_NEXT_PROPERTY.intValue()) {
    PropertyRecord propRecord=propStore.getRecord(nextProp);
    for (    PropertyBlock propBlock : propRecord.getPropertyBlocks()) {
      String key=propertyKeyTokens.nameOf(propBlock.getKeyIndexId());
      DefinedProperty propertyData=propBlock.newPropertyData(propStore);
      Object value=propertyData.value() != null ? propertyData.value() : propBlock.getType().getValue(propBlock,getPropertyStore());
      properties.put(key,value);
    }
    nextProp=propRecord.getNextProp();
  }
  return properties;
}
