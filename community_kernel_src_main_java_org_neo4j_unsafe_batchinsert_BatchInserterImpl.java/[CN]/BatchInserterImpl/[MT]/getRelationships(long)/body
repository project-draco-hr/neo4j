{
  NodeRecord nodeRecord=getNodeRecord(nodeId);
  long nextRel=nodeRecord.getNextRel();
  List<BatchRelationship> rels=new ArrayList<BatchRelationship>();
  while (nextRel != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    RelationshipRecord relRecord=getRelationshipRecord(nextRel);
    RelationshipType type=new RelationshipTypeImpl(typeHolder.getName(relRecord.getType()));
    rels.add(new BatchRelationship(relRecord.getId(),relRecord.getFirstNode(),relRecord.getSecondNode(),type));
    long firstNode=relRecord.getFirstNode();
    long secondNode=relRecord.getSecondNode();
    if (firstNode == nodeId) {
      nextRel=relRecord.getFirstNextRel();
    }
 else     if (secondNode == nodeId) {
      nextRel=relRecord.getSecondNextRel();
    }
 else {
      throw new InvalidRecordException("Node[" + nodeId + "] not part of firstNode["+ firstNode+ "] or secondNode["+ secondNode+ "]");
    }
  }
  return rels;
}
