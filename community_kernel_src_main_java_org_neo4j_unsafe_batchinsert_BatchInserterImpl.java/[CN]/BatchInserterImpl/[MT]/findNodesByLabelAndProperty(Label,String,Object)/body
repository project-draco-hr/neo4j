{
  for (  SchemaRule rule : schemaCache.getSchemaRulesForLabel(getLabelId(label))) {
    if (rule instanceof IndexRule) {
      final IndexRule indexRule=(IndexRule)rule;
      if (indexRule.getPropertyKey() == getOrCreatePropertyIndex(key)) {
        return new ResourceIterable<Long>(){
          @Override public ResourceIterator<Long> iterator(){
            SchemaIndexProvider.Descriptor providerDescriptor=indexRule.getProviderDescriptor();
            SchemaIndexProvider provider=schemaIndexProviders.apply(providerDescriptor);
            IndexAccessor onlineAccessor=provider.getOnlineAccessor(indexRule.getId());
            IndexReader reader=onlineAccessor.newReader();
            ResourceIterator<Long> idIterator=cleanupService.resourceIterator(reader.lookup(value),reader);
            return idIterator;
          }
        }
;
      }
    }
  }
  throw new IllegalArgumentException("No matching online index found on :" + label.name() + "("+ key+ ")");
}
