{
  for (  SchemaRule rule : schemaCache.schemaRulesForLabel(labelId)) {
    int otherPropertyKeyId;
switch (rule.getKind()) {
case INDEX_RULE:
case CONSTRAINT_INDEX_RULE:
      otherPropertyKeyId=((IndexRule)rule).getPropertyKey();
    break;
case UNIQUENESS_CONSTRAINT:
  otherPropertyKeyId=((UniquePropertyConstraintRule)rule).getPropertyKey();
break;
case MANDATORY_PROPERTY_CONSTRAINT:
otherPropertyKeyId=((MandatoryPropertyConstraintRule)rule).getPropertyKey();
break;
default :
throw new IllegalStateException("Case not handled.");
}
if (otherPropertyKeyId == propertyKeyId) {
throw new ConstraintViolationException("It is not allowed to create schema constraints and indexes on the same {label;property}.");
}
}
}
