{
  NodeRecord nodeRecord=getNodeRecord(nodeId).forReadingData();
  long nextRel=nodeRecord.getNextRel();
  List<Long> ids=new ArrayList<>();
  while (nextRel != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    RelationshipRecord relRecord=getRelationshipRecord(nextRel).forReadingData();
    ids.add(relRecord.getId());
    long firstNode=relRecord.getFirstNode();
    long secondNode=relRecord.getSecondNode();
    if (firstNode == nodeId) {
      nextRel=relRecord.getFirstNextRel();
    }
 else     if (secondNode == nodeId) {
      nextRel=relRecord.getSecondNextRel();
    }
 else {
      throw new InvalidRecordException("Node[" + nodeId + "] not part of firstNode["+ firstNode+ "] or secondNode["+ secondNode+ "]");
    }
  }
  return ids;
}
