{
  final AbstractGraphDatabase graphdb=new EmbeddedGraphDatabase("target/test-data/" + TestPropertyReadOnNewEntityBeforeLockRelease.class.getName() + "/graphdb");
  final CountDownLatch completion=new CountDownLatch(2);
class TaskRunner implements Runnable {
    private final Task task;
    TaskRunner(    Task task){
      this.task=task;
    }
    @Override public void run(){
      try {
        task.run(graphdb);
      }
  finally {
        completion.countDown();
      }
    }
  }
  new Thread(new TaskRunner(new CreateData())).start();
  new Thread(new TaskRunner(new ReadData())).start();
  try {
    completion.await();
  }
  finally {
    graphdb.shutdown();
  }
}
