{
  long result;
  if (freeIds.size() > 0 && aggressiveReuse) {
    result=freeIds.poll();
    defraggedIdCount--;
  }
 else   if (readFromDisk.size() > 0) {
    result=readFromDisk.removeFirst();
    defraggedIdCount--;
  }
 else   if (defraggedIdCount > 0 && canReadMoreIdBatches()) {
    readIdBatch();
    result=readFromDisk.removeFirst();
    defraggedIdCount--;
  }
 else {
    result=NO_RESULT;
  }
  return result;
}
