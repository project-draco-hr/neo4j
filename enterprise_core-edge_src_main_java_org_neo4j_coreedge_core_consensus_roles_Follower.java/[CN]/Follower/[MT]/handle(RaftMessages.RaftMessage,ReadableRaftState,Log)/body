{
  Outcome outcome=new Outcome(FOLLOWER,ctx);
switch (message.type()) {
case HEARTBEAT:
{
      Heart.beat(ctx,outcome,(Heartbeat)message,log);
      break;
    }
case APPEND_ENTRIES_REQUEST:
{
    Appending.handleAppendEntriesRequest(ctx,outcome,(AppendEntries.Request)message,log);
    break;
  }
case VOTE_REQUEST:
{
  Voting.handleVoteRequest(ctx,outcome,(RaftMessages.Vote.Request)message);
  break;
}
case LOG_COMPACTION_INFO:
{
handleLeaderLogCompaction(ctx,outcome,(RaftMessages.LogCompactionInfo)message);
break;
}
case ELECTION_TIMEOUT:
{
log.info("Election timeout triggered");
if (Election.start(ctx,outcome,log)) {
outcome.setNextRole(CANDIDATE);
log.info("Moving to CANDIDATE state after successfully starting election");
}
break;
}
default :
break;
}
return outcome;
}
