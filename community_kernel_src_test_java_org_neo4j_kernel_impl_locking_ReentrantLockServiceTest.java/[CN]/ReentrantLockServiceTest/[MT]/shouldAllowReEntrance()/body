{
  LockService locks=new ReentrantLockService();
  ThreadRepository.Events events=threads.events();
  LockNode lock1once=new LockNode(locks,1);
  LockNode lock1again=new LockNode(locks,1);
  LockNode lock1inOtherThread=new LockNode(locks,1);
  ThreadRepository.Signal lockedOnce=threads.signal();
  ThreadRepository.Signal ready=threads.signal();
  threads.execute(lock1once,ready.await(),lockedOnce,lock1again,events.trigger("Double Locked"),lock1once.release,lock1again.release);
  threads.execute(ready,lockedOnce.await(),lock1inOtherThread,events.trigger("Other Thread"),lock1inOtherThread.release);
  events.assertInOrder("Double Locked","Other Thread");
}
