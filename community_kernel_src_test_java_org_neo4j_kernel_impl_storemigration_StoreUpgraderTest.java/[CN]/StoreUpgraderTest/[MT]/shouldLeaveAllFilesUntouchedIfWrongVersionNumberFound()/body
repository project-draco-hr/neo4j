{
  File workingDirectory=new File("target/" + StoreUpgraderTest.class.getSimpleName());
  File comparisonDirectory=new File("target/" + StoreUpgraderTest.class.getSimpleName() + "-comparison");
  prepareSampleLegacyDatabase(workingDirectory);
  HashMap config=defaultConfig();
  config.put(Config.ALLOW_STORE_UPGRADE,"true");
  changeVersionNumber(new File(workingDirectory,"neostore.nodestore.db"),"v0.9.5");
  copyRecursively(workingDirectory,comparisonDirectory);
  try {
    new StoreUpgrader(new File(workingDirectory,NeoStore.DEFAULT_NAME).getPath(),config).attemptUpgrade();
    fail("Should have thrown exception");
  }
 catch (  StoreUpgrader.UnableToUpgradeException e) {
  }
  verifyFilesHaveSameContent(comparisonDirectory,workingDirectory);
}
