{
  String dbDir1=new File("target/db1").getAbsolutePath();
  Configurator config=new PropertyFileConfigurator(ServerBuilder.server().usingDatabaseDir(dbDir1).createPropertiesFiles());
  File irellevant=new File("target/irellevant");
  irellevant.createNewFile();
  config.configuration().setProperty("org.neo4j.server.properties",irellevant.getAbsolutePath());
  AdvancedNeoServer server=new AdvancedNeoServer(config);
  server.start();
  assertNotNull(server.getDatabase().getGraph());
  assertEquals(dbDir1,server.getDatabase().getGraph().getStoreDir());
  String dbDir2=new File("target/db2").getAbsolutePath();
  Configuration conf=config.configuration();
  conf.setProperty(Configurator.DATABASE_LOCATION_PROPERTY_KEY,dbDir2);
  ServerManagement bean=new ServerManagement(server);
  bean.restartServer();
  assertEquals(dbDir2,server.getDatabase().getGraph().getStoreDir());
}
