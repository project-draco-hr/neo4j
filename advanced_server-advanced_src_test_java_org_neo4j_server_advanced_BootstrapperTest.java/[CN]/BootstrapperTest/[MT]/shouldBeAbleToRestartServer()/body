{
  TargetDirectory target=TargetDirectory.forTest(getClass());
  String dbDir1=target.cleanDirectory("db1").getAbsolutePath();
  ConfigurationBuilder config=new PropertyFileConfigurator(AdvancedServerBuilder.server().usingDatabaseDir(dbDir1).createPropertiesFiles(),ConsoleLogger.DEV_NULL);
  File irrelevant=target.file("irrelevant");
  irrelevant.createNewFile();
  setProperty(config.configuration(),"org.neo4j.server.properties",irrelevant.getAbsolutePath());
  AdvancedNeoServer server=new AdvancedNeoServer(config,GraphDatabaseDependencies.newDependencies().logging(new SingleLoggingService(StringLogger.SYSTEM)));
  server.start();
  assertNotNull(server.getDatabase().getGraph());
  String dbDir2=target.cleanDirectory("db2").getAbsolutePath();
  Config conf=config.configuration();
  setProperty(conf,Configurator.DATABASE_LOCATION_PROPERTY_KEY,dbDir2);
  ServerManagement bean=new ServerManagement(server);
  bean.restartServer();
}
