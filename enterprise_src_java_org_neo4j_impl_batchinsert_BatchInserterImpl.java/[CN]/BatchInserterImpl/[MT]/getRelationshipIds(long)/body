{
  NodeRecord nodeRecord=getNodeRecord(nodeId);
  int nextRel=nodeRecord.getNextRel();
  List<Long> ids=new ArrayList<Long>();
  while (nextRel != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    RelationshipRecord relRecord=getRelationshipRecord(nextRel);
    ids.add(relRecord.getId() & 0xFFFFFFFFL);
    int firstNode=relRecord.getFirstNode();
    int secondNode=relRecord.getSecondNode();
    if (firstNode == nodeId) {
      nextRel=relRecord.getFirstNextRel();
    }
 else     if (secondNode == nodeId) {
      nextRel=relRecord.getSecondNextRel();
    }
 else {
      throw new InvalidRecordException("Node[" + nodeId + "] not part of firstNode["+ firstNode+ "] or secondNode["+ secondNode+ "]");
    }
  }
  return ids;
}
