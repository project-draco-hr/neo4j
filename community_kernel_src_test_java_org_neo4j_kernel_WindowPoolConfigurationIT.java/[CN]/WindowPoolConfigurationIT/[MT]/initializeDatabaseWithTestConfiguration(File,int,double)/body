{
  int nodeStoreMappedBytes=((int)((nodeCount * NodeStore.RECORD_SIZE) * memoryFactor)) - (NodeStore.RECORD_SIZE / 2);
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(dir.getAbsolutePath()).setConfig(GraphDatabaseSettings.nodestore_mapped_memory_size,"" + nodeStoreMappedBytes).setConfig(GraphDatabaseSettings.cache_type,"none").newGraphDatabase();
  Transaction tx=db.beginTx();
  try {
    Node node=db.getNodeById(nodeCount - 1);
    assertNotNull(node);
    tx.success();
  }
  finally {
    tx.finish();
    db.shutdown();
  }
}
