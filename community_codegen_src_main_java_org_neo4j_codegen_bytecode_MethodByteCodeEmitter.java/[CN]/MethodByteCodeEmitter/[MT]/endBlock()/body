{
  if (stateStack.isEmpty()) {
    throw new IllegalStateException("Unbalanced blocks");
  }
  stateStack.pop().endBlock();
}
