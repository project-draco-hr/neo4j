{
  final File copyDir=new File(testDir.directory(),"copy");
  final File originalDir=new File(testDir.directory(),"original");
  PageCache pageCache=pageCacheRule.getPageCache(fs);
  String unkownFormat="unkown_format";
  Config config=Config.empty().augment(stringMap(record_format.name(),unkownFormat));
  StoreCopyClient copier=new StoreCopyClient(copyDir,config,loadKernelExtensions(),NullLogProvider.getInstance(),fs,pageCache,new StoreCopyClient.Monitor.Adapter(),false);
  final GraphDatabaseAPI original=(GraphDatabaseAPI)startDatabase(originalDir);
  StoreCopyClient.StoreCopyRequester storeCopyRequest=storeCopyRequest(originalDir,original);
  try {
    copier.copyStore(storeCopyRequest,CancellationRequest.NEVER_CANCELLED);
    fail("copyStore should have failed with this format configuration");
  }
 catch (  Exception e) {
    assertThat(e.getMessage(),containsString(unkownFormat));
  }
}
