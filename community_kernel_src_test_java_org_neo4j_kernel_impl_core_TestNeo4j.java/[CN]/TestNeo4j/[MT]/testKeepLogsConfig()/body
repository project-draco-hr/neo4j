{
  Map<String,String> config=new HashMap<String,String>();
  config.put(Config.KEEP_LOGICAL_LOGS,Config.DEFAULT_DATA_SOURCE_NAME);
  String storeDir="target/configdb";
  deleteFileOrDirectory(storeDir);
  EmbeddedGraphDatabase db=new EmbeddedGraphDatabase(storeDir,config);
  XaDataSourceManager xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  XaDataSource xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.remove(Config.KEEP_LOGICAL_LOGS);
  db=new EmbeddedGraphDatabase(storeDir,config);
  xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(Config.KEEP_LOGICAL_LOGS,"false");
  db=new EmbeddedGraphDatabase(storeDir,config);
  xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertFalse(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(Config.KEEP_LOGICAL_LOGS,Config.DEFAULT_DATA_SOURCE_NAME + "=false");
  db=new EmbeddedGraphDatabase(storeDir,config);
  xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertFalse(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(Config.KEEP_LOGICAL_LOGS,Config.DEFAULT_DATA_SOURCE_NAME + "=true");
  db=new EmbeddedGraphDatabase(storeDir,config);
  xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(Config.KEEP_LOGICAL_LOGS,"true");
  db=new EmbeddedGraphDatabase(storeDir,config);
  xaDsMgr=db.getConfig().getTxModule().getXaDataSourceManager();
  xaDs=xaDsMgr.getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME);
  assertTrue(xaDs.isLogicalLogKept());
}
