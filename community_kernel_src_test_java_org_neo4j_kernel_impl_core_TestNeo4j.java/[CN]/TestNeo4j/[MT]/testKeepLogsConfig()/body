{
  Map<String,String> config=new HashMap<String,String>();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),Config.DEFAULT_DATA_SOURCE_NAME);
  String storeDir="target/configdb";
  deleteFileOrDirectory(storeDir);
  GraphDatabaseFactory graphDatabaseFactory=new GraphDatabaseFactory();
  GraphDatabaseAPI db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  XaDataSourceManager xaDsMgr=db.getXaDataSourceManager();
  XaDataSource xaDs=xaDsMgr.getNeoStoreDataSource();
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.remove(GraphDatabaseSettings.keep_logical_logs.name());
  db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  xaDsMgr=db.getXaDataSourceManager();
  xaDs=xaDsMgr.getNeoStoreDataSource();
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),GraphDatabaseSetting.FALSE);
  db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  xaDsMgr=db.getXaDataSourceManager();
  xaDs=xaDsMgr.getNeoStoreDataSource();
  assertFalse(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),Config.DEFAULT_DATA_SOURCE_NAME + "=false");
  db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  xaDsMgr=db.getXaDataSourceManager();
  xaDs=xaDsMgr.getNeoStoreDataSource();
  assertFalse(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),Config.DEFAULT_DATA_SOURCE_NAME + "=true");
  db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  xaDsMgr=db.getXaDataSourceManager();
  xaDs=xaDsMgr.getNeoStoreDataSource();
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),"true");
  db=(GraphDatabaseAPI)graphDatabaseFactory.newEmbeddedDatabaseBuilder(storeDir).setConfig(config).newGraphDatabase();
  xaDsMgr=db.getXaDataSourceManager();
  xaDs=xaDsMgr.getNeoStoreDataSource();
  assertTrue(xaDs.isLogicalLogKept());
  db.shutdown();
}
