{
  acquireExclusiveLockInThisThread();
  TxTerminationImpl txTermination=new TxTerminationImpl();
  Future<?> sharedLockAcquisition1=acquireSharedLockInAnotherThread(txTermination);
  assertThreadIsWaitingForLock(sharedLockAcquisition1);
  txTermination.markForTermination();
  assertLockAcquisitionFailed(sharedLockAcquisition1);
  releaseAllLocksInThisThread();
  Future<?> sharedLockAcquisition2=acquireSharedLockInAnotherThread(txTermination);
  assertLockAcquisitionSucceeded(sharedLockAcquisition2);
}
