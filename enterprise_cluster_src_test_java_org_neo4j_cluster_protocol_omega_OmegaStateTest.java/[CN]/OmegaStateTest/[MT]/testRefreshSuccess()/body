{
  OmegaContext context=Mockito.mock(OmegaContext.class);
  Message<OmegaMessage> message=Message.internal(OmegaMessage.refresh_ack,RefreshAckPayload.forRefresh(new RefreshPayload(1,2,3,1)));
  MessageProcessor outgoing=Mockito.mock(MessageProcessor.class);
  Mockito.when(context.getClusterNodeCount()).thenReturn(3);
  Mockito.when(context.getAckCount(1)).thenReturn(2);
  State state=new State(new EpochNumber());
  Mockito.when(context.getMyState()).thenReturn(state);
  OmegaState.omega.handle(context,message,outgoing);
  Mockito.verify(context).roundDone(1);
  assertEquals(1,state.getFreshness());
}
