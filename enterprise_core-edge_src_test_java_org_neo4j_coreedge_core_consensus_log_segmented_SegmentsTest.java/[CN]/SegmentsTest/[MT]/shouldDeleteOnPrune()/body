{
  verifyZeroInteractions(fsa);
  try (Segments segments=new Segments(fsa,fileNames,readerPool,segmentFiles,contentMarshal,logProvider,-1)){
    SegmentFile toPrune=segments.rotate(-1,-1,-1);
    segments.last().closeWriter();
    segments.rotate(10,10,2);
    segments.last().closeWriter();
    segments.rotate(20,20,2);
    segments.prune(11);
    verify(fsa,times(segmentFiles.size())).deleteFile(fileNames.getForVersion(toPrune.header().version()));
  }
 }
