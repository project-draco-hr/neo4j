{
  BackupClient client=new BackupClient(sourceHostNameOrIp,sourcePort,targetDb.getDependencyResolver().resolveDependency(Logging.class),targetDb.getStoreId());
  client.start();
  Map<String,Long> lastCommittedTxs;
  boolean consistent=false;
  try {
    lastCommittedTxs=unpackResponse(client.incrementalBackup(context),targetDb.getDependencyResolver().resolveDependency(XaDataSourceManager.class),new ProgressTxHandler());
    trimLogicalLogCount(targetDb);
    consistent=true;
  }
  finally {
    try {
      client.stop();
    }
 catch (    Throwable throwable) {
      throw new RuntimeException(throwable);
    }
  }
  return new BackupOutcome(lastCommittedTxs,consistent);
}
