{
  BackupClient client=new BackupClient(sourceHostNameOrIp,sourcePort,targetDb.getMessageLog(),targetDb.getStoreId());
  Map<String,Long> lastCommittedTxs;
  try {
    lastCommittedTxs=unpackResponse(client.incrementalBackup(context),targetDb,new ProgressTxHandler());
    trimLogicalLogCount(targetDb);
  }
  finally {
    client.shutdown();
  }
  return new BackupOutcome(lastCommittedTxs);
}
