{
  if (deletedRelationships != null && deletedRelationships.contains(rel)) {
    log.severe("Delete of relationship[" + rel + "] illegal since it has already been deleted (in this tx)");
    return false;
  }
  Integer nodeIds[]=((RelationshipImpl)rel).getNodeIds();
  if (deletedNodes != null && deletedNodes.containsKey(nodeIds[0])) {
    ((NodeImpl)deletedNodes.get(nodeIds[0])).removeRelationship(rel.getType(),new Integer((int)rel.getId()));
  }
  if (deletedNodes != null && deletedNodes.containsKey(nodeIds[1])) {
    ((NodeImpl)deletedNodes.get(nodeIds[1])).removeRelationship(rel.getType(),new Integer((int)rel.getId()));
  }
  if (deletedRelationships == null) {
    deletedRelationships=new java.util.HashSet<RelationshipImpl>();
  }
  deletedRelationships.add(rel);
  return true;
}
