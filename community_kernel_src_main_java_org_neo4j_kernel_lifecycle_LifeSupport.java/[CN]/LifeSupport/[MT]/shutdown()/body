{
  LifecycleException ex=null;
  try {
    stop();
  }
 catch (  LifecycleException e) {
    ex=e;
  }
  if (status == LifecycleStatus.STOPPED) {
    status=changedStatus(this,status,LifecycleStatus.SHUTTING_DOWN);
    for (int i=instances.size() - 1; i >= 0; i--) {
      LifecycleInstance lifecycleInstance=instances.get(i);
      try {
        lifecycleInstance.shutdown();
      }
 catch (      LifecycleException e) {
        ex=ex == null ? e : Exceptions.withSuppressed(ex,e);
      }
    }
    status=changedStatus(this,status,LifecycleStatus.SHUTDOWN);
    if (ex != null) {
      throw ex;
    }
  }
}
