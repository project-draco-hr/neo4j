{
  if (data == null) {
    throw new IndexNotFoundKernelException("Index dropped while sampling.");
  }
  final long[] uniqueAndSize={0,0};
  try {
    iterateAll(new IndexEntryIterator(){
      @Override public void visitEntry(      Object value,      Set<Long> nodeIds) throws Exception {
        int ids=nodeIds.size();
        if (ids > 0) {
          uniqueAndSize[0]+=1;
          uniqueAndSize[1]+=ids;
        }
      }
    }
);
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
  result.write(uniqueAndSize[0],uniqueAndSize[1]);
  return uniqueAndSize[1];
}
