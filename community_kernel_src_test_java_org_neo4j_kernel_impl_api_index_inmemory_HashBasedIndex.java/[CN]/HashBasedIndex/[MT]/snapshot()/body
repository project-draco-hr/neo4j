{
  HashBasedIndex snapshot=new HashBasedIndex();
  for (  Map.Entry<Object,Set<Long>> entry : data.entrySet()) {
    snapshot.data.put(entry.getKey(),new HashSet<>(entry.getValue()));
  }
  return snapshot;
}
