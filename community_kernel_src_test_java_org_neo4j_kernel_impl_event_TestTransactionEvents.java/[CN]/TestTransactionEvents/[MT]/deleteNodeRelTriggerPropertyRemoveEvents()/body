{
  GraphDatabaseService db=dbRule.getGraphDatabaseService();
  Node node1;
  Node node2;
  Relationship rel;
  try (Transaction tx=db.beginTx()){
    node1=db.createNode();
    node2=db.createNode();
    rel=node1.createRelationshipTo(node2,RelTypes.TXEVENT);
    node1.setProperty("test1","stringvalue");
    node1.setProperty("test2",1l);
    rel.setProperty("test1","stringvalue");
    rel.setProperty("test2",1l);
    rel.setProperty("test3",new int[]{1,2,3});
    tx.success();
  }
   MyTxEventHandler handler=new MyTxEventHandler();
  db.registerTransactionEventHandler(handler);
  try (Transaction tx=db.beginTx()){
    GraphDatabaseAPI dbApi=dbRule.getGraphDatabaseAPI();
    dbApi.getDependencyResolver().resolveDependency(Caches.class).clear();
    rel.delete();
    node1.delete();
    node2.delete();
    dbApi.getDependencyResolver().resolveDependency(Caches.class).clear();
    tx.success();
  }
   assertEquals("stringvalue",handler.nodeProps.get("test1"));
  assertEquals("stringvalue",handler.relProps.get("test1"));
  assertEquals(1l,handler.nodeProps.get("test2"));
  assertEquals(1l,handler.relProps.get("test2"));
  int[] intArray=(int[])handler.relProps.get("test3");
  assertEquals(3,intArray.length);
  assertEquals(1,intArray[0]);
  assertEquals(2,intArray[1]);
  assertEquals(3,intArray[2]);
}
