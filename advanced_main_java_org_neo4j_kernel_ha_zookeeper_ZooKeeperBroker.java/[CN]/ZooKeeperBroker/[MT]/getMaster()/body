{
  if (masterClient != null) {
    return masterClient;
  }
  master=zooClient.getMaster();
  if (master != null && master.getMachineId() == machineId) {
    throw new ZooKeeperException("I am master, so can't call getMaster() here",new Exception());
  }
  invalidateMaster();
  connectToMaster(master);
  return masterClient;
}
