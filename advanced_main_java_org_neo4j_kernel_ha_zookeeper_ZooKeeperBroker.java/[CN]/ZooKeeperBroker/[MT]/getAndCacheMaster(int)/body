{
  if (masterClient == null || masterId != machineIdForMasterClient || zooClient.isNewConnection()) {
    machineIdForMasterClient=masterId;
    Pair<String,Integer> host=getHaServer(masterId);
    masterClient=new MasterClient(host.first(),host.other());
    zooClient.isNewConnection();
  }
  return masterClient;
}
