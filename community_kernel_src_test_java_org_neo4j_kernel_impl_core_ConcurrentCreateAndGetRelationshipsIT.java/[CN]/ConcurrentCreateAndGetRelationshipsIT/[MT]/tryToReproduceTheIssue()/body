{
  GraphDatabaseService db=dbRule.getGraphDatabaseService();
  CountDownLatch startSignal=new CountDownLatch(1);
  AtomicBoolean stopSignal=new AtomicBoolean();
  AtomicReference<Exception> failure=new AtomicReference<Exception>();
  Node parentNode=createNode(db);
  Collection<Worker> workers=createWorkers(db,startSignal,stopSignal,failure,parentNode);
  startSignal.countDown();
  sleep(500);
  stopSignal.set(true);
  awaitWorkersToEnd(workers);
  if (failure.get() != null) {
    throw new Exception("A worker failed",failure.get());
  }
}
