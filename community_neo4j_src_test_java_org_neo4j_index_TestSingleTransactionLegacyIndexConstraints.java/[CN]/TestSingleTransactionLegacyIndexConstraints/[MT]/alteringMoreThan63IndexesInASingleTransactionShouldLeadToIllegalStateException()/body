{
  GraphDatabaseService db=new TestGraphDatabaseFactory().newImpermanentDatabase();
  try (Transaction tx=db.beginTx()){
    for (int i=0; i < 64; i++) {
      db.index().forNodes("foo" + i);
    }
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    for (int i=0; i < 63; i++) {
      db.index().forNodes("foo" + i).add(db.createNode(),"aKey","aValue");
    }
    try {
      db.index().forNodes("foo" + 63).add(db.createNode(),"aKey","aValue");
      fail("Altering more than 63 legacy indexes in a single tx should not be allowed");
    }
 catch (    IllegalStateException e) {
    }
    tx.success();
  }
 }
