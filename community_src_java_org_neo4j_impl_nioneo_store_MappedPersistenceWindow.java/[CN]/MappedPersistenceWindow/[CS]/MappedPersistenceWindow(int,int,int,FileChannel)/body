{
  super(channel);
  if (recordSize <= 0 || totalSize < recordSize) {
    throw new IOException("Illegal record/window size: " + recordSize + "/"+ totalSize);
  }
  if (totalSize % recordSize != 0) {
    throw new IOException("Illegal mod size/window (" + totalSize + "/"+ recordSize+ ")");
  }
  this.totalSize=totalSize;
  windowSize=totalSize / recordSize;
  this.recordSize=recordSize;
  this.position=position;
  buffer=new Buffer(this);
  try {
    buffer.setByteBuffer(channel.map(FileChannel.MapMode.READ_WRITE,position * recordSize,totalSize));
  }
 catch (  IOException e) {
    this.position=-1;
    throw new MappedMemException(e);
  }
}
