{
  int read=0;
  while (read < length) {
    int readThisTime=current.read(buffer,offset + read,length - read);
    if (readThisTime == -1) {
      if (read == 0 && actual.hasNext()) {
        previousReadersCollectivePosition+=current.position();
        closeCurrent();
        current=actual.next();
        for (        SourceMonitor monitor : monitors) {
          monitor.notify(toString());
        }
        if (!lastEndedInNewLine) {
          buffer[offset + read++]='\n';
          previousReadersCollectivePosition++;
        }
        lastEndedInNewLine=false;
      }
 else {
        break;
      }
    }
 else {
      read+=readThisTime;
      lastEndedInNewLine=buffer[readThisTime - 1] == '\n' || buffer[readThisTime - 1] == '\r';
    }
  }
  return read == 0 ? -1 : read;
}
