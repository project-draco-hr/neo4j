{
  PathFinder<Path> finder=GraphAlgoFactory.shortestPath(PathExpanders.allTypesAndDirections(),6);
  Transaction tx=me.getGraphDatabase().beginTx();
  try {
    Node other;
    if (me.hasRelationship(DynamicRelationshipType.withName("friend"))) {
      other=me.getRelationships(DynamicRelationshipType.withName("friend")).iterator().next().getOtherNode(me);
    }
 else {
      other=me.getGraphDatabase().createNode();
    }
    Path path=finder.findSinglePath(other,me);
    tx.success();
    return path;
  }
  finally {
    tx.finish();
  }
}
