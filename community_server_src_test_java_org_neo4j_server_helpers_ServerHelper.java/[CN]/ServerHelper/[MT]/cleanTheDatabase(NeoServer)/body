{
  if (server == null) {
    return;
  }
  new Transactor(server.getDatabase().graph,new UnitOfWork(){
    @Override public void doWork(){
      deleteAllNodesAndRelationships(server);
      deleteAllIndexes(server);
    }
    private void deleteAllNodesAndRelationships(    final NeoServer server){
      Iterable<Node> allNodes=GlobalGraphOperations.at(server.getDatabase().graph).getAllNodes();
      for (      Node n : allNodes) {
        Iterable<Relationship> relationships=n.getRelationships();
        for (        Relationship rel : relationships) {
          rel.delete();
        }
        if (n.getId() != 0) {
          n.delete();
        }
 else {
          for (          String key : n.getPropertyKeys()) {
            n.removeProperty(key);
          }
        }
      }
    }
    private void deleteAllIndexes(    final NeoServer server){
      IndexManager indexManager=server.getDatabase().graph.index();
      for (      String indexName : indexManager.nodeIndexNames()) {
        try {
          server.getDatabase().graph.index().forNodes(indexName).delete();
        }
 catch (        UnsupportedOperationException e) {
        }
      }
      for (      String indexName : indexManager.relationshipIndexNames()) {
        try {
          server.getDatabase().graph.index().forRelationships(indexName).delete();
        }
 catch (        UnsupportedOperationException e) {
        }
      }
      for (      String k : indexManager.getNodeAutoIndexer().getAutoIndexedProperties()) {
        indexManager.getNodeAutoIndexer().stopAutoIndexingProperty(k);
      }
      indexManager.getNodeAutoIndexer().setEnabled(false);
      for (      String k : indexManager.getRelationshipAutoIndexer().getAutoIndexedProperties()) {
        indexManager.getRelationshipAutoIndexer().stopAutoIndexingProperty(k);
      }
      indexManager.getRelationshipAutoIndexer().setEnabled(false);
    }
  }
).execute();
}
