{
  String[] quoteParts=text.split("\"");
  String lastPart=quoteParts[quoteParts.length - 1];
  boolean isWithinQuotes=quoteParts.length % 2 == 0;
  String lastWord=null;
  if (isWithinQuotes) {
    lastWord=lastPart;
    if (preserveQuotation) {
      lastWord="\"" + lastWord + (text.endsWith("\"") ? "\"" : "");
    }
  }
 else {
    String[] lastPartParts=splitAndKeepEscapedSpaces(lastPart,preserveQuotation);
    lastWord=lastPartParts[lastPartParts.length - 1];
  }
  return lastWord;
}
