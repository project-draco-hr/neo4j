{
  assumeFalse("This test runs with mocked ConsistencyCheckService, doesn't work with the legacy checker " + "since it creates its own",useLegacyChecker);
  File storeDir=storeDirectory.directory();
  File propertyFile=storeDirectory.file("neo4j.properties");
  Properties properties=new Properties();
  properties.setProperty(ConsistencyCheckSettings.consistency_check_property_owners.name(),"true");
  properties.store(new FileWriter(propertyFile),null);
  String[] args={storeDir.getPath(),"-config",propertyFile.getPath()};
  ConsistencyCheckService service=mock(ConsistencyCheckService.class);
  PrintStream systemOut=mock(PrintStream.class);
  runConsistencyCheckToolWith(service,systemOut,args);
  ArgumentCaptor<Config> config=ArgumentCaptor.forClass(Config.class);
  verify(service).runFullConsistencyCheck(eq(storeDir),config.capture(),any(ProgressMonitorFactory.class),any(LogProvider.class),any(FileSystemAbstraction.class),anyBoolean());
  assertTrue(config.getValue().get(ConsistencyCheckSettings.consistency_check_property_owners));
}
