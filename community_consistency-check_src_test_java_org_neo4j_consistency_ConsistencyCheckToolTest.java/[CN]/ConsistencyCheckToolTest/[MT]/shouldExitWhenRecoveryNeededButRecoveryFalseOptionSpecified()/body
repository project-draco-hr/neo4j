{
  File storeDir=storeDirectory.graphDbDir();
  EphemeralFileSystemAbstraction fileSystem=createDataBaseWithStateThatNeedsRecovery(storeDir);
  Monitors monitors=new Monitors();
  PhysicalLogFile.Monitor listener=mock(PhysicalLogFile.Monitor.class);
  monitors.addMonitorListener(listener);
  ConsistencyCheckTool.ExitHandle exitHandle=mock(ConsistencyCheckTool.ExitHandle.class);
  ConsistencyCheckTool consistencyCheckTool=newConsistencyCheckToolWith(monitors,exitHandle,fileSystem);
  consistencyCheckTool.run("-recovery=false",storeDir.getAbsolutePath());
  verifyZeroInteractions(listener);
  verify(exitHandle).pull();
}
