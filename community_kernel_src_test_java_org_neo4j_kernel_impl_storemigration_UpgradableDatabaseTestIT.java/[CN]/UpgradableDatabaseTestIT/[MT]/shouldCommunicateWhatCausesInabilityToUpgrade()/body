{
  File resourceDirectory=Unzip.unzip(LegacyStore.class,"exampledb.zip");
  File workingDirectory=directory.directory();
  FileUtils.deleteRecursively(workingDirectory);
  assertTrue(workingDirectory.mkdirs());
  copyRecursively(resourceDirectory,workingDirectory);
  changeVersionNumber(fileSystem,new File(workingDirectory,"neostore.nodestore.db"),"v0.9.5");
  try {
    new UpgradableDatabase(new StoreVersionCheck(fileSystem)).checkUpgradeable(new File(workingDirectory,"neostore"));
    fail("should not have been able to upgrade");
  }
 catch (  StoreUpgrader.UnexpectedUpgradingStoreVersionException e) {
    assertThat(e.getMessage(),is("'neostore.nodestore.db' has a store version number that we cannot upgrade " + "from. Expected 'NodeStore " + LEGACY_VERSION + "' but file is version 'NodeStore v0.9.5'."));
  }
}
