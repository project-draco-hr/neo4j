{
  final URI masterUri=availableMasterId;
  if (getServerId(masterUri).equals(getServerId(me))) {
    msgLog.error("I (" + me + ") tried to switch to slave for myself as master ("+ masterUri+ ")");
    return;
  }
  final AtomicLong wait=new AtomicLong();
  final CancellationHandle cancellationHandle=new CancellationHandle();
  startModeSwitching(new Runnable(){
    @Override public void run(){
      if (currentTargetState != HighAvailabilityMemberState.TO_SLAVE) {
        return;
      }
      try {
        haCommunicationLife.shutdown();
        haCommunicationLife=new LifeSupport();
        URI resultingSlaveHaURI=switchToSlave.switchToSlave(haCommunicationLife,me,masterUri,cancellationHandle);
        if (resultingSlaveHaURI == null) {
          msgLog.info("Switch to slave resulted in null URI - that means it was effectively cancelled");
        }
 else {
          slaveHaURI=resultingSlaveHaURI;
        }
      }
 catch (      MismatchingStoreIdException e) {
        run();
      }
catch (      NoSuchLogVersionException e) {
        run();
      }
catch (      Throwable t) {
        msgLog.logMessage("Error while trying to switch to slave",t);
        wait.set((1 + wait.get() * 2));
        wait.set(Math.min(wait.get(),5 * 60));
        modeSwitcherFuture=modeSwitcherExecutor.schedule(this,wait.get(),TimeUnit.SECONDS);
        msgLog.logMessage("Attempting to switch to slave in " + wait.get() + "s");
      }
    }
  }
,cancellationHandle);
}
