{
  msgLog.logMessage("I am " + config.get(ClusterSettings.server_id) + ", moving to master");
  try {
    MasterImpl masterImpl=new MasterImpl(graphDb,logging,config);
    MasterServer masterServer=new MasterServer(masterImpl,logging,serverConfig(),new BranchDetectingTxVerifier(graphDb));
    life.add(masterImpl);
    life.add(masterServer);
    delegateHandler.setDelegate(masterImpl);
    idGeneratorFactory.switchToMaster();
    life.start();
    URI haUri=createHaURI(masterServer);
    clusterMemberAvailability.memberIsAvailable(MASTER,haUri);
    msgLog.logMessage("I am " + config.get(ClusterSettings.server_id) + ", successfully moved to master");
  }
 catch (  Throwable e) {
    msgLog.logMessage("Failed to switch to master",e);
  }
}
