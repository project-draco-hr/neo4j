{
  try {
    MasterClient master=newMasterClient(masterUri,nioneoDataSource.getStoreId(),life);
    Slave slaveImpl=new SlaveImpl(nioneoDataSource.getStoreId(),master,new RequestContextFactory(getServerId(masterUri),xaDataSourceManager,graphDb.getDependencyResolver()),xaDataSourceManager);
    SlaveServer server=new SlaveServer(slaveImpl,serverConfig(),logging);
    assignMaster(master);
    life.add(slaveImpl);
    life.add(server);
    life.start();
    slaveHaURI=createHaURI(server);
    clusterMemberAvailability.memberIsAvailable(SLAVE,slaveHaURI);
    return true;
  }
 catch (  Throwable t) {
    msgLog.logMessage("Got exception while starting HA communication",t);
    life.shutdown();
    life=new LifeSupport();
    nioneoDataSource.stop();
  }
  return false;
}
