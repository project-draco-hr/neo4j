{
  msgLog.info("I am %s, moving to pending",instanceId);
  startModeSwitching(new Runnable(){
    @Override public void run(){
      if (cancellationHandle.cancellationRequested()) {
        msgLog.info("Switch to pending cancelled on start.");
        return;
      }
      if (oldState.equals(HighAvailabilityMemberState.SLAVE)) {
        clusterMemberAvailability.memberIsUnavailable(SLAVE);
      }
 else       if (oldState.equals(HighAvailabilityMemberState.MASTER)) {
        clusterMemberAvailability.memberIsUnavailable(MASTER);
      }
      Listeners.notifyListeners(modeSwitchListeners,new Listeners.Notification<ModeSwitcher>(){
        @Override public void notify(        ModeSwitcher listener){
          listener.switchToPending();
        }
      }
);
      neoStoreDataSourceSupplier.getDataSource().beforeModeSwitch();
      if (cancellationHandle.cancellationRequested()) {
        msgLog.info("Switch to pending cancelled before ha communication shutdown.");
        return;
      }
      haCommunicationLife.shutdown();
      haCommunicationLife=new LifeSupport();
    }
  }
,new CancellationHandle());
  try {
    modeSwitcherFuture.get(10,TimeUnit.SECONDS);
  }
 catch (  Exception ignored) {
  }
}
