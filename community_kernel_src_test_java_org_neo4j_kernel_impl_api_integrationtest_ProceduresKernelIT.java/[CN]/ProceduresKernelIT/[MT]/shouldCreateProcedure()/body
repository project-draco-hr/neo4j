{
  SchemaWriteOperations ops=schemaWriteOperationsInNewTransaction();
  ops.procedureCreate(signature,"javascript","emit(1);");
  Iterator<ProcedureSignature> all=ops.proceduresGetAll();
  assertThat(asCollection(all),Matchers.<Collection<ProcedureSignature>>equalTo(asList(signature)));
  commit();
  assertThat(asCollection(readOperationsInNewTransaction().proceduresGetAll()),Matchers.<Collection<ProcedureSignature>>equalTo(asList(signature)));
}
