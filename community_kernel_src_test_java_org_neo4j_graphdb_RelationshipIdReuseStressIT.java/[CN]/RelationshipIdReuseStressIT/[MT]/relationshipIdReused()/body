{
  Assume.assumeTrue(IdType.RELATIONSHIP.allowAggressiveReuse());
  Label cityLabel=DynamicLabel.label("city");
  final Label bandLabel=DynamicLabel.label("band");
  createBands(bandLabel);
  createCities(cityLabel);
  AtomicBoolean stopFlag=new AtomicBoolean(false);
  RelationshipsCreator relationshipsCreator=new RelationshipsCreator(stopFlag,bandLabel,cityLabel);
  List<Future> futures=new ArrayList<>();
  futures.add(startIdMaintenance(stopFlag));
  futures.add(startRelationshipRemoval(bandLabel,cityLabel,stopFlag));
  futures.add(startRelationshipsCreator(relationshipsCreator));
  futures.add(startRelationshipTypesCalculator(bandLabel,stopFlag));
  futures.add(startRelationshipCalculator(bandLabel,stopFlag));
  Thread.sleep(TimeUnit.SECONDS.toMillis(5));
  stopFlag.set(true);
  executorService.shutdown();
  executorService.awaitTermination(5,TimeUnit.SECONDS);
  completeFutures(futures);
  long highestPossibleIdInUse=getHighestUsedIdForRelationships();
  assertThat("Number of created relationships should be higher then highest possible id, since those are " + "reused.",relationshipsCreator.getCreatedRelationships(),Matchers.greaterThan(highestPossibleIdInUse));
}
