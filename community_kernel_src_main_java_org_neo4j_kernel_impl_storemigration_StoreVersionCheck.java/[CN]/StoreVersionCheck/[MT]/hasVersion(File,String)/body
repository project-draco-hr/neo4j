{
  String storeFilename=storeFile.getName();
  try (PagedFile file=pageCache.map(storeFile,pageCache.pageSize())){
    if (file.getLastPageId() == -1) {
      return new Result(Outcome.storeVersionNotFound,null,storeFilename);
    }
    String actualVersion=StoreVersionTrailerUtil.readTrailer(file,expectedVersion);
    if (actualVersion == null) {
      return new Result(Outcome.storeVersionNotFound,null,storeFilename);
    }
    if (!actualVersion.startsWith(typeDescriptor(expectedVersion))) {
      return new Result(Outcome.storeVersionNotFound,actualVersion,storeFilename);
    }
    if (!expectedVersion.equals(actualVersion)) {
      return new Result(Outcome.unexpectedUpgradingStoreVersion,actualVersion,storeFilename);
    }
  }
 catch (  IOException e) {
    return new Result(Outcome.missingStoreFile,null,storeFilename);
  }
  return new Result(Outcome.ok,null,storeFilename);
}
