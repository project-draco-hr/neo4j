{
  buf.clear();
  int bytesRead=fileChannel.read(buf);
  int wholeRecordsRead=bytesRead / RECORD_SIZE;
  if (wholeRecordsRead < expectAtLeastCount)   throw new RuntimeException("Expected to read at least " + expectAtLeastCount + " records, but could only read "+ wholeRecordsRead+ " ("+ bytesRead+ "b)");
  buf.flip();
  Long[] result=new Long[count];
  for (int i=0; i < wholeRecordsRead; i++)   result[i]=buf.getLong();
  return result;
}
