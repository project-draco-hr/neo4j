{
  this.file=file;
  try {
    if (!fileSystem.fileExists(file.getAbsolutePath()))     create(file,fileSystem,expectedVersion);
    fileChannel=fileSystem.open(file.getAbsolutePath(),"rw");
    Long[] records=readRecordsWithNullDefaults(fileChannel,RECORD_COUNT,allowUpgrade ? RECORD_COUNT - 1 : RECORD_COUNT);
    creationTime=records[0].longValue();
    randomIdentifier=records[1].longValue();
    version=records[2].longValue();
    lastCommittedTx=records[3].longValue();
    Long readIndexVersion=records[4];
    boolean versionDiffers=compareExpectedVersionWithStoreVersion(expectedVersion,allowUpgrade,readIndexVersion);
    indexVersion=expectedVersion;
    if (versionDiffers)     writeOut();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
