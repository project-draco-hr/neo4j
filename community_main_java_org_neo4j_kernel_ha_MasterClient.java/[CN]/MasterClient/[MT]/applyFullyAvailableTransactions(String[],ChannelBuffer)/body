{
  int numberOfTxEnds=scanForTxEnds(message);
  if (numberOfTxEnds > 0) {
    TransactionStream stream=readTransactionStreams(datasources,message);
    for (int i=0; i < numberOfTxEnds; i++) {
      Triplet<String,Long,TxExtractor> tx=stream.next();
      receiver.applyTransaction(tx.first(),tx.second(),tx.third().extract());
    }
    return discardAppliedTransactions(message);
  }
  return message;
}
