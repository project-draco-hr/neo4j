{
  String path=event.getPath();
  System.out.println(this + ", " + new Date()+ " Got event: "+ event+ "(path="+ path+ ")");
  if (path == null && event.getState() == Watcher.Event.KeeperState.Expired) {
    keeperState=KeeperState.Expired;
    zooKeeper=instantiateZooKeeper();
  }
 else   if (path == null && event.getState() == Watcher.Event.KeeperState.SyncConnected) {
    sequenceNr=setup();
    keeperState=KeeperState.SyncConnected;
    if (firstSyncConnected) {
      firstSyncConnected=false;
    }
 else {
      receiver.somethingIsWrong(new Exception());
    }
  }
 else   if (path == null && event.getState() == Watcher.Event.KeeperState.Disconnected) {
    keeperState=KeeperState.Disconnected;
  }
 else   if (event.getType() == Watcher.Event.EventType.NodeDataChanged) {
    if (path.contains(MASTER_NOTIFY_CHILD)) {
      if (super.getMaster().getMachineId() != machineId) {
        return;
      }
    }
 else     if (path.contains(MASTER_REBOUND_CHILD)) {
      if (super.getMaster().getMachineId() == machineId) {
        return;
      }
    }
 else {
      System.out.println("Unrecognized data change " + path);
      return;
    }
    receiver.somethingIsWrong(new Exception());
  }
}
