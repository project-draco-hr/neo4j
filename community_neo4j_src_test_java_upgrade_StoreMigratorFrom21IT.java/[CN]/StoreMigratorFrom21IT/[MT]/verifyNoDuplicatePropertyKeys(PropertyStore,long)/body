{
  HashSet<Integer> propertiesInUse=new HashSet<>();
  long nextPropertyId=firstPropertyId;
  while (nextPropertyId != -1) {
    PropertyRecord propertyRecord=propertyStore.getRecord(nextPropertyId);
    nextPropertyId=propertyRecord.getNextProp();
    if (!propertyRecord.inUse()) {
      continue;
    }
    for (    PropertyBlock propertyBlock : propertyRecord.getPropertyBlocks()) {
      if (!propertiesInUse.add(propertyBlock.getKeyIndexId())) {
        throw new AssertionError(String.format("Found a duplicate property in use: %s",propertyBlock.getKeyIndexId()));
      }
    }
  }
}
