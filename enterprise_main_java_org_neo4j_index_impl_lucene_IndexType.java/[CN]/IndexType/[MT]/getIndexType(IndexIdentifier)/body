{
  Map<String,String> config=identifier.config != null ? identifier.config : new HashMap<String,String>();
  String type=config.get(configKey(identifier.indexName,"type"));
  IndexType result=null;
  if (type.equals("exact")) {
    result=EXACT;
  }
 else   if (type.equals("fulltext")) {
    result=new FulltextType(getAnalyzer(config,identifier.indexName));
  }
 else {
    throw new RuntimeException("Unknown type '" + type + "' for index '"+ identifier.indexName+ "'");
  }
  return result;
}
