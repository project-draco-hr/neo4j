{
switch (versionToMigrateFrom) {
case Legacy19Store.LEGACY_VERSION:
case Legacy20Store.LEGACY_VERSION:
    break;
case Legacy21Store.LEGACY_VERSION:
case Legacy22Store.LEGACY_VERSION:
  Iterable<StoreFile> countsStoreFiles=Iterables.iterable(StoreFile.COUNTS_STORE_LEFT,StoreFile.COUNTS_STORE_RIGHT);
StoreFile.fileOperation(DELETE,fileSystem,storeDir,storeDir,countsStoreFiles,true,false,StoreFileType.STORE);
File neoStore=new File(storeDir,DEFAULT_NAME);
long lastTxId=MetaDataStore.getRecord(pageCache,neoStore,Position.LAST_TRANSACTION_ID);
rebuildCountsFromScratch(storeDir,lastTxId,pageCache);
break;
default :
throw new IllegalStateException("Unknown version to upgrade from: " + versionToMigrateFrom);
}
}
