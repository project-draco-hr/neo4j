{
  final File storeFileBase=new File(migrationDir,NeoStore.DEFAULT_NAME + StoreFactory.COUNTS_STORE);
  final StoreFactory storeFactory=new StoreFactory(fileSystem,storeDir,pageCache,DEV_NULL,new Monitors(),StoreVersionMismatchHandler.ALLOW_OLD_VERSION);
  try (NodeStore nodeStore=storeFactory.newNodeStore();RelationshipStore relationshipStore=storeFactory.newRelationshipStore()){
    try (Lifespan life=new Lifespan()){
      int highLabelId=(int)storeFactory.getHighId(StoreFile.LABEL_TOKEN_STORE,LabelTokenStore.RECORD_SIZE);
      int highRelationshipTypeId=(int)storeFactory.getHighId(StoreFile.RELATIONSHIP_TYPE_TOKEN_STORE,RelationshipTypeTokenStore.RECORD_SIZE);
      CountsComputer initializer=new CountsComputer(lastTxId,nodeStore,relationshipStore,highLabelId,highRelationshipTypeId);
      life.add(new CountsTracker(logging.getMessagesLog(CountsTracker.class),fileSystem,pageCache,config,storeFileBase).setInitializer(initializer));
    }
   }
 }
