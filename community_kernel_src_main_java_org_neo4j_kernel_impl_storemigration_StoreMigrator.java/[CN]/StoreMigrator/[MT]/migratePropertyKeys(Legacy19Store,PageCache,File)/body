{
  Token[] tokens=legacyStore.getPropertyIndexReader().readTokens();
  if (containsAnyDuplicates(tokens)) {
    StoreFactory storeFactory=storeFactory(pageCache,migrationDir);
    storeFactory.createPropertyStore();
    try (PropertyStore propertyStore=storeFactory.newPropertyStore()){
      Map<Integer,Integer> propertyKeyTranslation=dedupAndWritePropertyKeyTokenStore(propertyStore,tokens);
      migratePropertyStore(legacyStore,propertyKeyTranslation,propertyStore);
    }
   }
}
