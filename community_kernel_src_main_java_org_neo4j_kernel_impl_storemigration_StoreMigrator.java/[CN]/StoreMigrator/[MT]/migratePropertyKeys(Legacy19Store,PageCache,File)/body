{
  Token[] tokens=legacyStore.getPropertyIndexReader().readTokens();
  if (containsAnyDuplicates(tokens)) {
    StoreFactory storeFactory=storeFactory(pageCache,migrationDir);
    try (NeoStores neoStores=storeFactory.openNeoStores(SF_CREATE)){
      PropertyStore propertyStore=neoStores.getPropertyStore();
      Map<Integer,Integer> propertyKeyTranslation=dedupAndWritePropertyKeyTokenStore(propertyStore,tokens);
      migratePropertyStore(legacyStore,propertyKeyTranslation,propertyStore);
    }
   }
}
