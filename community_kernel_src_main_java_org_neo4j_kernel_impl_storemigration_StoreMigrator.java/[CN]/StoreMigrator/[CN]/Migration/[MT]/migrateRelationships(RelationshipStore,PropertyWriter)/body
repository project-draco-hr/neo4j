{
  long nodeMaxId=legacyStore.getNodeStoreReader().getMaxId();
  Iterable<RelationshipRecord> records=legacyStore.getRelationshipStoreReader().readRelationshipStore();
  for (  RelationshipRecord relationshipRecord : records) {
    reportProgress(nodeMaxId + relationshipRecord.getId());
    relationshipStore.setHighId(relationshipRecord.getId() + 1);
    if (relationshipRecord.inUse()) {
      long startOfPropertyChain=relationshipRecord.getNextProp();
      if (startOfPropertyChain != Record.NO_NEXT_RELATIONSHIP.intValue()) {
        long propertyRecordId=migrateProperties(startOfPropertyChain,propertyWriter);
        relationshipRecord.setNextProp(propertyRecordId);
      }
      relationshipStore.updateRecord(relationshipRecord);
    }
 else {
      relationshipStore.freeId(relationshipRecord.getId());
    }
  }
  legacyStore.getRelationshipStoreReader().close();
}
