{
  Session session=env.newSession();
  final AtomicReference<Neo4jError> error=new AtomicReference<>();
  session.run("RETURN 1",EMPTY_PARAMS,null,Session.Callbacks.<StatementMetadata,Object>noop());
  session.pullAll(null,new Session.Callback.Adapter<RecordStream,Object>(){
    @Override public void result(    RecordStream result,    Object attachment) throws Exception {
      throw new RuntimeException("Ooopsies!");
    }
    @Override public void failure(    Neo4jError err,    Object attachment){
      error.set(err);
    }
  }
);
  assertThat(error.get(),equalTo(new Neo4jError(Status.General.UnknownFailure,"An unexpected failure occurred: 'Ooopsies!'.")));
}
