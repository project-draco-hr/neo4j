{
  String analyzerClass=config.get(configKey(indexName,"analyzer"));
  if (analyzerClass != null) {
    try {
      return Class.forName(analyzerClass).asSubclass(Analyzer.class).newInstance();
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
  String lowerCase=config.get(configKey(indexName,"to_lower_case"));
  if (lowerCase == null || Boolean.parseBoolean(lowerCase)) {
    return LuceneDataSource.LOWER_CASE_WHITESPACE_ANALYZER;
  }
 else {
    return LuceneDataSource.WHITESPACE_ANALYZER;
  }
}
