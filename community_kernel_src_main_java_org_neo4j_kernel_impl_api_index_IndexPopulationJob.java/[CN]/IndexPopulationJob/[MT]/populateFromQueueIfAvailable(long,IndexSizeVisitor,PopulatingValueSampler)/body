{
  if (!queue.isEmpty()) {
    try (IndexUpdater updater=createCountingIndexUpdater(sizeVisitor,populatingSampler)){
      do {
        NodePropertyUpdate update=queue.poll();
        if (update.getNodeId() <= currentlyIndexedNodeId) {
          updater.process(update);
        }
      }
 while (!queue.isEmpty());
    }
   }
}
