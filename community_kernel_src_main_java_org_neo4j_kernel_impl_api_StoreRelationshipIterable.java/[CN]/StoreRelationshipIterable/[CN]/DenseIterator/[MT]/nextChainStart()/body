{
  while (groupRecord != null) {
    if (type.test(groupRecord.getType())) {
      while (groupChainIndex < GROUP_CHAINS.length) {
        GroupChain groupChain=GROUP_CHAINS[groupChainIndex++];
        long chainStart=groupChain.chainStart(groupRecord);
        if (chainStart != Record.NO_NEXT_RELATIONSHIP.intValue() && (direction == Direction.BOTH || groupChain.matchesDirection(direction))) {
          return chainStart;
        }
      }
    }
    groupRecord=groupRecord.getNext() != Record.NO_NEXT_RELATIONSHIP.intValue() ? groupStore.getRecord(groupRecord.getNext()) : null;
    groupChainIndex=0;
  }
  return Record.NO_NEXT_RELATIONSHIP.intValue();
}
