{
switch (direction) {
case BOTH:
    return true;
case OUTGOING:
  return relationship.getFirstNode() == nodeId;
case INCOMING:
return relationship.getSecondNode() == nodeId;
default :
throw new IllegalArgumentException("Unknown direction " + direction);
}
}
