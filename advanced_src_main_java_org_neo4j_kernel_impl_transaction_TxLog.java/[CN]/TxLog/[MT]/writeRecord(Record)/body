{
  if (record.getType() == TX_START) {
    txStart(record.getGlobalId());
  }
 else   if (record.getType() == BRANCH_ADD) {
    addBranch(record.getGlobalId(),record.getBranchId());
  }
 else   if (record.getType() == MARK_COMMIT) {
    markAsCommitting(record.getGlobalId());
  }
 else {
    throw new IOException("Illegal record type[" + record.getType() + "]");
  }
}
