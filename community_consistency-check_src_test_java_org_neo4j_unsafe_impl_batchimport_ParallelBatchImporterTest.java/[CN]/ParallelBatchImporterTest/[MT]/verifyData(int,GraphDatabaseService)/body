{
  Set<Label> expectedLabels=new HashSet<>();
  for (  String label : LABELS) {
    expectedLabels.add(DynamicLabel.label(label));
  }
  GlobalGraphOperations globalOps=GlobalGraphOperations.at(db);
  Set<Label> allLabels=Iterables.toSet(globalOps.getAllLabels());
  assertEquals(allLabels,expectedLabels);
  Random random=new Random();
  for (int i=0; i < nodeCount / 10; i++) {
    Node node=db.getNodeById(random.nextInt(nodeCount));
    int count=count(node.getRelationships());
    assertEquals("For node " + node,count,node.getDegree());
    for (    String key : node.getPropertyKeys()) {
      node.getProperty(key);
      Set<Label> actualLabels=Iterables.toSet(node.getLabels());
      assertEquals(actualLabels,expectedLabels);
    }
  }
  Label firstLabel=DynamicLabel.label(LABELS[0]);
  ResourceIterable<Node> allNodesWithLabel=globalOps.getAllNodesWithLabel(firstLabel);
  assertEquals(count(allNodesWithLabel),nodeCount);
  ResourceIterable<Node> foundNodes=db.findNodesByLabelAndProperty(firstLabel,"age",10);
  assertEquals(count(foundNodes),nodeCount);
}
