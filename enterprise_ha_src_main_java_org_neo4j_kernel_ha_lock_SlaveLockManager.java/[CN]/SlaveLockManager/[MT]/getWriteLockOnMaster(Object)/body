{
  Response<LockResult> response;
  if (resource instanceof Node) {
    makeSureTxHasBeenInitialized();
    response=master.acquireNodeWriteLock(requestContextFactory.newRequestContext(),((Node)resource).getId());
  }
 else   if (resource instanceof Relationship) {
    makeSureTxHasBeenInitialized();
    response=master.acquireRelationshipWriteLock(requestContextFactory.newRequestContext(),((Relationship)resource).getId());
  }
 else   if (resource instanceof GraphProperties) {
    makeSureTxHasBeenInitialized();
    response=master.acquireGraphWriteLock(requestContextFactory.newRequestContext());
  }
 else   if (resource instanceof IndexEntryLock) {
    makeSureTxHasBeenInitialized();
    IndexEntryLock lock=(IndexEntryLock)resource;
    response=master.acquireIndexEntryWriteLock(requestContextFactory.newRequestContext(),lock.labelId(),lock.propertyKeyId(),lock.propertyValue());
  }
 else   if (resource instanceof IndexLock) {
    makeSureTxHasBeenInitialized();
    IndexLock indexLock=(IndexLock)resource;
    response=master.acquireIndexWriteLock(requestContextFactory.newRequestContext(),indexLock.getIndex(),indexLock.getKey());
  }
 else {
    throw new IllegalArgumentException("Don't know how to take lock on resource: '" + resource + "'.");
  }
  return receiveLockResponse(response);
}
