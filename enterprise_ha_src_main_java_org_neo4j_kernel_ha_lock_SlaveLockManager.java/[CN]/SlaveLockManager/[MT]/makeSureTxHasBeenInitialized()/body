{
  if (!availabilityGuard.isAvailable(config.getAvailabilityTimeout())) {
    throw new RuntimeException("Timed out waiting for database to allow operations to proceed. " + availabilityGuard.describeWhoIsBlocking());
  }
  TransactionState state=txManager.getTransactionState();
  if (!state.isRemotelyInitialized()) {
    txHook.remotelyInitializeTransaction(txManager.getEventIdentifier());
    state.markAsRemotelyInitialized();
  }
}
