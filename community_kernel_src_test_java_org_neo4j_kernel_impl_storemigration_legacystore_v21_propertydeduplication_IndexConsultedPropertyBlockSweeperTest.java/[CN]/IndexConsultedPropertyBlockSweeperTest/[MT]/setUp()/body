{
  api=dbRule.getGraphDatabaseAPI();
  nonIndexedPropKey="notIndexed";
  indexedPropKey="indexed";
  Label usedLabel=Label.label("UsedLabel");
  try (Transaction transaction=api.beginTx()){
    api.schema().indexFor(usedLabel).on(indexedPropKey).create();
    transaction.success();
  }
   try (Transaction transaction=api.beginTx()){
    indexedValue="value1";
    nonIndexedValue="value2";
    Node nodeA=api.createNode(usedLabel);
    nodeA.setProperty(indexedPropKey,indexedValue);
    nodeA.setProperty(nonIndexedPropKey,nonIndexedValue);
    nodeId=nodeA.getId();
    transaction.success();
  }
   DependencyResolver resolver=api.getDependencyResolver();
  NeoStores neoStores=resolver.resolveDependency(RecordStorageEngine.class).testAccessNeoStores();
  nodeStore=neoStores.getNodeStore();
  PropertyKeyTokenStore propertyKeyTokenStore=neoStores.getPropertyKeyTokenStore();
  propertyKeys=PropertyDeduplicatorTestUtil.indexPropertyKeys(propertyKeyTokenStore);
  propertyStore=neoStores.getPropertyStore();
  nodeRecord=getRecord(nodeStore,nodeId);
  propertyId=nodeRecord.getNextProp();
  indexMock=mock(IndexLookup.Index.class);
  when(indexMock.contains(nodeId,indexedValue)).thenReturn(true);
  propertyRemoverMock=mock(DuplicatePropertyRemover.class);
}
