{
  try {
    boolean successfullyCaughtUp=false;
    if (wantedStoreId.equals(storeId)) {
      successfullyCaughtUp=tryToCatchUp(source,storeFetcher);
    }
    if (!successfullyCaughtUp) {
      storeFiles.delete(storeDir);
      copyWholeStoreFrom(source,wantedStoreId,storeFetcher);
    }
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
