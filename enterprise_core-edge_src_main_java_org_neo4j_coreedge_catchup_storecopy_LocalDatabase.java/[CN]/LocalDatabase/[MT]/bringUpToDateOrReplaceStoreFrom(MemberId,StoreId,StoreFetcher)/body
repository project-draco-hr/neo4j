{
  try {
    boolean successfullyCaughtUp=false;
    if (wantedStoreId.equals(storeId)) {
      log.info("Bringing store up to date with %s",source);
      successfullyCaughtUp=tryToCatchUp(source,storeFetcher);
    }
    if (!successfullyCaughtUp) {
      log.info("Failed to bring store up to date with %s. Downloading new store. ",source);
      storeFiles.delete(storeDir);
      copyWholeStoreFrom(source,wantedStoreId,storeFetcher);
    }
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
