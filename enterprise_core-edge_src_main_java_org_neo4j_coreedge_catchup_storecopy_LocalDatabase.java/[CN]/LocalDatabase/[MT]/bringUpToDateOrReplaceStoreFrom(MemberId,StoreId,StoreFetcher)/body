{
  try {
    boolean successfullyCaughtUp=false;
    if (wantedStoreId.equals(storeId)) {
      log.info("Bringing store up to date with %s",source);
      successfullyCaughtUp=tryToCatchUp(source,storeFetcher);
      if (!successfullyCaughtUp) {
        log.info("Failed to bring store up to date with %s.",source);
      }
    }
    if (!successfullyCaughtUp) {
      log.info("Deleting local store and downloading new store from %s.",source);
      storeFiles.delete(storeDir);
      copyWholeStoreFrom(source,wantedStoreId,storeFetcher);
    }
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
