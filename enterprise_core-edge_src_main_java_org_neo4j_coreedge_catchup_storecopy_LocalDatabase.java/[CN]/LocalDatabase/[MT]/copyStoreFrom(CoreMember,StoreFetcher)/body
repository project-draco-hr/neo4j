{
  try {
    storeFiles.delete(storeDir);
    TemporaryStoreDirectory tempStore=new TemporaryStoreDirectory(storeDir);
    storeFetcher.copyStore(from,tempStore.storeDir());
    copiedStoreRecovery.recoverCopiedStore(tempStore.storeDir());
    storeFiles.moveTo(tempStore.storeDir(),storeDir);
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
