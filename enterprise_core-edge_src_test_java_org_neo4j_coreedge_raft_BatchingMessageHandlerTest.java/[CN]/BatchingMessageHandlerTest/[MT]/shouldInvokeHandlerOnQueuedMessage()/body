{
  @SuppressWarnings("unchecked") Inbound.MessageHandler<RaftMessages.RaftMessage<Object>> innerHandler=mock(Inbound.MessageHandler.class);
  BatchingMessageHandler<Object> batchHandler=new BatchingMessageHandler<>(innerHandler,NullLogProvider.getInstance(),QUEUE_SIZE,MAX_BATCH,localDatabase);
  RaftMessages.NewEntry.Request<Object> message=new RaftMessages.NewEntry.Request<>(null,null,localDatabase.storeId());
  ExecutorService executor=Executors.newCachedThreadPool();
  Future<?> future=executor.submit(batchHandler);
  Thread.sleep(50);
  batchHandler.handle(message);
  future.get();
  verify(innerHandler).handle(message);
}
