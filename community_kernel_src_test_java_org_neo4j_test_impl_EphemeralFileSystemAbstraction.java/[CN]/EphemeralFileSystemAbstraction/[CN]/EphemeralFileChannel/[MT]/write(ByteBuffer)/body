{
  int wanted=src.limit();
  int pending=wanted;
  while (pending > 0) {
    int howMuchToWriteThisTime=min(pending,scratchPad.length);
    src.get(scratchPad,0,howMuchToWriteThisTime);
    fileAsBuffer.put(scratchPad,0,howMuchToWriteThisTime);
    pending-=howMuchToWriteThisTime;
  }
  int newSize=max(size,(int)position());
  int intermediaryBytes=newSize - wanted - size;
  if (intermediaryBytes > 0) {
    int oldPos=fileAsBuffer.position();
    try {
      fileAsBuffer.position(size);
      fillWithZeros(fileAsBuffer.buf,intermediaryBytes);
    }
  finally {
      fileAsBuffer.position(oldPos);
    }
  }
  size=newSize;
  return wanted;
}
