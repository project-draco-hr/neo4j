{
  int wanted=src.limit();
  int pending=wanted;
  while (pending > 0) {
    int howMuchToWriteThisTime=min(pending,scratchPad.length);
    src.get(scratchPad,0,howMuchToWriteThisTime);
    fileAsBuffer.put((int)fc.position,scratchPad,0,howMuchToWriteThisTime);
    fc.position+=howMuchToWriteThisTime;
    pending-=howMuchToWriteThisTime;
  }
  int newSize=max(size,(int)fc.position);
  int intermediaryBytes=newSize - wanted - size;
  if (intermediaryBytes > 0) {
    fileAsBuffer.fillWithZeros(size,intermediaryBytes);
    fileAsBuffer.buf.position(size);
  }
  size=newSize;
  return wanted;
}
