{
  if (tx.getResourceCount() == 0) {
    tx.setStatus(Status.STATUS_COMMITTED);
  }
 else {
    throw new ReadOnlyDbException();
  }
  tx.doAfterCompletion();
  txThreadMap.remove(thread);
  tx.setStatus(Status.STATUS_NO_TRANSACTION);
}
