{
  File failureFile=failureFile(indexId);
  RandomAccessFile rwFile=new RandomAccessFile(failureFile,"rw");
  try {
    FileChannel channel=rwFile.getChannel();
    byte[] data=failure.getBytes("utf-8");
    channel.write(wrap(data,0,Math.min(data.length,MAX_FAILURE_SIZE)));
    channel.force(true);
    channel.close();
  }
  finally {
    rwFile.close();
  }
}
