{
  File failureFile=failureFile(indexId);
  try (RandomAccessFile rwFile=new RandomAccessFile(failureFile,"rw")){
    FileChannel channel=rwFile.getChannel();
    byte[] data=failure.getBytes("utf-8");
    channel.write(ByteBuffer.wrap(data,0,Math.min(data.length,MAX_FAILURE_SIZE)));
    channel.force(true);
    channel.close();
  }
 }
