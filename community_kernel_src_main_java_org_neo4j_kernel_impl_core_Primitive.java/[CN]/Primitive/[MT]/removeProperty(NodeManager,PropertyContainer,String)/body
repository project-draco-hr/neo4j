{
  if (key == null) {
    throw new IllegalArgumentException("Null parameter.");
  }
  boolean success=false;
  TransactionState tx=nodeManager.getTransactionState();
  tx.acquireWriteLock(proxy);
  try {
    ensureFullProperties(nodeManager);
    PropertyData property=getAndUpdateTransactionStateForRemoveProperty(nodeManager,tx,key);
    if (property == null) {
      success=true;
      return null;
    }
    removeProperty(nodeManager,property,tx);
    success=true;
    return getPropertyValue(nodeManager,property);
  }
  finally {
    if (!success) {
      nodeManager.setRollbackOnly();
    }
  }
}
