{
  TransactionState tx=nodeManager.getTransactionState();
  ArrayMap<Integer,PropertyData> skipMap=null, addMap=null;
  if (tx.hasChanges()) {
    skipMap=tx.getCowPropertyRemoveMap(this);
    addMap=tx.getCowPropertyAddMap(this);
  }
  ensureFullProperties(nodeManager);
  List<String> keys=new ArrayList<String>();
  try {
    for (    PropertyData property : allProperties()) {
      Integer index=property.getIndex();
      if (skipMap != null && skipMap.get(index) != null) {
        continue;
      }
      if (addMap != null && addMap.get(index) != null) {
        continue;
      }
      keys.add(nodeManager.getPropertyKeyToken(index).getKey());
    }
    if (addMap != null) {
      for (      Integer index : addMap.keySet()) {
        keys.add(nodeManager.getPropertyKeyToken(index).getKey());
      }
    }
  }
 catch (  TokenNotFoundException e) {
    throw new NotFoundException(e);
  }
  return keys;
}
