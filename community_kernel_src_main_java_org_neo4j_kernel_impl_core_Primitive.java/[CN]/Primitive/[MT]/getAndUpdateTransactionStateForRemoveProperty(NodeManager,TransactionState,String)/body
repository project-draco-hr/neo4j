{
  ArrayMap<Integer,PropertyData> addMap=tx.getCowPropertyAddMap(this);
  ArrayMap<Integer,PropertyData> removeMap=tx.getCowPropertyRemoveMap(this);
  Token cachedIndex=nodeManager.getPropertyKeyTokenOrNull(key);
  PropertyData property=null;
  if (cachedIndex != null) {
    if (addMap != null) {
      property=addMap.remove(cachedIndex.id());
      if (property != null) {
        removeMap=removeMap != null ? removeMap : tx.getOrCreateCowPropertyRemoveMap(this);
        removeMap.put(cachedIndex.id(),property);
        return property;
      }
    }
    if (removeMap != null && removeMap.get(cachedIndex.id()) != null) {
      return null;
    }
    property=getPropertyForIndex(cachedIndex.id());
    if (property != null) {
      removeMap=removeMap != null ? removeMap : tx.getOrCreateCowPropertyRemoveMap(this);
      removeMap.put(cachedIndex.id(),property);
    }
  }
  return property;
}
