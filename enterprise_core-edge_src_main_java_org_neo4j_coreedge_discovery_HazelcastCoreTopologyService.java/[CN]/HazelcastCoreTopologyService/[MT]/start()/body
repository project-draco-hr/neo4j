{
  hazelcastInstance=createHazelcastInstance();
  log.info("Cluster discovery service started");
  membershipRegistrationId=hazelcastInstance.getCluster().addMembershipListener(new OurMembershipListener());
  mapRegistrationId=hazelcastInstance.getMap(EDGE_SERVER_BOLT_ADDRESS_MAP_NAME).addEntryListener(new OurEntryListener(),true);
  refreshCoreTopology();
  refreshEdgeTopology();
  listenerService.notifyListeners(coreServers());
  try {
    scheduler.start();
  }
 catch (  Throwable throwable) {
    log.debug("Failed to start job scheduler.");
    return;
  }
  JobScheduler.Group group=new JobScheduler.Group("Scheduler",POOLED);
  jobHandle=this.scheduler.scheduleRecurring(group,new TopologyRefresher(),config.get(CoreEdgeClusterSettings.cluster_topology_refresh),TimeUnit.MILLISECONDS);
}
