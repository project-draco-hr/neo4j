{
  AbstractNeoServer neoServer=mock(serverClass);
  Database database=mock(Database.class);
  final GraphDatabaseAPI graphDatabaseAPI=mock(GraphDatabaseAPI.class);
  final Version version=mock(Version.class);
  KernelData kernelData=stubKernelData(graphDatabaseAPI,version);
  when(version.getReleaseVersion()).thenReturn("2.0.0");
  DependencyResolver dependencyResolver=mock(DependencyResolver.class);
  when(graphDatabaseAPI.getDependencyResolver()).thenReturn(dependencyResolver);
  when(dependencyResolver.resolveDependency(KernelData.class)).thenReturn(kernelData);
  when(database.getGraph()).thenReturn(graphDatabaseAPI);
  when(neoServer.getDatabase()).thenReturn(database);
  return neoServer;
}
