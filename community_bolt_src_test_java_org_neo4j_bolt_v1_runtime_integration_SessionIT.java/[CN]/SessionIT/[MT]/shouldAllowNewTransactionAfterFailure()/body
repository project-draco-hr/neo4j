{
  Session session=env.newSession("<test>");
  session.init("TestClient/1.0",emptyMap(),-1,null);
  runAndPull(session,"BEGIN");
  session.run("invalid",EMPTY_PARAMS,Session.Callbacks.<StatementMetadata>noop());
  session.reset(Session.Callbacks.<Void>noop());
  runAndPull(session,"BEGIN");
  Object[] stream=runAndPull(session,"RETURN 1");
  assertThat(((Record)stream[0]).fields()[0],equalTo((Object)1L));
}
