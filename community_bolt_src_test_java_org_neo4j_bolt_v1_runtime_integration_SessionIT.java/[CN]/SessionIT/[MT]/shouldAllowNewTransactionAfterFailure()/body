{
  Session session=env.newSession("<test>");
  session.init("TestClient/1.0",emptyMap(),BASE_TX_ID,null,null);
  runAndPull(session,"BEGIN");
  session.run("invalid",EMPTY_PARAMS,null,Session.Callbacks.<StatementMetadata,Object>noop());
  session.reset(null,Session.Callbacks.<Void,Object>noop());
  runAndPull(session,"BEGIN");
  Object[] stream=runAndPull(session,"RETURN 1");
  assertThat(((Record)stream[0]).fields()[0],equalTo((Object)1L));
}
