{
  return new FullStoreChangeStream(){
    @Override public Iterator<NodeLabelUpdate> iterator(){
      return new PrefetchingIterator<NodeLabelUpdate>(){
        private final long[] NO_LABELS=new long[0];
        private final NodeStore nodeStore=neoStoreProvider.evaluate().getNodeStore();
        private final long highId=nodeStore.getHighestPossibleIdInUse();
        private long current;
        @Override protected NodeLabelUpdate fetchNextOrNull(){
          while (current <= highId) {
            NodeRecord node=nodeStore.forceGetRecord(current++);
            if (node.inUse()) {
              long[] labels=NodeLabelsField.parseLabelsField(node).get(nodeStore);
              if (labels.length > 0) {
                return NodeLabelUpdate.labelChanges(node.getId(),NO_LABELS,labels);
              }
            }
          }
          return null;
        }
      }
;
    }
    @Override public PrimitiveLongIterator labelIds(){
      final Token[] labels=neoStoreProvider.evaluate().getLabelTokenStore().getTokens(MAX_VALUE);
      return new PrimitiveLongBaseIterator(){
        int index;
        @Override protected boolean fetchNext(){
          return index <= labels.length ? next(labels[index++].id()) : false;
        }
      }
;
    }
    @Override public long highestNodeId(){
      return neoStoreProvider.evaluate().getNodeStore().getHighestPossibleIdInUse();
    }
  }
;
}
