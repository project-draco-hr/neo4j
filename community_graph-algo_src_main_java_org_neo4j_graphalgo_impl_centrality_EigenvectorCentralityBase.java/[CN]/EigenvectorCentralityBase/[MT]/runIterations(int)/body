{
  if (maxNrIterations <= 0) {
    return 0;
  }
  int localIterations=0;
  while (localIterations < maxNrIterations) {
    Map<Node,Double> oldValues=values;
    localIterations+=runInternalIteration();
    if (timeToStop(oldValues,values)) {
      break;
    }
  }
  changeSignBasedOnFirstNoneZeroValue();
  return localIterations;
}
