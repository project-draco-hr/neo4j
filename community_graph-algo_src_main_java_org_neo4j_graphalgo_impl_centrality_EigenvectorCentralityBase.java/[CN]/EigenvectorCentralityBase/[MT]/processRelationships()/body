{
  Map<Node,Double> newValues=new HashMap<>();
  for (  Relationship relationship : relationshipSet) {
    if (relationDirection.equals(Direction.BOTH) || relationDirection.equals(Direction.OUTGOING)) {
      processRelationship(newValues,relationship,false);
    }
    if (relationDirection.equals(Direction.BOTH) || relationDirection.equals(Direction.INCOMING)) {
      processRelationship(newValues,relationship,true);
    }
  }
  return newValues;
}
