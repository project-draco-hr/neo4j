{
  int size=unpackTextHeader();
  if (length >= size) {
    unpackRawBytesInto(buffer,offset,size);
  }
 else {
    unpackRawBytesInto(buffer,offset,length);
    discardRawBytes(size - length);
  }
  return size;
}
