{
  final Mode mode=Mode.fromString(config.get(EnterpriseServerSettings.mode).toUpperCase());
switch (mode) {
case HA:
    return lifecycleManagingDatabase(HA_FACTORY);
case ARBITER:
  throw new IllegalArgumentException("The server cannot be started in ARBITER mode.");
case CORE:
return lifecycleManagingDatabase(CORE_FACTORY);
case EDGE:
return lifecycleManagingDatabase(EDGE_FACTORY);
default :
return lifecycleManagingDatabase(ENTERPRISE_FACTORY);
}
}
