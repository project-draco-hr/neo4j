{
  Args args=Args.parse(arguments);
  long nodeCount=parseLongWithUnit(args.get("nodes",null));
  long relationshipCount=parseLongWithUnit(args.get("relationships",null));
  int labelCount=args.getNumber("labels",4).intValue();
  int relationshipTypeCount=args.getNumber("relationship-types",4).intValue();
  String dir=args.get(ImportTool.Options.STORE_DIR.key());
  Extractors extractors=new Extractors(COMMAS.arrayDelimiter());
  IdType idType=IdType.valueOf(args.get("id-type",IdType.ACTUAL.name()));
  Header nodeHeader=parseNodeHeader(args,idType,extractors);
  Header relationshipHeader=parseRelationshipHeader(args,idType,extractors);
  Input input=new CsvDataGeneratorInput(nodeHeader,relationshipHeader,COMMAS,nodeCount,relationshipCount,new Groups(),idType,labelCount,relationshipTypeCount,silentBadCollector(0));
  BatchImporter importer=new ParallelBatchImporter(dir,DEFAULT,new SystemOutLogging(),defaultVisible());
  importer.doImport(input);
}
