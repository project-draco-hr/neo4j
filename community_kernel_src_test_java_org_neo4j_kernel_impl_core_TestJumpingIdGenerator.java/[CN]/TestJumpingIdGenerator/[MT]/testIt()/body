{
  int sizePerJump=1000;
  IdGeneratorFactory factory=new JumpingIdGeneratorFactory(sizePerJump);
  IdGenerator generator=factory.get(IdType.NODE);
  for (int i=0; i < sizePerJump / 2; i++) {
    assertEquals((long)i,generator.nextId());
  }
  for (int i=0; i < sizePerJump - 1; i++) {
    long expected=0x100000000L - sizePerJump / 2 + i;
    if (expected >= 0xFFFFFFFFL) {
      expected++;
    }
    assertEquals(expected,generator.nextId());
  }
  for (int i=0; i < sizePerJump; i++) {
    assertEquals(0x200000000L - sizePerJump / 2 + i,generator.nextId());
  }
  for (int i=0; i < sizePerJump; i++) {
    assertEquals(0x300000000L - sizePerJump / 2 + i,generator.nextId());
  }
}
