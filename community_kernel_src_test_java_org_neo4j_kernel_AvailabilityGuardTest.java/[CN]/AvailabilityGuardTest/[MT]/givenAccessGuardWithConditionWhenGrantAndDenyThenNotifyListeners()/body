{
  TickingClock clock=new TickingClock(0,100);
  final AvailabilityGuard availabilityGuard=new AvailabilityGuard(clock,1);
  final AtomicBoolean notified=new AtomicBoolean();
  AvailabilityGuard.AvailabilityListener availabilityListener=new AvailabilityGuard.AvailabilityListener(){
    @Override public void available(){
    }
    @Override public void unavailable(){
      notified.set(true);
    }
  }
;
  availabilityGuard.addListener(availabilityListener);
  availabilityGuard.grant();
  availabilityGuard.deny();
  assertThat(notified.get(),equalTo(true));
}
