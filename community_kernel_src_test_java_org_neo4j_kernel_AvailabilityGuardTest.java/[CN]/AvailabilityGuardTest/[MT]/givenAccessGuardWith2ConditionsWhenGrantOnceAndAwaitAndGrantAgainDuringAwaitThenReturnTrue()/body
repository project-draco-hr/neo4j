{
  TickingClock clock=new TickingClock(0,100,TimeUnit.MILLISECONDS);
  Log log=mock(Log.class);
  final AvailabilityGuard availabilityGuard=new AvailabilityGuard(clock,log);
  availabilityGuard.require(REQUIREMENT_1);
  availabilityGuard.require(REQUIREMENT_2);
  clock.at(500,TimeUnit.MILLISECONDS,new Runnable(){
    @Override public void run(){
      availabilityGuard.fulfill(REQUIREMENT_1);
    }
  }
);
  availabilityGuard.fulfill(REQUIREMENT_2);
  long start=clock.currentTimeMillis();
  boolean result=availabilityGuard.isAvailable(1000);
  long end=clock.currentTimeMillis();
  long waitTime=end - start;
  assertThat(result,equalTo(true));
  assertThat(waitTime,equalTo(600L));
}
