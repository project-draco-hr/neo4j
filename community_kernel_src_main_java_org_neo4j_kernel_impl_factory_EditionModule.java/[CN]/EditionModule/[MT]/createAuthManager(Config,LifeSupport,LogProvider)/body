{
  boolean authEnabled=config.get(GraphDatabaseSettings.auth_enabled);
  if (authEnabled) {
    File storePath=config.get(GraphDatabaseSettings.auth_store);
    if (storePath == null) {
      logProvider.getLog(EditionModule.class).warn("Authentication not enabled because %s is not set.",GraphDatabaseSettings.auth_store.name());
      return AuthManager.NO_AUTH;
    }
    FileUserRepository users=life.add(new FileUserRepository(storePath.toPath(),logProvider));
    return life.add(new BasicAuthManager(users,systemUTC(),true));
  }
 else {
    return AuthManager.NO_AUTH;
  }
}
