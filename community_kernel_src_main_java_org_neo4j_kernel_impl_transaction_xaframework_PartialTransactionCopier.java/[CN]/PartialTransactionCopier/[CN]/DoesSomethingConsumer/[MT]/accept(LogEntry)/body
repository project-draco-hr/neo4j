{
  Integer identifier=logEntry.getIdentifier();
  boolean isActive=xidIdentMap.get(identifier) != null;
  if (!foundFirstActiveTx && isActive) {
    foundFirstActiveTx=true;
  }
  if (foundFirstActiveTx) {
    if (logEntry instanceof LogEntry.Start) {
      LogEntry.Start startEntry=(LogEntry.Start)logEntry;
      startEntriesEncountered.put(identifier,startEntry);
      startEntry.setStartPosition(targetLog.getFileChannelPosition());
      if (isActive)       xidIdentMap.put(identifier,startEntry);
    }
 else     if (logEntry instanceof LogEntry.Commit) {
      LogEntry.Commit commitEntry=(LogEntry.Commit)logEntry;
      LogEntry.Start startEntry=startEntriesEncountered.get(identifier);
      if (startEntry == null) {
        startEntry=fetchTransactionBulkFromLogExtractor(commitEntry.getTxId());
        startEntriesEncountered.put(identifier,startEntry);
      }
 else {
        LogExtractor.TxPosition oldPos=positionCache.getStartPosition(commitEntry.getTxId());
        LogExtractor.TxPosition newPos=positionCache.cacheStartPosition(commitEntry.getTxId(),startEntry,targetLogVersion);
        log.logMessage("Updated tx " + ((LogEntry.Commit)logEntry).getTxId() + " from "+ oldPos+ " to "+ newPos);
      }
    }
    if (startEntriesEncountered.containsKey(identifier)) {
      logEntryWriter.writeLogEntry(logEntry,targetLog);
    }
  }
  ;
  return true;
}
