{
  File temporaryConfigFile=createTempPropertyFile();
  writePropertyToFile(Configurator.DATABASE_LOCATION_PROPERTY_KEY,dbDir,temporaryConfigFile);
  if (portNo != null) {
    writePropertyToFile(Configurator.WEBSERVER_PORT_PROPERTY_KEY,portNo,temporaryConfigFile);
  }
  writePropertyToFile(Configurator.WEBADMIN_NAMESPACE_PROPERTY_KEY + ".rrdb.location",rrdbDir,temporaryConfigFile);
  writePropertyToFile(Configurator.WEB_ADMIN_PATH_PROPERTY_KEY,webAdminUri,temporaryConfigFile);
  writePropertyToFile(Configurator.REST_API_PATH_PROPERTY_KEY,webAdminDataUri,temporaryConfigFile);
  if (action == WhatToDo.CREATE_GOOD_TUNING_FILE) {
    File databaseTuningPropertyFile=createTempPropertyFile();
    writePropertyToFile("neostore.nodestore.db.mapped_memory","25M",databaseTuningPropertyFile);
    writePropertyToFile("neostore.relationshipstore.db.mapped_memory","50M",databaseTuningPropertyFile);
    writePropertyToFile("neostore.propertystore.db.mapped_memory","90M",databaseTuningPropertyFile);
    writePropertyToFile("neostore.propertystore.db.strings.mapped_memory","130M",databaseTuningPropertyFile);
    writePropertyToFile("neostore.propertystore.db.arrays.mapped_memory","130M",databaseTuningPropertyFile);
    writePropertyToFile(Configurator.DB_TUNING_PROPERTY_FILE_KEY,databaseTuningPropertyFile.getAbsolutePath(),temporaryConfigFile);
  }
 else   if (action == WhatToDo.CREATE_DANGLING_TUNING_FILE_PROPERTY) {
    writePropertyToFile(Configurator.DB_TUNING_PROPERTY_FILE_KEY,createTempPropertyFile().getAbsolutePath(),temporaryConfigFile);
  }
 else   if (action == WhatToDo.CREATE_CORRUPT_TUNING_FILE) {
    File corruptTuningFile=trashFile();
    writePropertyToFile(Configurator.DB_TUNING_PROPERTY_FILE_KEY,corruptTuningFile.getAbsolutePath(),temporaryConfigFile);
  }
  if (thirdPartyPackages.keySet().size() > 0) {
    writePropertiesToFile(Configurator.THIRD_PARTY_PACKAGES_KEY,thirdPartyPackages,temporaryConfigFile);
  }
  return temporaryConfigFile;
}
