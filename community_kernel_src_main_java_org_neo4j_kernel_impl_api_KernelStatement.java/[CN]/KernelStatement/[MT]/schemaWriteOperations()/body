{
  if (!transaction.mode().allowsSchemaWrites()) {
    throw new AuthorizationViolationException(String.format("Schema operations are not allowed for '%s'.",transaction.mode().name()));
  }
  transaction.upgradeToSchemaWrites();
  return facade;
}
