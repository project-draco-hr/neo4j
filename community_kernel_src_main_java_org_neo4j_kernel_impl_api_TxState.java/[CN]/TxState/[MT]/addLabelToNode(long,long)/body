{
  Pair<Collection<Long>,Collection<Long>> nodeLabels=getNodeLabels(labelId);
  nodeLabels.first().add(nodeId);
  nodeLabels.other().remove(nodeId);
  NodeState nodeState=getNodeState(nodeId,true);
  nodeState.getRemovedLabels().remove(labelId);
  return nodeState.getAddedLabels().add(labelId);
}
