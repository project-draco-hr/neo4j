{
  try (RaftLogCursor cursor=raftLog.getEntryCursor(lastApplied + 1)){
    while (cursor.next() && lastApplied < commitIndex) {
      long indexToApply=lastApplied + 1;
      stateMachine.applyCommand(cursor.get().content(),indexToApply);
      lastApplied=indexToApply;
      if (indexToApply % this.flushEvery == 0) {
        stateMachine.flush();
        lastAppliedStorage.persistStoreData(new LastAppliedState(lastApplied));
        lastFlushed=lastApplied;
      }
    }
  }
 }
