{
  while (lastApplied < commitIndex) {
    long indexToApply=lastApplied + 1;
    RaftLogEntry logEntry=raftLog.readLogEntry(indexToApply);
    stateMachine.applyCommand(logEntry.content(),indexToApply);
    lastApplied=indexToApply;
    if (indexToApply % this.flushEvery == 0) {
      stateMachine.flush();
      lastAppliedStorage.persistStoreData(new LastAppliedState(lastApplied));
    }
  }
}
