{
  assertStillOpen();
  long nextDefragId=nextIdFromDefragList();
  if (nextDefragId != -1) {
    return nextDefragId;
  }
  long id=highId.get();
  if (id == INTEGER_MINUS_ONE) {
    id=highId.incrementAndGet();
  }
  assertIdWithinCapacity(id);
  highId.incrementAndGet();
  return id;
}
