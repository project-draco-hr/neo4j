{
  try {
    fileChannel.position(fileChannel.size());
    writeBuffer.clear();
    while (!releasedIdList.isEmpty()) {
      long id=releasedIdList.removeFirst();
      if (id == INTEGER_MINUS_ONE) {
        continue;
      }
      writeBuffer.putLong(id);
      if (writeBuffer.position() == writeBuffer.capacity()) {
        writeBuffer.flip();
        while (writeBuffer.hasRemaining()) {
          fileChannel.write(writeBuffer);
        }
        writeBuffer.clear();
      }
    }
    writeBuffer.flip();
    while (writeBuffer.hasRemaining()) {
      fileChannel.write(writeBuffer);
    }
    fileChannel.position(readPosition);
    if (aggressiveReuse) {
      maxReadPosition=fileChannel.size();
    }
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException("Unable to write defragged id " + " batch",e);
  }
}
