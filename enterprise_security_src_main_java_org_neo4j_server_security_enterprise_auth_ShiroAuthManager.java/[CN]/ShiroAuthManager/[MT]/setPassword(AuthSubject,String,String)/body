{
  ShiroAuthSubject shiroAuthSubject=ShiroAuthSubject.castOrFail(authSubject);
  if (!shiroAuthSubject.doesUsernameMatch(username)) {
    throw new AuthorizationViolationException("Invalid attempt to change the password for user " + username);
  }
  passwordPolicy.validatePassword(password);
  setUserPassword(username,password);
}
