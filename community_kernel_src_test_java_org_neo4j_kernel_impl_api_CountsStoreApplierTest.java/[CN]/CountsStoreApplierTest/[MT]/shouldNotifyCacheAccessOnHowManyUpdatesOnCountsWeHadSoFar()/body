{
  final CountsTracker tracker=mock(CountsTracker.class);
  final CountsAccessor.Updater updater=mock(CountsAccessor.Updater.class);
  when(tracker.apply(anyLong())).thenReturn(Optionals.some(updater));
  final CountsStoreApplier applier=new CountsStoreApplier(tracker,TransactionApplicationMode.INTERNAL);
  applier.begin(new TransactionToApply(null,2L),new LockGroup());
  applier.visitNodeCountsCommand(addNodeCommand());
  applier.apply();
  verify(updater,times(1)).incrementNodeCount(ReadOperations.ANY_LABEL,1);
}
