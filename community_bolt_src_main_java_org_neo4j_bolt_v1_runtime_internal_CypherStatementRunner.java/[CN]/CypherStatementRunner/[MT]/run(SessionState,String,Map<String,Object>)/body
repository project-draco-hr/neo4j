{
  if (statement.equalsIgnoreCase("begin")) {
    ctx.beginTransaction();
    return RecordStream.EMPTY;
  }
 else   if (statement.equalsIgnoreCase("commit")) {
    ctx.commitTransaction();
    return RecordStream.EMPTY;
  }
 else   if (statement.equalsIgnoreCase("rollback")) {
    ctx.rollbackTransaction();
    return RecordStream.EMPTY;
  }
 else   if (statement.equalsIgnoreCase("foobar")) {
    throw new RuntimeException("Foobar occurred");
  }
 else {
    if (ctx.hasTransaction() || queryExecutionEngine.isPeriodicCommit(statement)) {
      return new CypherAdapterStream(db.execute(statement,params));
    }
 else {
      ctx.beginImplicitTransaction();
      return new CypherAdapterStream(db.execute(statement,params));
    }
  }
}
