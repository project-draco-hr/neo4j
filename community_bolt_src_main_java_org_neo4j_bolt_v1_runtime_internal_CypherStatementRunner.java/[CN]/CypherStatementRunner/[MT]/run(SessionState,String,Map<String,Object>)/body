{
  if (statement.equalsIgnoreCase("begin")) {
    ctx.beginTransaction();
    return RecordStream.EMPTY;
  }
 else   if (statement.equalsIgnoreCase("commit")) {
    ctx.commitTransaction();
    return RecordStream.EMPTY;
  }
 else   if (statement.equalsIgnoreCase("rollback")) {
    ctx.rollbackTransaction();
    return RecordStream.EMPTY;
  }
 else {
    boolean hasTx=ctx.hasTransaction();
    boolean isPeriodicCommit=queryExecutionEngine.isPeriodicCommit(statement);
    if (!hasTx && !isPeriodicCommit) {
      ctx.beginImplicitTransaction();
    }
    QuerySession session=ctx.createSession(queryExecutionEngine.queryService(),locker);
    Result result=queryExecutionEngine.executeQuery(statement,params,session);
    if (isPeriodicCommit) {
      ctx.beginImplicitTransaction();
    }
    return new CypherAdapterStream(result);
  }
}
