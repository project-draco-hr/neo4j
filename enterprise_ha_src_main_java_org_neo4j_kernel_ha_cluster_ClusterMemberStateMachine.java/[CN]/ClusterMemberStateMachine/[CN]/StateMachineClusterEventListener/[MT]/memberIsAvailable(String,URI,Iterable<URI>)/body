{
  try {
    if (role.equals(ClusterConfiguration.COORDINATOR)) {
      URI masterHaUri=ServerUtil.getUriForScheme("ha",instanceUris);
      if (!masterHaUri.equals(context.getAvailableHaMaster())) {
        ClusterMemberState oldState=state;
        context.setAvailableHaMasterId(masterHaUri);
        state=state.masterIsAvailable(context,instanceClusterUri,masterHaUri);
        logger.debug("Got masterIsAvailable(" + instanceClusterUri + ", moved to "+ state+ " from "+ oldState);
        final ClusterMemberChangeEvent event=new ClusterMemberChangeEvent(oldState,state,instanceClusterUri,masterHaUri);
        Listeners.notifyListeners(clusterMemberListeners,new Listeners.Notification<ClusterMemberListener>(){
          @Override public void notify(          ClusterMemberListener listener){
            listener.masterIsAvailable(event);
          }
        }
);
        accessGuard.setState(state);
      }
    }
 else     if (role.equals(ClusterConfiguration.SLAVE)) {
      URI slaveHaUri=ServerUtil.getUriForScheme("ha",instanceUris);
      ClusterMemberState oldState=state;
      state=state.slaveIsAvailable(context,instanceClusterUri);
      logger.debug("Got slaveIsAvailable(" + instanceClusterUri + "), "+ "moved to "+ state+ " from "+ oldState);
      final ClusterMemberChangeEvent event=new ClusterMemberChangeEvent(oldState,state,instanceClusterUri,slaveHaUri);
      Listeners.notifyListeners(clusterMemberListeners,new Listeners.Notification<ClusterMemberListener>(){
        @Override public void notify(        ClusterMemberListener listener){
          listener.slaveIsAvailable(event);
        }
      }
);
      accessGuard.setState(state);
    }
  }
 catch (  Throwable throwable) {
    logger.warn("Exception while receiving member availability notification",throwable);
  }
}
