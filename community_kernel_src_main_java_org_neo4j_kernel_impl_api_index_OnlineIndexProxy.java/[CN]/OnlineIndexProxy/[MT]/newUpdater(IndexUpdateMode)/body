{
  return new CollectingIndexUpdater(){
    @Override public void close() throws IOException {
switch (mode) {
case ONLINE:
        try {
          accessor.updateAndCommit(updates);
        }
 catch (        IndexEntryConflictException e) {
          throw e.notAllowed(descriptor);
        }
      break;
case RECOVERY:
    accessor.recover(updates);
  break;
default :
throw new ThisShouldNotHappenError("Stefan","Unsupported IndexUpdateMode");
}
}
}
;
}
