{
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  fsa.mkdir(testDir.directory());
  OnDiskIdAllocationState store=new OnDiskIdAllocationState(fsa,testDir.directory(),1,mock(Supplier.class));
  store.firstUnallocated(someType,1024);
  store.logIndex(1);
  OnDiskIdAllocationState restoredOne=new OnDiskIdAllocationState(fsa,testDir.directory(),1,mock(Supplier.class));
  assertEquals(1024,restoredOne.firstUnallocated(someType));
}
