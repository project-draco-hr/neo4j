{
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  fsa.mkdir(testDir.directory());
  OnDiskIdAllocationState store=new OnDiskIdAllocationState(fsa,testDir.directory(),100,mock(Supplier.class));
  store.firstUnallocated(someType,1024);
  store.logIndex(0);
  assertEquals(1024,store.firstUnallocated(someType));
  assertTrue(fsa.fileExists(store.currentStoreFile()));
  assertEquals(NUMBER_OF_BYTES_PER_WRITE,fsa.getFileSize(store.currentStoreFile()));
}
