{
  LifeSupport life=new LifeSupport();
  try {
    stopServicesAndHandleBranchedStore(BranchedDataPolicy.keep_none);
    MasterClient copyMaster=newMasterClient(masterUri,null,life);
    life.start();
    console.log("Copying store from master");
    new SlaveStoreWriter(config,console).copyStore(copyMaster,cancellationRequest);
    startServicesAgain();
    console.log("Finished copying store from master");
  }
  finally {
    life.stop();
  }
}
