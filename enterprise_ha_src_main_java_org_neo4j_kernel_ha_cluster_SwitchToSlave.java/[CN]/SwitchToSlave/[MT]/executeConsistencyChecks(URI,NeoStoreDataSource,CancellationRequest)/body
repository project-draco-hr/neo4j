{
  LifeSupport consistencyCheckLife=new LifeSupport();
  try {
    StoreId myStoreId=neoDataSource.getStoreId();
    MasterClient masterClient=newMasterClient(masterUri,myStoreId,consistencyCheckLife);
    consistencyCheckLife.start();
    if (cancellationRequest.cancellationRequested()) {
      return false;
    }
    checkDataConsistency(masterClient,neoDataSource,masterUri);
  }
  finally {
    consistencyCheckLife.shutdown();
  }
  return true;
}
