{
  StoreFetcher storeFetcher=mock(StoreFetcher.class);
  LocalDatabase localDatabase=mock(LocalDatabase.class);
  AdvertisedSocketAddress coreServerAddress=new AdvertisedSocketAddress("localhost:1999");
  CoreDiscoveryService hazelcastTopology=mock(CoreDiscoveryService.class);
  HazelcastClusterTopology clusterTopology=mock(HazelcastClusterTopology.class);
  when(hazelcastTopology.currentTopology()).thenReturn(clusterTopology);
  when(clusterTopology.firstTransactionServer()).thenReturn(coreServerAddress);
  when(localDatabase.isEmpty()).thenReturn(true);
  DataSourceManager dataSourceManager=mock(DataSourceManager.class);
  TxPollingClient txPuller=mock(TxPollingClient.class);
  EdgeServerStartupProcess edgeServerStartupProcess=new EdgeServerStartupProcess(storeFetcher,localDatabase,txPuller,dataSourceManager,new AlwaysChooseFirstServer(hazelcastTopology),new ConstantTimeRetryStrategy(1,MILLISECONDS),NullLogProvider.getInstance());
  edgeServerStartupProcess.start();
  verify(localDatabase).copyStoreFrom(coreServerAddress,storeFetcher);
  verify(dataSourceManager).start();
  verify(txPuller).startPolling();
}
