{
  try (AbstractDynamicStore store=newTestableDynamicStore()){
    DynamicRecord first=createDynamicRecord(1,store);
    DynamicRecord second=createDynamicRecord(2,store);
    DynamicRecord third=createDynamicRecord(3,store);
    first.setNextBlock(second.getId());
    store.forceUpdateRecord(first);
    second.setNextBlock(third.getId());
    store.forceUpdateRecord(second);
    second.setInUse(false);
    store.forceUpdateRecord(second);
    AbstractDynamicStore.DynamicRecordCursor recordsCursor=store.getRecordsCursor(1);
    assertTrue(recordsCursor.next());
    assertEquals(first,recordsCursor.get());
    assertTrue(recordsCursor.next());
    assertEquals(second,recordsCursor.get());
    assertTrue(recordsCursor.next());
    assertEquals(third,recordsCursor.get());
    assertFalse(recordsCursor.next());
  }
 }
