{
  Availability availability=availability();
  if (availability != Availability.UNAVAILABLE) {
    return availability;
  }
  long timeout=clock.millis() + millis;
  do {
    try {
      Thread.sleep(10);
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
      break;
    }
    availability=availability();
  }
 while (availability == Availability.UNAVAILABLE && clock.millis() < timeout);
  return availability;
}
