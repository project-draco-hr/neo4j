{
  for (int i=0, max=1 << format.bitmapFormat().shift; i < max; i++) {
    LabelScanStorageStrategy.StorageService storage=storage();
    LuceneLabelScanWriter writer=new LuceneLabelScanWriter(storage,format,mock(Lock.class));
    writer.write(labelChanges(i,labels(),labels(7)));
    writer.close();
    Document document=new Document();
    format.addRangeValuesField(document,0);
    format.addLabelAndSearchFields(document,7,new Bitmap(1L << i));
    verify(storage).updateDocument(eq(format.rangeTerm(0)),match(document));
  }
}
