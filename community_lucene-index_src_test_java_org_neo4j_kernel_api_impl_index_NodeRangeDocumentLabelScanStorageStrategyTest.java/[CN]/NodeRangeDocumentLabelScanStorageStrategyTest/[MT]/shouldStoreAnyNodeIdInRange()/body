{
  for (int i=0, max=1 << format.bitmapFormat().shift; i < max; i++) {
    LabelScanStorageStrategy.StorageService storage=storage();
    LuceneLabelScanWriter writer=new LuceneLabelScanWriter(storage,format,mock(Lock.class));
    writer.write(labelChanges(i,labels(),labels(7)));
    writer.close();
    verify(storage).updateDocument(eq(format.rangeTerm(0)),match(document(format.rangeField(0),format.labelField(7,1L << i),format.labelSearchField(7))));
  }
}
