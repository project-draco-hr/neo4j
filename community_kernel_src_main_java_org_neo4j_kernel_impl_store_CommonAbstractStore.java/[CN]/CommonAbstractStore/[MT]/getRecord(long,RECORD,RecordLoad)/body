{
  long pageId=pageIdForRecord(id);
  int offset=offsetForId(id);
  try (PageCursor cursor=storeFile.io(pageId,PF_SHARED_READ_LOCK)){
    record.setId(id);
    if (cursor.next(pageId)) {
      do {
        prepareForReading(cursor,offset,record);
        recordFormat.read(record,cursor,mode,recordSize,storeFile);
      }
 while (cursor.shouldRetry());
      checkForOutOfBounds(cursor,id);
      verifyAfterReading(record,mode);
    }
 else {
      verifyAfterNotRead(record,mode);
      ;
    }
    return record;
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
