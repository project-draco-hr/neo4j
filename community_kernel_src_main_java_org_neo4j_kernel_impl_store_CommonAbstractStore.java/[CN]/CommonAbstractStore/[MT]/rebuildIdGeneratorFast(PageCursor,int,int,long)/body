{
  long nextPageId=lastPageId;
  while (nextPageId >= 0 && cursor.next(nextPageId)) {
    nextPageId--;
    do {
      int currentRecord=recordsPerPage;
      while (currentRecord-- > 0) {
        cursor.setOffset(currentRecord * blockSize);
        byte inUseByte=cursor.getByte();
        if (isInUse(inUseByte)) {
          setHighId((cursor.getCurrentPageId() * recordsPerPage) + currentRecord);
          return ((lastPageId - nextPageId) * recordsPerPage) - currentRecord;
        }
      }
    }
 while (cursor.shouldRetry());
  }
  return 0;
}
