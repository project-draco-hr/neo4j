{
  if (getNumberOfReservedLowIds() > 0) {
    try (PageCursor pageCursor=file.io(0,PF_SHARED_WRITE_LOCK)){
      if (pageCursor.next()) {
        do {
          pageCursor.setOffset(0);
          createHeaderRecord(pageCursor);
        }
 while (pageCursor.shouldRetry());
        if (pageCursor.checkAndClearBoundsFlag()) {
          throw new UnderlyingStorageException("Out of page bounds when writing header; page size too small: " + pageCache.pageSize() + " bytes.");
        }
      }
    }
   }
  recordSize=determineRecordSize();
  File idFileName=new File(storageFileName.getPath() + ".id");
  idGeneratorFactory.create(idFileName,getNumberOfReservedLowIds(),true);
}
