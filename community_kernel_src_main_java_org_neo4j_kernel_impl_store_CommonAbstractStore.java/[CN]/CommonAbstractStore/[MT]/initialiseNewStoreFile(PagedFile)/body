{
  ByteBuffer headerRecord=createHeaderRecord();
  if (headerRecord != null) {
    try (PageCursor pageCursor=file.io(0,PF_SHARED_WRITE_LOCK)){
      if (pageCursor.next()) {
        do {
          pageCursor.setOffset(0);
          pageCursor.putBytes(headerRecord.array());
        }
 while (pageCursor.shouldRetry());
      }
    }
   }
  File idFileName=new File(storageFileName.getPath() + ".id");
  idGeneratorFactory.create(idFileName,0,true);
  IdGenerator idGenerator=idGeneratorFactory.open(idFileName,1,idType,0);
  initialiseNewIdGenerator(idGenerator);
  idGenerator.close();
}
