{
  try (PageCursor cursor=storeFile.io(0,PF_SHARED_LOCK)){
    long nextPageId=storeFile.getLastPageId();
    int recordsPerPage=getRecordsPerPage();
    int recordSize=getRecordSize();
    long highestId=getNumberOfReservedLowIds();
    while (nextPageId >= 0 && cursor.next(nextPageId)) {
      nextPageId--;
      boolean found;
      do {
        found=false;
        int currentRecord=recordsPerPage;
        while (currentRecord-- > 0) {
          cursor.setOffset(currentRecord * recordSize);
          long recordId=(cursor.getCurrentPageId() * recordsPerPage) + currentRecord;
          if (isRecordInUse(cursor)) {
            found=true;
            highestId=recordId + 1;
            ;
            break;
          }
        }
      }
 while (cursor.shouldRetry());
      if (found) {
        return highestId;
      }
    }
    return getNumberOfReservedLowIds();
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException("Unable to find high id by scanning backwards " + getStorageFileName(),e);
  }
}
