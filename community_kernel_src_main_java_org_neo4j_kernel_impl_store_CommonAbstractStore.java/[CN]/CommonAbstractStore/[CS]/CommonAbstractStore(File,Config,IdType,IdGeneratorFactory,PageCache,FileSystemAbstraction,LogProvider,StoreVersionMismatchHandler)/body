{
  this.storageFileName=fileName;
  this.configuration=configuration;
  this.idGeneratorFactory=idGeneratorFactory;
  this.pageCache=pageCache;
  this.fileSystemAbstraction=fileSystemAbstraction;
  this.idType=idType;
  this.logProvider=logProvider;
  this.log=logProvider.getLog(getClass());
  this.versionMismatchHandler=versionMismatchHandler;
  try {
    checkStorage();
    checkVersion();
    loadStorage();
  }
 catch (  Exception e) {
    releaseFileLockAndCloseFileChannel();
    throw launderedException(e);
  }
}
