{
  this.storageFileName=fileName;
  this.configuration=configuration;
  this.idGeneratorFactory=idGeneratorFactory;
  this.pageCache=pageCache;
  this.fileSystemAbstraction=fileSystemAbstraction;
  this.idType=idType;
  this.log=logProvider.getLog(getClass());
  this.versionMismatchHandler=versionMismatchHandler;
  try {
    checkStorage();
    checkVersion();
    loadStorage();
  }
 catch (  Exception e) {
    if (storeFile != null) {
      try {
        storeFile.close();
      }
 catch (      IOException failureToClose) {
        e.addSuppressed(failureToClose);
      }
    }
    closeFileChannel();
    throw launderedException(e);
  }
}
