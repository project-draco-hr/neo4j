{
  TypeBase base=bases.get(signature.charAt(0));
  if (base == null) {
    throw illegal(signature);
  }
  if (!base.validIn.contains(context)) {
    throw illegal(signature,context);
  }
  SignatureType type=base.parse(signature,0);
  if (type.length() != signature.length()) {
    throw illegal(signature);
  }
  return type;
}
