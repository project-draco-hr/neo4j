{
  BatchInserter inserter=new BatchInserterImpl(PATH);
  BatchInserterIndexProvider provider=new LuceneBatchInserterIndexProvider(inserter);
  BatchInserterIndex index=provider.nodeIndex("yeah",LuceneIndexImplementation.EXACT_CONFIG);
  index.setCacheCapacity("key",1000000);
  long t=System.currentTimeMillis();
  for (int i=0; i < 1000000; i++) {
    Map<String,Object> properties=MapUtil.map("key","value" + i);
    long id=inserter.createNode(properties);
    index.add(id,properties);
  }
  System.out.println("insert:" + (System.currentTimeMillis() - t));
  index.flush();
  t=System.currentTimeMillis();
  for (int i=0; i < 1000000; i++) {
    IteratorUtil.count((Iterator<Long>)index.get("key","value" + i));
  }
  System.out.println("get:" + (System.currentTimeMillis() - t));
}
