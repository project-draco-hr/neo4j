{
  if (in.readableBytes() < 5) {
    return;
  }
  if (detectSsl(in)) {
    enableSsl(ctx);
  }
 else   if (isHttp(in)) {
    switchToWebsocket(ctx);
  }
 else   if (isBoltPreamble(in)) {
    switchToSocket(ctx);
  }
 else {
    in.clear();
    ctx.close();
  }
}
