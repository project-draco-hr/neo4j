{
  Node resource=createNode();
  try (Transaction outerTx=db.beginTx();Transaction nestedTx=db.beginTx()){
    assertNotSame(outerTx,nestedTx);
    try (OtherThreadExecutor<Void> otherThread=new OtherThreadExecutor<>("other thread",null)){
      Lock lock=nestedTx.acquireWriteLock(resource);
      Future<Lock> future=tryToAcquireSameLockOnAnotherThread(resource,otherThread);
      acquireOnOtherThreadTimesOut(future);
      lock.release();
      assertNotNull(future.get());
    }
   }
 }
