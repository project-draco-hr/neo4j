{
  OnlineIndexSamplingJobFactory jobFactory=new OnlineIndexSamplingJobFactory(storeView,tokenNameLookup,logging);
  Predicate<IndexDescriptor> samplingUpdatePredicate=createSamplingPredicate();
  IndexSamplingJobQueue jobQueue=new IndexSamplingJobQueue(samplingUpdatePredicate);
  IndexSamplingJobTracker jobTracker=new IndexSamplingJobTracker(config,scheduler);
  Predicate<IndexDescriptor> indexRecoveryCondition=createIndexDescriptorPredicate();
  return new IndexSamplingController(config,jobFactory,jobQueue,jobTracker,snapshotProvider,scheduler,indexRecoveryCondition);
}
