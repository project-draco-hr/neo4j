{
  Iterator<NodePropertyConstraint> allConstraints=schemaReadOperations.constraintsGetForLabel(state,labelId);
  Iterator<NodePropertyConstraint> constraints=uniquePropertyConstraints(allConstraints);
  while (constraints.hasNext()) {
    PropertyConstraint constraint=constraints.next();
    int propertyKeyId=constraint.propertyKey();
    Object value=entityReadOperations.nodeGetProperty(state,nodeId,propertyKeyId);
    if (value != null) {
      DefinedProperty property=Property.property(propertyKeyId,value);
      validateNoExistingNodeWithLabelAndProperty(state,labelId,property,nodeId);
    }
  }
  return entityWriteOperations.nodeAddLabel(state,nodeId,labelId);
}
