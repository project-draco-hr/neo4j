{
  assertIndexOnline(state,index);
  int labelId=index.getLabelId();
  int propertyKeyId=index.getPropertyKeyId();
  String stringVal="";
  if (null != value) {
    DefinedProperty property=Property.property(propertyKeyId,value);
    stringVal=property.valueAsString();
  }
  LockHolder holder=state.locks();
  try (ReleasableLock r=holder.getReleasableIndexEntryReadLock(labelId,propertyKeyId,stringVal)){
    long nodeId=entityReadOperations.nodeGetUniqueFromIndexLookup(state,index,value);
    if (NO_SUCH_NODE == nodeId) {
      r.release();
      try (ReleasableLock w=holder.getReleasableIndexEntryWriteLock(labelId,propertyKeyId,stringVal)){
        nodeId=entityReadOperations.nodeGetUniqueFromIndexLookup(state,index,value);
        if (NO_SUCH_NODE != nodeId) {
          holder.getReleasableIndexEntryReadLock(labelId,propertyKeyId,stringVal).registerWithTransaction();
          w.release();
        }
      }
     }
    return nodeId;
  }
 }
