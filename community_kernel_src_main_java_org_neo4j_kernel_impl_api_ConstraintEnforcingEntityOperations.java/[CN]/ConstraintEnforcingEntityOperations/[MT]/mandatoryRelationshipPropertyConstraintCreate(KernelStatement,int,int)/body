{
  PrimitiveLongIterator relationships=relationshipsGetAll(state);
  while (relationships.hasNext()) {
    long relationship=relationships.next();
    try {
      if (relationshipGetType(state,state.getStoreStatement(),relationship) == relTypeId && !relationshipHasProperty(state,relationship,propertyKeyId)) {
        MandatoryRelationshipPropertyConstraint constraint=new MandatoryRelationshipPropertyConstraint(relTypeId,propertyKeyId);
        throw new CreateConstraintFailureException(constraint,new MandatoryRelationshipPropertyConstraintVerificationFailedKernelException(constraint,relationship));
      }
    }
 catch (    EntityNotFoundException e) {
      PropertyConstraint constraint=new MandatoryRelationshipPropertyConstraint(relTypeId,propertyKeyId);
      throw new CreateConstraintFailureException(constraint,e);
    }
  }
  return schemaWriteOperations.mandatoryRelationshipPropertyConstraintCreate(state,relTypeId,propertyKeyId);
}
