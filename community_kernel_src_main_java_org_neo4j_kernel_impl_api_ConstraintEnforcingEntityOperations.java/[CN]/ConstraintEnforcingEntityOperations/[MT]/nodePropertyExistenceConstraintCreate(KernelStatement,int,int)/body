{
  PrimitiveLongIterator nodes=nodesGetForLabel(state,labelId);
  while (nodes.hasNext()) {
    long nodeId=nodes.next();
    try (Cursor<NodeItem> node=nodeCursor(state,nodeId)){
      if (node.next()) {
        if (!node.get().hasProperty(propertyKeyId)) {
          NodePropertyExistenceConstraint constraint=new NodePropertyExistenceConstraint(labelId,propertyKeyId);
          throw new CreateConstraintFailureException(constraint,new NodePropertyExistenceConstraintVerificationFailedKernelException(constraint,nodeId));
        }
      }
    }
   }
  return schemaWriteOperations.nodePropertyExistenceConstraintCreate(state,labelId,propertyKeyId);
}
