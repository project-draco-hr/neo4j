{
  try {
    Directory indexDirectory=getIndexDirectory(identifier);
    IndexType type=getType(identifier);
    IndexWriterConfig writerConfig=new IndexWriterConfig(type.analyzer);
    writerConfig.setIndexDeletionPolicy(new MultipleBackupDeletionPolicy());
    Similarity similarity=type.getSimilarity();
    if (similarity != null) {
      writerConfig.setSimilarity(similarity);
    }
    return new IndexWriter(indexDirectory,writerConfig);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
