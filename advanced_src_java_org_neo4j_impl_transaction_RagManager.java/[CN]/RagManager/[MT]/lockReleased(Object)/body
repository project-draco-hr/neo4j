{
  List<Thread> lockingThreadList=resourceMap.get(resource);
  if (lockingThreadList == null) {
    throw new RuntimeException("Resource not found in resource map");
  }
  Thread currentThread=Thread.currentThread();
  if (!lockingThreadList.remove(currentThread)) {
    throw new RuntimeException("Thread not found in locking thread list");
  }
  if (lockingThreadList.size() == 0) {
    resourceMap.remove(resource);
  }
}
