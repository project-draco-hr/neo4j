{
  TaskExecutor<Void> executor=new DynamicTaskExecutor<>(2,0,10,new ParkStrategy.Park(1),getClass().getSimpleName());
  IOException exception=new IOException("Test message");
  ControlledTask firstBlockingTask=new ControlledTask();
  ControlledTask secondBlockingTask=new ControlledTask();
  executor.submit(firstBlockingTask);
  executor.submit(secondBlockingTask);
  firstBlockingTask.latch.awaitStart();
  secondBlockingTask.latch.awaitStart();
  FailingTask failingTask=new FailingTask(exception);
  executor.submit(failingTask);
  ControlledTask thirdBlockingTask=new ControlledTask();
  executor.submit(thirdBlockingTask);
  firstBlockingTask.latch.finish();
  failingTask.latch.await();
  failingTask.latch.release();
  assertExceptionOnSubmit(executor,exception);
  executor.shutdown(false);
}
