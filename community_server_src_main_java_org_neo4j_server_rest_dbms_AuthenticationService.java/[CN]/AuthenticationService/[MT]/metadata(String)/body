{
  if (!authEnabled) {
    return output.ok();
  }
  if (authHeader == null) {
    return output.unauthorized(new ExceptionRepresentation(new Neo4jError(AuthorizationFailed,"No authorization token supplied.")),"None");
  }
  String token=AuthenticateHeaders.extractToken(authHeader);
  if (token.length() == 0) {
    return output.response(Response.Status.BAD_REQUEST,new ExceptionRepresentation(new Neo4jError(Status.Request.InvalidFormat,"Invalid Authorization header.")));
  }
  User user=security.userForToken(token);
  if (user.privileges().APIAccess()) {
    return output.ok(new AuthorizationRepresentation(user));
  }
  return output.unauthorized(new ExceptionRepresentation(new Neo4jError(AuthorizationFailed,"Invalid authorization token supplied.")),"None");
}
