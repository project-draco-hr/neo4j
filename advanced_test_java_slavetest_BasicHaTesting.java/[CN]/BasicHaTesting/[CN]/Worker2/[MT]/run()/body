{
  Transaction tx=db.beginTx();
  try {
    db.getNodeById(node2).setProperty("2","T2 2");
    barrier1.countDown();
    try {
      barrier2.await();
    }
 catch (    InterruptedException e1) {
      Thread.interrupted();
      e1.printStackTrace();
    }
    db.getNodeById(node1).setProperty("1","T2 2");
    System.out.println("YAY worker2 won");
    tx.success();
    successfull=true;
  }
 catch (  DeadlockDetectedException e) {
    System.out.println("YAY worker2 deadlock");
    deadlocked=true;
  }
catch (  Throwable t) {
    t.printStackTrace();
  }
 finally {
    tx.finish();
  }
}
