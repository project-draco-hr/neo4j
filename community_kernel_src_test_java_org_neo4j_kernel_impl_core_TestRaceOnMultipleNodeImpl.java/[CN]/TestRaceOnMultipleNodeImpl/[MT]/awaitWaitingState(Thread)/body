{
  for (; ; ) switch (thread.getState()) {
case WAITING:
case TIMED_WAITING:
    return;
case TERMINATED:
  throw new IllegalStateException("thread terminated");
default :
try {
  Thread.sleep(1);
}
 catch (InterruptedException e) {
  Thread.interrupted();
}
}
}
