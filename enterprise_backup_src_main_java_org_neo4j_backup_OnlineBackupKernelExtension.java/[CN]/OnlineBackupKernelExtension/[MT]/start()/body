{
  if (config.<Boolean>get(OnlineBackupSettings.online_backup_enabled)) {
    TheBackupInterface backup=new BackupImpl(logging.getMessagesLog(BackupImpl.class),new BackupImpl.SPI(){
      @Override public String getStoreDir(){
        return graphDatabaseAPI.getStoreDir();
      }
      @Override public StoreId getStoreId(){
        return graphDatabaseAPI.getStoreId();
      }
    }
,xaDataSourceManager,kpeg,monitors);
    try {
      server=new BackupServer(backup,config.get(OnlineBackupSettings.online_backup_server),logging,monitors);
      server.init();
      server.start();
      try {
        graphDatabaseAPI.getDependencyResolver().resolveDependency(ClusterMemberEvents.class).addClusterMemberListener(new StartBindingListener());
        graphDatabaseAPI.getDependencyResolver().resolveDependency(BindingNotifier.class).addBindingListener(new BindingListener(){
          @Override public void listeningAt(          URI myUri){
            me=myUri;
          }
        }
);
      }
 catch (      NoClassDefFoundError e) {
      }
catch (      IllegalArgumentException e) {
      }
    }
 catch (    Throwable t) {
      throw new RuntimeException(t);
    }
  }
}
