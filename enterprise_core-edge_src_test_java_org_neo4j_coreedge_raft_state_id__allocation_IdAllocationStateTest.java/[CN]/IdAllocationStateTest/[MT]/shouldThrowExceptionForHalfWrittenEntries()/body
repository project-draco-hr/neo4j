{
  final IdAllocationState state=new IdAllocationState();
  for (int i=1; i <= 3; i++) {
    state.firstUnallocated(IdType.NODE,1024 * i);
    state.logIndex(i);
  }
  final IdAllocationState.Marshal marshal=new IdAllocationState.Marshal();
  InMemoryVersionableReadableClosablePositionAwareChannel channel=new InMemoryVersionableReadableClosablePositionAwareChannel();
  marshal.marshal(state,channel);
  channel.putInt(1).putInt(2).putInt(3).putLong(4L);
  marshal.unmarshal(channel);
  try {
    marshal.unmarshal(channel);
    fail();
  }
 catch (  EndOfStreamException e) {
  }
}
