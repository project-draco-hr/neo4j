{
  long[][] countsForPage;
  do {
    countsForPage=new long[recordsPerPage][countersPerRecord];
    for (int recordNumber=0; recordNumber < recordsPerPage; recordNumber++) {
      cursor.setOffset(recordNumber * (countersPerRecord + 1) * SizeOfCounter);
      for (int counterNumber=0; counterNumber < countersPerRecord; counterNumber++) {
        countsForPage[recordNumber][counterNumber]=cursor.getLong();
      }
    }
  }
 while (cursor.shouldRetry());
  for (int recordNumber=0; recordNumber < recordsPerPage; recordNumber++) {
    for (int counterNumber=0; counterNumber < countersPerRecord; counterNumber++) {
      assertThat(countsForPage[recordNumber][counterNumber],is(getExpectedCount(pageNumber,recordNumber,counterNumber)));
    }
  }
}
