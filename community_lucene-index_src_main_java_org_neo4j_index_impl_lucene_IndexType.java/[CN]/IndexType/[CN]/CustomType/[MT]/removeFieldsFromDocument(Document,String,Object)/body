{
  String exactKey=exactKey(key);
  Set<String> values=null;
  if (value != null) {
    String stringValue=value.toString();
    values=new HashSet<>(Arrays.asList(document.getValues(exactKey)));
    if (!values.remove(stringValue)) {
      return;
    }
  }
  document.removeFields(exactKey);
  document.removeFields(key);
  if (value != null) {
    for (    String existingValue : values) {
      addToDocument(document,key,existingValue);
    }
  }
  restoreNumericFields(document);
}
