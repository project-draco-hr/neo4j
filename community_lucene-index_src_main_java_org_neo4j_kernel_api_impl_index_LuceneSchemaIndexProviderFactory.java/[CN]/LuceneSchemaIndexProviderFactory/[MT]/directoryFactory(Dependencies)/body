{
  if (dependencies.getFileSystemAbstraction() instanceof EphemeralFileSystemAbstraction) {
    return DirectoryFactory.IN_MEMORY;
  }
 else   if (dependencies.getFileSystemAbstraction() instanceof DefaultFileSystemAbstraction) {
    return DirectoryFactory.PERSISTENT;
  }
  throw new IllegalArgumentException("Unsupported file system " + dependencies.getFileSystemAbstraction());
}
