{
  long txId=TransactionIdStore.BASE_TX_ID;
  while (batch != null) {
    txId=transactionIdStore.nextCommittingTransactionId();
    batch.commitment(new FakeCommitment(txId,transactionIdStore),txId);
    batch.commitment().publishAsCommitted();
    batch=batch.next();
  }
  return txId;
}
