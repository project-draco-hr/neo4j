{
  File toOpen=logFiles.getLogFileForVersion(forVersion);
  PhysicalLogVersionedStoreChannel channel=openFileChannel(toOpen,"rw");
  long[] header=readLogHeader(headerBuffer,channel,false);
  if (header == null) {
    long lastTxId=transactionIdStore.getLastCommittedTransactionId();
    writeLogHeader(headerBuffer,forVersion,lastTxId);
    transactionMetadataCache.putHeader(forVersion,lastTxId);
    channel.writeAll(headerBuffer);
    channel.setVersion(forVersion);
    monitor.opened(toOpen,forVersion,lastTxId,true);
  }
  return channel;
}
