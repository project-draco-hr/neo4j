{
  long lastLogVersionUsed=logVersionRepository.getCurrentLogVersion();
  PhysicalLogVersionedStoreChannel channel=openLogChannelForVersion(lastLogVersionUsed);
  doRecoveryOn(channel,recoveredDataVisitor);
  writer=new PhysicalWritableLogChannel(channel,new LogVersionBridge(){
    @Override public VersionedStoreChannel next(    VersionedStoreChannel channel) throws IOException {
      if (channel.position() >= rotateAtSize) {
        return rotate(channel);
      }
      return channel;
    }
  }
);
}
