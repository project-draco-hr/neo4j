{
  if (!fileSystem.fileExists(logFileName)) {
    throw new IOException("Logical log[" + logFileName + "] not found");
  }
  StoreChannel channel=fileSystem.open(logFileName,"rw");
  long[] header=VersionAwareLogEntryReader.readLogHeader(ByteBuffer.allocate(16),channel,false);
  try {
    FileUtils.truncateFile(channel,endPosition);
  }
 catch (  IOException e) {
    monitor.failureToTruncate(logFileName,e);
  }
  channel.close();
  File newName;
  newName=logFiles.getHistoryFileName(header[0]);
  if (!fileSystem.renameFile(logFileName,newName)) {
    throw new IOException("Failed to rename log to: " + newName);
  }
}
