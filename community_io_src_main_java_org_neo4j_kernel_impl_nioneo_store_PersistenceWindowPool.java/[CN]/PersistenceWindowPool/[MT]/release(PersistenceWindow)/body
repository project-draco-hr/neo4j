{
  try {
    if (window instanceof PersistenceRow) {
      PersistenceRow dpw=(PersistenceRow)window;
      try {
        if (brickSize > 0 && dpw.isDirty()) {
          applyChangesToWindowIfNecessary(dpw);
        }
        if (dpw.writeOutAndCloseIfFree(readOnly)) {
          activeRowWindows.remove(dpw.position(),dpw);
        }
 else {
          dpw.reset();
        }
      }
  finally {
        if (brickSize > 0) {
          int brickIndex=positionToBrickIndex(dpw.position());
          BrickElement theBrick=brickArray[brickIndex];
          theBrick.unLock();
        }
      }
    }
  }
  finally {
    ((LockableWindow)window).unLock();
  }
}
