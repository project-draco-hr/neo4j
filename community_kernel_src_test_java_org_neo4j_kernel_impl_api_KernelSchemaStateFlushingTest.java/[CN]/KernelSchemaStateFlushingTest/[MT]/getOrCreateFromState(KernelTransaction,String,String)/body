{
  StatementOperationParts ctx=tx.newStatementOperations();
  StatementState state=ctxProvider.statementForReading();
  try {
    return ctx.schemaStateOperations().schemaStateGetOrCreate(state,key,new Function<String,String>(){
      @Override public String apply(      String from){
        return value;
      }
    }
);
  }
  finally {
    ctx.lifecycleOperations().close(state);
  }
}
