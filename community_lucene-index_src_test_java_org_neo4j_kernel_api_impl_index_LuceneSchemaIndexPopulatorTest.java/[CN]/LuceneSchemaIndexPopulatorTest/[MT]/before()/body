{
  directory=new RAMDirectory();
  DirectoryFactory directoryFactory=new DirectoryFactory.Single(new DirectoryFactory.UncloseableDirectory(directory));
  Config config=new Config(stringMap(store_dir.name(),"target/whatever"));
  provider=new LuceneSchemaIndexProvider(directoryFactory,config);
  indexDescriptor=new IndexDescriptor(42,propertyKeyId);
  indexStoreView=mock(IndexStoreView.class);
  IndexConfiguration indexConfig=new IndexConfiguration(false);
  IndexSamplingConfig samplingConfig=new IndexSamplingConfig(config);
  index=provider.getPopulator(indexId,indexDescriptor,indexConfig,samplingConfig);
  index.create();
}
