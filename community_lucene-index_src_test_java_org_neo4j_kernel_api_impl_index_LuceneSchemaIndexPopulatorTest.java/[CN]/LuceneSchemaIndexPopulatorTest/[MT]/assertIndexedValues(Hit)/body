{
  switchToVerification();
  for (  Hit hit : expectedHits) {
    TopDocs hits=searcher.search(documentLogic.newQuery(hit.value),10);
    assertEquals("Unexpected number of index results from " + hit.value,hit.nodeIds.length,hits.totalHits);
    Set<Long> foundNodeIds=new HashSet<Long>();
    for (int i=0; i < hits.totalHits; i++) {
      Document document=searcher.doc(hits.scoreDocs[i].doc);
      foundNodeIds.add(parseLong(document.get("_id_")));
    }
    assertEquals(asSet(hit.nodeIds),foundNodeIds);
  }
}
