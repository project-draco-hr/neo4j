{
  when(config.get(SecuritySettings.ldap_authorization_group_to_role_mapping)).thenReturn("group1=role1;group2=role2,role3;group3=role4");
  LdapRealm realm=new LdapRealm(config,securityLog);
  assertThat(realm.getGroupToRoleMapping().keySet(),equalTo(new TreeSet<>(asList("group1","group2","group3"))));
  assertThat(realm.getGroupToRoleMapping().get("group1"),equalTo(singletonList("role1")));
  assertThat(realm.getGroupToRoleMapping().get("group2"),equalTo(asList("role2","role3")));
  assertThat(realm.getGroupToRoleMapping().get("group3"),equalTo(singletonList("role4")));
  assertThat(realm.getGroupToRoleMapping().size(),equalTo(3));
}
