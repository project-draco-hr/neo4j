{
  when(config.get(SecuritySettings.ldap_authorization_user_search_filter)).thenReturn("");
  LogProvider logProvider=mock(LogProvider.class);
  Log log=mock(Log.class);
  LdapContext ldapContext=mock(LdapContext.class);
  NamingEnumeration result=mock(NamingEnumeration.class);
  when(logProvider.getLog(LdapRealm.class)).thenReturn(log);
  when(ldapContext.search(anyString(),anyString(),anyObject(),anyObject())).thenReturn(result);
  when(result.hasMoreElements()).thenReturn(false);
  LdapRealm realm=new LdapRealm(config,logProvider);
  realm.findRoleNamesForUser("username",ldapContext);
  verify(log).warn(contains("LDAP user search filter does not contain the argument placeholder {0}"));
}
