{
  when(config.get(SecuritySettings.ldap_authorization_group_to_role_mapping)).thenReturn("'group1' = role1;\t \"group2\"\n=\t role2,role3 ;  gr oup3= role4\n ;'group4 '= ; g =r");
  LdapRealm realm=new LdapRealm(config,securityLog);
  assertThat(realm.getGroupToRoleMapping().keySet(),equalTo(new TreeSet<>(asList("group1","group2","gr oup3","group4 ","g"))));
  assertThat(realm.getGroupToRoleMapping().get("group1"),equalTo(singletonList("role1")));
  assertThat(realm.getGroupToRoleMapping().get("group2"),equalTo(asList("role2","role3")));
  assertThat(realm.getGroupToRoleMapping().get("gr oup3"),equalTo(singletonList("role4")));
  assertThat(realm.getGroupToRoleMapping().get("group4 "),equalTo(Collections.emptyList()));
  assertThat(realm.getGroupToRoleMapping().get("g"),equalTo(singletonList("r")));
  assertThat(realm.getGroupToRoleMapping().size(),equalTo(5));
}
