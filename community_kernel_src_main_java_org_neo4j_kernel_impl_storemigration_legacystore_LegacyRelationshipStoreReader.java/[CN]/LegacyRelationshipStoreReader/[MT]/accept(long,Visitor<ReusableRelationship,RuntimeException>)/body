{
  ByteBuffer buffer=ByteBuffer.allocateDirect(4 * 1024 * RECORD_SIZE);
  ReusableRelationship rel=new ReusableRelationship();
  long position=(approximateStartId * RECORD_SIZE) - ((approximateStartId * RECORD_SIZE) % buffer.capacity()), fileSize=fileChannel.size();
  while (position < fileSize) {
    int recordOffset=0;
    buffer.clear();
    fileChannel.read(buffer,position);
    while (recordOffset < buffer.capacity() && (recordOffset + position) < fileSize) {
      buffer.position(recordOffset);
      long id=(position + recordOffset) / RECORD_SIZE;
      readRecord(buffer,id,rel);
      if (visitor.visit(rel)) {
        return;
      }
      recordOffset+=RECORD_SIZE;
    }
    position+=buffer.capacity();
  }
}
