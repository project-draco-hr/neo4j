{
  Iterable<IndexDescriptor> committedRules;
  try {
    committedRules=option(storeLayer.indexesGetForLabelAndPropertyKey(labelId,propertyKey));
  }
 catch (  SchemaRuleNotFoundException e) {
    committedRules=emptyList();
  }
  DiffSets<IndexDescriptor> ruleDiffSet=state.txState().indexDiffSetsByLabel(labelId);
  boolean hasTxStateWithChanges=state.hasTxStateWithChanges();
  Iterator<IndexDescriptor> rules=hasTxStateWithChanges ? filterByPropertyKeyId(ruleDiffSet.apply(committedRules.iterator()),propertyKey) : committedRules.iterator();
  return singleOrNull(rules);
}
