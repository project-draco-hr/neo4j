{
  UniquenessConstraint constraint=new UniquenessConstraint(labelId,propertyKeyId);
  try {
    verifyNoDataChanges(state,labelId,propertyKeyId);
    if (!state.txState().constraintDoUnRemove(constraint)) {
      for (Iterator<UniquenessConstraint> it=schemaReadDelegate.constraintsGetForLabelAndPropertyKey(state,labelId,propertyKeyId); it.hasNext(); ) {
        if (it.next().equals(labelId,propertyKeyId)) {
          return constraint;
        }
      }
      long indexId=constraintIndexCreator.createUniquenessConstraintIndex(state,this,labelId,propertyKeyId);
      state.txState().constraintDoAdd(constraint,indexId);
    }
    return constraint;
  }
 catch (  TransactionalException|ConstraintVerificationFailedKernelException|SchemaAndDataModificationInSameTransactionException|DropIndexFailureException e) {
    throw new CreateConstraintFailureException(constraint,e);
  }
}
