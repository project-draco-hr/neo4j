{
  Property existingProperty=relationshipGetProperty(state,relationshipId,property.propertyKeyId());
  if (!existingProperty.isDefined()) {
    legacyPropertyTrackers.relationshipAddStoreProperty(relationshipId,property);
    state.neoStoreTransaction.relAddProperty(relationshipId,property.propertyKeyId(),property.value());
  }
 else {
    legacyPropertyTrackers.relationshipChangeStoreProperty(relationshipId,(DefinedProperty)existingProperty,property);
    state.neoStoreTransaction.relChangeProperty(relationshipId,property.propertyKeyId(),property.value());
  }
  state.txState().relationshipDoReplaceProperty(relationshipId,existingProperty,property);
  return existingProperty;
}
