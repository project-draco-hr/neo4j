{
  if (state.hasTxStateWithChanges()) {
    if (state.txState().relationshipIsAddedInThisTx(relationshipId)) {
      return state.txState().relationshipPropertyDiffSets(relationshipId).getAdded().iterator();
    }
    if (state.txState().relationshipIsDeletedInThisTx(relationshipId)) {
      throw new IllegalStateException("Relationship " + relationshipId + " has been deleted");
    }
    return state.txState().relationshipPropertyDiffSets(relationshipId).apply(entityReadDelegate.relationshipGetAllProperties(state,relationshipId));
  }
 else {
    return entityReadDelegate.relationshipGetAllProperties(state,relationshipId);
  }
}
