{
  if (state.txState().nodeIsDeletedInThisTx(nodeId)) {
    return IteratorUtil.emptyPrimitiveLongIterator();
  }
  if (state.txState().nodeIsAddedInThisTx(nodeId)) {
    return toPrimitiveLongIterator(state.txState().nodeStateLabelDiffSets(nodeId).getAdded().iterator());
  }
  PrimitiveLongIterator committed=entityReadDelegate.nodeGetLabels(state,nodeId);
  return state.txState().nodeStateLabelDiffSets(nodeId).applyPrimitiveLongIterator(committed);
}
