{
  legacyPropertyTrackers.relationshipDelete(relationshipId);
  final TxState txState=state.txState();
  if (txState.relationshipIsAddedInThisTx(relationshipId)) {
    txState.relationshipVisit(relationshipId,new RelationshipVisitor<RuntimeException>(){
      @Override public void visit(      long relId,      long startNode,      long endNode,      int type){
        state.recordState().relDelete(relId);
      }
    }
);
    txState.relationshipDoDeleteAddedInThisTx(relationshipId);
  }
 else {
    try {
      storeLayer.relationshipVisit(relationshipId,new RelationshipVisitor<RuntimeException>(){
        @Override public void visit(        long relId,        long startNode,        long endNode,        int type){
          state.recordState().relDelete(relId);
          txState.relationshipDoDelete(relId,startNode,endNode,type);
        }
      }
);
    }
 catch (    EntityNotFoundException e) {
      return;
    }
  }
}
