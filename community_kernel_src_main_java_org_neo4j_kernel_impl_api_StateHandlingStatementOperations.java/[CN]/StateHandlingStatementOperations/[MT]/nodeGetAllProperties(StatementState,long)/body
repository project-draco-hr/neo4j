{
  if (state.txState().nodeIsAddedInThisTx(nodeId)) {
    return state.txState().getNodePropertyDiffSets(nodeId).getAdded().iterator();
  }
  if (state.txState().nodeIsDeletedInThisTx(nodeId)) {
    throw new IllegalStateException("Node " + nodeId + " has been deleted");
  }
  return state.txState().getNodePropertyDiffSets(nodeId).apply(entityReadDelegate.nodeGetAllProperties(state,nodeId));
}
