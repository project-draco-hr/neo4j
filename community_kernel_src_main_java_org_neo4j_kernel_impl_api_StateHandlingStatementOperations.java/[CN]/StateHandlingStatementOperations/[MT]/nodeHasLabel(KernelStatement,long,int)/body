{
  if (state.hasTxStateWithChanges()) {
    if (state.txState().nodeIsDeletedInThisTx(nodeId)) {
      return false;
    }
switch (state.txState().labelState(nodeId,labelId)) {
case ADDED:
      return true;
case REMOVED:
    return false;
default :
  if (state.txState().nodeIsAddedInThisTx(nodeId)) {
    return false;
  }
}
}
return storeLayer.nodeHasLabel(nodeId,labelId);
}
