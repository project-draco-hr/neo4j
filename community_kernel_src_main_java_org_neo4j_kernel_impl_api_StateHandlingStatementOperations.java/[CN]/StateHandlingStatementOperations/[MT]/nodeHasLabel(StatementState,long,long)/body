{
  if (state.hasTxStateWithChanges()) {
    if (state.txState().nodeIsDeletedInThisTx(nodeId)) {
      return false;
    }
    if (state.txState().nodeIsAddedInThisTx(nodeId)) {
      TxState.UpdateTriState labelState=state.txState().labelState(nodeId,labelId);
      return labelState.isTouched() && labelState.isAdded();
    }
    TxState.UpdateTriState labelState=state.txState().labelState(nodeId,labelId);
    if (labelState.isTouched()) {
      return labelState.isAdded();
    }
  }
  return entityReadDelegate.nodeHasLabel(state,nodeId,labelId);
}
