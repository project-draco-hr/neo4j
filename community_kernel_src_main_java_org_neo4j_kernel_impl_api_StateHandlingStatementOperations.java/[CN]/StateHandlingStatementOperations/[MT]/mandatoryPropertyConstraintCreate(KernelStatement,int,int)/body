{
  MandatoryPropertyConstraint constraint=new MandatoryPropertyConstraint(labelId,propertyKeyId);
  PrimitiveLongIterator nodes=nodesGetForLabel(state,labelId);
  while (nodes.hasNext()) {
    try {
      if (!nodeGetProperty(state,nodes.next(),propertyKeyId).isDefined()) {
        throw new CreateConstraintFailureException(constraint,new ConstraintVerificationFailedKernelException(constraint));
      }
    }
 catch (    EntityNotFoundException e) {
      throw new CreateConstraintFailureException(constraint,e);
    }
  }
  state.txState().constraintDoAdd(constraint);
  return constraint;
}
