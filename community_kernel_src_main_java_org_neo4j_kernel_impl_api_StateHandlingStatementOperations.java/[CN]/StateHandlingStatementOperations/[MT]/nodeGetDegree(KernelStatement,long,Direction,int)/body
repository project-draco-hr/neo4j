{
  if (state.hasTxStateWithChanges()) {
    int degree=0;
    if (state.txState().nodeIsDeletedInThisTx(nodeId)) {
      return 0;
    }
    if (!state.txState().nodeIsAddedInThisTx(nodeId)) {
      degree=storeLayer.nodeGetDegree(state.getStoreStatement(),nodeId,direction,relType);
    }
    return state.txState().augmentNodeDegree(nodeId,degree,direction,relType);
  }
  return storeLayer.nodeGetDegree(state.getStoreStatement(),nodeId,direction,relType);
}
