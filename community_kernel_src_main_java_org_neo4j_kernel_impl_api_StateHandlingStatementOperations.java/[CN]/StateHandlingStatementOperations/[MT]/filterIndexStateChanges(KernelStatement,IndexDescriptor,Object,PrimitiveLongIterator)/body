{
  if (state.hasTxStateWithChanges()) {
    DiffSets<Long> labelPropertyChanges=nodesWithLabelAndPropertyDiffSet(state,index,value);
    DiffSets<Long> deletionChanges=state.txState().nodesDeletedInTx();
    return deletionChanges.applyPrimitiveLongIterator(labelPropertyChanges.applyPrimitiveLongIterator(nodeIds));
  }
  return nodeIds;
}
