{
  this.graphDb=new EmbeddedGraphDatabase(path,params);
  this.xaDs=(NeoStoreXaDataSource)graphDb.getConfig().getTxModule().getXaDataSourceManager().getXaDataSource("nioneodb");
  this.xaDs.makeBackupSlave();
  recover();
  jobEater=new JobEater();
  logApplier=new LogApplier(xaDs);
  jobEater.start();
  logApplier.start();
  this.masterIp=masterIp;
  this.masterPort=masterPort;
  masterConnection=new Connection(masterIp,masterPort);
  while (!masterConnection.connected()) {
    if (masterConnection.connectionRefused()) {
      throw new SocketException("Connection to master[" + masterIp + ":"+ masterPort+ "] refused");
    }
  }
  jobEater.addJob(new ConnectToMasterJob(masterConnection,this));
}
