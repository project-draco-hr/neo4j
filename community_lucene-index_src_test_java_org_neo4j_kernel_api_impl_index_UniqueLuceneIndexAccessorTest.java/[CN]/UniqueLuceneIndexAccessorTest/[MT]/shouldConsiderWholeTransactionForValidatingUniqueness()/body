{
  UniqueLuceneIndexAccessor accessor=createAccessor();
  accessor.updateAndCommit(asList(add(1l,"value1")));
  accessor.updateAndCommit(asList(add(2l,"value2")));
  accessor.updateAndCommit(asList(change(1l,"value1","value2"),change(2l,"value2","value1")));
  accessor.close();
  assertEquals(asList(2l),getAllNodes("value1"));
  assertEquals(asList(1l),getAllNodes("value2"));
}
