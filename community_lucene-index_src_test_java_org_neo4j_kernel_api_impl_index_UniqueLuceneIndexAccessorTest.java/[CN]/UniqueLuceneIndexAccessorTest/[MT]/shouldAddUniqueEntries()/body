{
  DirectoryFactory directoryFactory=new DirectoryFactory.InMemoryDirectoryFactory();
  File indexDirectory=new File("index1");
  LuceneDocumentStructure documentStructure=new LuceneDocumentStructure();
  UniqueLuceneIndexAccessor accessor=new UniqueLuceneIndexAccessor(documentStructure,standard(),new IndexWriterStatus(),directoryFactory,indexDirectory);
  accessor.updateAndCommit(asList(add(1,"value1"),add(2,"value2")));
  accessor.updateAndCommit(asList(add(3,"value3")));
  accessor.close();
  List<Long> nodeIds=getAllNodes(documentStructure,directoryFactory.open(indexDirectory),"value1");
  assertEquals(asList(1l),nodeIds);
}
