{
  return new ResourceIterable<Label>(){
    @Override public ResourceIterator<Label> iterator(){
      final StatementOperationParts context=statementCtxProvider.getCtxForReading();
      Iterator<Long> labels;
      final StatementState state=statementCtxProvider.statementForReading();
      try {
        labels=context.entityReadOperations().nodeGetLabels(state,getId());
      }
 catch (      EntityNotFoundException e) {
        context.close(state);
        throw new NotFoundException("No node with id " + getId() + " found.",e);
      }
      return nodeLookup.getCleanupService().resourceIterator(map(new Function<Long,Label>(){
        @Override public Label apply(        Long labelId){
          try {
            return label(context.keyReadOperations().labelGetName(state,labelId));
          }
 catch (          LabelNotFoundKernelException e) {
            throw new ThisShouldNotHappenError("Mattias","Listed labels for node " + nodeId + ", but the returned label "+ labelId+ " doesn't exist anymore");
          }
        }
      }
,labels),state.closeable(context.lifecycleOperations()));
    }
  }
;
}
