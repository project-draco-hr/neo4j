{
  ByteBuffer buffer=ByteBuffer.wrap(new byte[RECORD_SIZE]);
  Collection<Token> tokens=new ArrayList<Token>();
  for (long id=0; id < maxId; id++) {
    readIntoBuffer(fileChannel,buffer,RECORD_SIZE);
    byte inUseByte=buffer.get();
    boolean inUse=(inUseByte == Record.IN_USE.byteValue());
    if (inUseByte != Record.IN_USE.byteValue() && inUseByte != Record.NOT_IN_USE.byteValue()) {
      throw new InvalidRecordException("Record[" + id + "] unknown in use flag["+ inUse+ "]");
    }
    if (!inUse) {
      continue;
    }
    buffer.getInt();
    int nameId=buffer.getInt();
    String name=nameStoreReader.readDynamicString(nameId);
    tokens.add(new Token(name,(int)id));
  }
  return tokens.toArray(new Token[tokens.size()]);
}
