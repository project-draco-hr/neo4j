{
  String key="mykey";
  String value="myvalue";
  long nodeId=graphdbHelper.createNode();
  String indexName="node";
  actions.createNodeIndex(MapUtil.map("name",indexName));
  Transaction transaction=graph.beginTx();
  List<Object> listOfIndexedNodes;
  try {
    listOfIndexedNodes=serialize(actions.getIndexedNodes(indexName,key,value));
  }
  finally {
    transaction.finish();
  }
  assertFalse(listOfIndexedNodes.iterator().hasNext());
  actions.addToNodeIndex(indexName,key,value,nodeId);
  assertEquals(Arrays.asList(nodeId),graphdbHelper.getIndexedNodes(indexName,key,value));
}
