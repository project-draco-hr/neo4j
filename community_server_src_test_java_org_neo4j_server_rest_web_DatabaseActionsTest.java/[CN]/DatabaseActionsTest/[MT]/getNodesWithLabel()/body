{
  String label1="first", label2="second";
  long node1=graphdbHelper.createNode(label(label1));
  long node2=graphdbHelper.createNode(label(label1),label(label2));
  graphdbHelper.createNode(label(label2));
  Transaction transaction=graph.beginTx();
  List<Object> representation;
  try {
    representation=serialize(actions.getNodesWithLabel(label1,map()));
  }
  finally {
    transaction.finish();
  }
  assertEquals(asSet(node1,node2),asSet(Iterables.map(new Function<Object,Long>(){
    @Override public Long apply(    Object from){
      Map<?,?> nodeMap=(Map<?,?>)from;
      return nodeUriToId((String)nodeMap.get("self"));
    }
  }
,representation)));
}
