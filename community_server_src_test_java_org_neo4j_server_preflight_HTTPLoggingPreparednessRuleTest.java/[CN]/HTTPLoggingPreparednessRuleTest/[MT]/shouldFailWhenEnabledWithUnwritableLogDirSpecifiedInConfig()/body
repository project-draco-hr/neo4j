{
  File confDir=TargetDirectory.forTest(this.getClass()).cleanDirectory("confDir");
  File unwritableDirectory=createUnwritableDirectory();
  Config config=new Config(MapUtil.stringMap(Configurator.HTTP_LOGGING,"true",Configurator.HTTP_LOG_CONFIG_LOCATION,createConfigFile(createLogbackConfigXml(unwritableDirectory),confDir).getAbsolutePath()));
  EnsurePreparedForHttpLogging rule=new EnsurePreparedForHttpLogging(config);
  boolean result=rule.run();
  assertFalse(result);
  assertEquals(String.format("HTTP log directory [%s] does not exist",unwritableDirectory),rule.getFailureMessage());
}
