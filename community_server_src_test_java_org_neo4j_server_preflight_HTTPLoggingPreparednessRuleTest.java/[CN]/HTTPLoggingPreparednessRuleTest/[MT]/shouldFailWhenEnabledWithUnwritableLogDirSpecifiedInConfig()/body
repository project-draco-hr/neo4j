{
  final File confDir=TargetDirectory.forTest(this.getClass()).cleanDirectory("confDir");
  Configuration config=new MapBasedConfiguration();
  config.setProperty(Configurator.HTTP_LOGGING,"true");
  final File unwritableDirectory=createUnwritableDirectory();
  config.setProperty(Configurator.HTTP_LOG_CONFIG_LOCATION,createConfigFile(createLogbackConfigXml(unwritableDirectory),confDir).getAbsolutePath());
  EnsurePreparedForHttpLogging rule=new EnsurePreparedForHttpLogging(config);
  boolean result=rule.run();
  assertFalse(result);
  assertEquals(String.format("HTTP log directory [%s] does not exist",unwritableDirectory),rule.getFailureMessage());
}
