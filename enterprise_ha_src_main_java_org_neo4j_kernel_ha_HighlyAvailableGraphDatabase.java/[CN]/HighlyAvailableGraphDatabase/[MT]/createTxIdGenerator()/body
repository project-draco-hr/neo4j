{
  DelegateInvocationHandler<TxIdGenerator> txIdGeneratorDelegate=new DelegateInvocationHandler<TxIdGenerator>();
  TxIdGenerator txIdGenerator=(TxIdGenerator)Proxy.newProxyInstance(TxIdGenerator.class.getClassLoader(),new Class[]{TxIdGenerator.class},txIdGeneratorDelegate);
  members=new ClusterMembers(clusterClient,clusterClient,clusterClient,clusterEvents);
  slaves=life.add(new HighAvailabilitySlaves(members,clusterClient,new DefaultSlaveFactory(xaDataSourceManager,msgLog,config.get(HaSettings.max_concurrent_channels_per_slave),config.get(HaSettings.com_chunk_size).intValue())));
  new TxIdGeneratorModeSwitcher(memberStateMachine,txIdGeneratorDelegate,(HaXaDataSourceManager)xaDataSourceManager,master,requestContextFactory,msgLog,config,slaves);
  return txIdGenerator;
}
