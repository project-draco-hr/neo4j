{
  if (!accessGuard.await(stateSwitchTimeoutMillis)) {
    throw new TransactionFailureException("Timeout waiting for cluster to elect master");
  }
  return super.beginTx(forceMode);
}
