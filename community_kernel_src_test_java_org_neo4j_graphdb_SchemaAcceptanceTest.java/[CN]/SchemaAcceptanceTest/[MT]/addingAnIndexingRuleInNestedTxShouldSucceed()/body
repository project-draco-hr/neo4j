{
  IndexDefinition index;
  Transaction tx=db.beginTx();
  IndexDefinition indexDef;
  try {
    Transaction tx1=db.beginTx();
    try {
      indexDef=db.schema().indexFor(label).on(propertyKey).create();
      tx1.success();
    }
  finally {
      tx1.finish();
    }
    index=indexDef;
    tx.success();
  }
  finally {
    tx.finish();
  }
  waitForIndex(db,indexDef);
  assertThat(getIndexes(db,label),containsOnly(index));
}
