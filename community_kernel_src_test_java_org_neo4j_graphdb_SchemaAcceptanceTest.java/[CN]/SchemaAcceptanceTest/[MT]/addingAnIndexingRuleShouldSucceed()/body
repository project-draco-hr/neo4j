{
  GraphDatabaseService beansAPI=dbRule.getGraphDatabaseService();
  Schema schema=beansAPI.schema();
  String property="my_property_key";
  Labels label=Labels.MY_LABEL;
  IndexDefinition index=createIndexRule(beansAPI,label,property);
  assertEquals(asSet(property),asSet(singlePropertyKey(schema.getIndexes(label))));
  assertTrue(asSet(schema.getIndexes(label)).contains(index));
  Iterable<IndexDefinition> indexes=schema.getIndexes(Labels.MY_LABEL);
  long timeout=System.currentTimeMillis() + 1000 * 5;
  assertEquals(asSet(property),asSet(singlePropertyKey(indexes)));
  awaitIndexState(single(indexes),Schema.IndexState.ONLINE,schema,timeout);
}
