{
  GraphDatabaseService graphDb=new EmbeddedGraphDatabase("target/var/neodb");
  DummyKernelEventHandler handler1=new DummyKernelEventHandler(RESOURCE1){
    public ExecutionOrder orderComparedTo(    KernelEventHandler other){
      if (((DummyKernelEventHandler)other).resource == RESOURCE2) {
        return ExecutionOrder.AFTER;
      }
      return ExecutionOrder.DOESNT_MATTER;
    }
  }
;
  DummyKernelEventHandler handler2=new DummyKernelEventHandler(RESOURCE1){
    public ExecutionOrder orderComparedTo(    KernelEventHandler other){
      if (((DummyKernelEventHandler)other).resource == RESOURCE1) {
        return ExecutionOrder.BEFORE;
      }
      return ExecutionOrder.DOESNT_MATTER;
    }
  }
;
  graphDb.registerKernelEventHandler(handler1);
  graphDb.registerKernelEventHandler(handler2);
  graphDb.shutdown();
  assertEquals(0,handler2.beforeShutdown);
  assertEquals(1,handler1.beforeShutdown);
}
