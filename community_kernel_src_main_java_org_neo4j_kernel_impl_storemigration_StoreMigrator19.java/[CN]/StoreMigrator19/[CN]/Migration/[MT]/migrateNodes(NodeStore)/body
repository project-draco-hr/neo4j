{
  for (  NodeRecord nodeRecord : loop(legacyStore.getNodeStoreReader().readNodeStore())) {
    if (nodeRecord.getId() == 109991l) {
      System.out.println("processing " + nodeRecord);
    }
    reportProgress(nodeRecord.getId());
    nodeStore.setHighId(nodeRecord.getId() + 1);
    if (nodeRecord.inUse()) {
      nodeStore.updateRecord(nodeRecord);
    }
 else {
      nodeStore.freeId(nodeRecord.getId());
    }
  }
  legacyStore.getNodeStoreReader().close();
}
