{
  RelationshipExpander expander=toExpander(getServer().getDb(),direction,filterMap,caseInsensitiveFilters,looseFilters);
  Map<String,Collection<Relationship>> relationships=readAllRelationships(expander != null ? expander.expand(thing.asNode()) : Collections.<Relationship>emptyList());
  Node node=thing.asNode();
  for (  Map.Entry<String,Collection<Relationship>> entry : relationships.entrySet()) {
    if (brief) {
      Relationship firstRel=entry.getValue().iterator().next();
      String relDisplay=withArrows(firstRel,getDisplayName(getServer(),session,firstRel,false,true),thing.asNode());
      out.println(getDisplayName(getServer(),session,thing,true) + relDisplay + " x"+ entry.getValue().size());
    }
 else {
      for (      Relationship rel : entry.getValue()) {
        StringBuffer buf=new StringBuffer(getDisplayName(getServer(),session,thing,true));
        String relDisplay=quiet ? "" : getDisplayName(getServer(),session,rel,verbose,true);
        buf.append(withArrows(rel,relDisplay,thing.asNode()));
        buf.append(getDisplayName(getServer(),session,rel.getOtherNode(node),true));
        out.println(buf);
      }
    }
  }
}
