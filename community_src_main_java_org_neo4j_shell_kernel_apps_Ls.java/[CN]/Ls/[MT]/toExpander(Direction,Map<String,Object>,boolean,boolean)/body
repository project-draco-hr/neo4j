{
  Expander expander=TraversalFactory.emptyExpander();
  for (  RelationshipType type : getServer().getDb().getRelationshipTypes()) {
    boolean matches=false;
    if (filterMap == null || filterMap.isEmpty()) {
      matches=true;
    }
 else {
      for (      String filter : filterMap.keySet()) {
        if (matches(newPattern(filter,caseInsensitiveFilters),type.name(),caseInsensitiveFilters,looseFilters)) {
          matches=true;
          break;
        }
      }
    }
    if (matches) {
      expander=expander.add(type,direction);
    }
  }
  return expander;
}
