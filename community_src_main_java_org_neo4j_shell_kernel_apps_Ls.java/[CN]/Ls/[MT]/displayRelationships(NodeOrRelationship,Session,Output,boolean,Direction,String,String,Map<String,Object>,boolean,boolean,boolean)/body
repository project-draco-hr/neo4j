{
  RelationshipExpander expander=toExpander(direction,filterMap,caseInsensitiveFilters,looseFilters);
  Map<String,Collection<Relationship>> relationships=readAllRelationships(expander.expand(thing.asNode()));
  for (  Map.Entry<String,Collection<Relationship>> entry : relationships.entrySet()) {
    if (brief) {
      out.println(getDisplayName(getServer(),session,thing,true) + " " + prefixString+ getDisplayName(getServer(),session,entry.getValue().iterator().next(),false,true)+ postfixString+ " x"+ entry.getValue().size());
    }
 else {
      for (      Relationship rel : entry.getValue()) {
        StringBuffer buf=new StringBuffer(getDisplayName(getServer(),session,thing,true));
        buf.append(" " + prefixString).append(getDisplayName(getServer(),session,rel,verbose,true));
        buf.append(postfixString + " ");
        buf.append(getDisplayName(getServer(),session,direction == Direction.OUTGOING ? rel.getEndNode() : rel.getStartNode(),true));
        out.println(buf);
      }
    }
  }
}
