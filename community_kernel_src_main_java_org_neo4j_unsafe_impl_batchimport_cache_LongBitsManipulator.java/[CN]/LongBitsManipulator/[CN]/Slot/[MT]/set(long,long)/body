{
  if (value < 0 || value > maxValue) {
    throw new IllegalStateException("Invalid value " + value + ", max is "+ maxValue);
  }
  long otherBits=field & ~mask;
  return (value << bitOffset) | otherBits;
}
