{
  if (config.get(GraphDatabaseSettings.read_only)) {
    return new ReadOnlyTokenCreator();
  }
 else {
    DelegateInvocationHandler<TokenCreator> labelIdCreatorDelegate=new DelegateInvocationHandler<>(TokenCreator.class,logging.getInternalLogProvider());
    TokenCreator labelIdCreator=(TokenCreator)newProxyInstance(TokenCreator.class.getClassLoader(),new Class[]{TokenCreator.class},labelIdCreatorDelegate);
    paxosLife.add(new LabelTokenCreatorModeSwitcher(highAvailabilityModeSwitcher,labelIdCreatorDelegate,masterDelegateInvocationHandler,requestContextFactory,kernelProvider,idGeneratorFactory));
    return labelIdCreator;
  }
}
