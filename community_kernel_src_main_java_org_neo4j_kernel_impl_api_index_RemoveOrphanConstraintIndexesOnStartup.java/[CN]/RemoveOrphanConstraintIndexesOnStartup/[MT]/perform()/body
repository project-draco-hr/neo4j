{
  try {
    txManager.begin(ForceMode.unforced);
    boolean success=false;
    KernelTransaction tx=null;
    try {
      tx=txManager.getKernelTransaction();
      StatementOperations context=ctxProvider.getCtxForWriting();
      StatementState state=tx.newStatementState();
      try {
        for (Iterator<IndexDescriptor> indexes=context.uniqueIndexesGetAll(state); indexes.hasNext(); ) {
          IndexDescriptor index=indexes.next();
          if (context.indexGetOwningUniquenessConstraintId(state,index) == null) {
            context.uniqueIndexDrop(state,index);
          }
        }
      }
  finally {
        context.close(state);
      }
      success=true;
    }
  finally {
      if (tx != null) {
        if (success) {
          tx.commit();
        }
 else {
          tx.rollback();
        }
      }
 else {
        txManager.rollback();
      }
    }
  }
 catch (  Throwable e) {
    log.error("Failed to execute orphan index checking transaction.",e);
  }
}
