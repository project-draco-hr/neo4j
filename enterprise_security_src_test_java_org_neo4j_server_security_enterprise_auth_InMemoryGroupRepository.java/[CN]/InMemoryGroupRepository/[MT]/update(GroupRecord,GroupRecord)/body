{
  if (!existingGroup.name().equals(updatedGroup.name())) {
    throw new IllegalArgumentException("updatedGroup has a different name");
  }
synchronized (this) {
    boolean foundGroup=false;
    for (    GroupRecord other : groups.values()) {
      if (other.equals(existingGroup)) {
        foundGroup=true;
      }
    }
    if (!foundGroup) {
      throw new ConcurrentModificationException();
    }
    groups.put(updatedGroup.name(),updatedGroup);
    removeFromUserMap(existingGroup);
    populateUserMap(updatedGroup);
  }
}
