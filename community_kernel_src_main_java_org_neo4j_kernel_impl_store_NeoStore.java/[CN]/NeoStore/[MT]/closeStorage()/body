{
  if (relTypeStore != null) {
    relTypeStore.close();
    relTypeStore=null;
  }
  if (labelTokenStore != null) {
    labelTokenStore.close();
    labelTokenStore=null;
  }
  if (propStore != null) {
    propStore.close();
    propStore=null;
  }
  if (relStore != null) {
    relStore.close();
    relStore=null;
  }
  if (nodeStore != null) {
    nodeStore.close();
    nodeStore=null;
  }
  if (schemaStore != null) {
    schemaStore.close();
    schemaStore=null;
  }
  if (relGroupStore != null) {
    relGroupStore.close();
    relGroupStore=null;
  }
  if (counts != null) {
    try {
      counts.rotate(getLastCommittedTransactionId());
      counts.shutdown();
    }
 catch (    IOException e) {
      throw new UnderlyingStorageException(e);
    }
 finally {
      counts=null;
    }
  }
}
