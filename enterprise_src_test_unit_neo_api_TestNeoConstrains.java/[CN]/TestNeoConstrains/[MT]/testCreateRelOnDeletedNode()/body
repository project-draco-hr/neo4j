{
  try {
    NodeManager nm=NodeManager.getManager();
    Node node1=nm.createNode();
    Node node2=nm.createNode();
    TransactionFactory.getUserTransaction().commit();
    TransactionFactory.getUserTransaction().begin();
    node1.delete();
    try {
      NodeManager.getManager().createRelationship(node1,node2,MyRelTypes.TEST);
    }
 catch (    Exception e) {
    }
    try {
      TransactionFactory.getUserTransaction().commit();
      fail("Transaction should be marked rollback");
    }
 catch (    Exception e) {
    }
    TransactionFactory.getUserTransaction().begin();
    node2.delete();
    node1.delete();
  }
 catch (  Exception e) {
    fail("" + e);
  }
}
