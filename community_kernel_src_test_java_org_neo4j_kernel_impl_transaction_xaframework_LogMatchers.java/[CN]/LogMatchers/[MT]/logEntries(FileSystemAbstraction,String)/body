{
  StoreChannel fileChannel=fileSystem.open(new File(logPath),"r");
  ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
  try {
    LogIoUtils.readLogHeader(buffer,fileChannel,true);
    List<LogEntry> entries=new ArrayList<LogEntry>();
    DumpLogicalLog.CommandFactory cmdFactory=new DumpLogicalLog.CommandFactory();
    LogEntry entry;
    while ((entry=LogIoUtils.readEntry(buffer,fileChannel,cmdFactory)) != null) {
      entries.add(entry);
    }
    return entries;
  }
  finally {
    fileChannel.close();
  }
}
