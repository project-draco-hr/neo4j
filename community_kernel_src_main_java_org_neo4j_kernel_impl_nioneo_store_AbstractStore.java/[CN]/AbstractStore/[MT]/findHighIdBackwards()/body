{
  FileChannel fileChannel=getFileChannel();
  int recordSize=getRecordSize();
  long fileSize=fileChannel.size();
  long highId=fileSize / recordSize;
  ByteBuffer byteBuffer=ByteBuffer.allocate(getRecordSize());
  for (long i=highId; i > 0; i--) {
    fileChannel.position(i * recordSize);
    if (fileChannel.read(byteBuffer) > 0) {
      byteBuffer.flip();
      boolean isInUse=isRecordInUse(byteBuffer);
      byteBuffer.clear();
      if (isInUse) {
        return i;
      }
    }
  }
  return 0;
}
