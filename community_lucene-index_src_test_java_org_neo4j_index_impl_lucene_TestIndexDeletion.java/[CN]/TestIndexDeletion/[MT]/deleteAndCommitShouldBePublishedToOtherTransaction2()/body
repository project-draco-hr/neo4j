{
  WorkThread firstTx=createWorker("First");
  WorkThread secondTx=createWorker("Second");
  firstTx.beginTransaction();
  secondTx.beginTransaction();
  firstTx.createNodeAndIndexBy(key,"some value");
  secondTx.createNodeAndIndexBy(key,"some other value");
  firstTx.deleteIndex();
  firstTx.commit();
  secondTx.queryIndex(key,"some other value");
  assertThat(secondTx,hasThrownException());
  secondTx.rollback();
  rollbackTx();
}
