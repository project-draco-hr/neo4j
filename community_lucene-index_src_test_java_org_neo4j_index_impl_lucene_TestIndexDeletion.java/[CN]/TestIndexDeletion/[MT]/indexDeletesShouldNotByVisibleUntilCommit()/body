{
  commitTx();
  WorkThread firstTx=createWorker();
  WorkThread secondTx=createWorker();
  firstTx.beginTransaction();
  firstTx.waitForCommandToComplete();
  firstTx.removeFromIndex(key,value);
  firstTx.waitForCommandToComplete();
  IndexHits<Node> indexHits=secondTx.queryIndex(key,value);
  secondTx.waitForCommandToComplete();
  assertThat(indexHits,contains(node));
  firstTx.rollback();
}
