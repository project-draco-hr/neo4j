{
  IndexImplementation indexImplementation=indexProviders.get(LUCENE_LEGACY_INDEX_PROVIDER_NAME);
  if (indexImplementation != null) {
switch (versionToMigrateFrom) {
case Legacy23Store.LEGACY_VERSION:
case Legacy22Store.LEGACY_VERSION:
case Legacy21Store.LEGACY_VERSION:
case Legacy20Store.LEGACY_VERSION:
case Legacy19Store.LEGACY_VERSION:
      originalLegacyIndexesRoot=indexImplementation.getStoreDirectory(storeDir);
    migrationLegacyIndexesRoot=indexImplementation.getStoreDirectory(migrationDir);
  migrateLegacyIndexes();
legacyIndexMigrated=true;
break;
default :
throw new IllegalStateException("Unknown version to upgrade from: " + versionToMigrateFrom);
}
}
 else {
log.debug("Lucene index provider not found, nothing to migrate.");
}
}
