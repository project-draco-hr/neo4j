{
  File storeDir=unzip(getClass(),"exampledb.zip");
  org.neo4j.kernel.impl.storemigration.legacystore.v20.LegacyNodeStoreReader nodeStoreReader=new org.neo4j.kernel.impl.storemigration.legacystore.v20.LegacyNodeStoreReader(fs,new File(storeDir,"neostore.nodestore.db"));
  assertEquals(1003,nodeStoreReader.getMaxId());
  final AtomicInteger nodeCount=new AtomicInteger(0);
  nodeStoreReader.accept(new org.neo4j.kernel.impl.storemigration.legacystore.v20.LegacyNodeStoreReader.Visitor(){
    @Override public void visit(    NodeRecord record){
      if (record.inUse()) {
        nodeCount.incrementAndGet();
      }
    }
  }
);
  assertEquals(501,nodeCount.get());
  nodeStoreReader.close();
}
