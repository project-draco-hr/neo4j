{
  IndexingService indexing=newIndexingServiceWithMockedDependencies(populator,accessor,withData());
  Set<Long> expectedChangedNodeIds=asSet(1L,2L,3L,4L,5L);
  IndexUpdates updates=mock(IndexUpdates.class);
  when(updates.iterator()).thenReturn(IteratorUtil.<NodePropertyUpdate>emptyIterator());
  when(updates.changedNodeIds()).thenReturn(expectedChangedNodeIds);
  ValidatedIndexUpdates validatedUpdates=indexing.validate(updates);
  assertEquals(expectedChangedNodeIds,validatedUpdates.changedNodeIds());
}
