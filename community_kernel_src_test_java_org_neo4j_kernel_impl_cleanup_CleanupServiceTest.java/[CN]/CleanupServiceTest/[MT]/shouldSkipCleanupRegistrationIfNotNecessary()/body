{
  @SuppressWarnings("unchecked") Thunk<Boolean> cleanupNecessity=mock(Thunk.class);
  when(cleanupNecessity.evaluate()).thenReturn(false);
  Logging logging=mock(Logging.class);
  when(logging.getMessagesLog(Matchers.<Class<?>>any())).thenReturn(DEV_NULL);
  CleanupService service=new ReferenceQueueBasedCleanupService(scheduler,logging,referenceQueue,cleanupNecessity);
  service.start();
  Iterator<Integer> iterator=new ArrayIterator<Integer>(new Integer[]{1,2,3});
  Closeable closer=mock(Closeable.class);
  ResourceIterator<Integer> resourceIterator=service.resourceIterator(iterator,closer);
  resourceIterator.next();
  service.stop();
  verify(cleanupNecessity,times(1)).evaluate();
  verifyZeroInteractions(closer);
}
