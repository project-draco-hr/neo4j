{
  lifeSupport.start();
  StateMarshal<Long> byteBufferMarshal=new SafeStateMarshal<Long>(){
    @Override public Long startState(){
      return 0L;
    }
    @Override public long ordinal(    Long aLong){
      return aLong;
    }
    @Override public void marshal(    Long aLong,    WritableChannel channel) throws IOException {
      channel.putLong(aLong);
    }
    @Override public Long unmarshal0(    ReadableChannel channel) throws IOException, EndOfStreamException {
      return channel.getLong();
    }
  }
;
  this.stateStorage=lifeSupport.add(new DurableStateStorage<>(fileSystemAbstraction,stateDir,FILENAME,byteBufferMarshal,numberOfEntriesBeforeRotation,NullLogProvider.getInstance()));
  this.theState=this.stateStorage.getInitialState();
}
