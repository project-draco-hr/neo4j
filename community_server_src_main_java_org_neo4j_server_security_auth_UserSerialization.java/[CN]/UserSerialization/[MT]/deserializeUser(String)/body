{
  String[] parts=line.split(userSeparator,-1);
  if (parts.length != 4) {
    throw new IllegalStateException("Cannot read user data from authorization file.");
  }
  return new User.Builder().withName(parts[0]).withToken(parts[1]).withCredentials(deserializeCredentials(parts[2])).withRequiredPasswordChange(parts[3].equals("password_change_required")).withPrivileges(Privileges.ADMIN).build();
}
