{
  if ((NON_DOUBLE_LONG & rhs) != NON_DOUBLE_LONG) {
    if (Double.isNaN(lhs)) {
      return +1;
    }
    if (Double.isInfinite(lhs)) {
      return lhs < 0 ? -1 : +1;
    }
    return BigDecimal.valueOf(lhs).compareTo(BigDecimal.valueOf(rhs));
  }
  return Double.compare(lhs,rhs);
}
