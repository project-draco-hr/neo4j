{
  while (true) {
    Relationship nextRel=fetchNextRelOrNull();
    if (nextRel == null) {
      return null;
    }
    Node result=nextRel.getOtherNode(this.lastParentTraverserNode);
    LevelData levelData=this.visitedNodes.get(result);
    boolean createdLevelData=false;
    if (levelData == null) {
      levelData=new LevelData(result,this.currentDepth);
      this.visitedNodes.put(result,levelData);
      createdLevelData=true;
    }
    if (this.currentDepth < levelData.depth) {
      throw new RuntimeException("This shouldn't happen... I think");
    }
 else     if (this.currentDepth == levelData.depth) {
      for (      Path.Builder parentPath : this.lastParentLevelData.paths) {
        levelData.paths.add(parentPath.push(nextRel));
      }
    }
    if (!createdLevelData) {
      continue;
    }
    this.nextNodes.add(result);
    return levelData;
  }
}
