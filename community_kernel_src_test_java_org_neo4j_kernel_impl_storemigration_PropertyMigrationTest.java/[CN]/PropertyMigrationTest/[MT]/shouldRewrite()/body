{
  URL legacyStoreResource=getClass().getResource("oldformatstore/neostore");
  LegacyStore legacyStore=new LegacyStore(legacyStoreResource.getFile());
  LegacyPropertyStoreReader propertyStoreReader=legacyStore.getPropertyStoreReader();
  LegacyDynamicRecordFetcher legacyDynamicRecordFetcher=legacyStore.getDynamicRecordFetcher();
  LegacyNodeStoreReader legacyNodeStoreReader=legacyStore.getLegacyNodeStoreReader();
  HashMap config=MigrationTestUtils.defaultConfig();
  File outputDir=new File("target/outputDatabase");
  FileUtils.deleteRecursively(outputDir);
  assertTrue(outputDir.mkdirs());
  String storeFileName="target/outputDatabase/neostore";
  config.put("neo_store",storeFileName);
  NeoStore.createStore(storeFileName,config);
  NeoStore neoStore=new NeoStore(config);
  PropertyStore propertyStore=neoStore.getPropertyStore();
  new PropertyMigration(legacyNodeStoreReader,propertyStoreReader,legacyDynamicRecordFetcher).migrateNodeProperties(new PropertyWriter(propertyStore));
  assertEquals(1000,propertyStore.getHighId());
  neoStore.close();
}
