{
  Index<Node> index=nodeIndex("index",LuceneIndexProvider.EXACT_CONFIG);
  Node neo=graphDb.createNode();
  Node trinity=graphDb.createNode();
  index.add(neo,"username","neo@matrix");
  index.add(neo,"sex","male");
  index.add(trinity,"username","trinity@matrix");
  index.add(trinity,"sex","female");
  assertThat(index.query("username:*@matrix AND sex:male"),contains(neo));
  assertThat(index.query(new QueryContext("username:*@matrix sex:male").defaultOperator(Operator.AND)),contains(neo));
  assertThat(index.query("username:*@matrix OR sex:male"),contains(neo,trinity));
  assertThat(index.query(new QueryContext("username:*@matrix sex:male").defaultOperator(Operator.OR)),contains(neo,trinity));
  restartTx();
  assertThat(index.query("username:*@matrix AND sex:male"),contains(neo));
  assertThat(index.query(new QueryContext("username:*@matrix sex:male").defaultOperator(Operator.AND)),contains(neo));
  assertThat(index.query("username:*@matrix OR sex:male"),contains(neo,trinity));
  assertThat(index.query(new QueryContext("username:*@matrix sex:male").defaultOperator(Operator.OR)),contains(neo,trinity));
  index.delete();
}
