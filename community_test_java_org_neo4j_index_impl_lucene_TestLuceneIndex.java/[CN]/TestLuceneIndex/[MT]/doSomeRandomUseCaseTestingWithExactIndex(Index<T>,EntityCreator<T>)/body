{
  String name="name";
  String mattias="Mattias Persson";
  String title="title";
  String hacker="Hacker";
  assertCollection(index.get(name,mattias));
  T entity1=creator.create();
  T entity2=creator.create();
  assertNull(index.get(name,mattias).getSingle());
  index.add(entity1,name,mattias);
  assertCollection(index.get(name,mattias),entity1);
  assertQueryNotPossible(index);
  assertEquals(entity1,index.get(name,mattias).getSingle());
  assertQueryNotPossible(index);
  commitTx();
  assertCollection(index.get(name,mattias),entity1);
  assertCollection(index.query(name,"\"" + mattias + "\""),entity1);
  assertCollection(index.query("name:\"" + mattias + "\""),entity1);
  assertEquals(entity1,index.get(name,mattias).getSingle());
  assertCollection(index.query("name","Mattias*"),entity1);
  beginTx();
  index.add(entity2,title,hacker);
  index.add(entity1,title,hacker);
  assertCollection(index.get(name,mattias),entity1);
  assertCollection(index.get(title,hacker),entity1,entity2);
  assertQueryNotPossible(index);
  commitTx();
  assertCollection(index.get(name,mattias),entity1);
  assertCollection(index.get(title,hacker),entity1,entity2);
  assertCollection(index.query("name:\"" + mattias + "\" OR title:\""+ hacker+ "\""),entity1,entity2);
  assertCollection(index.query("name:\"" + mattias + "\" AND title:\""+ hacker+ "\""),entity1);
  beginTx();
  index.remove(entity2,title,hacker);
  assertCollection(index.get(name,mattias),entity1);
  assertCollection(index.get(title,hacker),entity1);
  assertQueryNotPossible(index);
  commitTx();
  assertCollection(index.get(name,mattias),entity1);
  assertCollection(index.get(title,hacker),entity1);
  assertCollection(index.query("name:\"" + mattias + "\" OR title:\""+ hacker+ "\""),entity1);
  beginTx();
  index.remove(entity1,title,hacker);
  index.remove(entity1,name,mattias);
  index.clear();
  commitTx();
}
