{
  if (types.length == 0) {
    types=this.types;
  }
  for (  int type : types) {
    RelationshipLoadingPosition position=getTypePosition(type);
    if (position.hasMore(direction,types)) {
      currentPosition=position;
      return position.position(direction,types);
    }
  }
  return Record.NO_NEXT_RELATIONSHIP.intValue();
}
