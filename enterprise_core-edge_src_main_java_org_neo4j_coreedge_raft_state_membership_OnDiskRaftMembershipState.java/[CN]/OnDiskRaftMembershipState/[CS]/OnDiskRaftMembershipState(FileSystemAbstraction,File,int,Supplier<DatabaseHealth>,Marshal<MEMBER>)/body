{
  InMemoryRaftMembershipState.InMemoryRaftMembershipStateMarshal<MEMBER> marshal=new InMemoryRaftMembershipState.InMemoryRaftMembershipStateMarshal<>(memberMarshal);
  File fileA=new File(storeDir,FILENAME + "a");
  File fileB=new File(storeDir,FILENAME + "b");
  RaftMembershipStateRecoveryManager<MEMBER> recoveryManager=new RaftMembershipStateRecoveryManager<>(fileSystemAbstraction,marshal);
  final StateRecoveryManager.RecoveryStatus recoveryStatus=recoveryManager.recover(fileA,fileB);
  inMemoryRaftMembershipState=recoveryManager.readLastEntryFrom(recoveryStatus.previouslyActive());
  this.statePersister=new StatePersister<>(fileA,fileB,fileSystemAbstraction,numberOfEntriesBeforeRotation,ByteBuffer.allocate(MAX_SIZE_OF_ADDRESS_STATE_ON_DISK),marshal,recoveryStatus.previouslyInactive(),databaseHealthSupplier);
}
