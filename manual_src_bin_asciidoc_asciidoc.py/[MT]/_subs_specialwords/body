def _subs_specialwords(mo):
    'Special word substitution function called by\n    Config.subs_specialwords().'
    word = mo.re.pattern
    template = config.specialwords[word]
    if (not (template in config.sections)):
        raise EAsciiDoc, ('missing special word template [%s]' % template)
    if (mo.group()[0] == '\\'):
        return mo.group()[1:]
    args = {}
    args['words'] = mo.group()
    args.update(mo.groupdict())
    for (k, v) in args.items():
        if (v is None):
            del args[k]
    lines = subs_attrs(config.sections[template], args)
    if (len(lines) == 0):
        result = ''
    elif (len(lines) == 1):
        result = lines[0]
    else:
        result = writer.newline.join(lines)
    return result
