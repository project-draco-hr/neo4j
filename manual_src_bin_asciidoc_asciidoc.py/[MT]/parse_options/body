def parse_options(options, allowed, errmsg):
    "Parse comma separated string of unquoted option names and return as a\n    tuple of valid options. 'allowed' is a list of allowed option values.\n    If allowed=() then all legitimate names are allowed.\n    'errmsg' is an error message prefix if an illegal option error is thrown."
    result = []
    if options:
        for s in re.split('\\s*,\\s*', options):
            if ((allowed and (s not in allowed)) or (not is_name(s))):
                raise EAsciiDoc, ('%s: %s' % (errmsg, s))
            result.append(s)
    return tuple(result)
