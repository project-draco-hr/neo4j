def format(self, msg, prefix='', linenos=True, cursor=None, offset=0):
    'Return formatted message string.'
    if ((self.linenos is not False) and ((linenos or self.linenos) and reader.cursor)):
        if (cursor is None):
            cursor = reader.cursor
        prefix += ('%s: line %d: ' % (os.path.basename(cursor[0]), (cursor[1] + offset)))
    return (prefix + msg)
