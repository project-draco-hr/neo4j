def match(self, prefix, name, text):
    "Return re match object matching 'text' with macro type 'prefix',\n        macro name 'name'."
    for m in self.macros:
        if (m.prefix == prefix):
            mo = m.reo.match(text)
            if mo:
                if (m.name == name):
                    return mo
                if re.match(name, mo.group('name')):
                    return mo
    return None
