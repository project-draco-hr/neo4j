def subs_specialchars(self, s):
    "Perform special character substitution on string 's'."
    "It may seem like a good idea to escape special characters with a ''\n        character, the reason we don't is because the escape character itself\n        then has to be escaped and this makes including code listings\n        problematic. Use the predefined {amp},{lt},{gt} attributes instead."
    result = ''
    for ch in s:
        result = (result + self.specialchars.get(ch, ch))
    return result
