def set_theme_attributes(self):
    theme = document.attributes.get('theme')
    if (theme and ('themedir' not in document.attributes)):
        themedir = config.find_config_dir('themes', theme)
        if themedir:
            document.attributes['themedir'] = themedir
            iconsdir = os.path.join(themedir, 'icons')
            if (('data-uri' in document.attributes) and os.path.isdir(iconsdir)):
                document.attributes['iconsdir'] = iconsdir
        else:
            message.warning(('missing theme: %s' % theme), linenos=False)
