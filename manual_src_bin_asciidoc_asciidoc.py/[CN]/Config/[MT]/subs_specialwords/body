def subs_specialwords(self, s):
    "Search for word patterns from self.specialwords in 's' and\n        substitute using corresponding macro."
    result = s
    for word in self.specialwords.keys():
        result = re.sub(word, _subs_specialwords, result)
    return result
