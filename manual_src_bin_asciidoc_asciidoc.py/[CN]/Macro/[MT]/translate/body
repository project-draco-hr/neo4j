def translate(self):
    ' Block macro translation.'
    assert (self.prefix == '#')
    s = reader.read()
    before = s
    if self.has_passthrough():
        s = macros.extract_passthroughs(s, '#')
    s = subs_attrs(s)
    if s:
        s = self.subs(s)
        if self.has_passthrough():
            s = macros.restore_passthroughs(s)
        if s:
            trace('macro block', before, s)
            writer.write(s)
