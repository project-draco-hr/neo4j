def build_colspecs(self):
    '\n        Generate column related substitution attributes.\n        '
    cols = []
    i = 1
    for col in self.columns:
        colspec = self.get_tags(col.style).colspec
        if colspec:
            self.attributes['halign'] = col.halign
            self.attributes['valign'] = col.valign
            self.attributes['colabswidth'] = col.abswidth
            self.attributes['colpcwidth'] = col.pcwidth
            self.attributes['colnumber'] = str(i)
            s = subs_attrs(colspec, self.attributes)
            if (not s):
                message.warning('colspec dropped: contains undefined attribute')
            else:
                cols.append(s)
        i += 1
    if cols:
        self.attributes['colspecs'] = writer.newline.join(cols)
