def open(self, fname):
    self.fname = fname
    message.verbose(('reading: ' + fname))
    if (fname == '<stdin>'):
        self.f = sys.stdin
        self.infile = None
        self.indir = None
    else:
        self.f = open(fname, 'rb')
        self.infile = fname
        self.indir = os.path.dirname(fname)
    document.attributes['infile'] = self.infile
    document.attributes['indir'] = self.indir
    self._lineno = 0
    self.next = []
    if Reader1.read(self):
        if self.cursor[2].startswith(UTF8_BOM):
            self.cursor[2] = self.cursor[2][len(UTF8_BOM):]
            self.bom = UTF8_BOM
        self.unread(self.cursor)
        self.cursor = None
