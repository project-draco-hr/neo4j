{
  this.transactionData=nodeManager.getTransactionData();
  try {
    if (tm.getStatus() != Status.STATUS_ACTIVE) {
      return;
    }
  }
 catch (  SystemException e) {
    e.printStackTrace();
  }
  states=new ArrayList<HandlerAndState>();
  for (  TransactionEventHandler<?> handler : this.handlers) {
    try {
      Object state=handler.beforeCommit(transactionData);
      states.add(new HandlerAndState(handler,state));
    }
 catch (    Throwable t) {
      try {
        tm.setRollbackOnly();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      throw new RuntimeException(t);
    }
  }
}
