{
  LatencyCalculator latencyCalculator=new LatencyCalculator(timeoutStrategy,input);
  DelayedDirectExecutor executor=new DelayedDirectExecutor();
  Timeouts timeouts=new Timeouts(timeoutStrategy);
  final MultiPaxosContext context=new MultiPaxosContext(me,Iterables.<ElectionRole,ElectionRole>iterable(new ElectionRole(ClusterConfiguration.COORDINATOR)),new ClusterConfiguration(initialConfig.getName(),logging.getMessagesLog(ClusterConfiguration.class),initialConfig.getMemberURIs()),executor,logging,objectInputStreamFactory,objectOutputStreamFactory,acceptorInstanceStore,timeouts,electionCredentialsProvider);
  SnapshotContext snapshotContext=new SnapshotContext(context.getClusterContext(),context.getLearnerContext());
  return newProtocolServer(me,input,output,stateMachineExecutor,latencyCalculator,executor,timeouts,context,snapshotContext);
}
