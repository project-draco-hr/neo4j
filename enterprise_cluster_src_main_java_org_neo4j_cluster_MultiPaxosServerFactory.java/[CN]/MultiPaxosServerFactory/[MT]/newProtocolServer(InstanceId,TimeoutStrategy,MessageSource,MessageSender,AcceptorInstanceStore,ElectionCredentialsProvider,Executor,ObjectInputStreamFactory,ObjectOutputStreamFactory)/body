{
  DelayedDirectExecutor executor=new DelayedDirectExecutor(logProvider);
  Timeouts timeouts=new Timeouts(timeoutStrategy);
  final MultiPaxosContext context=new MultiPaxosContext(me,Iterables.<ElectionRole,ElectionRole>iterable(new ElectionRole(ClusterConfiguration.COORDINATOR)),new ClusterConfiguration(initialConfig.getName(),logProvider,initialConfig.getMemberURIs()),executor,logProvider,objectInputStreamFactory,objectOutputStreamFactory,acceptorInstanceStore,timeouts,electionCredentialsProvider);
  SnapshotContext snapshotContext=new SnapshotContext(context.getClusterContext(),context.getLearnerContext());
  return newProtocolServer(me,input,output,stateMachineExecutor,executor,timeouts,context,snapshotContext);
}
