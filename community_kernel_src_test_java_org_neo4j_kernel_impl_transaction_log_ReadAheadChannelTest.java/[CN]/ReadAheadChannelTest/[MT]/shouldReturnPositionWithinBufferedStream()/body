{
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  File file=new File("foo.txt");
  int readAheadSize=512;
  int fileSize=readAheadSize * 8;
  createFile(fsa,file,fileSize);
  ReadAheadChannel<StoreChannel> bufferedReader=new ReadAheadChannel<>(fsa.open(file,"r"),readAheadSize);
  for (int i=0; i < fileSize / Long.BYTES; i++) {
    assertEquals(Long.BYTES * i,bufferedReader.position());
    bufferedReader.getLong();
  }
  assertEquals(fileSize,bufferedReader.position());
  try {
    bufferedReader.getLong();
    fail();
  }
 catch (  ReadPastEndException e) {
  }
  assertEquals(fileSize,bufferedReader.position());
}
