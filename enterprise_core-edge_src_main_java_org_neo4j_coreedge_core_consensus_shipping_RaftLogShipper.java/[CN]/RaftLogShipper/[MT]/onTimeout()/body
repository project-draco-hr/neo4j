{
  if (mode == PIPELINE) {
    log.info("%s: timed out, moving to CATCHUP mode",statusAsString());
    mode=Mode.CATCHUP;
    scheduleTimeout(retryTimeMillis);
  }
 else   if (mode == CATCHUP) {
    log.info("%s: timed out, moving to MISMATCH mode",statusAsString());
    mode=Mode.MISMATCH;
  }
  if (lastLeaderContext != null) {
    sendEmpty(lastSentIndex,lastLeaderContext);
  }
}
