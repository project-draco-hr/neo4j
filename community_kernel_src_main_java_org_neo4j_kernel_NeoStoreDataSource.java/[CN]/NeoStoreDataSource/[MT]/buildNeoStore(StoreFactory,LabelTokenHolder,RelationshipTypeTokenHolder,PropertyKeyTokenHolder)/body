{
  final NeoStore neoStore=storeFactory.newNeoStore(false);
  life.add(new LifecycleAdapter(){
    @Override public void start(){
      if (startupStatistics.numberOfRecoveredTransactions() > 0) {
        neoStore.rebuildIdGenerators();
      }
      neoStoreModule.neoStore().makeStoreOk();
      propertyKeyTokenHolder.addTokens(neoStoreModule.neoStore().getPropertyKeyTokenStore().getTokens(Integer.MAX_VALUE));
      relationshipTypeTokens.addTokens(neoStoreModule.neoStore().getRelationshipTypeTokenStore().getTokens(Integer.MAX_VALUE));
      labelTokens.addTokens(neoStoreModule.neoStore().getLabelTokenStore().getTokens(Integer.MAX_VALUE));
      if (neoStore.getCounts() == null) {
        neoStore.rebuildCountStoreIfNeeded(storeFactory.storeFileName(COUNTS_STORE));
      }
    }
  }
);
  return new NeoStoreModule(){
    @Override public NeoStore neoStore(){
      return neoStore;
    }
  }
;
}
