{
  StateHandlingStatementOperations stateHandlingContext=new StateHandlingStatementOperations(storeReadLayer,legacyPropertyTrackers,constraintIndexCreator,legacyIndexStore);
  StatementOperationParts parts=new StatementOperationParts(stateHandlingContext,stateHandlingContext,stateHandlingContext,stateHandlingContext,stateHandlingContext,stateHandlingContext,new SchemaStateConcern(updateableSchemaState),null,stateHandlingContext,stateHandlingContext,stateHandlingContext);
  ConstraintEnforcingEntityOperations constraintEnforcingEntityOperations=new ConstraintEnforcingEntityOperations(constraintSemantics,parts.entityWriteOperations(),parts.entityReadOperations(),parts.schemaWriteOperations(),parts.schemaReadOperations());
  DataIntegrityValidatingStatementOperations dataIntegrityContext=new DataIntegrityValidatingStatementOperations(parts.keyWriteOperations(),parts.schemaReadOperations(),constraintEnforcingEntityOperations);
  parts=parts.override(null,dataIntegrityContext,constraintEnforcingEntityOperations,constraintEnforcingEntityOperations,null,dataIntegrityContext,null,null,null,null,null);
  LockingStatementOperations lockingContext=new LockingStatementOperations(parts.entityReadOperations(),parts.entityWriteOperations(),parts.schemaReadOperations(),parts.schemaWriteOperations(),parts.schemaStateOperations());
  parts=parts.override(null,null,null,lockingContext,lockingContext,lockingContext,lockingContext,lockingContext,null,null,null);
  if (guard != null) {
    GuardingStatementOperations guardingOperations=new GuardingStatementOperations(parts.entityWriteOperations(),parts.entityReadOperations(),guard);
    parts=parts.override(null,null,guardingOperations,guardingOperations,null,null,null,null,null,null,null);
  }
  return parts;
}
