{
  DatabaseReference ref=db;
  if (ref == null) {
    System.out.println("Shutdown attempted before completion of startup");
    throw new IllegalStateException("database has not been started");
  }
  System.out.println("Shutdown started");
  try {
    if (ref.graph != null) {
      ref.graph.shutdown();
    }
 else {
      System.out.println("database has already been shutdown");
    }
  }
  finally {
    db(null);
  }
  System.out.println("Shutdown completed");
  super.shutdown();
}
