{
  long id=record.getId();
  registerIdFromUpdateRecord(id);
  Buffer buffer=window.getOffsettedBuffer(id);
  if (record.inUse() || force) {
    long nextRel=record.getNextRel();
    long nextProp=record.getNextProp();
    short relModifier=nextRel == Record.NO_NEXT_RELATIONSHIP.intValue() ? 0 : (short)((nextRel & 0x700000000L) >> 31);
    short propModifier=nextProp == Record.NO_NEXT_PROPERTY.intValue() ? 0 : (short)((nextProp & 0xF00000000L) >> 28);
    short inUseUnsignedByte=(record.inUse() ? Record.IN_USE : Record.NOT_IN_USE).byteValue();
    inUseUnsignedByte=(short)(inUseUnsignedByte | relModifier | propModifier);
    buffer.put((byte)inUseUnsignedByte).putInt((int)nextRel).putInt((int)nextProp);
    long labelField=record.getLabelField();
    buffer.putInt((int)labelField);
    buffer.put((byte)((labelField & 0xFF00000000L) >> 32));
    byte extra=record.isDense() ? (byte)1 : (byte)0;
    buffer.put(extra);
  }
 else {
    buffer.put(Record.NOT_IN_USE.byteValue());
    if (!isInRecoveryMode()) {
      freeId(id);
    }
  }
}
