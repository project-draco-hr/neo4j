{
  String indexName1="first", indexName2="second", key="name";
{
    BatchInserterIndexProvider provider=new LuceneBatchInserterIndexProvider(inserter);
    BatchInserterIndex index1=provider.nodeIndex(indexName1,LuceneIndexImplementation.EXACT_CONFIG);
    index1.add(0,map(key,"Mattias"));
    BatchInserterIndex index2=provider.nodeIndex(indexName1,LuceneIndexImplementation.EXACT_CONFIG);
    index2.add(0,map(key,"Mattias"));
    provider.shutdown();
    shutdownInserter();
  }
{
    startInserter();
    BatchInserterIndexProvider provider=new LuceneBatchInserterIndexProvider(inserter);
    BatchInserterIndex index2=provider.nodeIndex(indexName2,LuceneIndexImplementation.EXACT_CONFIG);
    index2.add(1,map(key,"Mattias"));
    provider.shutdown();
    shutdownInserter();
  }
{
    switchToGraphDatabaseService();
    try (Transaction transaction=db.beginTx()){
      assertTrue(indexName1 + " should exist",db.index().existsForNodes(indexName1));
      assertTrue(indexName2 + " should exist",db.index().existsForNodes(indexName2));
      transaction.success();
    }
   }
}
