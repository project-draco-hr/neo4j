{
  OnlineBackup backup=portOrNull == null ? OnlineBackup.from(from) : OnlineBackup.from(from,portOrNull.intValue());
  String fromMessage=from + (portOrNull != null ? ":" + backup.getPort() : "");
  try {
    if (targetExists(target)) {
      System.out.println("Doing incremental backup from '" + fromMessage + "'");
      backup.incremental(target);
    }
 else {
      System.out.println("Doing full backup from '" + fromMessage + "'");
      backup.full(target);
    }
    verifyContents(target);
    printCompletionMessage(backup);
  }
 catch (  ComException e) {
    System.out.println("Couldn't connect to '" + fromMessage + "': "+ e.getMessage());
  }
 finally {
    try {
      backup.close();
    }
 catch (    Exception e) {
      System.out.println(e.toString());
    }
  }
}
