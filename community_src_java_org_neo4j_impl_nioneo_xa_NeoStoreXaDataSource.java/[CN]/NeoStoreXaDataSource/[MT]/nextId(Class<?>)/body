{
  Store store=idGenerators.get(clazz);
  if (store == null) {
    throw new IdGenerationFailedException("No IdGenerator for: " + clazz);
  }
  try {
    return store.nextId();
  }
 catch (  IOException e) {
    throw new IdGenerationFailedException(e);
  }
}
