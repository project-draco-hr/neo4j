{
  try (PageCursor cursor=pagedFile.io(0,PF_EXCLUSIVE_LOCK)){
    while (!condition.fulfilled()) {
      int pageNumber=Random.nextInt(maxPages);
      assertTrue("I must be able to access pages",cursor.next(pageNumber));
      int recordNumber=Random.nextInt(recordsPerPage);
      checksumVerifier.verifyChecksum(cursor,recordNumber);
      countUpdater.updateCount(cursor,recordNumber,counterNumber);
      countKeeper.onCounterUpdated(pageNumber,recordNumber,counterNumber);
      assertFalse("Exclusive lock, so never a need to retry",cursor.shouldRetry());
    }
  }
   return null;
}
