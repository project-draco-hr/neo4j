{
  if (!(authSubject instanceof BasicAuthSubject)) {
    throw new IllegalArgumentException("Incorrect AuthSubject type " + authSubject.getClass().getTypeName());
  }
  BasicAuthSubject basicAuthSubject=(BasicAuthSubject)authSubject;
  if (!basicAuthSubject.doesUsernameMatch(username)) {
    throw new AuthorizationViolationException("Invalid attempt to change the password for user " + username);
  }
  return setPassword(username,password);
}
