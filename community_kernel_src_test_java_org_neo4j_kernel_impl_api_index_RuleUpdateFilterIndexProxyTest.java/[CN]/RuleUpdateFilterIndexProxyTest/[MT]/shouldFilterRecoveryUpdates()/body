{
  IndexProxy delegate=mock(IndexProxy.class);
  when(delegate.getDescriptor()).thenReturn(new IndexDescriptor(1337,1337));
  doAnswer(saveUpdatesInLastUpdatesField).when(delegate).recover(anyCollection());
  RuleUpdateFilterIndexProxy indexProxy=new RuleUpdateFilterIndexProxy(delegate);
  assertRecovers(indexProxy,add(1,1337,1,new long[]{1337}));
  assertDoesntRecover(indexProxy,add(1,1336,1,new long[]{1337}));
  assertDoesntRecover(indexProxy,add(1,1337,1,new long[]{1336}));
}
