{
  StoreId storeId=new StoreId(1,1,1,1);
  TransactionApplier transactionApplier=mock(TransactionApplier.class);
  TransactionIdStore transactionIdStore=mock(TransactionIdStore.class);
  when(transactionIdStore.getLastCommittedTransactionId()).thenReturn(2L);
  CommittedTransactionRepresentation tx=mock(CommittedTransactionRepresentation.class);
  LogEntryCommit commitEntry=mock(LogEntryCommit.class);
  when(commitEntry.getTxId()).thenReturn(3L);
  when(tx.getCommitEntry()).thenReturn(commitEntry);
  ApplyPulledTransactions handler=new ApplyPulledTransactions(NullLogProvider.getInstance(),singleton(transactionApplier),singleton(transactionIdStore),new Monitors());
  handler.onTxReceived(new TxPullResponse(storeId,tx));
  verify(transactionApplier).appendToLogAndApplyToStore(any(CommittedTransactionRepresentation.class));
}
