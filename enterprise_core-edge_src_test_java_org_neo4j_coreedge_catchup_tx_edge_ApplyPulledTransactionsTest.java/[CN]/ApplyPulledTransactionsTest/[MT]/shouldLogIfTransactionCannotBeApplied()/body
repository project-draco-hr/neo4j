{
  StoreId storeId=new StoreId(1,1,1,1);
  TransactionApplier transactionApplier=mock(TransactionApplier.class);
  doThrow(TransactionFailureException.class).when(transactionApplier).appendToLogAndApplyToStore(any(CommittedTransactionRepresentation.class));
  LogProvider logProvider=mock(LogProvider.class);
  Log log=mock(Log.class);
  when(logProvider.getLog(ApplyPulledTransactions.class)).thenReturn(log);
  ApplyPulledTransactions handler=new ApplyPulledTransactions(logProvider,singleton(transactionApplier));
  handler.onTxReceived(new TxPullResponse(storeId,mock(CommittedTransactionRepresentation.class)));
  verify(log).error(anyString(),any(Throwable.class));
}
