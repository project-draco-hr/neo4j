{
  Long nextId=nextLocalIdOrNull();
  if (nextId == null) {
    IdAllocation allocation=receiver.receive(broker.getMaster().allocateIds(receiver.getSlaveContext(),idType));
    nextId=storeLocally(allocation);
  }
  return nextId.intValue();
}
