{
  final InMemoryUserRepository users=new InMemoryUserRepository();
  final AuthManager manager=new AuthManager(users,mock(AuthenticationStrategy.class),false);
  manager.start();
  try {
    manager.authenticate("foo","bar");
    fail("exception expected");
  }
 catch (  IllegalStateException e) {
  }
  try {
    manager.newUser("foo","bar",true);
    fail("exception expected");
  }
 catch (  IllegalStateException e) {
  }
  try {
    manager.deleteUser("foo");
    fail("exception expected");
  }
 catch (  IllegalStateException e) {
  }
  try {
    manager.getUser("foo");
    fail("exception expected");
  }
 catch (  IllegalStateException e) {
  }
  try {
    manager.setPassword("foo","bar");
    fail("exception expected");
  }
 catch (  IllegalStateException e) {
  }
  assertTrue(users.numberOfUsers() == 0);
}
