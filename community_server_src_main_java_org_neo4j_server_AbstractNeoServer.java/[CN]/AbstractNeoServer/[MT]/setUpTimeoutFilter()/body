{
  if (!getConfiguration().containsKey(Configurator.WEBSERVER_LIMIT_EXECUTION_TIME_PROPERTY_KEY)) {
    return;
  }
  Guard guard=database.getGraph().getGuard();
  if (guard == null) {
    throw new RuntimeException(format("Inconsistent configuration. In order to use %s, you must set %s.",Configurator.WEBSERVER_LIMIT_EXECUTION_TIME_PROPERTY_KEY,GraphDatabaseSettings.execution_guard_enabled.name()));
  }
  Filter filter=new GuardingRequestFilter(guard,getConfiguration().getInt(Configurator.WEBSERVER_LIMIT_EXECUTION_TIME_PROPERTY_KEY));
  webServer.addFilter(filter,"/*");
}
