{
  TransactionRecordState tx=newWriteTransaction().first();
  int nodeId=5, relId=10, relationshipType=3, propertyKeyId=4, ruleId=8;
  tx.nodeCreate(nodeId);
  tx.createRelationshipTypeToken("type",relationshipType);
  tx.relCreate(relId,0,nodeId,nodeId);
  tx.relAddProperty(relId,propertyKeyId,new long[]{1l << 60,1l << 60,1l << 60,1l << 60,1l << 60,1l << 60,1l << 60,1l << 60,1l << 60,1l << 60});
  tx.createPropertyKeyToken("key",propertyKeyId);
  tx.nodeAddProperty(nodeId,propertyKeyId,"something long and nasty that requires dynamic records for sure I would think and hope. Ok then " + "??????%!=");
  for (int i=0; i < 10; i++) {
    tx.addLabelToNode(10000 + i,nodeId);
  }
  tx.createSchemaRule(indexRule(ruleId,100,propertyKeyId,PROVIDER_DESCRIPTOR));
  PhysicalTransactionRepresentation toCommit=transactionRepresentationOf(tx);
  RecoveryCreatingCopyingNeoCommandHandler recoverer=new RecoveryCreatingCopyingNeoCommandHandler();
  toCommit.accept(recoverer);
  commit(recoverer.getAsRecovered(),TransactionApplicationMode.EXTERNAL);
  assertEquals("NodeStore",nodeId + 1,neoStores.getNodeStore().getHighId());
  assertEquals("DynamicNodeLabelStore",2,neoStores.getNodeStore().getDynamicLabelStore().getHighId());
  assertEquals("RelationshipStore",relId + 1,neoStores.getRelationshipStore().getHighId());
  assertEquals("RelationshipTypeStore",relationshipType + 1,neoStores.getRelationshipTypeTokenStore().getHighId());
  assertEquals("RelationshipType NameStore",2,neoStores.getRelationshipTypeTokenStore().getNameStore().getHighId());
  assertEquals("PropertyStore",2,neoStores.getPropertyStore().getHighId());
  assertEquals("PropertyStore DynamicStringStore",2,neoStores.getPropertyStore().getStringStore().getHighId());
  assertEquals("PropertyStore DynamicArrayStore",2,neoStores.getPropertyStore().getArrayStore().getHighId());
  assertEquals("PropertyIndexStore",propertyKeyId + 1,neoStores.getPropertyKeyTokenStore().getHighId());
  assertEquals("PropertyKeyToken NameStore",2,neoStores.getPropertyStore().getPropertyKeyTokenStore().getNameStore().getHighId());
  assertEquals("SchemaStore",ruleId + 1,neoStores.getSchemaStore().getHighId());
}
