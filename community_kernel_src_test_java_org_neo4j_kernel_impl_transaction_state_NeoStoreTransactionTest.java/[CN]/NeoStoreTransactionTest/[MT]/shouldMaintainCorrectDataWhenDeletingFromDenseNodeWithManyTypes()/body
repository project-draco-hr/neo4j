{
  resetFileSystem();
  instantiateNeoStore(1);
  Pair<TransactionRecordState,NeoStoreTransactionContext> transactionAndContextPair=newWriteTransaction();
  TransactionRecordState tx=transactionAndContextPair.first();
  NeoStoreTransactionContext txCtx=transactionAndContextPair.other();
  long nodeId=nextId(NODE);
  int typeA=0, typeB=12, typeC=600;
  tx.nodeCreate(nodeId);
  tx.createRelationshipTypeToken("A",typeA);
  long[] relationshipsCreatedAIncoming=createRelationships(tx,nodeId,typeA,INCOMING,1);
  long[] relationshipsCreatedAOutgoing=createRelationships(tx,nodeId,typeA,OUTGOING,1);
  tx.createRelationshipTypeToken("B",typeB);
  long[] relationshipsCreatedBIncoming=createRelationships(tx,nodeId,typeB,INCOMING,1);
  long[] relationshipsCreatedBOutgoing=createRelationships(tx,nodeId,typeB,OUTGOING,1);
  tx.createRelationshipTypeToken("C",typeC);
  long[] relationshipsCreatedCIncoming=createRelationships(tx,nodeId,typeC,INCOMING,1);
  long[] relationshipsCreatedCOutgoing=createRelationships(tx,nodeId,typeC,OUTGOING,1);
  deleteRelationship(tx,relationshipsCreatedAIncoming[0]);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeA,1,0);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeB,1,1);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeC,1,1);
  deleteRelationship(tx,relationshipsCreatedAOutgoing[0]);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeA);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeB,1,1);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeC,1,1);
  deleteRelationship(tx,relationshipsCreatedBIncoming[0]);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeA);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeB,1,0);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeC,1,1);
  deleteRelationship(tx,relationshipsCreatedBOutgoing[0]);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeA);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeB);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeC,1,1);
  deleteRelationship(tx,relationshipsCreatedCIncoming[0]);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeA);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeB);
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeC,1,0);
  deleteRelationship(tx,relationshipsCreatedCOutgoing[0]);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeA);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeB);
  assertRelationshipGroupDoesNotExist(txCtx,txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData(),typeC);
}
