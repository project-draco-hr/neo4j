{
  NodeRecord node=neoStore.getNodeStore().getRecord(nodeId);
  assertTrue("Node should be dense, is " + node,node.isDense());
  long groupId=node.getNextRel();
  int cursor=0;
  List<RelationshipGroupRecord> seen=new ArrayList<>();
  while (groupId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    RelationshipGroupRecord group=neoStore.getRelationshipGroupStore().getRecord(groupId);
    seen.add(group);
    assertEquals("Invalid type, seen groups so far " + seen,types[cursor++],group.getType());
    groupId=group.getNext();
  }
  assertEquals("Not enough relationship group records found in chain for " + node,types.length,cursor);
}
