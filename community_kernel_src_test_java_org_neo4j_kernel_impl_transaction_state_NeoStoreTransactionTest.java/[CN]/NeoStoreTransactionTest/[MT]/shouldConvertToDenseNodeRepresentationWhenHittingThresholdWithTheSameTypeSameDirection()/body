{
  resetFileSystem();
  instantiateNeoStore(8);
  Pair<TransactionRecordState,NeoStoreTransactionContext> transactionContextPair=newWriteTransaction();
  TransactionRecordState tx=transactionContextPair.first();
  NeoStoreTransactionContext txCtx=transactionContextPair.other();
  long nodeId=nextId(NODE);
  int typeA=0;
  tx.nodeCreate(nodeId);
  tx.createRelationshipTypeToken("A",typeA);
  createRelationships(tx,nodeId,typeA,OUTGOING,8);
  assertFalse(txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData().isDense());
  createRelationships(tx,nodeId,typeA,OUTGOING,1);
  assertTrue(txCtx.getNodeRecords().getOrLoad(nodeId,null).forReadingData().isDense());
  assertDenseRelationshipCounts(tx,txCtx,nodeId,typeA,9,0);
}
