{
  NeoStoreIndexStoreView storeView=new NeoStoreIndexStoreView(locks,neoStore);
  SchemaIndexProviderMap providerMap=new DefaultSchemaIndexProviderMap(NO_INDEX_PROVIDER);
  Logging logging=new SingleLoggingService(DEV_NULL);
  IndexingService.Monitor monitor=IndexingService.NO_MONITOR;
  UpdateableSchemaState updateableSchemaState=new KernelSchemaStateStore();
  IndexSamplingSetup samplingSetup=new IndexSamplingSetup(new IndexSamplingConfig(new Config()),storeView,null,mock(TokenNameLookup.class),logging);
  return new CapturingIndexingService(samplingSetup,new IndexProxySetup(samplingSetup,storeView,providerMap,updateableSchemaState,null,null,logging),providerMap,storeView,Collections.<IndexRule>emptyList(),logging,monitor);
}
