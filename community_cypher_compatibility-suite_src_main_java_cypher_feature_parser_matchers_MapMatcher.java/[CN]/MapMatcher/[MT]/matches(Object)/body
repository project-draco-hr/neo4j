{
  if (value instanceof Map) {
    Map<String,Object> realMap=(Map<String,Object>)value;
    Set<String> expectedKeys=map.keySet();
    Set<String> actualKeys=realMap.keySet();
    boolean match=expectedKeys.equals(actualKeys);
    if (match) {
      for (      String key : expectedKeys) {
        match&=map.get(key).matches(realMap.get(key));
      }
      return match;
    }
  }
  return false;
}
