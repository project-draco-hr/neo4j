{
  int port;
  for (port=minPort; port <= maxPort; port++) {
    if (except.contains(port)) {
      continue;
    }
    try {
      ServerSocket socket=new ServerSocket(port);
      socket.close();
      return port;
    }
 catch (    IOException ex) {
      except.add(port);
    }
  }
  throw new IOException("No open port could be found");
}
