{
  if (direction == null) {
    return defaultDirection;
  }
  Direction result=null;
  try {
    result=Direction.valueOf(direction.toUpperCase());
  }
 catch (  Exception e) {
    if (direction.equalsIgnoreCase("o")) {
      result=Direction.OUTGOING;
    }
 else     if (direction.equalsIgnoreCase("i")) {
      result=Direction.INCOMING;
    }
  }
  if (result == null) {
    throw new ShellException("Unknown direction " + direction + " (may be "+ directionAlternatives()+ ")");
  }
  return result;
}
