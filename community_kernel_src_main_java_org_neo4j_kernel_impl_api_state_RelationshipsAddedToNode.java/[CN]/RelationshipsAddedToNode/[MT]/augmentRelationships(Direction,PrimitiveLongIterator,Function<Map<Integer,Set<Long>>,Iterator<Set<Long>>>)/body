{
switch (direction) {
case INCOMING:
    if (incoming != null) {
      rels=augmentPrimitiveIterator(rels,typeFilter.apply(incoming()));
    }
  break;
case OUTGOING:
if (outgoing != null) {
  rels=augmentPrimitiveIterator(rels,typeFilter.apply(outgoing()));
}
break;
case BOTH:
if (outgoing != null) {
rels=augmentPrimitiveIterator(rels,typeFilter.apply(outgoing()));
}
if (incoming != null) {
rels=augmentPrimitiveIterator(rels,typeFilter.apply(incoming()));
}
break;
}
if (loops != null) {
rels=augmentPrimitiveIterator(rels,loops().values().iterator());
}
return rels;
}
