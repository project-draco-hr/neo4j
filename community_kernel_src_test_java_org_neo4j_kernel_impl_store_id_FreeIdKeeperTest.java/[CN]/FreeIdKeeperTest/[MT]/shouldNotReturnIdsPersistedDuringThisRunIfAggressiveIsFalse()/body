{
  FileSystemAbstraction fs=new EphemeralFileSystemAbstraction();
  StoreChannel channel=spy(fs.open(new File("id.file"),"rw"));
  int threshold=10;
  FreeIdKeeper keeper=new FreeIdKeeper(channel,threshold,false);
  for (int i=0; i < threshold; i++) {
    keeper.freeId(i);
  }
  verify(channel,times(1)).write(any(ByteBuffer.class));
  assertEquals(NO_RESULT,keeper.getId());
}
