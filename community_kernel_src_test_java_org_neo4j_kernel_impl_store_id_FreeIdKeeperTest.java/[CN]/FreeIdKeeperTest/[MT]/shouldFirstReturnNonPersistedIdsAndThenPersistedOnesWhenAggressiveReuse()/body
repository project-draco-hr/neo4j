{
  FileSystemAbstraction fs=new EphemeralFileSystemAbstraction();
  StoreChannel channel=fs.open(new File("id.file"),"rw");
  int threshold=10;
  FreeIdKeeper keeper=new FreeIdKeeper(channel,threshold,true);
  for (int i=0; i < threshold; i++) {
    keeper.freeId(i);
  }
  int extraIds=3;
  for (int i=threshold; i < threshold + extraIds; i++) {
    keeper.freeId(i);
  }
  for (int i=threshold; i < threshold + extraIds; i++) {
    assertEquals(i,keeper.getId());
  }
  for (int i=0; i < threshold; i++) {
    assertEquals(i,keeper.getId());
  }
}
