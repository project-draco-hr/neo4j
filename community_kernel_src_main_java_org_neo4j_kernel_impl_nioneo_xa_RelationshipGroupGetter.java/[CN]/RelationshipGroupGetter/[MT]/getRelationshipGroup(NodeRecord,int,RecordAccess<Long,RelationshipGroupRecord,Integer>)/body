{
  long groupId=node.getNextRel();
  long previousGroupId=Record.NO_NEXT_RELATIONSHIP.intValue();
  RecordProxy<Long,RelationshipGroupRecord,Integer> previous=null, current=null;
  while (groupId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    current=relGroupRecords.getOrLoad(groupId,null);
    RelationshipGroupRecord record=current.forReadingData();
    record.setPrev(previousGroupId);
    if (record.getType() == type) {
      return new RelationshipGroupPosition(previous,current);
    }
 else     if (record.getType() > type) {
      return new RelationshipGroupPosition(previous,null);
    }
    previousGroupId=groupId;
    groupId=record.getNext();
    previous=current;
  }
  return new RelationshipGroupPosition(previous,null);
}
