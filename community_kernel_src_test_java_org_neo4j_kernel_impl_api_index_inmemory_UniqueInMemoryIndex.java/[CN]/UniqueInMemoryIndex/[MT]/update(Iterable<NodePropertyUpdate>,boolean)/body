{
  PropertyUpdateUniquenessValidator.validateUniqueness(updates,UniqueInMemoryIndex.this);
  for (  NodePropertyUpdate update : updates) {
switch (update.getUpdateMode()) {
case CHANGED:
case REMOVED:
      remove(update.getNodeId(),update.getValueBefore());
  }
}
for (NodePropertyUpdate update : updates) {
switch (update.getUpdateMode()) {
case ADDED:
case CHANGED:
    add(update.getNodeId(),update.getValueAfter(),applyIdempotently);
}
}
}
