{
  ConsistencySummaryStatistics summary=new ConsistencySummaryStatistics();
  ConsistencyReporter reporter=new ConsistencyReporter(new DirectRecordAccess(diffs),new InconsistencyReport(new InconsistencyMessageLogger(logger),summary));
  StoreProcessor processor=new StoreProcessor(reporter);
  diffs.applyToAll(processor);
  if (0 == summary.getInconsistencyCountForRecordType(RecordType.SCHEMA)) {
    performFullCheckOfSchemaStore(diffs,reporter,processor);
  }
  return summary;
}
