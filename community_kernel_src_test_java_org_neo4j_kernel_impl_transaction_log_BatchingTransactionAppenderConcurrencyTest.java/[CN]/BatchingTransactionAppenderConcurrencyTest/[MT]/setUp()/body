{
  WritableLogChannel channel=new InMemoryLogChannel(){
    @Override public void force() throws IOException {
      try {
        forceSemaphore.release();
        channelCommandQueue.put(ChannelCommand.force);
      }
 catch (      InterruptedException e) {
        throw new IOException(e);
      }
    }
    @Override public void emptyBufferIntoChannelAndClearIt(){
      try {
        channelCommandQueue.put(ChannelCommand.emptyBufferIntoChannelAndClearIt);
      }
 catch (      InterruptedException e) {
        throw new RuntimeException(e);
      }
    }
  }
;
  when(logFile.getWriter()).thenReturn(channel);
}
