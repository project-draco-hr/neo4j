{
  ClassLoader contextClassLoader=Thread.currentThread().getContextClassLoader();
  try {
    Thread.currentThread().setContextClassLoader(new ServiceBlockClassLoader(contextClassLoader));
    FooService fooService=Service.load(FooService.class,"foo");
    assertTrue(fooService instanceof BarService);
  }
  finally {
    Thread.currentThread().setContextClassLoader(contextClassLoader);
  }
}
