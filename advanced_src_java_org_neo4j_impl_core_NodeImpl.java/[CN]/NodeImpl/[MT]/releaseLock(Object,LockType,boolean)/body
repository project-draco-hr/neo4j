{
  try {
    TransactionIsolationLevel level=TransactionFactory.getTransactionIsolationLevel();
    if (level == TransactionIsolationLevel.READ_COMMITTED) {
      if (lockType == LockType.READ) {
        LockManager.getManager().releaseReadLock(resource);
      }
 else       if (lockType == LockType.WRITE) {
        if (forceRelease) {
          LockManager.getManager().releaseWriteLock(resource);
        }
 else {
          CommandManager.getManager().addLockToTransaction(resource,lockType);
        }
      }
 else {
        throw new RuntimeException("Unkown lock type: " + lockType);
      }
    }
 else     if (level == TransactionIsolationLevel.BAD) {
      CommandManager.getManager().addLockToTransaction(resource,lockType);
    }
 else {
      throw new RuntimeException("Unkown transaction isolation level, " + level);
    }
  }
 catch (  NotInTransactionException e) {
    e.printStackTrace();
    throw new RuntimeException("Unable to get transaction isolation level.",e);
  }
catch (  LockNotFoundException e) {
    throw new RuntimeException("Unable to release locks.",e);
  }
catch (  IllegalResourceException e) {
    throw new RuntimeException("Unable to release locks.",e);
  }
}
