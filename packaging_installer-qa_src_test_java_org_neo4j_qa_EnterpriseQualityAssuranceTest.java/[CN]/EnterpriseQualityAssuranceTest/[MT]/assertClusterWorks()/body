{
  int rounds=4;
  long nodeId=-1;
  for (int i=0; i < drivers.length * rounds; i++) {
    EnterpriseDriver driver=drivers[i % drivers.length];
    try {
switch (i % 4) {
case 0:
        nodeId=driver.api().createNode();
      break;
case 1:
    driver.api().waitUntilNodeExists(nodeId);
  break;
case 2:
driver.api().waitUntilNodeExists(nodeId);
driver.api().deleteNode(nodeId);
break;
case 3:
driver.api().waitUntilNodeDoesNotExist(nodeId);
break;
}
}
 catch (Exception e) {
throw new RuntimeException("Ensuring HA cluster works failed while executing request on server " + driver.vm().definition().vmName() + ". See nested exception.",e);
}
}
}
