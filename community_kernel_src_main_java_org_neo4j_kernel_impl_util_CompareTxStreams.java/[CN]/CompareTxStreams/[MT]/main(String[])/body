{
  LogExtractor extractor1=null;
  LogExtractor extractor2=null;
  try {
    extractor1=LogExtractor.from(args[0]);
    extractor2=LogExtractor.from(args[1]);
    boolean branchingDetected=false;
    long lastTx=1;
    while (true) {
      long tx1=extractor1.extractNext(new InMemoryLogBuffer());
      long tx2=extractor2.extractNext(new InMemoryLogBuffer());
      if (tx1 != tx2)       throw new RuntimeException("Differing tx " + tx1 + " and "+ tx2);
      if (tx1 == -1 || tx2 == -1)       break;
      lastTx=tx1;
      if (!branchingDetected) {
        if (extractor1.getLastStartEntry().getMasterId() != extractor2.getLastStartEntry().getMasterId() || extractor1.getLastTxChecksum() != extractor2.getLastTxChecksum()) {
          branchingDetected=true;
          System.out.println("Branch at " + tx1 + ": masters:"+ extractor1.getLastStartEntry().getMasterId()+ ","+ extractor2.getLastStartEntry().getMasterId()+ " checksums:"+ extractor1.getLastTxChecksum()+ ","+ extractor2.getLastTxChecksum());
        }
      }
 else {
        if (extractor1.getLastStartEntry().getMasterId() == extractor2.getLastStartEntry().getMasterId() && extractor1.getLastTxChecksum() == extractor2.getLastTxChecksum()) {
          branchingDetected=false;
          System.out.println("Merged again at " + tx1);
        }
 else {
          System.out.println("Still branched at " + tx1 + ": masters:"+ extractor1.getLastStartEntry().getMasterId()+ ","+ extractor2.getLastStartEntry().getMasterId()+ " checksums:"+ extractor1.getLastTxChecksum()+ ","+ extractor2.getLastTxChecksum());
        }
      }
    }
    System.out.println("Last tx " + lastTx);
  }
  finally {
    closeExtractor(extractor1);
    closeExtractor(extractor2);
  }
}
