{
  HEvent prev=history.getAndSet(event);
  event.prev=prev == null ? end : prev;
  return event;
}
