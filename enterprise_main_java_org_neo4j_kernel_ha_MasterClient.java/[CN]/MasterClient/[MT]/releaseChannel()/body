{
synchronized (channels) {
    Triplet<Channel,ChannelBuffer,ByteBuffer> channel=channels.remove(Thread.currentThread());
    if (channel != null) {
      if (unusedChannels.size() < 5) {
        unusedChannels.push(channel);
      }
 else {
        channel.first().close();
        activeChannels--;
      }
      channels.notify();
    }
  }
}
