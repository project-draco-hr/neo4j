{
  if (protocol.isExpecting(NextMessage.TX_STREAM_FINISHED)) {
    long lastTransactionIdSent=msg.readLong();
    boolean success=msg.readBoolean();
    out.add(new TxStreamFinishedResponse(lastTransactionIdSent,success));
  }
 else {
    out.add(Unpooled.copiedBuffer(msg));
  }
}
