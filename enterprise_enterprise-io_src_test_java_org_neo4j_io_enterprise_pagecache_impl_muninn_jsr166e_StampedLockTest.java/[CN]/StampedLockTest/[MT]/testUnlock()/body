{
  StampedLock lock=new StampedLock();
  assertFalse(lock.isWriteLocked());
  assertFalse(lock.isReadLocked());
  assertEquals(lock.getReadLockCount(),0);
  long s=lock.writeLock();
  assertTrue(lock.isWriteLocked());
  assertFalse(lock.isReadLocked());
  assertEquals(lock.getReadLockCount(),0);
  lock.unlock(s);
  assertFalse(lock.isWriteLocked());
  assertFalse(lock.isReadLocked());
  assertEquals(lock.getReadLockCount(),0);
  long rs=lock.readLock();
  assertFalse(lock.isWriteLocked());
  assertTrue(lock.isReadLocked());
  assertEquals(lock.getReadLockCount(),1);
  lock.unlock(rs);
  assertFalse(lock.isWriteLocked());
  assertFalse(lock.isReadLocked());
  assertEquals(lock.getReadLockCount(),0);
}
