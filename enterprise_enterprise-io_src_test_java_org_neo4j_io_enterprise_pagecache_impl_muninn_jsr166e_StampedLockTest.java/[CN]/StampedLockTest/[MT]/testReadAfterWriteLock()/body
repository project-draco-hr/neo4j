{
  final StampedLock lock=new StampedLock();
  final long s=lock.writeLock();
  Thread t1=newStartedThread(new CheckedRunnable(){
    public void realRun(){
      long rs=lock.readLock();
      lock.unlockRead(rs);
    }
  }
);
  Thread t2=newStartedThread(new CheckedRunnable(){
    public void realRun(){
      long rs=lock.readLock();
      lock.unlockRead(rs);
    }
  }
);
  releaseWriteLock(lock,s);
  awaitTermination(t1);
  awaitTermination(t2);
}
