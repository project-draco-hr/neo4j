{
  StampedLock lock=new StampedLock();
  long s, p;
  assertTrue((p=lock.tryOptimisticRead()) != 0L);
  assertTrue((s=lock.writeLock()) != 0L);
  assertFalse(lock.validate(p));
  assertFalse((p=lock.tryOptimisticRead()) != 0L);
  assertTrue(lock.validate(s));
  lock.unlockWrite(s);
}
