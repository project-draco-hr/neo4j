{
  if (event.getNewState() == event.getOldState()) {
    return;
  }
switch (event.getNewState()) {
case TO_MASTER:
    shutdownCurrent();
  delegate.setDelegate(current=life.add(getMasterImpl()));
life.start();
break;
case TO_SLAVE:
shutdownCurrent();
delegate.setDelegate(current=life.add(getSlaveImpl(event.getServerHaUri())));
life.start();
break;
case PENDING:
shutdownCurrent();
break;
}
}
