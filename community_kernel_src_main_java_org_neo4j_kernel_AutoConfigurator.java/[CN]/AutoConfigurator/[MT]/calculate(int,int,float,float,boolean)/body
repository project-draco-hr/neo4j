{
  int size;
  if (storeSize > (memLeft * use)) {
    size=(int)(memLeft * use);
  }
 else   if (canExpand) {
    if (storeSize * expand * 5 < memLeft * use) {
      size=(int)(memLeft * use / 5);
    }
 else {
      size=(int)(memLeft * use);
    }
  }
 else {
    size=storeSize;
  }
  return size;
}
