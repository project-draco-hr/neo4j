{
  try {
    Xid xid=new XidImpl(new byte[4],new byte[4]);
    XAResource xaRes=xaCon.getXaResource();
    xaRes.start(xid,XAResource.TMNOFLAGS);
    int node1=ds.nextId(Node.class);
    xaCon.getNodeConsumer().createNode(node1);
    xaRes.end(xid,XAResource.TMSUCCESS);
    xaRes.prepare(xid);
    xaCon.clearAllTransactions();
    copyLogicalLog();
    xaCon.clearAllTransactions();
    ds.close();
    deleteLogicalLogIfExist();
    renameCopiedLogicalLog();
    truncateLogicalLog(32);
    truncateLogicalLog(40);
    ds=new NeoStoreXaDataSource("neo","nioneo_logical.log",lockManager,lockReleaser);
    xaCon=(NeoStoreXaConnection)ds.getXaConnection();
    xaRes=xaCon.getXaResource();
    assertEquals(0,xaRes.recover(XAResource.TMNOFLAGS).length);
    xaCon.clearAllTransactions();
  }
 catch (  Exception e) {
    e.printStackTrace();
    fail("" + e);
  }
}
