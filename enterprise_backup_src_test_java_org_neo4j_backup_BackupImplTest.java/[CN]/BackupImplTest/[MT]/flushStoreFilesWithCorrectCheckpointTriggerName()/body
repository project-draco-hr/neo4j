{
  StoreCopyServer storeCopyServer=mock(StoreCopyServer.class);
  when(storeCopyServer.flushStoresAndStreamStoreFiles(anyString(),any(StoreWriter.class),anyBoolean())).thenReturn(RequestContext.EMPTY);
  BackupImpl backup=new BackupImpl(storeCopyServer,new Monitors(),mock(LogicalTransactionStore.class),mock(TransactionIdStore.class),mock(LogFileInformation.class),defaultStoreIdSupplier());
  backup.fullBackup(mock(StoreWriter.class),false).close();
  verify(storeCopyServer).flushStoresAndStreamStoreFiles(eq(BackupImpl.FULL_BACKUP_CHECKPOINT_TRIGGER),any(StoreWriter.class),eq(false));
}
