{
  HostnamePort localhost=new HostnamePort("localhost",9000);
  ServerBootstrap bootstrap=mock(ServerBootstrap.class);
  Channel channel=mock(Channel.class);
  when(bootstrap.bind(new InetSocketAddress("localhost",9000))).thenReturn(channel);
  Connection connection=new PortRangeSocketBinder(bootstrap).bindToFirstAvailablePortInRange(localhost);
  assertEquals(channel,connection.getChannel());
  assertEquals(new InetSocketAddress("localhost",9000),connection.getSocketAddress());
}
