{
  super.writeEntity(relationship);
  if (relationship.hasSpecificId()) {
    channel.put(SPECIFIC_ID);
    channel.putLong(relationship.specificId());
  }
 else {
    channel.put(UNSPECIFIED_ID);
  }
  writeGroup(relationship.startNodeGroup(),0);
  writeGroup(relationship.endNodeGroup(),1);
  writeValue(relationship.startNode());
  writeValue(relationship.endNode());
  if (relationship.hasTypeId()) {
    channel.put(HAS_TYPE_ID);
    channel.putInt(relationship.typeId());
  }
 else {
    if (previousType != null && relationship.type().equals(previousType)) {
      channel.put(SAME_TYPE);
    }
 else {
      channel.put(NEW_TYPE);
      writeToken(previousType=relationship.type());
    }
  }
}
