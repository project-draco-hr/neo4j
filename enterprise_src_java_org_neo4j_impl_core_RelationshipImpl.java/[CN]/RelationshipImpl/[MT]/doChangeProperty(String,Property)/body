{
  if (propertyMap.containsKey(key)) {
    Property oldValue=propertyMap.get(key);
    if (!oldValue.getValue().getClass().equals(newValue.getValue().getClass())) {
      throw new IllegalValueException("New value[" + newValue.getValue() + " not same type as old value["+ oldValue.getValue()+ "]");
    }
    propertyMap.put(key,newValue);
    return oldValue;
  }
  throw new NotFoundException("Property not found: " + key);
}
