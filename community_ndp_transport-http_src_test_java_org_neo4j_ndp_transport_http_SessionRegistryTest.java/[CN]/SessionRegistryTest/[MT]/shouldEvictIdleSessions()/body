{
  when(session.key()).thenReturn("1234");
  when(environment.newSession()).thenReturn(session);
  FakeClock clock=new FakeClock();
  org.neo4j.ndp.transport.http.SessionRegistry registry=new SessionRegistry(environment,clock);
  String sessionKey=registry.create();
  clock.forward(61,TimeUnit.SECONDS);
  registry.destroyIdleSessions(60,TimeUnit.SECONDS);
  verify(session).close();
  assertFalse(registry.acquire(sessionKey).sessionExists());
}
