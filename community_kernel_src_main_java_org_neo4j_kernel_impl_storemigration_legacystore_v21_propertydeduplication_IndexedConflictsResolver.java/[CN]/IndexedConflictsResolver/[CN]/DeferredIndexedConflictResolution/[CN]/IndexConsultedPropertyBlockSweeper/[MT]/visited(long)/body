{
  PropertyRecord record=propertyStore.getRecord(recordId);
  boolean changed=false;
  List<PropertyBlock> blocks=record.getPropertyBlocks();
  ListIterator<PropertyBlock> it=blocks.listIterator();
  while (it.hasNext()) {
    PropertyBlock block=it.next();
    Object lastPropertyValue=propertyStore.getValue(block);
    try {
      if (index.contains(nodeRecord.getId(),lastPropertyValue) && !foundExact) {
        foundExact=true;
      }
 else {
        it.remove();
        changed=true;
      }
    }
 catch (    IOException e) {
      throw new InnerIterationIOException(e);
    }
  }
  if (changed) {
    propertyStore.updateRecord(record);
    if (blocks.isEmpty()) {
      propertyRemover.fixUpPropertyLinksAroundUnusedRecord(nodeRecord,record);
    }
  }
}
