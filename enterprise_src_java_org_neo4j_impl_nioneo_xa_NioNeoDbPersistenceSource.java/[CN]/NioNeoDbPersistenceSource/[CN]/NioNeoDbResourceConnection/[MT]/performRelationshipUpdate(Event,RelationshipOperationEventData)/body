{
  try {
    if (event == Event.RELATIONSHIP_ADD_PROPERTY) {
      int propertyId=propStore.nextId();
      relConsumer.addProperty(data.getRelationshipId(),propertyId,data.getPropertyIndex(),data.getProperty());
      data.setNewPropertyId(propertyId);
    }
 else     if (event == Event.RELATIONSHIP_CHANGE_PROPERTY) {
      relConsumer.changeProperty(data.getRelationshipId(),data.getPropertyId(),data.getProperty());
    }
 else     if (event == Event.RELATIONSHIP_REMOVE_PROPERTY) {
      relConsumer.removeProperty(data.getRelationshipId(),data.getPropertyId());
    }
 else     if (event == Event.RELATIONSHIP_DELETE) {
      int relId=data.getRelationshipId();
      relConsumer.deleteRelationship(relId);
    }
 else     if (event == Event.RELATIONSHIP_CREATE) {
      int firstNodeId=data.getStartNodeId();
      int secondNodeId=data.getEndNodeId();
      relConsumer.createRelationship(data.getRelationshipId(),firstNodeId,secondNodeId,data.getTypeId());
    }
 else {
      throw new PersistenceUpdateFailedException("Unkown event: " + event);
    }
  }
 catch (  Exception t) {
    throw new PersistenceUpdateFailedException("Event[" + event + "]",t);
  }
}
