{
  commit();
  DummyTransactionEventHandler<Object> handler=new DummyTransactionEventHandler<Object>(null);
  getGraphDb().registerTransactionEventHandler(handler);
  getGraphDb().registerTransactionEventHandler(handler);
  newTransaction();
  commit();
  assertEquals(Integer.valueOf(0),handler.beforeCommit);
  assertEquals(Integer.valueOf(1),handler.afterCommit);
  assertNull(handler.afterRollback);
  getGraphDb().unregisterTransactionEventHandler(handler);
}
