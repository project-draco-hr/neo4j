{
  Iterator<Map<String,Object>> errors=((List<Map<String,Object>>)response.get("errors")).iterator();
  Iterator<StatusCode> expected=iterator(expectedErrors);
  while (expected.hasNext()) {
    assertTrue(errors.hasNext());
    assertThat((String)errors.next().get("code"),equalTo(expected.next().getCode()));
  }
  if (errors.hasNext()) {
    Map<String,Object> error=errors.next();
    fail("Expected no more errors, but got " + error.get("code") + " - '"+ error.get("message")+ "'.");
  }
}
