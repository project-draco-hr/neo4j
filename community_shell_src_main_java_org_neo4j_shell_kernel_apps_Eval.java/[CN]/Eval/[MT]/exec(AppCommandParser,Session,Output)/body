{
  boolean satisfied=parser.getLine().endsWith("\n") || (parser.getLineWithoutApp().length() > 0 && parser.getLine().indexOf('\n') == -1);
  if (!satisfied)   return Continuation.INPUT_INCOMPLETE;
  scripting=scripting != null ? scripting : new ScriptEngineViaReflection(getServer());
  String javascriptCode=parser.getLineWithoutApp();
  javascriptCode=decorateWithImports(javascriptCode,STANDARD_EVAL_IMPORTS);
  Object scriptEngine=scripting.getJavascriptEngine();
  scripting.addDefaultContext(scriptEngine,session,out);
  Object result=scripting.interpret(scriptEngine,javascriptCode);
  if (result != null) {
    out.println(result.toString());
  }
  return Continuation.INPUT_COMPLETE;
}
