{
  if (direction == DirectionWrapper.BOTH) {
    return getRelationshipCount(node,DirectionWrapper.OUTGOING.getNextRel(group)) + getRelationshipCount(node,DirectionWrapper.INCOMING.getNextRel(group)) + getRelationshipCount(node,DirectionWrapper.BOTH.getNextRel(group));
  }
  return getRelationshipCount(node,direction.getNextRel(group)) + getRelationshipCount(node,DirectionWrapper.BOTH.getNextRel(group));
}
