{
  RelationshipRecord record=relRecords.getOrLoad(id,null).forChangingLinkage();
  if (!record.inUse()) {
    throw new IllegalStateException("Unable to delete relationship[" + id + "] since it is already deleted.");
  }
  ArrayMap<Integer,DefinedProperty> propertyMap=getAndDeletePropertyChain(record);
  disconnectRelationship(record);
  updateNodesForDeletedRelationship(record);
  record.setInUse(false);
  return propertyMap;
}
