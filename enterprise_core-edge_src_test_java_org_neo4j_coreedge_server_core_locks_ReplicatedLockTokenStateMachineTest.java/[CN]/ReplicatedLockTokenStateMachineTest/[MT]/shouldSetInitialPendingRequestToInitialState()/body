{
  StateStorage<ReplicatedLockTokenState<Object>> storage=mock(StateStorage.class);
  CoreMember initialHoldingCoreMember=new CoreMember(new AdvertisedSocketAddress("1"),new AdvertisedSocketAddress("2"));
  ReplicatedLockTokenState<Object> initialState=new ReplicatedLockTokenState<>(123,3,initialHoldingCoreMember);
  when(storage.getInitialState()).thenReturn(initialState);
  PendingLockTokensRequests<Object> lockRequests=new PendingLockTokensRequests<>();
  new ReplicatedLockTokenStateMachine<>(storage,lockRequests);
  LockToken initialToken=lockRequests.currentToken();
  assertEquals(initialState.get().owner(),initialToken.owner());
  assertEquals(initialState.get().id(),initialToken.id());
}
