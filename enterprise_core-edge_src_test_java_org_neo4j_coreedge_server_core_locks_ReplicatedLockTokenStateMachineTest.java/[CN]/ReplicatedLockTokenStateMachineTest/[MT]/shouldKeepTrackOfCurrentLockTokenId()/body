{
  ReplicatedLockTokenStateMachine stateMachine=new ReplicatedLockTokenStateMachine<>(new InMemoryStateStorage<>(new ReplicatedLockTokenState<>()));
  int firstCandidateId=stateMachine.nextCandidateId();
  stateMachine.applyCommand(new ReplicatedLockTokenRequest<>(member(0),firstCandidateId),1);
  assertEquals(firstCandidateId,stateMachine.currentToken().id());
  stateMachine.applyCommand(new ReplicatedLockTokenRequest<>(member(0),firstCandidateId + 1),2);
  assertEquals(firstCandidateId + 1,stateMachine.currentToken().id());
}
