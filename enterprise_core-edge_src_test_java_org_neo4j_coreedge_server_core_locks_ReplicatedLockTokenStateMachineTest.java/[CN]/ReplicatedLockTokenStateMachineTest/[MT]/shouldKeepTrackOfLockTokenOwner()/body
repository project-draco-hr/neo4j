{
  ReplicatedLockTokenStateMachine stateMachine=new ReplicatedLockTokenStateMachine<>(new StubStateStorage<>(new InMemoryReplicatedLockTokenState<RaftTestMember>()));
  int firstCandidateId=stateMachine.nextCandidateId();
  stateMachine.applyCommand(new ReplicatedLockTokenRequest<>(member(0),firstCandidateId),1);
  assertEquals(member(0),stateMachine.currentToken().owner());
  stateMachine.applyCommand(new ReplicatedLockTokenRequest<>(member(1),firstCandidateId + 1),2);
  assertEquals(member(1),stateMachine.currentToken().owner());
}
