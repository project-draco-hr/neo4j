{
  FakeClock clock=new FakeClock();
  Authentication auth=new Authentication(clock,new InMemoryUserRepository(),3);
  auth.authenticate("wrong","wrong");
  auth.authenticate("wrong","wrong");
  auth.authenticate("wrong","wrong");
  try {
    auth.authenticate("wrong","wrong");
    fail("Shouldn't have been allowed");
  }
 catch (  TooManyAuthenticationAttemptsException e) {
    assertThat(e.getMessage(),equalTo("Too many failed authentication requests. Please try again in 5 seconds."));
  }
  clock.forward(6,TimeUnit.SECONDS);
  assertFalse(auth.authenticate("wrong","wrong"));
}
