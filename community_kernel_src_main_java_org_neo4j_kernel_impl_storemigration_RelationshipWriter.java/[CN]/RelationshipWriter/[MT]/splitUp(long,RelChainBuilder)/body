{
  final Map<Integer,Relationships> result=new HashMap<>();
  records.accept(new Visitor<RelationshipRecord,RuntimeException>(){
    @Override public boolean visit(    RelationshipRecord record) throws RuntimeException {
      Integer type=record.getType();
      Relationships relationships=result.get(type);
      if (relationships == null) {
        relationships=new Relationships(nodeId);
        result.put(type,relationships);
      }
      relationships.add(record);
      return false;
    }
  }
);
  return result;
}
