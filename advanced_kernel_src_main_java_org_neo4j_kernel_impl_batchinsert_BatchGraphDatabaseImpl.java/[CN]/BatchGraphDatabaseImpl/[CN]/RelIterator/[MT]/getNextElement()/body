{
  while (nextElement == null && relItr.hasNext()) {
    Relationship possibleRel=graphDbService.getRelationshipById(relItr.next());
    if (dir == Direction.OUTGOING && possibleRel.getEndNode().getId() == nodeId) {
      continue;
    }
    if (dir == Direction.INCOMING && possibleRel.getStartNode().getId() == nodeId) {
      continue;
    }
    if (types != null) {
      for (      RelationshipType type : types) {
        if (type.name().equals(possibleRel.getType().name())) {
          nextElement=possibleRel;
          break;
        }
      }
    }
 else {
      nextElement=possibleRel;
    }
  }
}
