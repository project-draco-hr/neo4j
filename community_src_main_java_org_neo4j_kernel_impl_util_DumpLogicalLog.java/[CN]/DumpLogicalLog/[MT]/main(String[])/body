{
  String fileName=args[0];
  boolean single=false;
  int startIndex=0;
  if (args[0].equals("-single")) {
    single=true;
    fileName=args[1];
    startIndex=1;
  }
  for (int i=startIndex; i < args.length; i++) {
    fileName=args[i];
    FileChannel fileChannel=new RandomAccessFile(fileName,"r").getChannel();
    ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
    buffer.clear();
    if (!single) {
      buffer.limit(16);
      if (fileChannel.read(buffer) != 16) {
        System.out.println("Unable to read timestamp information, " + "no records in logical log.");
        fileChannel.close();
        return;
      }
      buffer.flip();
      long logVersion=buffer.getLong();
      long prevLastCommittedTx=buffer.getLong();
      System.out.println("Logical log version: " + logVersion + " with prev committed tx["+ prevLastCommittedTx+ "]");
    }
    long logEntriesFound=0;
    XaCommandFactory cf=new CommandFactory();
    while (readEntry(fileChannel,buffer,cf)) {
      logEntriesFound++;
    }
    System.out.println("Internal recovery completed, scanned " + logEntriesFound + " log entries.");
    fileChannel.close();
  }
}
