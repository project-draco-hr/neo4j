{
  int recordsPerPage=cursor.getCurrentPageSize() / getRecordSize();
  for (int pageRecordId=0; pageRecordId < recordsPerPage; pageRecordId++) {
    int recordId=(int)(cursor.getCurrentPageId() * recordsPerPage + pageRecordId);
    Record expectedRecord=createRecord(cursor.getCurrentFile(),recordId);
    Record actualRecord;
    int offset=cursor.getOffset();
    do {
      cursor.setOffset(offset);
      actualRecord=readRecord(cursor);
    }
 while (cursor.shouldRetry());
    assertThat(actualRecord,isOneOf(expectedRecord,zeroRecord()));
  }
}
