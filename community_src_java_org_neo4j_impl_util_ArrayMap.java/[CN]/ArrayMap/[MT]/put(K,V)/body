{
  for (int i=0; i < arrayCount; i++) {
    if (arrayEntries[i].getKey().equals(key)) {
      arrayEntries[i].setNewValue(value);
      return;
    }
  }
  if (arrayCount != -1) {
    if (arrayCount < arrayEntries.length) {
      arrayEntries[arrayCount++]=new ArrayEntry<K,V>(key,value);
    }
 else {
      if (useThreadSafeMap) {
        propertyMap=new ConcurrentHashMap<K,V>();
      }
 else {
        propertyMap=new HashMap<K,V>();
      }
      for (int i=0; i < arrayCount; i++) {
        propertyMap.put(arrayEntries[i].getKey(),arrayEntries[i].getValue());
      }
      arrayEntries=null;
      arrayCount=-1;
      propertyMap.put(key,value);
    }
  }
 else {
    propertyMap.put(key,value);
  }
}
