{
  filterNeostoreLogicalLog(dir,new Predicate<LogEntry>(){
    private final Set<Integer> prune=new HashSet<Integer>();
    @Override public boolean accept(    LogEntry item){
      if (item instanceof TwoPhaseCommit) {
        prune.add(item.getIdentifier());
        return false;
      }
 else       if (prune.contains(item.getIdentifier()))       return false;
      return true;
    }
  }
);
}
