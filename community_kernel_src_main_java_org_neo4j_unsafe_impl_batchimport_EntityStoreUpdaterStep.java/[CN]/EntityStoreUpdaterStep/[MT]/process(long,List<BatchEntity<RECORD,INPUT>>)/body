{
  propertyRecords.close();
  long highestId=0;
  for (  BatchEntity<RECORD,INPUT> entity : batch) {
    RECORD record=entity.record();
    PropertyBlock[] propertyBlocks=entity.getPropertyBlocks();
    if (propertyBlocks.length > 0) {
      reassignDynamicRecordIds(propertyBlocks);
      long firstProp=propertyCreator.createPropertyChain(record,blockIterator.dressArray(propertyBlocks),propertyRecords);
      record.setNextProp(firstProp);
    }
    highestId=max(highestId,record.getId());
    entityStore.updateRecord(record);
  }
  entityStore.setHighestPossibleIdInUse(highestId);
  for (  PropertyRecord propertyRecord : propertyRecords.records()) {
    propertyStore.updateRecord(propertyRecord);
  }
  return null;
}
