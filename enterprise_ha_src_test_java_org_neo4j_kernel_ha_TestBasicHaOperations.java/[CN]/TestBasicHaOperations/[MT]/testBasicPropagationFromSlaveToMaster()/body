{
  clusterManager=new ClusterManager(clusterOfSize(2),dir.cleanDirectory("propagation"),stringMap(HaSettings.tx_push_factor.name(),"1"));
  clusterManager.start();
  ClusterManager.ManagedCluster cluster=clusterManager.getDefaultCluster();
  cluster.await(ClusterManager.allSeesAllAsAvailable());
  HighlyAvailableGraphDatabase master=cluster.getMaster();
  HighlyAvailableGraphDatabase slave=cluster.getAnySlave();
  long nodeId;
  try (Transaction tx=master.beginTx()){
    Node node=master.createNode();
    nodeId=node.getId();
    node.setProperty("foo","bar");
    tx.success();
  }
   try (Transaction tx=master.beginTx()){
    master.getNodeById(nodeId).getProperty("foo");
    tx.success();
  }
   slave.getDependencyResolver().resolveDependency(UpdatePullerClient.class).pullUpdates();
  try (Transaction tx=slave.beginTx()){
    slave.getNodeById(nodeId).setProperty("foo","bar2");
    tx.success();
  }
   try (Transaction tx=master.beginTx()){
    assertEquals("bar2",master.getNodeById(nodeId).getProperty("foo"));
    tx.success();
  }
 }
