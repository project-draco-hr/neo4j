{
  String key="name";
  String value="Neo";
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(serverPath.getPath()).setConfig(OnlineBackupSettings.online_backup_enabled,GraphDatabaseSetting.TRUE).newGraphDatabase();
  Index<Node> index=db.index().forNodes(key);
  Transaction tx=db.beginTx();
  Node node=db.createNode();
  node.setProperty(key,value);
  tx.success();
  tx.finish();
  OnlineBackup.from("127.0.0.1").full(backupPath.getPath());
  assertEquals(DbRepresentation.of(db),DbRepresentation.of(backupPath));
  FileUtils.deleteDirectory(new File(backupPath.getPath()));
  OnlineBackup.from("127.0.0.1").full(backupPath.getPath());
  assertEquals(DbRepresentation.of(db),DbRepresentation.of(backupPath));
  tx=db.beginTx();
  index.add(node,key,value);
  tx.success();
  tx.finish();
  FileUtils.deleteDirectory(new File(backupPath.getPath()));
  OnlineBackup backup=OnlineBackup.from("127.0.0.1").full(backupPath.getPath());
  assertTrue("Should be consistent",backup.isConsistent());
  assertEquals(DbRepresentation.of(db),DbRepresentation.of(backupPath));
  db.shutdown();
}
