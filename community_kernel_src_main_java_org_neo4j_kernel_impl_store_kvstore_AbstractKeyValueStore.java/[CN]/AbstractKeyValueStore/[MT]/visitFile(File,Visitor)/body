{
  try (KeyValueStoreFile file=rotationStrategy.openStoreFile(path)){
    if (visitor instanceof MetadataVisitor) {
      ((MetadataVisitor)visitor).visitMetadata(path,file.headers(),file.entryCount());
    }
    try (DataProvider provider=file.dataProvider()){
      transfer(provider,visitor);
    }
   }
 }
