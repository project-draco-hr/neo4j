{
  try (KeyValueStoreFile<MetaData> file=state.openStoreFile(path)){
    if (visitor instanceof MetadataVisitor<?>) {
      @SuppressWarnings("unchecked") MetadataVisitor<MetaData> metadataVisitor=(MetadataVisitor<MetaData>)visitor;
      metadataVisitor.visitMetadata(path,file.metadata(),file.recordCount());
    }
    try (DataProvider provider=file.dataProvider()){
      transfer(provider,visitor);
    }
   }
 }
