{
  try (LockWrapper lock=writeLock(updateLock)){
    return state.resetter(lock.get(),new Runnable(){
      @Override public void run(){
        try {
          prepareRotation(version(headers())).rotate();
        }
 catch (        IOException e) {
          throw new UnderlyingStorageException(e);
        }
      }
    }
);
  }
 }
