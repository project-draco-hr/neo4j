{
  boolean isSuccess=true;
  if (applier != null) {
    if (cancelTasks) {
      applier.shutdownNow();
    }
 else {
      applier.shutdown();
    }
    if (!applier.awaitTermination(1,HOURS)) {
      log.error("Applier did not terminate in 1 hour.");
      isSuccess=false;
    }
  }
  if (willContinue) {
    applier=newSingleThreadExecutor(new NamedThreadFactory("core-state-applier"));
  }
  return isSuccess;
}
