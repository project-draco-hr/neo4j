{
  try (RaftLogCursor cursor=raftLog.getEntryCursor(lastApplied + 1)){
    lastApplyingStorage.persistStoreData(lastToApply);
    while (cursor.next() && lastApplied < lastToApply) {
      if (cursor.get().content() instanceof DistributedOperation) {
        DistributedOperation distributedOperation=(DistributedOperation)cursor.get().content();
        progressTracker.trackReplication(distributedOperation);
        handleOperation(lastApplied + 1,distributedOperation);
        lastApplied++;
        maybeFlush();
      }
      if (Thread.interrupted()) {
        throw new InterruptedException(format("Interrupted while applying at lastApplied=%d with lastToApply=%d",lastApplied,lastToApply));
      }
    }
  }
 }
