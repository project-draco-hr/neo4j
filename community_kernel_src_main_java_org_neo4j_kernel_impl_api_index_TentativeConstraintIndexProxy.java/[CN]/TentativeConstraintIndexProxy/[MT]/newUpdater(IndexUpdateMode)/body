{
switch (mode) {
case ONLINE:
    return new CollectingIndexUpdater(){
      @Override public void close() throws IOException {
        try {
          target.accessor.updateAndCommit(updates);
        }
 catch (        IndexEntryConflictException conflict) {
          failures.add(conflict);
        }
      }
    }
;
case RECOVERY:
  return super.newUpdater(mode);
default :
throw new ThisShouldNotHappenError("Stefan","Unsupported IndexUpdateMode");
}
}
