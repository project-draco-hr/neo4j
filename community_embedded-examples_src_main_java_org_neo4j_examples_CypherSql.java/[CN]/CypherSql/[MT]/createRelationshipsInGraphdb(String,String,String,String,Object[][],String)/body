{
  try (Transaction tx=graphdb.beginTx()){
    RelationshipType type=DynamicRelationshipType.withName(relationshipType);
    for (    Object[] relationship : relationships) {
      Node sourceNode=graphdb.findNode(DynamicLabel.label(sourceEntity),sourceMatchAttribute,relationship[0]);
      Node targetNode=graphdb.findNode(DynamicLabel.label(targetEntity),targetMatchAttribute,relationship[1]);
      sourceNode.createRelationshipTo(targetNode,type);
    }
    tx.success();
  }
 }
