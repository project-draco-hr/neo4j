{
  try (Transaction tx=graphdb.beginTx()){
    RelationshipType type=DynamicRelationshipType.withName(relationshipType);
    for (    Object[] relationship : relationships) {
      Node sourceNode=graphdb.findNodesByLabelAndProperty(DynamicLabel.label(sourceEntity),sourceMatchAttribute,relationship[0]).iterator().next();
      Node targetNode=graphdb.findNodesByLabelAndProperty(DynamicLabel.label(targetEntity),targetMatchAttribute,relationship[1]).iterator().next();
      sourceNode.createRelationshipTo(targetNode,type);
    }
    tx.success();
  }
 }
