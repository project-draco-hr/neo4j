{
  try (Transaction tx=graphdb.beginTx()){
    RelationshipType type=DynamicRelationshipType.withName(relationshipType);
    for (    Object[] relationship : relationships) {
      Node sourceNode=graphdb.findNodes(DynamicLabel.label(sourceEntity),sourceMatchAttribute,relationship[0]).next();
      Node targetNode=graphdb.findNodes(DynamicLabel.label(targetEntity),targetMatchAttribute,relationship[1]).next();
      sourceNode.createRelationshipTo(targetNode,type);
    }
    tx.success();
  }
 }
