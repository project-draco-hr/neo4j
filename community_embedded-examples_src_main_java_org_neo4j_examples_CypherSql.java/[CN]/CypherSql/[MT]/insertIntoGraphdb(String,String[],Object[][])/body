{
  Transaction tx=graphdb.beginTx();
  try {
    Index<Node> index=graphdb.index().forNodes(tableName);
    for (    Object[] value : values) {
      Node node=graphdb.createNode();
      for (int i=0; i < fields.length; i++) {
        node.setProperty(fields[i],value[i]);
        if (i == 0) {
          index.add(node,fields[i],value[i]);
        }
      }
    }
    tx.success();
  }
  finally {
    tx.finish();
  }
}
