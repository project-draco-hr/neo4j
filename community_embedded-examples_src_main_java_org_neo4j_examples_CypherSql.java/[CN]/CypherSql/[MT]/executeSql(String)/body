{
  StringBuilder builder=new StringBuilder(512);
  Statement statement=sqldb.createStatement();
  if (statement.execute(sql)) {
    ResultSet result=statement.getResultSet();
    ResultSetMetaData meta=result.getMetaData();
    int rowCount=0;
    int columnCount=meta.getColumnCount();
    String line=new String(new char[columnCount]).replace("\0","+" + LINE_SEGMENT) + "+\n";
    builder.append(line);
    for (int i=1; i <= columnCount; i++) {
      String output=meta.getColumnLabel(i);
      printColumn(builder,output);
    }
    builder.append("|\n").append(line);
    while (result.next()) {
      rowCount++;
      for (int i=1; i <= columnCount; i++) {
        String output=result.getString(i);
        printColumn(builder,output);
      }
      builder.append("|\n");
    }
    result.close();
    builder.append(line).append(rowCount).append(" rows\n");
  }
 else {
    throw new RuntimeException("Couldn't execute: " + sql);
  }
  statement.close();
  return builder.toString();
}
