{
  StringBuilder builder=new StringBuilder(512);
  Statement statement=null;
  try {
    statement=sqldb.createStatement();
    if (statement.execute(sql)) {
      ResultSet result=null;
      try {
        result=statement.getResultSet();
        ResultSetMetaData meta=result.getMetaData();
        int rowCount=0;
        int columnCount=meta.getColumnCount();
        String line=new String(new char[columnCount]).replace("\0","+" + LINE_SEGMENT) + "+\n";
        builder.append(line);
        for (int i=1; i <= columnCount; i++) {
          String output=meta.getColumnLabel(i);
          printColumn(builder,output);
        }
        builder.append("|\n").append(line);
        while (result.next()) {
          rowCount++;
          for (int i=1; i <= columnCount; i++) {
            String output=result.getString(i);
            printColumn(builder,output);
          }
          builder.append("|\n");
        }
        builder.append(line).append(rowCount).append(" rows\n");
      }
  finally {
        if (result != null) {
          result.close();
        }
      }
    }
 else {
      throw new RuntimeException("Couldn't execute: " + sql);
    }
  }
  finally {
    if (statement != null) {
      statement.close();
    }
  }
  return builder.toString();
}
