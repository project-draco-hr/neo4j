{
  Map<String,String> config=new HashMap<String,String>();
  config.put(Config.RELATIONSHIP_KEYS_NON_INDEXABLE,"relPropNonIndexable");
  config.put(Config.NODE_AUTO_INDEXING,"true");
  config.put(Config.RELATIONSHIP_AUTO_INDEXING,"true");
  EmbeddedGraphDatabase graphDb=new EmbeddedGraphDatabase(getStoreDir("testSemantics"),config);
  AutoIndexer<Node> nodeAutoIndexer=graphDb.index().getNodeAutoIndexer();
  Node node1=null, node2=null;
  Transaction tx=graphDb.beginTx();
  try {
    node1=graphDb.createNode();
    node1.setProperty("nodeProp1","value1");
    assertFalse(nodeAutoIndexer.getAutoIndex().get("nodeProp1","value1").hasNext());
    tx.success();
  }
 catch (  Exception e) {
    tx.failure();
  }
 finally {
    tx.finish();
  }
  nodeAutoIndexer.startIgnoringProperty("nodeProp1");
  tx=graphDb.beginTx();
  try {
    node2=graphDb.createNode();
    node2.setProperty("nodeProp1","value1");
    tx.success();
  }
 catch (  Exception e) {
    tx.failure();
  }
 finally {
    tx.finish();
  }
  assertEquals(node1,nodeAutoIndexer.getAutoIndex().get("nodeProp1","value1").getSingle());
  tx=graphDb.beginTx();
  try {
    node1.setProperty("nodeProp1","value2");
    tx.success();
  }
 catch (  Exception e) {
    tx.failure();
  }
 finally {
    tx.finish();
  }
  assertEquals(node1,nodeAutoIndexer.getAutoIndex().get("nodeProp1","value1").getSingle());
  graphDb.shutdown();
}
