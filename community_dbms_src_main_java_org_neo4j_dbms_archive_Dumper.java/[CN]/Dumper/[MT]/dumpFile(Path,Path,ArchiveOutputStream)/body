{
  try {
    ArchiveEntry entry=createEntry(file,root,archive);
    archive.putArchiveEntry(entry);
    if (isRegularFile(file)) {
      writeFile(file,archive);
    }
    archive.closeArchiveEntry();
  }
 catch (  IOException e) {
    throw new TunnellingException(e);
  }
}
