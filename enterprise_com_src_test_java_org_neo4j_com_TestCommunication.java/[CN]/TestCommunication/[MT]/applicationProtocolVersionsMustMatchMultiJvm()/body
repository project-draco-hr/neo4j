{
  ServerInterface server=new MadeUpServerProcess().start(new StartupData(storeIdToUse.getCreationTime(),storeIdToUse.getRandomId(),storeIdToUse.getStoreVersion(),INTERNAL_PROTOCOL_VERSION,(byte)(APPLICATION_PROTOCOL_VERSION + 1)));
  server.awaitStarted();
  MadeUpClient client=new MadeUpClient(MadeUpServerProcess.PORT,storeIdToUse,INTERNAL_PROTOCOL_VERSION,APPLICATION_PROTOCOL_VERSION);
  try {
    client.multiply(10,20);
    fail("Shouldn't be able to communicate with different application protocol versions");
  }
 catch (  IllegalProtocolVersionException e) {
  }
  client.shutdown();
  server.shutdown();
}
