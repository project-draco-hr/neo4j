{
  final File logDirectory=TargetDirectory.forTest(this.getClass()).directory("givenExplicitlyEnabledServerLoggingConfigurationShouldLogAccess-logdir",true);
  FileUtils.forceMkdir(logDirectory);
  final File confDir=TargetDirectory.forTest(this.getClass()).directory("givenExplicitlyEnabledServerLoggingConfigurationShouldLogAccess-confdir",true);
  FileUtils.forceMkdir(confDir);
  final File configFile=HTTPLoggingPreparednessRuleTest.createConfigFile(HTTPLoggingPreparednessRuleTest.createLogbackConfigXml(logDirectory),confDir);
  final String query="?explicitlyEnabled=" + UUID.randomUUID().toString();
  NeoServer server=ServerBuilder.server().withDefaultDatabaseTuning().withProperty(Configurator.HTTP_LOGGING,"true").withProperty(Configurator.HTTP_LOG_CONFIG_LOCATION,configFile.getPath()).usingDatabaseDir(TargetDirectory.forTest(this.getClass()).directory("givenExplicitlyEnabledServerLoggingConfigurationShouldLogAccess-dbdir",true).getAbsolutePath()).build();
  try {
    server.start();
    FunctionalTestHelper functionalTestHelper=new FunctionalTestHelper(server);
    JaxRsResponse response=new RestRequest().get(functionalTestHelper.webAdminUri() + query);
    assertEquals(200,response.getStatus());
    response.close();
    assertEventually("request appears in log",5,new Condition(){
      public boolean evaluate(){
        return occursIn(query,new File(logDirectory,"http.log"));
      }
    }
);
  }
  finally {
    server.stop();
  }
}
