{
  Args arguments=new Args(args);
  boolean full=arguments.has(FULL);
  boolean incremental=arguments.has(INCREMENTAL);
  if (full & incremental || !(full | incremental)) {
    System.out.println("Specify either " + dash(FULL) + " or "+ dash(INCREMENTAL));
    exitAbnormally();
  }
  String from=arguments.get(FROM,null);
  String fromHa=arguments.get(FROM_HA,null);
  if ((from != null && fromHa != null) || (from == null && fromHa == null)) {
    System.out.println("Specify either " + dash(FROM) + " or "+ dash(FROM_HA));
    exitAbnormally();
  }
  String to=arguments.get(TO,null);
  if (to == null) {
    System.out.println("Specify target location with " + dash(TO) + " <target-directory>");
    exitAbnormally();
  }
  if (fromHa != null) {
    try {
      System.out.println("Asking ZooKeeper service at '" + fromHa + "' for master");
      from=getMasterServerInCluster(fromHa);
      System.out.println("Found master '" + from + "' in cluster");
    }
 catch (    ComException e) {
      System.out.println(e.getMessage());
      exitAbnormally();
    }
catch (    RuntimeException e) {
      if (e.getCause() instanceof KeeperException) {
        KeeperException zkException=(KeeperException)e.getCause();
        System.out.println("Couldn't connect to '" + fromHa + "', "+ zkException.getMessage());
        exitAbnormally();
      }
      throw e;
    }
  }
  doBackup(full,from,to);
}
