{
  Pair<Map<String,String>,Boolean> config=getOrCreateIndexConfig(Node.class,indexName,customConfiguration);
  try {
    return getIndexProvider(config.first().get(PROVIDER)).nodeIndex(indexName,config.first());
  }
 catch (  RuntimeException e) {
    if (config.other()) {
      indexStore.remove(Node.class,indexName);
    }
    throw e;
  }
}
