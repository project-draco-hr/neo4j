{
  while (this.version <= logVersion) {
    long result=collectNextFromCurrentSource(target);
    if (result != -1) {
      if (previousCommitEntry != null && result == previousCommitEntry.getTxId())       continue;
      if (result != nextExpectedTxId) {
        throw new RuntimeException("Expected txId " + nextExpectedTxId + ", but got "+ result+ " (starting from "+ startTxId+ ")"+ " "+ counter+ ", "+ previousCommitEntry+ ", "+ lastCommitEntry);
      }
      nextExpectedTxId++;
      counter++;
      return result;
    }
    if (this.version < logVersion) {
      continueInNextLog();
    }
  }
  return -1;
}
