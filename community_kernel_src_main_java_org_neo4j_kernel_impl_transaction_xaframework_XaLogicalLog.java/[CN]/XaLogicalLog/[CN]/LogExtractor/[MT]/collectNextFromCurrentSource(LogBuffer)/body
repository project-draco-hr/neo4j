{
  LogEntry entry;
  while ((entry=LogIoUtils.readEntry(localBuffer,source,cf)) != null) {
    if (collector.collect(entry,target)) {
      previousCommitEntry=lastCommitEntry;
      LogIoUtils.writeLogEntry(new LogEntry.Done(collector.getIdentifier()),target);
      lastCommitEntry=(LogEntry.Commit)entry;
      return lastCommitEntry.getTxId();
    }
  }
  return -1;
}
