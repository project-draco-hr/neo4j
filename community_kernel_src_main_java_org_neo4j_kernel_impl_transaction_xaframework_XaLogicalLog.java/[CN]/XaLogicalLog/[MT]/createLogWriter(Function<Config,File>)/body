{
  return new LogBufferFactory(){
    @Override public LogBuffer createActiveLogFile(    Config config,    long prevCommittedId) throws IllegalStateException, IOException {
      File activeLogFile=new XaLogicalLogFiles(logBasePath.apply(config),fileSystem).getLog1FileName();
      StoreChannel channel=fileSystem.create(activeLogFile);
      ByteBuffer scratch=ByteBuffer.allocateDirect(128);
      writeLogHeader(scratch,0,prevCommittedId);
      while (scratch.hasRemaining()) {
        channel.writeAll(scratch);
      }
      scratch.clear();
      return new DirectLogBuffer(channel,scratch);
    }
  }
;
}
