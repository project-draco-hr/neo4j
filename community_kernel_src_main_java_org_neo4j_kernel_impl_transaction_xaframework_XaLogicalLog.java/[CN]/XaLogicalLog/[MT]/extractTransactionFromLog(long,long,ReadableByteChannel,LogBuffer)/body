{
  LogEntry entry;
  TxPosition txPosition=txStartPositionCache.get(txId);
  LogEntryCollector collector=txPosition != null ? new KnownIdentifierCollector(txPosition.identifier,targetBuffer) : new KnownTxIdCollector(txId,targetBuffer);
  LogEntry.Commit commitEntry=null;
  ByteBuffer localBuffer=ByteBuffer.allocate(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
  while ((entry=LogIoUtils.readEntry(localBuffer,logChannel,cf)) != null && commitEntry == null) {
    if (collector.collect(entry)) {
      if (entry instanceof LogEntry.Commit) {
        commitEntry=(LogEntry.Commit)entry;
      }
    }
  }
  if (commitEntry == null) {
    msgLog.logMessage("txId=" + txId + " not found in log="+ expectedVersion,true);
    throw new IOException("Transaction[" + txId + "] not found in log ("+ expectedVersion+ ") "+ "current version is ("+ this.logVersion+ ")");
  }
  if (targetBuffer != null) {
    LogIoUtils.writeLogEntry(new LogEntry.Done(collector.getIdentifier()),targetBuffer);
  }
  return commitEntry;
}
