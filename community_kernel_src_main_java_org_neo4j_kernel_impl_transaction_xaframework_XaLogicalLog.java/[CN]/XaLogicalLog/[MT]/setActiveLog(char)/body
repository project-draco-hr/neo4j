{
  if (c != CLEAN && c != LOG1 && c != LOG2) {
    throw new IllegalArgumentException("Log must be either clean, " + "1 or 2");
  }
  if (c == currentLog) {
    throw new IllegalStateException("Log should not be equal to " + "current " + currentLog);
  }
  ByteBuffer bb=ByteBuffer.wrap(new byte[4]);
  bb.asCharBuffer().put(c).flip();
  StoreChannel fc=fileSystem.open(new File(fileName.getPath() + ".active"),"rw");
  int wrote=fc.write(bb);
  if (wrote != 4) {
    throw new IllegalStateException("Expected to write 4 -> " + wrote);
  }
  fc.force(false);
  fc.close();
  currentLog=c;
}
