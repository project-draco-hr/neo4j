{
  long logEntriesFound=0;
  scanIsComplete=false;
  LogApplier logApplier=new LogApplier(byteChannel);
  int xidIdent=getNextIdentifier();
  long startEntryPosition=writeBuffer.getFileChannelPosition();
  while (logApplier.readAndWriteAndApplyEntry(xidIdent)) {
    logEntriesFound++;
  }
  byteChannel.close();
  scanIsComplete=true;
  LogEntry.Start startEntry=logApplier.startEntry;
  if (startEntry == null) {
    throw new IOException("Unable to find start entry");
  }
  startEntry.setStartPosition(startEntryPosition);
  cacheTxStartPosition(logApplier.commitEntry.getTxId(),logApplier.commitEntry.getMasterId(),startEntry);
  checkLogRotation();
}
