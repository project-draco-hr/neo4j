{
  LogEntry.Start startEntry=xidIdentMap.get(identifier);
  logChannel.position(startEntry.getStartPosition());
  LogEntry entry;
  boolean found=false;
  long startedAt=sharedBuffer.position();
  while ((entry=LogIoUtils.readEntry(sharedBuffer,logChannel,commandReader)) != null) {
    if (entry.getIdentifier() != identifier) {
      continue;
    }
    if (entry instanceof LogEntry.Prepare) {
      break;
    }
    if (entry instanceof LogEntry.Start || entry instanceof LogEntry.Command) {
      LogIoUtils.writeLogEntry(entry,targetBuffer,commandWriter);
      found=true;
    }
 else {
      throw new RuntimeException("Expected start or command entry but found: " + entry);
    }
  }
  bufferMonitor.bytesRead(sharedBuffer.position() - startedAt);
  if (!found) {
    throw new IOException("Transaction for internal identifier[" + identifier + "] not found in current log");
  }
}
