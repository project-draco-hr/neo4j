{
  try {
    scanIsComplete=false;
    int xidIdent=getNextIdentifier();
    LogDeserializer logApplier=getLogDeserializer(byteChannel,xidIdent);
    LogEntry.Start startEntry=logApplier.getStartEntry();
    if (!filter.accept(startEntry))     return false;
    long startEntryPosition=writeBuffer.getFileChannelPosition();
    boolean successfullyApplied=false;
    try {
      logApplier.apply();
      successfullyApplied=true;
    }
  finally {
      if (!successfullyApplied && logApplier.getStartEntry() != null && xidIdentMap.get(xidIdent) != null) {
        try {
          xaRm.forget(logApplier.getStartEntry().getXid());
        }
 catch (        XAException e) {
          throw new IOException(e);
        }
 finally {
          xidIdentMap.remove(xidIdent);
        }
      }
    }
    scanIsComplete=true;
    startEntry.setStartPosition(startEntryPosition);
    cacheTxStartPosition(logApplier.getCommitEntry().getTxId(),startEntry);
    checkLogRotation();
    return true;
  }
  finally {
    byteChannel.close();
  }
}
