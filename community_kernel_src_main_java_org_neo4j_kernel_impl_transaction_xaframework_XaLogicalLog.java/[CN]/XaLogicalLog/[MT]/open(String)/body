{
  fileChannel=new RandomAccessFile(fileToOpen,"rw").getChannel();
  if (fileChannel.size() != 0) {
    nonCleanShutdown=true;
    doingRecovery=true;
    try {
      doInternalRecovery(fileToOpen);
    }
  finally {
      doingRecovery=false;
    }
  }
 else {
    logVersion=xaTf.getCurrentVersion();
    long lastTxId=xaTf.getLastCommittedTx();
    LogIoUtils.writeLogHeader(sharedBuffer,logVersion,lastTxId);
    previousLogLastCommittedTx=lastTxId;
    logHeaderCache.put(logVersion,previousLogLastCommittedTx);
    fileChannel.write(sharedBuffer);
    scanIsComplete=true;
    msgLog.logMessage("Opened [" + fileToOpen + "] clean empty log, version="+ logVersion+ ", lastTxId="+ lastTxId,true);
  }
}
