{
switch (logFiles.determineState()) {
case LEGACY_WITHOUT_LOG_ROTATION:
    open(fileName);
  break;
case NO_ACTIVE_FILE:
open(logFiles.getLog1FileName());
setActiveLog(LOG1);
break;
case CLEAN:
String newLog=logFiles.getLog1FileName();
renameIfExists(newLog);
renameIfExists(logFiles.getLog2FileName());
open(newLog);
setActiveLog(LOG1);
break;
case DUAL_LOGS_LOG_1_ACTIVE:
fixDualLogFiles(logFiles.getLog1FileName(),logFiles.getLog2FileName());
case LOG_1_ACTIVE:
currentLog=LOG1;
open(logFiles.getLog1FileName());
break;
case DUAL_LOGS_LOG_2_ACTIVE:
fixDualLogFiles(logFiles.getLog2FileName(),logFiles.getLog1FileName());
case LOG_2_ACTIVE:
currentLog=LOG2;
open(logFiles.getLog2FileName());
break;
default :
throw new IllegalStateException("FATAL: Unrecognized logical log state.");
}
instantiateCorrectWriteBuffer();
}
