{
  ReadableByteChannel log=null;
  try {
    ByteBuffer buffer=LogExtractor.newLogReaderBuffer();
    log=getLogicalLog(version);
    VersionAwareLogEntryReader.readLogHeader(buffer,log,true);
    LogDeserializer deserializer=new LogDeserializer(buffer,commandReaderFactory);
    TimeWrittenConsumer consumer=new TimeWrittenConsumer();
    try (Cursor<LogEntry,IOException> cursor=deserializer.cursor(log)){
      while (cursor.next(consumer))       ;
    }
     return consumer.getTimeWritten();
  }
  finally {
    if (log != null) {
      log.close();
    }
  }
}
