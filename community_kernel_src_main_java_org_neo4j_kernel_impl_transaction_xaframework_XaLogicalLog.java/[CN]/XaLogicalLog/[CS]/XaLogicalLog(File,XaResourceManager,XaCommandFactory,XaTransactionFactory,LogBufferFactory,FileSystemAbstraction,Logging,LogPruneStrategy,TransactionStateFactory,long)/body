{
  this.fileName=fileName;
  this.xaRm=xaRm;
  this.cf=cf;
  this.xaTf=xaTf;
  this.logBufferFactory=logBufferFactory;
  this.fileSystem=fileSystem;
  this.pruneStrategy=pruneStrategy;
  this.stateFactory=stateFactory;
  this.rotateAtSize=rotateAtSize;
  this.autoRotate=rotateAtSize > 0;
  this.logFiles=new XaLogicalLogFiles(fileName,fileSystem);
  sharedBuffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
  msgLog=logging.getMessagesLog(getClass());
  this.partialTransactionCopier=new PartialTransactionCopier(sharedBuffer,cf,msgLog,positionCache,this,xidIdentMap);
}
