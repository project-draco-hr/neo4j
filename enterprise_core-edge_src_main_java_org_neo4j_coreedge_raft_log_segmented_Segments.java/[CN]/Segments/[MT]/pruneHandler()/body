{
  Iterator<SegmentFile> filesItr=segmentFiles.iterator();
  SegmentFile segment;
  while (filesItr.hasNext() && (segment=filesItr.next()).isDisposed()) {
    segment.delete();
    Iterator<Map.Entry<Long,SegmentFile>> rangeItr=rangeMap.entrySet().iterator();
    Map.Entry<Long,SegmentFile> firstRange=Iterators.firstOrNull(rangeItr);
    if (firstRange != null && firstRange.getValue() == segment) {
      rangeItr.remove();
    }
    filesItr.remove();
  }
}
