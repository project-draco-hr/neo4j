{
  if (password == null || password.isEmpty()) {
    throw new IllegalCredentialsException("Password cannot be empty.");
  }
  BasicAuthSubject basicAuthSubject=BasicAuthSubject.castOrFail(authSubject);
  if (basicAuthSubject.credentialsMatchesPassword(password)) {
    throw new IllegalCredentialsException("Old password and new password cannot be the same.");
  }
}
