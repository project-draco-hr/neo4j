{
  if (this.directory == null) {
    return new Pair<Set<Long>,TxData>(Collections.<Long>emptySet(),this);
  }
  try {
    Hits hits=new Hits(searcher(),query,null);
    HashSet<Long> result=new HashSet<Long>();
    for (int i=0; i < hits.length(); i++) {
      result.add(Long.parseLong(hits.doc(i).getField(LuceneIndex.KEY_DOC_ID).stringValue()));
    }
    return new Pair<Set<Long>,TxData>(result,this);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
