{
  if (this.directory == null) {
    return new Pair<Collection<Long>,TxData>(Collections.<Long>emptySet(),this);
  }
  try {
    Sort sorting=contextOrNull != null ? contextOrNull.sorting : null;
    boolean prioritizeCorrectness=contextOrNull == null || !contextOrNull.tradeCorrectnessForSpeed;
    Hits hits=new Hits(searcher(prioritizeCorrectness),query,null,sorting,prioritizeCorrectness);
    Collection<Long> result=new ArrayList<Long>();
    for (int i=0; i < hits.length(); i++) {
      result.add(Long.parseLong(hits.doc(i).getField(LuceneIndex.KEY_DOC_ID).stringValue()));
    }
    return new Pair<Collection<Long>,TxData>(result,this);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
