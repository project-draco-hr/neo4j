{
  try {
    ensureLuceneDataInstantiated();
    Document document=LuceneDataSource.findDocument(index.type,searcher(),entityId);
    if (document != null) {
      index.type.removeFromDocument(document,key,value);
      if (LuceneDataSource.documentIsEmpty(document)) {
        writer.deleteDocuments(index.type.idTerm(entityId));
      }
 else {
        writer.updateDocument(index.type.idTerm(entityId),document);
      }
    }
    invalidateSearcher();
    return this;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
