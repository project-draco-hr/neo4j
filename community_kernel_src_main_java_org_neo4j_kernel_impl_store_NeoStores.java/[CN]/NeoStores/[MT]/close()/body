{
  if (relTypeTokenNameStore != null) {
    relTypeTokenNameStore.close();
    relTypeTokenNameStore=null;
  }
  if (relTypeStore != null) {
    relTypeStore.close();
    relTypeStore=null;
  }
  if (labelTokenNamesStore != null) {
    labelTokenNamesStore.close();
    labelTokenNamesStore=null;
  }
  if (labelTokenStore != null) {
    labelTokenStore.close();
    labelTokenStore=null;
  }
  if (propertyKeyTokenNamesStore != null) {
    propertyKeyTokenNamesStore.close();
    propertyKeyTokenNamesStore=null;
  }
  if (propertyKeyTokenStore != null) {
    propertyKeyTokenStore.close();
    propertyKeyTokenStore=null;
  }
  if (propertyArrayStore != null) {
    propertyArrayStore.close();
    propertyArrayStore=null;
  }
  if (propertyStringStore != null) {
    propertyStringStore.close();
    propertyStringStore=null;
  }
  if (propStore != null) {
    propStore.close();
    propStore=null;
  }
  if (relationshipStore != null) {
    relationshipStore.close();
    relationshipStore=null;
  }
  if (nodeLabelStore != null) {
    nodeLabelStore.close();
    nodeLabelStore=null;
  }
  if (nodeStore != null) {
    nodeStore.close();
    nodeStore=null;
  }
  if (schemaStore != null) {
    schemaStore.close();
    schemaStore=null;
  }
  if (relGroupStore != null) {
    relGroupStore.close();
    relGroupStore=null;
  }
  if (counts != null) {
    try {
      counts.rotate(getMetaDataStore().getLastCommittedTransactionId());
      counts.shutdown();
    }
 catch (    IOException e) {
      throw new UnderlyingStorageException(e);
    }
 finally {
      counts=null;
    }
  }
  if (metaDataStore != null) {
    metaDataStore.close();
    metaDataStore=null;
  }
}
