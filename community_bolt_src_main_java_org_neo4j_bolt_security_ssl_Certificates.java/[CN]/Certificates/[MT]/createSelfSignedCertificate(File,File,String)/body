{
  KeyPairGenerator keyGen=KeyPairGenerator.getInstance(DEFAULT_ENCRYPTION);
  keyGen.initialize(2048,random);
  KeyPair keypair=keyGen.generateKeyPair();
  X500Name owner=new X500Name("CN=" + hostName);
  X509v3CertificateBuilder builder=new JcaX509v3CertificateBuilder(owner,new BigInteger(64,random),NOT_BEFORE,NOT_AFTER,owner,keypair.getPublic());
  PrivateKey privateKey=keypair.getPrivate();
  ContentSigner signer=new JcaContentSignerBuilder("SHA512WithRSAEncryption").build(privateKey);
  X509CertificateHolder certHolder=builder.build(signer);
  X509Certificate cert=new JcaX509CertificateConverter().setProvider(PROVIDER).getCertificate(certHolder);
  cert.verify(keypair.getPublic());
  writePem("CERTIFICATE",cert.getEncoded(),certificatePath);
  writePem("PRIVATE KEY",privateKey.getEncoded(),privateKeyPath);
}
