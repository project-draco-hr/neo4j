{
  int maxResourceId=findMaxResourceId(resourceTypes);
  this.lockMaps=new ConcurrentMap[maxResourceId];
  this.resourceTypes=new ResourceType[maxResourceId];
  WaitStrategy<AcquireLockTimeoutException>[] waitStrategies=new WaitStrategy[maxResourceId];
  for (  ResourceType type : resourceTypes) {
    this.lockMaps[type.typeId()]=new ConcurrentHashMap<>(16,0.6f,512);
    waitStrategies[type.typeId()]=type.waitStrategy();
    this.resourceTypes[type.typeId()]=type;
  }
  clientPool=new ForsetiClientFlyweightPool(lockMaps,waitStrategies,new DefaultDeadlockStrategy());
}
