{
  int count=0;
  try (KernelStatement statement=(KernelStatement)tx.acquireStatement();Cursor<NodeItem> nodeCursor=statement.getStoreStatement().acquireSingleNodeCursor(node)){
    nodeCursor.next();
    try (Cursor<RelationshipItem> relationships=nodeCursor.get().relationships(Direction.BOTH)){
      while (relationships.next()) {
        long rel=relationships.get().id();
        if (rel == rel1) {
          assertEquals(node,relationships.get().startNode());
          assertEquals(relType1,relationships.get().type());
        }
 else         if (rel == rel2) {
          assertEquals(node,relationships.get().endNode());
          assertEquals(relType2,relationships.get().type());
        }
 else {
          throw new IOException();
        }
        count++;
      }
    }
   }
   return count;
}
