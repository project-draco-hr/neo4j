{
  if (committedTx == 1)   return XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER;
  LogExtractor extractor=null;
  try {
    extractor=LogExtractor.from(getGraphDb().getStoreDir(),committedTx);
    long tx=extractor.extractNext(NullLogBuffer.INSTANCE);
    if (tx != committedTx)     throw new RuntimeException("Master for " + committedTx + " not found");
    return extractor.getLastStartEntry().getMasterId();
  }
 catch (  IOException e) {
    msgLog.logMessage("Couldn't get master for " + committedTx + " using "+ XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER+ " temporarily",e);
    return XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER;
  }
 finally {
    if (extractor != null)     extractor.close();
  }
}
