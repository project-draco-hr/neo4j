{
  if (committedTx == 1)   return XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER;
  LogExtractor extractor=null;
  try {
    extractor=LogExtractor.from(storeDir,committedTx);
    long tx=extractor.extractNext(NullLogBuffer.INSTANCE);
    if (tx != committedTx) {
      msgLog.logMessage("Tried to extract master for tx " + committedTx + " at initialization, but got tx "+ tx+ " back. Will be using "+ XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER+ " temporarily");
      return XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER;
    }
    return extractor.getLastStartEntry().getMasterId();
  }
 catch (  IOException e) {
    msgLog.logMessage("Couldn't get master for " + committedTx + " using "+ XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER+ " temporarily",e);
    return XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER;
  }
 finally {
    if (extractor != null)     extractor.close();
  }
}
