{
  try {
    refreshHaServers();
    int totalCount=getNumberOfServers();
    int myVersionCount=zooKeeper.getChildren(getRoot() + "/" + COMPATIBILITY_CHILD,false).size();
    boolean result=myVersionCount <= totalCount - 1;
    msgLog.logMessage("Checking compatibility mode, read " + totalCount + " as all machines, "+ myVersionCount+ " as myVersion machines. Based on that I return "+ result);
    return result;
  }
 catch (  Exception e) {
    msgLog.logMessage("Tried to discover if we are in compatibility mode, got this exception instead",e);
    throw new RuntimeException(e);
  }
}
