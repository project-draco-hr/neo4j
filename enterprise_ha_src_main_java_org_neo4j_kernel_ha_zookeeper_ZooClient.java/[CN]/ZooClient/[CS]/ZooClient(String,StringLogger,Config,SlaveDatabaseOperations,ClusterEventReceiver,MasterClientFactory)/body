{
  super(conf.get(HaSettings.coordinators),stringLogger,conf.getInteger(zk_session_timeout),clientFactory);
  this.storeDir=storeDir;
  this.conf=conf;
  this.localDatabase=localDatabase;
  this.clusterReceiver=clusterReceiver;
  machineId=conf.getInteger(server_id);
  backupPort=conf.getInteger(OnlineBackupSettings.online_backup_port);
  haServer=conf.isSet(server) ? conf.get(server) : defaultServer();
  writeLastCommittedTx=conf.getEnum(SlaveUpdateMode.class,slave_coordinator_update_mode).syncWithZooKeeper;
  clusterName=conf.get(cluster_name);
  sequenceNr="not initialized yet";
  allowCreateCluster=conf.getBoolean(allow_init_cluster);
  asMachine=new Machine(machineId,0,0,0,haServer,backupPort);
  try {
    watcher=new WatcherImpl();
    zooKeeper=new ZooKeeper(getServers(),getSessionTimeout(),watcher);
    watcher.flushUnprocessedEvents(zooKeeper);
  }
 catch (  IOException e) {
    throw new ZooKeeperException("Unable to create zoo keeper client",e);
  }
}
