{
  long maxId=10;
  IdGeneratorImpl.createGenerator(fsr.get(),file,0,false);
  IdGenerator idGenerator=new IdGeneratorImpl(fsr.get(),file,1,maxId,false,0);
  for (long i=0; i <= maxId; i++) {
    idGenerator.nextId();
  }
  try {
    idGenerator.nextId();
    fail("Should have failed");
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(IdCapacityExceededException.class));
  }
}
