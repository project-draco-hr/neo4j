{
  if (replacedProperty.isDefined()) {
    getOrCreateRelationshipState(relationshipId).changeProperty(newProperty);
  }
 else {
    getOrCreateRelationshipState(relationshipId).addProperty(newProperty);
  }
  legacyState.relationshipSetProperty(relationshipId,newProperty);
  hasChanges=true;
}
