{
  legacyState.deleteRelationship(id);
  deletedRelationships().remove(id);
  if (startNodeId == endNodeId) {
    getOrCreateNodeState(startNodeId).removeRelationship(id,type,Direction.BOTH);
  }
 else {
    getOrCreateNodeState(startNodeId).removeRelationship(id,type,Direction.OUTGOING);
    getOrCreateNodeState(endNodeId).removeRelationship(id,type,Direction.INCOMING);
  }
  hasChanges=true;
}
