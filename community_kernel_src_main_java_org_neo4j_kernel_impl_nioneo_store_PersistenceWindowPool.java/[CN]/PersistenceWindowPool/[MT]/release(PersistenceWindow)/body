{
  try {
    if (window instanceof PersistenceRow) {
      PersistenceRow dpw=(PersistenceRow)window;
      if (brickSize > 0 && dpw.isDirty())       applyChangesToWindowIfNecessary(dpw);
      if (dpw.writeOutAndCloseIfFree(readOnly)) {
        activeRowWindows.remove(dpw.position(),dpw);
      }
 else {
        dpw.reset();
      }
    }
  }
  finally {
    ((LockableWindow)window).unLock();
  }
}
