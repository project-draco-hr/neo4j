{
  if (window instanceof PersistenceRow) {
    PersistenceRow dpw=(PersistenceRow)window;
    dpw.writeOut();
synchronized (this) {
      if (dpw.getWaitingThreadsCount() == 0 && !dpw.isMarked()) {
        int key=(int)dpw.position();
        activeRowWindows.remove(key);
      }
    }
    dpw.unLock();
  }
 else {
    ((LockableWindow)window).unLock();
  }
}
