{
  int oldLimit=buf.limit();
  int newLimit=oldLimit - Math.max(buf.remaining() / 2,1);
  buf.limit(newLimit);
  return oldLimit;
}
