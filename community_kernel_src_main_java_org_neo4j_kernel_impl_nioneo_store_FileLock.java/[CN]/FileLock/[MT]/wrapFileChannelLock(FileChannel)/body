{
  final java.nio.channels.FileLock lock=channel.tryLock();
  if (lock == null) {
    throw new IOException("Unable to lock " + channel);
  }
  return new FileLock(){
    @Override public void release() throws IOException {
      lock.release();
    }
  }
;
}
