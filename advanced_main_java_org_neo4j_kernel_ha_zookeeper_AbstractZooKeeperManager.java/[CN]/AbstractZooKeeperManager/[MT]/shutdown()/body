{
  try {
    invalidateMaster();
    cachedMaster=new Pair<Master,Machine>(null,Machine.NO_MACHINE);
    getZooKeeper().close();
  }
 catch (  InterruptedException e) {
    throw new ZooKeeperException("Error closing zookeeper connection",e);
  }
}
