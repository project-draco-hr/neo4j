{
  Machine master=getMasterBasedOn(getAllMachines(wait).values());
  invalidateMaster();
  MasterClient masterClient=master == Machine.NO_MACHINE || master.getMachineId() == getMyMachineId() ? null : new MasterClient(master);
  cachedMaster=new Pair<Master,Machine>(masterClient,master);
  return cachedMaster;
}
