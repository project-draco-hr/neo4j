{
  RetryStrategy.Timeout timeout=new ConstantTimeRetryStrategy(10,TimeUnit.SECONDS).newTimeout();
  localDatabase.stop();
  while (true) {
    try {
      performDownload(source);
      localDatabase.start();
      break;
    }
 catch (    CoreServerSelectionException|StoreCopyFailedException ex) {
      ex.printStackTrace();
      log.info(ex.getMessage() + ", retrying in %d ms.",timeout.getMillis());
      try {
        Thread.sleep(timeout.getMillis());
        timeout.increment();
      }
 catch (      InterruptedException e) {
        log.warn("Snapshot download interrupted");
        break;
      }
    }
catch (    IOException e) {
      localDatabase.panic(e);
      break;
    }
  }
}
