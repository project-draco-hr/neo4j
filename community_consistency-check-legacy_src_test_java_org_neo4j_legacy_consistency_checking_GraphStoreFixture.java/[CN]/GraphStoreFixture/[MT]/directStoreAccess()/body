{
  if (directStoreAccess == null) {
    DefaultFileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();
    PageCache pageCache=getPageCache(fileSystem);
    StoreAccess nativeStores=new StoreAccess(fileSystem,pageCache,directory).initialize();
    directStoreAccess=new DirectStoreAccess(nativeStores,new LuceneLabelScanStoreBuilder(directory,nativeStores.getRawNeoStores(),fileSystem,FormattedLogProvider.toOutputStream(System.out)).build(),createIndexes(fileSystem));
  }
  return directStoreAccess;
}
