{
  if (directStoreAccess == null) {
    DefaultFileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();
    PageCache pageCache=getPageCache(fileSystem);
    StoreAccess nativeStores=new StoreAccess(fileSystem,pageCache,directory).initialize();
    Config config=new Config();
    OperationalMode operationalMode=OperationalMode.single;
    directStoreAccess=new DirectStoreAccess(nativeStores,new LuceneLabelScanStoreBuilder(directory,nativeStores.getRawNeoStores(),fileSystem,config,operationalMode,FormattedLogProvider.toOutputStream(System.out)).build(),createIndexes(fileSystem,config,operationalMode));
  }
  return directStoreAccess;
}
