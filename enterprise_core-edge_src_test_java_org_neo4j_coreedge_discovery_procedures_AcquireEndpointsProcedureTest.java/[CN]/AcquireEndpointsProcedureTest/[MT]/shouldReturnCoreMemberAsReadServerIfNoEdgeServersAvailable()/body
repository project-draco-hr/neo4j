{
  final CoreTopologyService topologyService=mock(CoreTopologyService.class);
  Map<MemberId,CoreAddresses> coreMembers=new HashMap<>();
  MemberId theLeader=member(0);
  coreMembers.put(theLeader,DiscoverEndpointAcquisitionServersProcedureTest.coreAddresses(0));
  when(topologyService.coreServers()).thenReturn(new CoreTopology(clusterId,false,coreMembers));
  when(topologyService.edgeServers()).thenReturn(new EdgeTopology(clusterId,DiscoverEndpointAcquisitionServersProcedureTest.addresses()));
  LeaderLocator leaderLocator=mock(LeaderLocator.class);
  when(leaderLocator.getLeader()).thenReturn(theLeader);
  AcquireEndpointsProcedure procedure=new AcquireEndpointsProcedure(topologyService,leaderLocator,NullLogProvider.getInstance());
  final List<Object[]> members=asList(procedure.apply(null,new Object[0]));
  assertThat(members,containsInAnyOrder(new Object[]{DiscoverEndpointAcquisitionServersProcedureTest.coreAddresses(0).getRaftServer().toString(),"WRITE"},new Object[]{DiscoverEndpointAcquisitionServersProcedureTest.coreAddresses(0).getRaftServer().toString(),"READ"}));
}
