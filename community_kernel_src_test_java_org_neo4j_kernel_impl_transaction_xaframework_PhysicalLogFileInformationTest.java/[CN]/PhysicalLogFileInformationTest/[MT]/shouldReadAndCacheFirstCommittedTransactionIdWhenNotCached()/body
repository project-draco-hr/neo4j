{
  PhysicalLogFileInformation info=new PhysicalLogFileInformation(logFiles,transactionMetadataCache,transactionIdStore,spi);
  long expected=5;
  long version=10l;
  when(logFiles.getHighestLogVersion()).thenReturn(version);
  when(transactionMetadataCache.getLogHeader(version)).thenReturn(-1l);
  when(logFiles.versionExists(version)).thenReturn(true);
  when(logFiles.extractHeader(version)).thenReturn(new long[]{-1l,expected - 1l});
  when(logFiles.hasAnyTransaction(version)).thenReturn(true);
  long firstCommittedTxId=info.getFirstExistingTxId();
  assertEquals(expected,firstCommittedTxId);
  verify(transactionMetadataCache,times(1)).putHeader(version,expected - 1);
}
