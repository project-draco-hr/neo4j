{
  deleteRecursively(new File(dir));
  assertEquals(0,getRuntime().exec(new String[]{"java","-Djava.awt.headless=true","-cp",getProperty("java.class.path"),getClass().getName()}).waitFor());
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(dir);
  try (Transaction ignored=db.beginTx()){
    assertEquals(MyRelTypes.TEST.name(),GlobalGraphOperations.at(db).getAllRelationshipTypes().iterator().next().name());
  }
  finally {
    db.shutdown();
  }
}
