{
  String type=config.get(LuceneIndexProvider.KEY_TYPE);
  IndexType result=null;
  Similarity similarity=getCustomSimilarity(config);
  boolean toLowerCase=parseBoolean(config.get(LuceneIndexProvider.KEY_TO_LOWER_CASE),true);
  Analyzer customAnalyzer=getCustomAnalyzer(config);
  if (type != null) {
    if (type.equals("exact")) {
      result=EXACT;
    }
 else     if (type.equals("fulltext")) {
      Analyzer analyzer=customAnalyzer;
      if (analyzer == null) {
        analyzer=toLowerCase ? LuceneDataSource.LOWER_CASE_WHITESPACE_ANALYZER : LuceneDataSource.WHITESPACE_ANALYZER;
      }
      result=new CustomType(analyzer,toLowerCase,similarity);
    }
  }
 else {
    if (customAnalyzer == null) {
      throw new IllegalArgumentException("No 'type' was given (which can point out " + "built-in analyzers, such as 'exact' and 'fulltext')" + " and no 'analyzer' was given either (which can point out a custom " + Analyzer.class.getName() + " to use)");
    }
    result=new CustomType(customAnalyzer,toLowerCase,similarity);
  }
  return result;
}
