{
  int xidIdent=getNextIdentifier();
  try {
    byte globalId[]=xid.getGlobalTransactionId();
    byte branchId[]=xid.getBranchQualifier();
    int formatId=xid.getFormatId();
    buffer.clear();
    buffer.put(TX_START).put((byte)globalId.length).put((byte)branchId.length).put(globalId).put(branchId).putInt(xidIdent).putInt(formatId);
    buffer.flip();
    fileChannel.write(buffer);
    xidIdentMap.put(xidIdent,xid);
  }
 catch (  IOException e) {
    throw new XAException("Logical log couldn't start transaction: " + e);
  }
  return xidIdent;
}
