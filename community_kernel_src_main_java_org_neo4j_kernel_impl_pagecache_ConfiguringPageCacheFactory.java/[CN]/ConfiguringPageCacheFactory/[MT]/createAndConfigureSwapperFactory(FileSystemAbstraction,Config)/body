{
  String desiredImplementation=config.get(pagecache_swapper);
  if (desiredImplementation != null) {
    for (    PageSwapperFactory factory : Service.load(PageSwapperFactory.class)) {
      if (factory.implementationName().equals(desiredImplementation)) {
        factory.setFileSystemAbstraction(fs);
        if (factory instanceof ConfigurablePageSwapperFactory) {
          ConfigurablePageSwapperFactory cfactory=(ConfigurablePageSwapperFactory)factory;
          cfactory.configure(config);
        }
        return factory;
      }
    }
  }
  SingleFilePageSwapperFactory factory=new SingleFilePageSwapperFactory();
  factory.setFileSystemAbstraction(fs);
  return factory;
}
