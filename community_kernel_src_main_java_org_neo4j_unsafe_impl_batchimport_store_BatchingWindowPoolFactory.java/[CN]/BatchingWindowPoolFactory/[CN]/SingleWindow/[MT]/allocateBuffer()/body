{
  final int capacity=roundedToNearestRecordSize(windowTargetSize);
  this.maxRecordsInBuffer=capacity / recordSize;
  bufferPool=new SimplePool<>(2,new Factory<ByteBuffer>(){
    @Override public ByteBuffer newInstance(){
      return allocateDirect(capacity);
    }
  }
);
  this.currentBuffer=new Buffer(this,bufferPool.acquire());
}
