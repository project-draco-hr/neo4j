{
  ReplicatedIdRangeAcquirer rangeAcquirer=mock(ReplicatedIdRangeAcquirer.class);
  when(rangeAcquirer.acquireIds(IdType.NODE)).thenReturn(new IdAllocation(new IdRange(new long[0],0,1024),-1,0)).thenReturn(new IdAllocation(new IdRange(new long[0],-1,0),1024,0));
  ReplicatedIdGenerator idGenerator=new ReplicatedIdGenerator(IdType.NODE,0,rangeAcquirer,NullLogProvider.getInstance());
  Set<Long> idsGenerated=new HashSet<>();
  long nextId;
  while ((nextId=idGenerator.nextId()) != -1) {
    idsGenerated.add(nextId);
  }
  long minId=Collections.min(idsGenerated);
  long maxId=Collections.max(idsGenerated);
  assertEquals(0,minId);
  assertEquals(1023,maxId);
}
