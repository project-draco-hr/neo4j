{
  if (relId < 0) {
    throw new IllegalArgumentException("Negative id " + relId);
  }
  RelationshipImpl relationship=relCache.get(relId);
  if (relationship != null) {
    return new RelationshipProxy(relId,this);
  }
  relationship=new RelationshipImpl(relId,this);
  ReentrantLock loadLock=lockId(relId);
  try {
    if (relCache.get(relId) != null) {
      relationship=relCache.get(relId);
      return new RelationshipProxy(relId,this);
    }
    RawRelationshipData data=persistenceManager.loadLightRelationship(relId);
    if (data == null) {
      throw new NotFoundException("Relationship[" + relId + "] not found");
    }
    RelationshipType type=getRelationshipTypeById(data.getType());
    if (type == null) {
      throw new RuntimeException("Relationship[" + data.getId() + "] exist but relationship type["+ data.getType()+ "] not found.");
    }
    final int startNodeId=data.getFirstNode();
    final int endNodeId=data.getSecondNode();
    relationship=new RelationshipImpl(relId,startNodeId,endNodeId,type,false,this);
    relCache.add(relId,relationship);
    return new RelationshipProxy(relId,this);
  }
  finally {
    loadLock.unlock();
  }
}
