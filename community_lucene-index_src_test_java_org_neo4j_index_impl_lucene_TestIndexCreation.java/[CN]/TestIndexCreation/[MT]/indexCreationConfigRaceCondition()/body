{
  for (int run=0; run < 10; run++) {
    final int r=run;
    final CountDownLatch latch=new CountDownLatch(1);
    ExecutorService executor=newCachedThreadPool();
    for (int thread=0; thread < 10; thread++) {
      executor.submit(new Runnable(){
        @Override public void run(){
          Transaction tx=db.beginTx();
          try {
            latch.await();
            Index<Node> index=db.index().forNodes("index" + r);
            Node node=db.createNode();
            index.add(node,"name","Name");
            tx.success();
          }
 catch (          InterruptedException e) {
            Thread.interrupted();
          }
 finally {
            tx.finish();
          }
        }
      }
);
    }
    latch.countDown();
    executor.shutdown();
    executor.awaitTermination(10,TimeUnit.SECONDS);
    verifyThatIndexCreationTransactionIsTheFirstOne();
  }
}
