{
  state.nodeDoDelete(1l);
  state.nodeDoDelete(2l);
  when(ops.nodeGetAllProperties(1l)).thenReturn(IteratorUtil.<DefinedProperty>emptyIterator());
  when(ops.nodeGetAllProperties(2l)).thenReturn(asList(Property.stringProperty(1,"p")).iterator());
  when(ops.nodeGetLabels(1l)).thenReturn(PrimitiveIntCollections.emptyIterator());
  when(ops.nodeGetLabels(2l)).thenReturn(PrimitiveIntCollections.iterator(15));
  when(ops.propertyKeyGetName(1)).thenReturn("key");
  when(ops.labelGetName(15)).thenReturn("label");
  TxStateTransactionDataSnapshot snapshot=snapshot();
  assertThat(idList(snapshot.deletedNodes()),equalTo(asList(1l,2l)));
  assertThat(single(snapshot.removedLabels()).label().name(),equalTo("label"));
  assertThat(single(snapshot.removedNodeProperties()).key(),equalTo("key"));
}
