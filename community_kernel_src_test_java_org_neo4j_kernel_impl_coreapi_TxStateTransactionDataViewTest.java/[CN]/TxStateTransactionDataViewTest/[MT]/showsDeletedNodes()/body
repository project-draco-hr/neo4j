{
  state.nodeDoDelete(1L);
  state.nodeDoDelete(2L);
  when(storeStatement.acquireSingleNodeCursor(2L)).thenReturn(asNodeCursor(2L,asPropertyCursor(stringProperty(1,"p")),asLabelCursor(15)));
  when(storeStatement.acquireSingleNodeCursor(1L)).thenReturn(asNodeCursor(1L,asPropertyCursor(),asLabelCursor()));
  when(ops.propertyKeyGetName(1)).thenReturn("key");
  when(ops.labelGetName(15)).thenReturn("label");
  TxStateTransactionDataSnapshot snapshot=snapshot();
  assertThat(idList(snapshot.deletedNodes()),equalTo(asList(1L,2L)));
  assertThat(single(snapshot.removedLabels()).label().name(),equalTo("label"));
  assertThat(single(snapshot.removedNodeProperties()).key(),equalTo("key"));
}
