{
  state.nodeDoDelete(1l);
  state.nodeDoDelete(2l);
  when(storeStatement.acquireSingleNodeCursor(2l)).thenReturn(asNodeCursor(2l,asPropertyCursor(stringProperty(1,"p")),asLabelCursor(15)));
  when(storeStatement.acquireSingleNodeCursor(1l)).thenReturn(asNodeCursor(1l,asPropertyCursor(),asLabelCursor()));
  when(ops.propertyKeyGetName(1)).thenReturn("key");
  when(ops.labelGetName(15)).thenReturn("label");
  TxStateTransactionDataSnapshot snapshot=snapshot();
  assertThat(idList(snapshot.deletedNodes()),equalTo(asList(1l,2l)));
  assertThat(single(snapshot.removedLabels()).label().name(),equalTo("label"));
  assertThat(single(snapshot.removedNodeProperties()).key(),equalTo("key"));
}
