{
  state.relationshipDoDelete(1l,1,1l,2l);
  state.relationshipDoDelete(2l,1,1l,1l);
  when(ops.relationshipGetAllProperties(1l)).thenReturn(IteratorUtil.<DefinedProperty>emptyIterator());
  when(ops.relationshipGetAllProperties(2l)).thenReturn(asList(Property.stringProperty(1,"p")).iterator());
  when(ops.propertyKeyGetName(1)).thenReturn("key");
  TxStateTransactionDataSnapshot snapshot=snapshot();
  assertThat(idList(snapshot.deletedRelationships()),equalTo(asList(1l,2l)));
  assertThat(single(snapshot.removedRelationshipProperties()).key(),equalTo("key"));
}
