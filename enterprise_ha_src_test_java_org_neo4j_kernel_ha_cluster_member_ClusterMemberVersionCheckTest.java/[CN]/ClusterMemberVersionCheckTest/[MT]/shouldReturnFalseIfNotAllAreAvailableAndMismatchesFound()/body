{
  ClusterMembers members=clusterMembersWith(member(ID_1,MASTER,true,EXPECTED_STORE_ID,true),member(ID_3,SLAVE,true,EXPECTED_STORE_ID,true),member(ID_4,SLAVE,true,UNEXPECTED_STORE_ID,true),member(ID_5,UNKNOWN,true,EXPECTED_STORE_ID,true));
  int timeoutMillis=1;
  Outcome outcome=new ClusterMemberVersionCheck(members,ID_2,twoTickClock(timeoutMillis)).doVersionCheck(EXPECTED_STORE_ID,timeoutMillis,MILLISECONDS);
  assertTrue(outcome.hasMismatched());
  assertThat(outcome.getMismatched(),equalTo(singletonMap(ID_4.toIntegerIndex(),UNEXPECTED_STORE_ID)));
  assertTrue(outcome.hasUnavailable());
  assertThat(outcome.getUnavailable(),equalTo(singleton(ID_5.toIntegerIndex())));
  verify(members,times(1)).waitForEvent(timeoutMillis);
}
