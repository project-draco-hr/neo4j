{
  FileUtils.deleteRecursively(new File("target/batchinserter-example"));
  BatchInserter inserter=BatchInserters.inserter("target/batchinserter-example");
  Map<String,Object> properties=new HashMap<String,Object>();
  properties.put("name","Mattias");
  long mattiasNode=inserter.createNode(properties);
  properties.put("name","Chris");
  long chrisNode=inserter.createNode(properties);
  RelationshipType knows=DynamicRelationshipType.withName("KNOWS");
  inserter.createRelationship(mattiasNode,chrisNode,knows,null);
  inserter.shutdown();
  GraphDatabaseService db=new EmbeddedGraphDatabase("target/batchinserter-example");
  Node mNode=db.getNodeById(mattiasNode);
  Node cNode=mNode.getSingleRelationship(knows,Direction.OUTGOING).getEndNode();
  assertEquals("Chris",cNode.getProperty("name"));
  db.shutdown();
}
