{
  if (readPosition == writePosition) {
    return eof ? -1 : 0;
  }
  buffer.position(readPosition);
  int originalPosition=readPosition;
  int originalLimit=buffer.limit();
  buffer.limit(Math.min(buffer.position() + (dst.limit() - dst.position()),writePosition));
  dst.put(buffer);
  readPosition=buffer.position();
  buffer.limit(originalLimit);
  return readPosition - originalPosition;
}
