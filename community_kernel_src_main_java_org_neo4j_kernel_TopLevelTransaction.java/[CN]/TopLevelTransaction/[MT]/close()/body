{
  try {
    transaction.close();
  }
 catch (  Exception e) {
    if (transactionOutcome.successCalled()) {
      throw new TransactionFailureException("Unable to commit transaction",e);
    }
 else {
      throw new TransactionFailureException("Unable to rollback transaction",e);
    }
  }
 finally {
    stmtProvider.unbindTransactionFromCurrentThread();
  }
}
