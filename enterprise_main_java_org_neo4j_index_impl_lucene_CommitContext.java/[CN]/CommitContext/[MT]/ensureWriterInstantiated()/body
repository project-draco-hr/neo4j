{
  if (writer == null) {
    if (isRecovery) {
      writer=dataSource.getRecoveryIndexWriter(identifier);
    }
 else {
      writer=dataSource.getIndexWriter(identifier);
      writer.setMaxBufferedDocs(commandList.addCount + 100);
      writer.setMaxBufferedDeleteTerms(commandList.removeCount + 100);
    }
    searcher=dataSource.getIndexSearcher(identifier).getSearcher();
  }
}
