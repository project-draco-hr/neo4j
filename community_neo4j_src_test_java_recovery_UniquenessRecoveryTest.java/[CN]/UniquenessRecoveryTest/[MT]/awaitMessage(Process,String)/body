{
  BufferedReader out=new BufferedReader(new InputStreamReader(process.getInputStream()));
  for (String line; (line=out.readLine()) != null; ) {
    System.out.println(line);
    if (message != null && line.contains(message)) {
      return null;
    }
  }
  int exitCode=process.waitFor();
  BufferedReader err=new BufferedReader(new InputStreamReader(process.getInputStream()));
  for (String line; (line=out.readLine()) != null; ) {
    System.out.println(line);
  }
  for (String line; (line=err.readLine()) != null; ) {
    System.err.println(line);
  }
  System.out.println("process exited with exit code: " + exitCode);
  return exitCode;
}
