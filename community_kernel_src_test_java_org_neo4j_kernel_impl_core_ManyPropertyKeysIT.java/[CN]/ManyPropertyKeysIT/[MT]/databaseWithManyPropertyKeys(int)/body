{
  DefaultFileSystemAbstraction fs=new DefaultFileSystemAbstraction();
  PageCache pageCache=pageCacheRule.getPageCache(fs);
  StoreFactory storeFactory=new StoreFactory(fs,storeDir,pageCache,LowLimitV3_0.RECORD_FORMATS,NullLogProvider.getInstance());
  NeoStores neoStores=storeFactory.openAllNeoStores(true);
  PropertyKeyTokenStore store=neoStores.getPropertyKeyTokenStore();
  for (int i=0; i < propertyKeyCount; i++) {
    PropertyKeyTokenRecord record=new PropertyKeyTokenRecord((int)store.nextId());
    record.setInUse(true);
    Collection<DynamicRecord> nameRecords=store.allocateNameRecords(PropertyStore.encodeString(key(i)));
    record.addNameRecords(nameRecords);
    record.setNameId((int)Iterables.first(nameRecords).getId());
    store.updateRecord(record);
  }
  neoStores.close();
  return database();
}
