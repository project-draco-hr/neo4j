{
  @SuppressWarnings("unchecked") DelegateInvocationHandler<UpdatePuller> invocationHandler=mock(DelegateInvocationHandler.class);
  PullerFactory pullerFactory=mock(PullerFactory.class);
  slaveUpdatePuller=mock(SlaveUpdatePuller.class);
  when(pullerFactory.createSlaveUpdatePuller()).thenReturn(slaveUpdatePuller);
  when(invocationHandler.setDelegate(slaveUpdatePuller)).thenReturn(slaveUpdatePuller);
  modeSwitcher=new UpdatePullerSwitcher(invocationHandler,pullerFactory);
}
