{
  assertValidToken(token);
  User user=users.findByName(name);
  if (user == null) {
    return null;
  }
  User updatedUser=user.augment().withToken(token).build();
  try {
    users.save(updatedUser);
    return updatedUser;
  }
 catch (  IllegalUsernameException e) {
    throw new ThisShouldNotHappenError("Jake","Username has already been accepted, we are modifying the token only.");
  }
}
