{
  final InMemoryRaftLog log=new InMemoryRaftLog();
  final InMemoryRaftMembershipState<RaftTestMember> state=mock(InMemoryRaftMembershipState.class);
  final long logIndex=42l;
  when(state.logIndex()).thenReturn(logIndex);
  RaftMembershipManager<RaftTestMember> membershipManager=new RaftMembershipManager<>(new DirectReplicator(),RaftTestMemberSetBuilder.INSTANCE,log,NullLogProvider.getInstance(),3,1000,new FakeClock(),1000,state);
  log.registerListener(membershipManager);
  membershipManager.onAppended(new RaftTestGroup(1,2,3,4),logIndex - 1);
  verify(state,times(0)).logIndex(anyLong());
  verify(state,times(0)).setVotingMembers(anySet());
}
