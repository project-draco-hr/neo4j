{
  CatchupClientProtocol protocol=new CatchupClientProtocol();
  ChannelPipeline pipeline=ch.pipeline();
  pipeline.addLast(new LengthFieldBasedFrameDecoder(Integer.MAX_VALUE,0,4,0,4));
  pipeline.addLast(new LengthFieldPrepender(4));
  pipeline.addLast(new VersionDecoder(logProvider));
  pipeline.addLast(new VersionPrepender());
  pipeline.addLast(new TxPullRequestEncoder());
  pipeline.addLast(new GetStoreRequestEncoder());
  pipeline.addLast(new CoreSnapshotRequestEncoder());
  pipeline.addLast(new ResponseMessageTypeEncoder());
  pipeline.addLast(new RequestMessageTypeEncoder());
  pipeline.addLast(new ClientMessageTypeHandler(protocol,logProvider));
  pipeline.addLast(owner.decoders(protocol));
  pipeline.addLast(new TxPullResponseHandler(protocol,owner));
  pipeline.addLast(new CoreSnapshotResponseHandler(protocol,owner));
  pipeline.addLast(new StoreCopyFinishedResponseHandler(protocol,owner));
  pipeline.addLast(new TxStreamFinishedResponseHandler(protocol,owner));
  pipeline.addLast(new FileHeaderHandler(protocol,logProvider));
  pipeline.addLast(new FileContentHandler(protocol,owner));
  pipeline.addLast(new IdleStateHandler(0,0,2,TimeUnit.MINUTES));
  pipeline.addLast(new IdleChannelReaperHandler(nonBlockingChannels));
  pipeline.addLast(new ExceptionLoggingHandler(logProvider.getLog(getClass())));
}
