{
  startDb(createAlwaysInitiallyPopulatingLuceneIndexFactory());
  IndexDefinition indexDefinition=createIndex(myLabel);
  waitForIndex(indexDefinition);
  long nodeId=createNode(myLabel,12);
  assertEquals(1,doIndexLookup(myLabel,12).size());
  killDb();
  startDb(createAlwaysInitiallyPopulatingLuceneIndexFactory());
  try (Transaction tx=db.beginTx()){
    IndexDefinition index=db.schema().getIndexes().iterator().next();
    waitForIndex(index);
    assertEquals(12,db.getNodeById(nodeId).getProperty(NUM_BANANAS_KEY));
    assertEquals(1,doIndexLookup(myLabel,12).size());
  }
 }
