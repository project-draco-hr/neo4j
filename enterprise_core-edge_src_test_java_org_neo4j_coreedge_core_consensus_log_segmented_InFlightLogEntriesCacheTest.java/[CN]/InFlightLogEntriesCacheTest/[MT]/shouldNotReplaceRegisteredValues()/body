{
  InFlightMap<Object,Object> cache=new InFlightMap<>();
  Object first=new Object();
  Object second=new Object();
  try {
    cache.register(first,first);
    cache.register(first,second);
    fail("Should not allow silent replacement of values");
  }
 catch (  IllegalArgumentException e) {
    assertEquals(first,cache.retrieve(first));
  }
}
