{
  return new ChannelInitializer<SocketChannel>(){
    @Override public void initChannel(    SocketChannel ch) throws Exception {
      ch.config().setAllocator(PooledByteBufAllocator.DEFAULT);
      if (sslCtx != null) {
        ch.pipeline().addLast(sslCtx.newHandler(ch.alloc()));
      }
      ch.pipeline().addLast(new HttpServerCodec(),new HttpObjectAggregator(MAX_WEBSOCKET_HANDSHAKE_SIZE),new WebSocketServerProtocolHandler(""),new WebSocketFrameTranslator(),new SocketTransportHandler(new SocketTransportHandler.ProtocolChooser(availableVersions),logging));
    }
  }
;
}
