{
  IndexRule indexRule=constraintIndexRule(indexId,labelId,propertyKeyId,new Descriptor("provider1","version1"),constraintId);
  NodeRecord nodeRecord=nodeWithLabels(labelId);
  long duplicateNodeId1=1;
  long duplicateNodeId2=2;
  NodeCorrectlyIndexedCheck check=new NodeCorrectlyIndexedCheck(indexContaining(indexRule,Collections.<Object,long[]>singletonMap("propertyValue",new long[]{nodeRecord.getId(),duplicateNodeId1,duplicateNodeId2})),nodeHasProperty(nodeRecord,"propertyValue"));
  ConsistencyReport.NodeConsistencyReport report=mock(ConsistencyReport.NodeConsistencyReport.class);
  check.check(nodeRecord,engineFor(report),null);
  verify(report).uniqueIndexNotUnique(indexRule,"propertyValue",duplicateNodeId1);
  verify(report).uniqueIndexNotUnique(indexRule,"propertyValue",duplicateNodeId2);
}
