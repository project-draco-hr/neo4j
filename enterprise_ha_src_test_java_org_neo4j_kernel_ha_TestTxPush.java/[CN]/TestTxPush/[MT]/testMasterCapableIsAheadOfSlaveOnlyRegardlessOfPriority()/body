{
  HighlyAvailableGraphDatabase master=null, slave1=null, slave2=null;
  try {
    Transaction tx=master.beginTx();
    Node node=master.createNode();
    long nodeId=node.getId();
    node.setProperty("foo","bar");
    tx.success();
    tx.finish();
    try {
      slave1.getNodeById(nodeId);
      fail("It shouldn't be in the slave only instance");
    }
 catch (    NotFoundException e) {
    }
    assertEquals("bar",slave2.getNodeById(nodeId).getProperty("foo"));
  }
  finally {
    if (slave2 != null) {
      slave2.shutdown();
    }
    if (slave1 != null) {
      slave1.shutdown();
    }
    if (master != null) {
      master.shutdown();
    }
  }
}
