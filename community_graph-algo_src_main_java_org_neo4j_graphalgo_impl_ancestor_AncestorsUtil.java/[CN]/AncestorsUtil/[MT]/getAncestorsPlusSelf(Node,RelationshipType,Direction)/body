{
  LinkedList<Node> ancestors=new LinkedList<Node>();
  ancestors.add(node);
  Iterator<Relationship> relIterator=node.getRelationships(relationship,direction).iterator();
  while (relIterator.hasNext()) {
    Relationship rel=relIterator.next();
    Node parentNode=null;
    if (direction.equals(Direction.INCOMING)) {
      parentNode=rel.getStartNode();
    }
 else {
      parentNode=rel.getEndNode();
    }
    ancestors.add(parentNode);
    relIterator=parentNode.getRelationships(relationship,direction).iterator();
  }
  return ancestors;
}
