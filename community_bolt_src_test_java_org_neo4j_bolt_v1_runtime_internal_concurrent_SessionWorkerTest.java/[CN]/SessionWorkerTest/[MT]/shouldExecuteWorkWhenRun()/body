{
  Session session=Mockito.mock(Session.class);
  SessionWorker worker=new SessionWorker(session,NullLogService.getInstance());
  worker.handle(new Consumer<Session>(){
    @Override public void accept(    Session session){
      session.run("Hello, world!",null,null,null);
    }
  }
);
  worker.handle(SessionWorker.SHUTDOWN);
  worker.run();
  Mockito.verify(session).run("Hello, world!",null,null,null);
  Mockito.verify(session).close();
  Mockito.verifyNoMoreInteractions(session);
}
