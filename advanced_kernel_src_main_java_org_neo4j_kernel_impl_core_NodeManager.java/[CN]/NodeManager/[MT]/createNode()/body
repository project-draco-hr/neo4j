{
  long id=idGenerator.nextId(Node.class);
  NodeImpl node=new NodeImpl(id,true);
  acquireLock(node,LockType.WRITE);
  boolean success=false;
  try {
    persistenceManager.nodeCreate(id);
    nodeCache.put(id,node);
    success=true;
    return new NodeProxy(id,this);
  }
  finally {
    releaseLock(node,LockType.WRITE);
    if (!success) {
      setRollbackOnly();
    }
  }
}
