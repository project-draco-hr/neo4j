{
  RuntimeException startupError=new RuntimeException();
  GraphDatabaseFacadeFactory db=newFaultyGraphDatabaseFacadeFactory(startupError);
  GraphDatabaseFacade mockFacade=mock(GraphDatabaseFacade.class);
  try {
    db.newFacade(dir.graphDbDir(),Collections.<String,String>emptyMap(),mock(GraphDatabaseFacadeFactory.Dependencies.class),mockFacade);
    fail("Should have thrown " + RuntimeException.class);
  }
 catch (  RuntimeException exception) {
    assertEquals(startupError,Exceptions.rootCause(exception));
  }
}
