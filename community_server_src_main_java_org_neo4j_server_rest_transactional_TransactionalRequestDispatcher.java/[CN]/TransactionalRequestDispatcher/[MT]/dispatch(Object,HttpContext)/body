{
  if (o instanceof RestfulGraphDatabase) {
    RestfulGraphDatabase restfulGraphDatabase=(RestfulGraphDatabase)o;
    final Transaction transaction=database.getGraph().beginTx();
    restfulGraphDatabase.getOutputFormat().setRepresentationWrittenHandler(new DefaultRepresentationWrittenHandler(httpContext,transaction));
  }
 else   if (o instanceof BatchOperationService) {
    BatchOperationService batchOperationService=(BatchOperationService)o;
    final Transaction transaction=database.getGraph().beginTx();
    batchOperationService.setRepresentationWrittenHandler(new DefaultRepresentationWrittenHandler(httpContext,transaction));
  }
 else   if (o instanceof CypherService) {
    CypherService cypherService=(CypherService)o;
    final Transaction transaction=database.getGraph().beginTx();
    cypherService.getOutputFormat().setRepresentationWrittenHandler(new DefaultRepresentationWrittenHandler(httpContext,transaction));
  }
 else   if (o instanceof DatabaseMetadataService) {
    DatabaseMetadataService databaseMetadataService=(DatabaseMetadataService)o;
    final Transaction transaction=database.getGraph().beginTx();
    databaseMetadataService.setRepresentationWrittenHandler(new RepresentationWrittenHandler(){
      @Override public void onRepresentationWritten(){
      }
      @Override public void onRepresentationFinal(){
        transaction.finish();
      }
    }
);
  }
  requestDispatcher.dispatch(o,httpContext);
}
