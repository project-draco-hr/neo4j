{
  closeWriter(identifier);
  deleteFileOrDirectory(getFileDirectory(baseStorePath,identifier));
  invalidateCache(identifier);
  boolean removeFromIndexStore=!recovery || (recovery && indexStore.has(identifier.entityType.getType(),identifier.indexName));
  if (removeFromIndexStore) {
    indexStore.remove(identifier.entityType.getType(),identifier.indexName);
  }
  typeCache.invalidate(identifier);
synchronized (indexes) {
    LuceneIndex<? extends PropertyContainer> index=indexes.remove(identifier);
    if (index != null) {
      index.markAsDeleted();
    }
  }
}
