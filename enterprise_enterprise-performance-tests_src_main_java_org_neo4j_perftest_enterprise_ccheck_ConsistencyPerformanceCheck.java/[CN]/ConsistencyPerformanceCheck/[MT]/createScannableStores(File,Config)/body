{
  StoreFactory factory=new StoreFactory(storeDir,tuningConfiguration,new DefaultIdGeneratorFactory(fileSystem),pageCache,fileSystem,NullLogProvider.getInstance());
  NeoStores neoStores=factory.openAllNeoStores(true);
  OperationalMode operationalMode=OperationalMode.single;
  SchemaIndexProvider indexes=new LuceneSchemaIndexProvider(fileSystem,DirectoryFactory.PERSISTENT,storeDir,tuningConfiguration,operationalMode);
  LuceneLabelScanStoreBuilder labelScanStoreBuilder=new LuceneLabelScanStoreBuilder(storeDir,neoStores,fileSystem,tuningConfiguration,operationalMode,NullLogProvider.getInstance());
  LabelScanStore labelScanStore=labelScanStoreBuilder.build();
  return new DirectStoreAccess(new StoreAccess(neoStores).initialize(),labelScanStore,indexes);
}
