{
  when(jmxServer.getAttribute(beanName,"name")).thenThrow(new RuntimeMBeanException(new UnsupportedOperationException("Haha, screw discoverable services!")));
  JmxQueryProcedure procedure=new JmxQueryProcedure(ProcedureSignature.procedureName("bob"),jmxServer);
  RawIterator<Object[],ProcedureException> result=procedure.apply(null,new Object[]{"*:*"});
  assertThat(asList(result),contains(equalTo(new Object[]{"org.neo4j:chevyMakesTheTruck=bobMcCoshMakesTheDifference","This is a description",map(attributeName,map("description","This is the attribute desc.","value",null))})));
}
