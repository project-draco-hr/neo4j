{
  try (SegmentFile segment=create(fsRule.get(),raftLogFile,contentMarshal,logProvider,segmentHeader)){
    Runnable onDisposeHandler=mock(Runnable.class);
    segment.closeWriter();
    segment.markForDisposal(onDisposeHandler);
    verify(onDisposeHandler).run();
  }
 }
