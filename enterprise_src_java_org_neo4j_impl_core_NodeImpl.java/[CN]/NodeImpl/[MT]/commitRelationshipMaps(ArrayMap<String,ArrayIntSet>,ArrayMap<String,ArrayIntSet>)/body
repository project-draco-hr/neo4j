{
  if (relationshipMap == null) {
    return;
  }
  if (cowRelationshipAddMap != null) {
    for (    String type : cowRelationshipAddMap.keySet()) {
      ArrayIntSet source=cowRelationshipAddMap.get(type);
      if (source.size() == 0) {
        continue;
      }
      ArrayIntSet dest=new ArrayIntSet();
      ArrayIntSet orig=relationshipMap.get(type);
      if (orig != null) {
        for (        int relId : orig.values()) {
          dest.add(relId);
        }
      }
      for (      int relId : source.values()) {
        dest.add(relId);
      }
      relationshipMap.put(type,dest);
    }
  }
  if (cowRelationshipRemoveMap != null && relationshipMap != null) {
    for (    String type : cowRelationshipRemoveMap.keySet()) {
      ArrayIntSet source=cowRelationshipRemoveMap.get(type);
      if (source.size() == 0) {
        continue;
      }
      ArrayIntSet dest=new ArrayIntSet();
      ArrayIntSet orig=relationshipMap.get(type);
      if (orig != null) {
        for (        int relId : orig.values()) {
          if (!source.contains(relId)) {
            dest.add(relId);
          }
        }
        relationshipMap.put(type,dest);
      }
    }
  }
}
