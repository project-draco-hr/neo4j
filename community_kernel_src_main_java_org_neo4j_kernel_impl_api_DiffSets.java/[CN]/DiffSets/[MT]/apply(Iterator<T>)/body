{
  Iterator<T> result=source;
  if (removedElements != null && !removedElements.isEmpty()) {
    ensureFilterHasBeenCreated();
    result=filter(filter,result);
  }
  if (addedElements != null && !addedElements.isEmpty()) {
    result=concat(result,addedElements.iterator());
  }
  return result;
}
