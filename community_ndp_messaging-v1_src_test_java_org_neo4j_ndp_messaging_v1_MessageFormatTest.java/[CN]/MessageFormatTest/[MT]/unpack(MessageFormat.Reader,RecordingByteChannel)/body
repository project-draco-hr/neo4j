{
  String serialized=BytePrinter.hex(channel.getBytes());
  RecordingMessageHandler messages=new RecordingMessageHandler();
  try {
    reader.reset(channel).read(messages);
  }
 catch (  Throwable e) {
    throw new AssertionError("Failed to unpack message, wire data was:\n" + serialized + "["+ channel.getBytes().length+ "b]",e);
  }
  return (T)messages.asList().get(0);
}
