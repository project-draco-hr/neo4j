{
  try {
    fileChannel=fs.open(fileName,"rw");
    ByteBuffer buffer=ByteBuffer.allocate(HEADER_SIZE);
    readHeader(buffer);
    markAsSticky(buffer);
    fileChannel.position(HEADER_SIZE);
    maxReadPosition=fileChannel.size();
    defraggedIdCount=(int)(maxReadPosition - HEADER_SIZE) / 8;
    readIdBatch();
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException("Unable to init id generator " + fileName,e);
  }
}
