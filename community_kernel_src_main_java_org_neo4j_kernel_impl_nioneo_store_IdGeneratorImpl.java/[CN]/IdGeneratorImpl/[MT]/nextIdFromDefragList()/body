{
  if (aggressiveReuse) {
    Long id=releasedIdList.poll();
    if (id != null) {
      defraggedIdCount--;
      return id.longValue();
    }
  }
  if (!defragedIdList.isEmpty() || canReadMoreIdBatches()) {
    if (defragedIdList.isEmpty()) {
      readIdBatch();
    }
    long id=defragedIdList.removeFirst();
    defraggedIdCount--;
    return id;
  }
  return -1;
}
