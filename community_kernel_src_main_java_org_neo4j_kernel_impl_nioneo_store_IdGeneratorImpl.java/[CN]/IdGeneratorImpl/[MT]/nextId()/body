{
  assertStillOpen();
  long nextDefragId=nextIdFromDefragList();
  if (nextDefragId != -1) {
    return nextDefragId;
  }
  assertIdWithinCapacity(nextFreeId.get());
  return nextFreeId.getAndIncrement();
}
