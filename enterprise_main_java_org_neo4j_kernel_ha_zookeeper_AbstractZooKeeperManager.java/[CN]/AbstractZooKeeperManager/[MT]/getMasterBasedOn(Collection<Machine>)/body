{
  Map<Integer,Pair<Long,Integer>> debugData=new TreeMap<Integer,Pair<Long,Integer>>();
  Machine master=null;
  int lowestSeq=Integer.MAX_VALUE;
  long highestTxId=-1;
  for (  Machine info : getAllMachines().values()) {
    debugData.put(info.getMachineId(),new Pair<Long,Integer>(info.getLatestTxId(),info.getSequenceId()));
    if (info.getLatestTxId() >= highestTxId) {
      highestTxId=info.getLatestTxId();
      if (info.getSequenceId() < lowestSeq) {
        master=info;
        lowestSeq=info.getSequenceId();
      }
    }
  }
  System.out.println("getMaster " + (master != null ? master.getMachineId() : "none") + " based on "+ debugData);
  return master;
}
