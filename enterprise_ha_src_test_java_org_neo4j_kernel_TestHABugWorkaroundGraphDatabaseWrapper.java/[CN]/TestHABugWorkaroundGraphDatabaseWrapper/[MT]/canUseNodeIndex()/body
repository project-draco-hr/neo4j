{
  Node node=createNode();
  Index<Node> nodeIndex=graphdb.index().forNodes("nodeIndex");
  indexAdd(nodeIndex,node,"key","value");
  assertEquals(node,nodeIndex.get("key","value").getSingle());
  assertEquals(node,nodeIndex.query("key:value").getSingle());
  assertEquals(node,nodeIndex.query("key","value").getSingle());
  assertContainsAll(nodeIndex.get("key","value"),node);
  assertEquals(1,nodeIndex.get("key","value").size());
  indexRemove(nodeIndex,node);
  assertNull(nodeIndex.get("key","value").getSingle());
  indexAdd(nodeIndex,node,"key","value");
  assertEquals(node,nodeIndex.get("key","value").getSingle());
  indexRemove(nodeIndex,node,"key");
  assertNull(nodeIndex.get("key","value").getSingle());
  indexAdd(nodeIndex,node,"key","value");
  assertEquals(node,nodeIndex.get("key","value").getSingle());
  indexRemove(nodeIndex,node,"key","value");
  assertNull(nodeIndex.get("key","value").getSingle());
  assertEquals("nodeIndex",nodeIndex.getName());
  assertEquals(Node.class,nodeIndex.getEntityType());
}
