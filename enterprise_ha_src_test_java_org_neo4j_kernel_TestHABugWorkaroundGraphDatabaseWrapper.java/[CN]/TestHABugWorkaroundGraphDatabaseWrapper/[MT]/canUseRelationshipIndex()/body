{
  Node node1=createNode();
  Node node2=createNode();
  Node node3=createNode();
  Relationship rel=createRelationship(node1,node2,TestTypes.TEST);
  RelationshipIndex relIndex=graphdb.index().forRelationships("relIndex");
  indexAdd(relIndex,rel,"key","value");
  assertEquals(rel,relIndex.get("key","value").getSingle());
  assertEquals(rel,relIndex.get("key","value",node1,node2).getSingle());
  assertNull(relIndex.get("key","value",node1,node3).getSingle());
  assertEquals(rel,relIndex.query("key:value").getSingle());
  assertEquals(rel,relIndex.query("key","value").getSingle());
  assertEquals(rel,relIndex.query("key","value",node1,node2).getSingle());
  assertEquals(rel,relIndex.query("key:value",node1,node2).getSingle());
  assertNull(relIndex.query("key","value",node1,node3).getSingle());
  assertContainsAll(relIndex.get("key","value"),rel);
  assertEquals(1,relIndex.get("key","value").size());
  indexRemove(relIndex,rel);
  assertNull(relIndex.get("key","value").getSingle());
  indexAdd(relIndex,rel,"key","value");
  assertEquals(rel,relIndex.get("key","value").getSingle());
  indexRemove(relIndex,rel,"key");
  assertNull(relIndex.get("key","value").getSingle());
  indexAdd(relIndex,rel,"key","value");
  assertEquals(rel,relIndex.get("key","value").getSingle());
  indexRemove(relIndex,rel,"key","value");
  assertNull(relIndex.get("key","value").getSingle());
  assertEquals("relIndex",relIndex.getName());
  assertEquals(Relationship.class,relIndex.getEntityType());
}
