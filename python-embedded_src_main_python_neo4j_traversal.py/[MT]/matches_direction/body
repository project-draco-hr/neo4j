def matches_direction(path, direction):
    if (direction is any):
        return True
    rel = path.last_relationship
    return ((rel.end == path.end) and (direction is outgoing))
