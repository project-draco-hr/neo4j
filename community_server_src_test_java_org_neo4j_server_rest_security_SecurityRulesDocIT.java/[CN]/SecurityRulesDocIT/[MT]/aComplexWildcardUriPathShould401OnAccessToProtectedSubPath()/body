{
  String mountPoint="/protected/wildcard_replacement/x/y/z/something/else/more_wildcard_replacement/a/b/c" + "/final/bit";
  server=CommunityServerBuilder.server().withDefaultDatabaseTuning().withThirdPartyJaxRsPackage("org.dummy.web.service",mountPoint).withSecurityRules(PermanentlyFailingSecurityRuleWithComplexWildcardPath.class.getCanonicalName()).usingDatabaseDir(folder.cleanDirectory(name.getMethodName()).getAbsolutePath()).build();
  server.start();
  gen.get().addSnippet("config","\n[source,properties]\n----\norg.neo4j.server.rest.security_rules=my.rules" + ".PermanentlyFailingSecurityRuleWithComplexWildcardPath\n----\n");
  gen.get().addTestSourceSnippets(PermanentlyFailingSecurityRuleWithComplexWildcardPath.class,"failingRuleWithComplexWildcardPath");
  gen.get().setSection("ops");
  functionalTestHelper=new FunctionalTestHelper(server);
  JaxRsResponse clientResponse=gen.get().expectedStatus(401).expectedType(MediaType.APPLICATION_JSON_TYPE).expectedHeader("WWW-Authenticate").get(trimTrailingSlash(functionalTestHelper.baseUri()) + mountPoint + "/more/stuff").response();
  assertEquals(401,clientResponse.getStatus());
}
