{
  server=CommunityServerBuilder.server().withDefaultDatabaseTuning().withSecurityRules(NoAccessToDatabaseSecurityRule.class.getCanonicalName(),NoAccessToWebAdminSecurityRule.class.getCanonicalName()).usingDatabaseDir(folder.cleanDirectory(name.getMethodName()).getAbsolutePath()).build();
  server.start();
  functionalTestHelper=new FunctionalTestHelper(server);
  gen.get().expectedStatus(401).get(functionalTestHelper.dataUri()).response();
  gen.get().expectedStatus(401).expectedType(MediaType.TEXT_HTML_TYPE).get(functionalTestHelper.webAdminUri()).response();
  assertTrue(NoAccessToDatabaseSecurityRule.wasInvoked());
  assertTrue(NoAccessToWebAdminSecurityRule.wasInvoked());
}
