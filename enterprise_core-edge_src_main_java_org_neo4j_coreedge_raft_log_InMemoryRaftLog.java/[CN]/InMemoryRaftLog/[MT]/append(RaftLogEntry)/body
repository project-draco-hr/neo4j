{
  Objects.requireNonNull(logEntry);
  if (logEntry.term() >= term) {
    term=logEntry.term();
  }
 else {
    throw new RaftStorageException(String.format("Non-monotonic term %d for in entry %s in term %d",logEntry.term(),logEntry.toString(),term));
  }
  for (  Listener listener : listeners) {
    listener.onAppended(logEntry.content());
  }
  raftLog.put(++appendIndex,logEntry);
  return appendIndex;
}
