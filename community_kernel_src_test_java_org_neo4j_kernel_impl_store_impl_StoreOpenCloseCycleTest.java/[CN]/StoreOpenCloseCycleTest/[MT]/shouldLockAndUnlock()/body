{
  StoreFormat<?,?> format=mock(StoreFormat.class);
  when(format.version()).thenReturn("v1.0.0");
  when(format.type()).thenReturn("SomeFormat");
  File dbFileName=new File("/store");
  StoreChannel channel=mock(StoreChannel.class);
  FileLock lock=mock(FileLock.class);
  FileSystemAbstraction fs=mock(FileSystemAbstraction.class);
  when(fs.tryLock(dbFileName,channel)).thenReturn(lock);
  StoreOpenCloseCycle logic=new StoreOpenCloseCycle(NullLog.getInstance(),dbFileName,format,fs);
  logic.openStore(channel);
  verify(fs).tryLock(dbFileName,channel);
  logic.closeStore(channel,0);
  verify(lock).release();
}
