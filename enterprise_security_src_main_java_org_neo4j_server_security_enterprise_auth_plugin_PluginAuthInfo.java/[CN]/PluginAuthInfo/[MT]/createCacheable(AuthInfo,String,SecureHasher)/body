{
  if (authInfo instanceof CacheableAuthInfo) {
    byte[] credentials=((CacheableAuthInfo)authInfo).getCredentials();
    SimpleHash hashedCredentials=secureHasher.hash(credentials);
    return new PluginAuthInfo(authInfo,hashedCredentials,realmName);
  }
 else {
    return new PluginAuthInfo(authInfo.getPrincipal(),realmName,authInfo.getRoles().stream().collect(Collectors.toSet()));
  }
}
