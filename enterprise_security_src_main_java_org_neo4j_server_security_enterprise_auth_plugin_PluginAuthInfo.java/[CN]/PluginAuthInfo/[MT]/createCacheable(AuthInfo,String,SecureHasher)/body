{
  if (authInfo instanceof CacheableAuthInfo) {
    byte[] credentials=((CacheableAuthInfo)authInfo).credentials();
    SimpleHash hashedCredentials=secureHasher.hash(credentials);
    return new PluginAuthInfo(authInfo,hashedCredentials,realmName);
  }
 else {
    return new PluginAuthInfo(authInfo.principal(),realmName,authInfo.roles().stream().collect(Collectors.toSet()));
  }
}
