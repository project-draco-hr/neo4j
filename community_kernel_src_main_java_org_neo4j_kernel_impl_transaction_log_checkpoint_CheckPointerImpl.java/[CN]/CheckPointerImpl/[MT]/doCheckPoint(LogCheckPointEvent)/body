{
  long[] lastClosedTransaction=transactionIdStore.getLastClosedTransaction();
  long lastClosedTransactionId=lastClosedTransaction[0];
  LogPosition logPosition=new LogPosition(lastClosedTransaction[1],lastClosedTransaction[2]);
  msgLog.info(prefix(lastClosedTransactionId) + "Starting check pointing...");
  kernelHealth.assertHealthy(IOException.class);
  msgLog.info(prefix(lastClosedTransactionId) + " Starting store flush...");
  storeFlusher.forceEverything();
  msgLog.info(prefix(lastClosedTransactionId) + " Store flush completed");
  kernelHealth.assertHealthy(IOException.class);
  msgLog.info(prefix(lastClosedTransactionId) + " Starting appending check point entry into the tx log...");
  appender.checkPoint(logPosition,logCheckPointEvent);
  threshold.checkPointHappened(lastClosedTransactionId);
  msgLog.info(prefix(lastClosedTransactionId) + " Appending check point entry into the tx log completed");
  msgLog.info(prefix(lastClosedTransactionId) + "Check pointing completed");
  logPruning.pruneLogs(logPosition.getLogVersion());
  lastCheckPointedTx=lastClosedTransactionId;
  return lastClosedTransactionId;
}
