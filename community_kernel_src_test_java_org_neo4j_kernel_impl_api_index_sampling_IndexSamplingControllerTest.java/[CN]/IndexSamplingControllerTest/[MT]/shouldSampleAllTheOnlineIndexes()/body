{
  IndexSamplingController controller=newSamplingController();
  when(tracker.canExecuteMoreSamplingJobs()).thenReturn(true);
  when(indexProxy.getState()).thenReturn(ONLINE);
  when(anotherIndexProxy.getState()).thenReturn(POPULATING);
  indexMap.putIndexProxy(3,anotherIndexProxy);
  controller.sampleIndexes(TRIGGER_REBUILD_UPDATED);
  verify(jobFactory).create(samplingConfig,indexProxy);
  verify(tracker).scheduleSamplingJob(job);
  verify(tracker,times(2)).waitUntilCanExecuteMoreSamplingJobs();
  verifyNoMoreInteractions(jobFactory,tracker);
}
