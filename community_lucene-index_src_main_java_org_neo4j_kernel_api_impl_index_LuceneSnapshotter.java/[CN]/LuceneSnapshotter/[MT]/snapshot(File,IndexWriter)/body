{
  SnapshotDeletionPolicy deletionPolicy=(SnapshotDeletionPolicy)writer.getConfig().getIndexDeletionPolicy();
  try {
    return new LuceneSnapshotIterator(indexDir,deletionPolicy.snapshot(ID),deletionPolicy);
  }
 catch (  IllegalStateException e) {
    if (e.getMessage().equals(NO_INDEX_COMMIT_TO_SNAPSHOT)) {
      return emptyIterator();
    }
    throw e;
  }
}
