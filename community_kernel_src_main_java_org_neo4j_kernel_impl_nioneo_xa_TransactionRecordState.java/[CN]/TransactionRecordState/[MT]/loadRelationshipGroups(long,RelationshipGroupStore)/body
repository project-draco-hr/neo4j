{
  long groupId=firstGroup;
  long previousGroupId=Record.NO_NEXT_RELATIONSHIP.intValue();
  Map<Integer,RelationshipGroupRecord> result=new HashMap<>();
  while (groupId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    RelationshipGroupRecord record=store.getRecord(groupId);
    record.setPrev(previousGroupId);
    result.put(record.getType(),record);
    previousGroupId=groupId;
    groupId=record.getNext();
  }
  return result;
}
