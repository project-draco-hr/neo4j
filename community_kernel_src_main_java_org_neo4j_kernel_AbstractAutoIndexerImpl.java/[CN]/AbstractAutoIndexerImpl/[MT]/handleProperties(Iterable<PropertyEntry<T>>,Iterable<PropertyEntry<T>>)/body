{
  final Index<T> nodeIndex=getIndexInternal();
  for (  PropertyEntry<T> entry : assigned) {
    Object previousValue=entry.previouslyCommitedValue();
    String key=entry.key();
    if (propertyKeysToInclude.contains(key)) {
      if (previousValue != null) {
        nodeIndex.remove(entry.entity(),key,previousValue);
      }
      nodeIndex.add(entry.entity(),key,entry.value());
    }
 else     if (previousValue != null) {
      nodeIndex.remove(entry.entity(),key,previousValue);
    }
  }
  for (  PropertyEntry<T> entry : removed) {
    String key=entry.key();
    Object previouslyCommitedValue=entry.previouslyCommitedValue();
    if (previouslyCommitedValue != null) {
      nodeIndex.remove(entry.entity(),key,previouslyCommitedValue);
    }
  }
}
