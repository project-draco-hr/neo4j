{
  List<NeoBackupTask> tasks=new ArrayList<NeoBackupTask>();
  logger.info("Checking and preparing " + xaNames.toString() + " data sources.");
  for (  String xaName : xaNames) {
    XaDataSourceResource srcDataSource=srcResource.getDataSource(xaName);
    if (srcDataSource == null) {
      String message="XaDataSource not found in backup source: [" + xaName + "]";
      logger.severe(message);
      throw new RuntimeException(message);
    }
 else {
      XaDataSourceResource dstDataSource=dstResource.getDataSource(xaName);
      if (dstDataSource == null) {
        String message="XaDataSource not found in backup destination: [" + xaName + "]";
        logger.severe(message);
        throw new RuntimeException(message);
      }
 else {
        NeoBackupTask task=new NeoBackupTask(srcDataSource,dstDataSource);
        task.prepare();
        tasks.add(task);
      }
    }
  }
  if (tasks.size() == 0) {
    String message="No data sources to backup were found.";
    logger.severe(message);
    throw new RuntimeException(message);
  }
 else {
    for (    NeoBackupTask task : tasks) {
      task.run();
    }
    logger.info("Completed backup of " + tasks + " data sources.");
  }
}
