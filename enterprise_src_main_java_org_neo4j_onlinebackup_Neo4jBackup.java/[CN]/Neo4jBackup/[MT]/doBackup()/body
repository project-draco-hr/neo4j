{
  logger.info("Initializing backup.");
  Neo4jResource srcResource=new EmbeddedGraphDatabaseResource(onlineGraphDb);
  if (xaNames == null) {
    if (backupGraphDb == null) {
      Neo4jResource dstResource=LocalGraphDatabaseResource.getInstance(destDir);
      runSimpleBackup(srcResource,dstResource);
      dstResource.close();
    }
 else {
      Neo4jResource dstResource=new EmbeddedGraphDatabaseResource(backupGraphDb);
      runSimpleBackup(srcResource,dstResource);
    }
  }
 else {
    if (backupGraphDb == null) {
      Neo4jResource dstResource=LocalLuceneIndexResource.getInstance(destDir);
      runMultiBackup(srcResource,dstResource);
      dstResource.close();
    }
 else {
      Neo4jResource dstResource=new EmbeddedGraphDatabaseResource(backupGraphDb);
      runMultiBackup(srcResource,dstResource);
    }
  }
}
