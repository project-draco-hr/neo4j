{
  DatabaseHealth health=mock(DatabaseHealth.class);
  when(health.isHealthy()).thenReturn(false);
  PageCache pageCache=spy(pageCacheRule.getPageCache(fs.get()));
  NeoStoreDataSource ds=dsRule.getDataSource(dir.graphDbDir(),fs.get(),pageCache,stringMap(),health);
  ds.init();
  ds.start();
  verify(pageCache,never()).flushAndForce();
  ds.stop();
  ds.shutdown();
  verify(pageCache,never()).flushAndForce(IOLimiter.unlimited());
}
