{
  return sendRequest(HaRequestType.ALLOCATE_IDS,SlaveContext.EMPTY,new Serializer(){
    public void write(    ChannelBuffer buffer,    ByteBuffer readBuffer) throws IOException {
      buffer.writeByte(idType.ordinal());
    }
  }
,new Deserializer<IdAllocation>(){
    public IdAllocation read(    ChannelBuffer buffer,    ByteBuffer temporaryBuffer) throws IOException {
      return readIdAllocation(buffer);
    }
  }
).response();
}
