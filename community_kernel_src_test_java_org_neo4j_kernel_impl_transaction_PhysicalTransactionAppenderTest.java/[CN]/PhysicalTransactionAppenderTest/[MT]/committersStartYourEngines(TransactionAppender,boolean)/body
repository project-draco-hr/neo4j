{
  ExecutorService executor=cleanup.add(Executors.newCachedThreadPool());
  Future[] futures=new Future[transactions.length];
  for (int i=0; i < transactions.length; i++) {
    final TransactionRepresentation transaction=createTransaction(transactions[i],i);
    futures[i]=executor.submit(new Callable<Long>(){
      @Override public Long call() throws IOException {
        return appender.append(transaction);
      }
    }
);
  }
  return futures;
}
