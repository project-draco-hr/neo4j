{
  node.setDense(true);
  node.setNextRel(Record.NO_NEXT_RELATIONSHIP.intValue());
  long relId=firstRel.getId();
  RelationshipRecord relRecord=firstRel;
  while (relId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    relId=relChain(relRecord,node.getId()).get(relRecord);
    connectRelationshipToDenseNode(node,relRecord,relRecords,relGroupRecords);
    if (relId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
      locker.getWriteLock(relId);
      relRecord=relRecords.getOrLoad(relId,null).forChangingLinkage();
    }
  }
  if (upgradedDenseNodes == null) {
    upgradedDenseNodes=new ArrayList<>();
  }
  upgradedDenseNodes.add(node);
}
