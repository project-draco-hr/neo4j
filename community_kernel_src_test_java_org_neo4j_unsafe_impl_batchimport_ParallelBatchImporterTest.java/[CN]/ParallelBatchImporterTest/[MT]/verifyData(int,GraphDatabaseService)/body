{
  Set<Label> expectedLabels=new HashSet<>();
  for (  String label : LABELS) {
    expectedLabels.add(DynamicLabel.label(label));
  }
  GlobalGraphOperations globalOps=GlobalGraphOperations.at(db);
  Set<Label> allLabels=Iterables.toSet(globalOps.getAllLabels());
  assertThat(allLabels,is(expectedLabels));
  Random random=new Random();
  for (int i=0; i < 10; i++) {
    Node node=db.getNodeById(random.nextInt(nodeCount));
    int count=count(node.getRelationships());
    assertEquals("For node " + node,count,node.getDegree());
    for (    String key : node.getPropertyKeys()) {
      node.getProperty(key);
      Set<Label> actualLabels=Iterables.toSet(node.getLabels());
      assertThat(actualLabels,is(expectedLabels));
    }
  }
}
