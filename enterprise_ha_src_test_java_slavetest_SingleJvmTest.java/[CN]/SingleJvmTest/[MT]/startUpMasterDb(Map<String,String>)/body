{
  final int masterId=0;
  final Map<String,String> config=MapUtil.stringMap(extraConfig,HaSettings.server_id.name(),String.valueOf(masterId));
  addDefaultReadTimeout(config);
  String path=dbPath(0).getAbsolutePath();
  HighlyAvailableGraphDatabase haGraphDb=new HighlyAvailableGraphDatabase(path,config,Service.load(IndexProvider.class),Service.load(KernelExtension.class),Service.load(CacheProvider.class)){
    @Override protected Broker createBroker(){
      return makeMasterBroker(masterId,this,config);
    }
    @Override protected ClusterClient createClusterClient(){
      return makeMasterClusterClientFromBroker(getBroker());
    }
  }
;
  return haGraphDb;
}
