{
  int masterId=0;
  Map<String,String> config=MapUtil.stringMap(extraConfig,HaConfig.CONFIG_KEY_SERVER_ID,String.valueOf(masterId));
  addDefaultReadTimeout(config);
  String path=dbPath(0).getAbsolutePath();
  PlaceHolderGraphDatabaseService placeHolderDb=new PlaceHolderGraphDatabaseService(path);
  Broker broker=makeMasterBroker(masterId,placeHolderDb,config);
  HighlyAvailableGraphDatabase db=new HighlyAvailableGraphDatabase(new HAGraphDb(path,config,wrapBrokerAndSetPlaceHolderDb(placeHolderDb,broker)));
  placeHolderDb.setDb(db);
  return placeHolderDb;
}
