{
  final int masterId=0;
  final Map<String,String> config=MapUtil.stringMap(extraConfig,HaConfig.CONFIG_KEY_SERVER_ID,String.valueOf(masterId));
  addDefaultReadTimeout(config);
  String path=dbPath(0).getAbsolutePath();
  HighlyAvailableGraphDatabase haGraphDb=new HighlyAvailableGraphDatabase(path,config){
    @Override protected Broker createBroker(){
      return makeMasterBroker(masterId,this,config);
    }
    @Override protected ClusterClient createClusterClient(){
      return makeMasterClusterClientFromBroker(getBroker());
    }
  }
;
  return haGraphDb;
}
