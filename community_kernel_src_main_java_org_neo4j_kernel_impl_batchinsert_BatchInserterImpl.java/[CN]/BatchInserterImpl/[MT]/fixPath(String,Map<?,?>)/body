{
  File directories=new File(dir);
  if (!directories.exists()) {
    if (!directories.mkdirs()) {
      throw new UnderlyingStorageException("Unable to create directory path[" + storeDir + "] for Neo4j kernel store.");
    }
  }
  dir=FileUtils.fixSeparatorsInPath(dir);
  String fileSeparator=System.getProperty("file.separator");
  String store=dir + fileSeparator + NeoStore.DEFAULT_NAME;
  if (!new File(store).exists()) {
    NeoStore.createStore(store,config);
  }
  return store;
}
