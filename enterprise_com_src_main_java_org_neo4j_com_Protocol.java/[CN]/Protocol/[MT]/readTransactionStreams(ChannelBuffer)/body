{
  final String[] datasources=readTransactionStreamHeader(buffer);
  if (datasources.length == 1) {
    return TransactionStream.EMPTY;
  }
  return new TransactionStream(){
    @Override protected Pair<Long,TransactionRepresentation> fetchNextOrNull(){
      makeSureNextTransactionIsFullyFetched(buffer);
      String datasource=datasources[buffer.readUnsignedByte()];
      if (datasource == null) {
        return null;
      }
      long txId=buffer.readLong();
      TransactionRepresentation txRepr=null;
      return Pair.of(txId,txRepr);
    }
  }
;
}
