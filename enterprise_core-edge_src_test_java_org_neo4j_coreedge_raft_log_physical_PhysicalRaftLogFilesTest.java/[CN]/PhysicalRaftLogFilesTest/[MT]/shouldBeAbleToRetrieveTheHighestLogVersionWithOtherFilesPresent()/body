{
  fs.mkdir(tmpDirectory);
  PhysicalRaftLogFiles files=new PhysicalRaftLogFiles(tmpDirectory,fs,mock(ChannelMarshal.class),new VersionIndexRanges());
  writeLogHeader(fs,new File(tmpDirectory,BASE_FILE_NAME + DEFAULT_VERSION_SUFFIX + "1"),1,-1);
  writeLogHeader(fs,new File(tmpDirectory,"unknown" + DEFAULT_VERSION_SUFFIX + "4"),1,-1);
  writeLogHeader(fs,new File(tmpDirectory,BASE_FILE_NAME + DEFAULT_VERSION_SUFFIX + "3"),3,-1);
  writeLogHeader(fs,new File(tmpDirectory,BASE_FILE_NAME),1,-1);
  files.init();
  final long highestLogVersion=files.getHighestLogVersion();
  assertEquals(3,highestLogVersion);
}
