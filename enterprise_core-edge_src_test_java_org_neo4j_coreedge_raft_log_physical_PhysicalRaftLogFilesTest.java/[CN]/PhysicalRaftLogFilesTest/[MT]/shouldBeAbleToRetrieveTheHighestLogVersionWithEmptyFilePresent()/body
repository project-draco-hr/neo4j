{
  fs.mkdir(tmpDirectory);
  PhysicalRaftLogFiles files=new PhysicalRaftLogFiles(tmpDirectory,fs,mock(ChannelMarshal.class),new VersionIndexRanges());
  writeLogHeader(fs,new File(tmpDirectory,BASE_FILE_NAME + DEFAULT_VERSION_SUFFIX + "1"),1,-1);
  writeLogHeader(fs,new File(tmpDirectory,BASE_FILE_NAME + DEFAULT_VERSION_SUFFIX + "3"),3,42);
  File emptyFile=new File(tmpDirectory,BASE_FILE_NAME + DEFAULT_VERSION_SUFFIX + "4");
  fs.create(emptyFile);
  files.init();
  final long highestLogVersion=files.getHighestLogVersion();
  assertEquals(4,highestLogVersion);
  LogHeader logHeader=readLogHeader(fs,emptyFile);
  assertEquals(4,logHeader.logVersion);
  assertEquals(42,logHeader.lastCommittedTxId);
}
