{
  if (data == null || !(data.getData() instanceof PersistenceMetadata)) {
    String msg="The data for " + event + " is "+ data+ ", which does not implement PersistenceMetadata.";
    throw new IllegalArgumentException(msg);
  }
  ResourceConnection resource=broker.acquireResourceConnection();
  resource.performUpdate(event,data);
}
