{
  int logsFound=0;
  PhysicalRaftLogFiles files=new PhysicalRaftLogFiles(new File(filenameOrDirectory),fileSystem,marshal,new VersionIndexRanges());
  SingleVersionReader reader=new SingleVersionReader(files,fileSystem,marshal);
  for (  String fileName : filenamesOf(filenameOrDirectory,logPrefix)) {
    logsFound++;
    out.println("=== " + fileName + " ===");
    StoreChannel fileChannel=fileSystem.open(new File(fileName),"r");
    LogHeader logHeader;
    try {
      logHeader=readLogHeader(ByteBuffer.allocateDirect(LOG_HEADER_SIZE),fileChannel,false);
    }
 catch (    IOException ex) {
      out.println("Unable to read timestamp information, no records in logical log.");
      out.println(ex.getMessage());
      fileChannel.close();
      throw ex;
    }
    out.println("Logical log format:" + logHeader.logFormatVersion + "version: "+ logHeader.logVersion+ " with prev committed tx["+ logHeader.lastCommittedTxId+ "]");
    try (IOCursor<RaftLogAppendRecord> cursor=reader.readEntriesFrom(new LogPosition(logHeader.logVersion,LogHeader.LOG_HEADER_SIZE))){
      while (cursor.next()) {
        out.println(cursor.get().toString());
      }
    }
   }
  return logsFound;
}
