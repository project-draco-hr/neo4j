{
  init();
  while (true) {
    try {
      String line=this.readLine(tryGetProperPromptString());
      if (EXIT_COMMANDS.contains(line)) {
        break;
      }
      line=expandLine(line);
      String result=this.getServer().interpretLine(line,session(),getOutput());
      if (result == null || result.trim().length() == 0) {
        continue;
      }
      if (result.contains("e")) {
        break;
      }
    }
 catch (    Exception e) {
      if (this.shouldPrintStackTraces()) {
        e.printStackTrace();
      }
 else {
        this.console.format(getShortExceptionMessage(e) + "\n");
      }
    }
  }
  this.shutdown();
}
