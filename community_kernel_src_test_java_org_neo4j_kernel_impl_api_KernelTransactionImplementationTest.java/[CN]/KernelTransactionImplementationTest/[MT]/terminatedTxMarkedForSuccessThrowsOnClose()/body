{
  Locks locks=mock(Locks.class);
  Locks.Client client=mock(Locks.Client.class);
  when(locks.newClient()).thenReturn(client);
  KernelTransactionImplementation tx=newInitializedTransaction(true,locks);
  tx.success();
  tx.markForTermination(Status.General.UnknownFailure);
  try {
    tx.close();
    fail("Exception expected");
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(TransactionTerminatedException.class));
  }
}
