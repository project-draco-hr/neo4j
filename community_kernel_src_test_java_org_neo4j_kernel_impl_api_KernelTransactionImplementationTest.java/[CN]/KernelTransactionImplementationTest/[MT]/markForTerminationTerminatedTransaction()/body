{
  Locks.Client locksClient=mock(Locks.Client.class);
  KernelTransactionImplementation tx=newTransaction(accessMode(),locksClient,true);
  transactionInitializer.accept(tx);
  tx.markForTermination(Status.Transaction.Terminated);
  tx.markForTermination(Status.Transaction.Outdated);
  tx.markForTermination(Status.Transaction.LockClientStopped);
  assertEquals(Status.Transaction.Terminated,tx.getReasonIfTerminated());
  verify(locksClient).stop();
  verify(transactionMonitor).transactionTerminated(isWriteTx);
}
