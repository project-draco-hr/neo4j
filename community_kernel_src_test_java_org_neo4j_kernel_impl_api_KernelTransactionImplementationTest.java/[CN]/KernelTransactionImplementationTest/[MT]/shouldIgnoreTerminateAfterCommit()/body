{
  Locks locks=mock(Locks.class);
  Locks.Client client=mock(Locks.Client.class);
  when(locks.newClient()).thenReturn(client);
  KernelTransaction transaction=newInitializedTransaction(true,locks);
  transaction.success();
  transaction.close();
  transaction.markForTermination(Status.General.UnknownFailure);
  verify(transactionMonitor,times(1)).transactionFinished(true);
  verify(transactionMonitor,never()).transactionTerminated();
  verify(client,never()).stop();
  verifyNoMoreInteractions(transactionMonitor);
}
