{
  Transaction tx=underlyingNode.getGraphDatabase().beginTx();
  try {
    if (!this.equals(otherPerson)) {
      Relationship friendRel=getFriendRelationshipTo(otherPerson);
      if (friendRel == null) {
        underlyingNode.createRelationshipTo(otherPerson.getUnderlyingNode(),FRIEND);
      }
      tx.success();
    }
  }
  finally {
    tx.finish();
  }
}
