{
  int bytesToKeep=6;
  int segmentFilesCount=14;
  int expectedIndex=segmentFilesCount - bytesToKeep;
  Segments segments=mock(Segments.class);
  ListIterator<SegmentFile> testSegmentFiles=testSegmentFiles(segmentFilesCount);
  when(segments.getSegmentFileIteratorAtEnd()).thenReturn(testSegmentFiles);
  SizeBasedLogPruningStrategy sizeBasedLogPruningStrategy=new SizeBasedLogPruningStrategy(bytesToKeep);
  assertEquals(expectedIndex,sizeBasedLogPruningStrategy.getIndexToKeep(segments));
}
