{
  machine.init("FunClient/1.2",Collections.<String,Object>emptyMap(),null,Session.Callback.NO_OP);
  machine.beginTransaction();
  machine.close();
  assertThat(machine.state(),CoreMatchers.equalTo(SessionStateMachine.State.STOPPED));
  verify(spi).beginTransaction(any(KernelTransaction.Type.class),any(AccessMode.class));
  verify(ktx).close();
}
