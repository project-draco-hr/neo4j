{
  IndexConfiguration config=IndexConfiguration.NON_UNIQUE;
  IndexSamplingConfig indexSamplingConfig=new IndexSamplingConfig(Config.empty());
  IndexPopulator populator=indexProvider.getPopulator(17,descriptor,config,indexSamplingConfig);
  populator.create();
  long nodeId=1;
  int propertyKeyId=10, labelId=11;
  final String propertyValue="value1";
  PropertyAccessor propertyAccessor=new PropertyAccessor(){
    @Override public Property getProperty(    long nodeId,    int propertyKeyId) throws EntityNotFoundException {
      return Property.stringProperty(propertyKeyId,propertyValue);
    }
  }
;
  populator.add(singletonList(NodePropertyUpdate.add(nodeId,0,propertyValue,new long[]{0})));
  try (IndexUpdater updater=populator.newPopulatingUpdater(propertyAccessor)){
    updater.process(add(nodeId,propertyKeyId,propertyValue,new long[]{labelId}));
  }
   populator.close(true);
  IndexAccessor accessor=indexProvider.getOnlineAccessor(17,IndexConfiguration.NON_UNIQUE,indexSamplingConfig);
  try (IndexReader reader=accessor.newReader()){
    PrimitiveLongIterator nodes=reader.seek(propertyValue);
    assertEquals(asSet(1L),PrimitiveLongCollections.toSet(nodes));
  }
   accessor.close();
}
