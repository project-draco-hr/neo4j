{
  from=canonicalFile(from);
  to=canonicalFile(to);
  boolean replaceExisting=false;
  for (  CopyOption op : copyOptions) {
    if (op == StandardCopyOption.REPLACE_EXISTING) {
      replaceExisting=true;
    }
  }
  if (!files.containsKey(from)) {
    throw new IOException("'" + from + "' doesn't exist");
  }
  if (!replaceExisting && files.containsKey(to)) {
    throw new IOException("'" + to + "' already exists");
  }
  files.put(to,files.remove(from));
  return true;
}
