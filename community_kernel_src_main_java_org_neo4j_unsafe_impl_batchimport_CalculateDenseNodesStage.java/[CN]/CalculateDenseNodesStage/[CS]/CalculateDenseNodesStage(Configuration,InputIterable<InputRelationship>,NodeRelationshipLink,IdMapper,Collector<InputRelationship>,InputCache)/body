{
  super("Calculate dense nodes",config,false);
  add(new InputIteratorBatcherStep<>(control(),config.batchSize(),config.movingAverageSize(),relationships.iterator(),InputRelationship.class));
  if (!relationships.supportsMultiplePasses()) {
    add(new InputEntityCacherStep<>(control(),config.workAheadSize(),config.movingAverageSize(),inputCache.cacheRelationships()));
  }
  add(new RelationshipPreparationStep(control(),config,idMapper));
  add(new CalculateDenseNodesStep(control(),config,nodeRelationshipLink,badRelationshipsCollector));
}
