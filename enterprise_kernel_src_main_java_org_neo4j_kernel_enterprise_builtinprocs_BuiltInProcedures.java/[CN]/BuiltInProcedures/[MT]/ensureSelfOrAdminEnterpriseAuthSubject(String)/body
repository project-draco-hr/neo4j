{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  if (subject.isAdmin() || subject.hasUsername(username)) {
    subject.ensureUserExistsWithName(username);
    return subject;
  }
  throw new AuthorizationViolationException(PERMISSION_DENIED);
}
