{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  subject.ensureUserExistsWithName(username);
  if (subject.isAdmin() || subject.hasUsername(username)) {
    return subject;
  }
  throw new AuthorizationViolationException(PERMISSION_DENIED);
}
