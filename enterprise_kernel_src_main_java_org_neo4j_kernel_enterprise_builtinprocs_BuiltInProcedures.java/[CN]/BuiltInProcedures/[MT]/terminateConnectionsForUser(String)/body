{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  if (!subject.isAdmin() && !subject.hasUsername(username)) {
    throw new AuthorizationViolationException(PERMISSION_DENIED);
  }
  subject.ensureUserExistsWithName(username);
  return terminateConnectionsForValidUser(username);
}
