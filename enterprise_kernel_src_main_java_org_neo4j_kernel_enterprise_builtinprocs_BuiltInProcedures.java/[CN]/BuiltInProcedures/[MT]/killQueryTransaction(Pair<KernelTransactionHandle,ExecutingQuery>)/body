{
  ExecutingQuery query=pair.other();
  if (isAdminEnterpriseAuthSubject() || authSubject.hasUsername(query.authSubjectName())) {
    pair.first().markForTermination(Status.Transaction.Terminated);
    return new QueryTerminationResult(queryId(query.kernelQueryId()),query.authSubjectName());
  }
 else {
    throw new AuthorizationViolationException(PERMISSION_DENIED);
  }
}
