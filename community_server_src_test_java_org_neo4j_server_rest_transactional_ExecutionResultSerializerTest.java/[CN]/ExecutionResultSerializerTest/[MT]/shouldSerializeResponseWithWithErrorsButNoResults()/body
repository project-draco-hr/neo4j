{
  ByteArrayOutputStream output=new ByteArrayOutputStream();
  ExecutionResultSerializer serializer=new ExecutionResultSerializer(output,txUriScheme);
  serializer.prologue(1337l);
  serializer.epilogue(iterator(new UnableToStartTransactionError(null),new UnknownStatementError("SOME STRING",null)));
  Map<String,Object> result=deserialize(output);
  assertThat(((String)result.get("commit")),equalTo("transaction/1337/commit"));
  assertThat(result.keySet().size(),equalTo(3));
  List<Map<String,Object>> errors=listOfMaps(result.get("errors"));
  assertThat(errors.size(),equalTo(2));
  assertThat((Long.valueOf((Integer)errors.get(0).get("code"))),equalTo(Neo4jError.Code.UNABLE_TO_START_TRANSACTION.getCode()));
  assertThat((Long.valueOf((Integer)errors.get(1).get("code"))),equalTo(Neo4jError.Code.UNKNOWN_STATEMENT_ERROR.getCode()));
  assertThat(((String)errors.get(1).get("message")),containsString("SOME STRING"));
}
