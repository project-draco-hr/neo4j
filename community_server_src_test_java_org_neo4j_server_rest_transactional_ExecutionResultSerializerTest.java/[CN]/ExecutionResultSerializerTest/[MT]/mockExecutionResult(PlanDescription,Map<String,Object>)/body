{
  Set<String> keys=new HashSet<>();
  for (  Map<String,Object> row : rows) {
    keys.addAll(row.keySet());
  }
  ExtendedExecutionResult executionResult=mock(ExtendedExecutionResult.class);
  when(executionResult.columns()).thenReturn(new ArrayList<>(keys));
  final Iterator<Map<String,Object>> inner=asList(rows).iterator();
  ResourceIterator<Map<String,Object>> iterator=new ResourceIterator<Map<String,Object>>(){
    @Override public void close(){
    }
    @Override public boolean hasNext(){
      return inner.hasNext();
    }
    @Override public Map<String,Object> next(){
      return inner.next();
    }
    @Override public void remove(){
      inner.remove();
    }
  }
;
  when(executionResult.planDescriptionRequested()).thenReturn(null != planDescription);
  if (executionResult.planDescriptionRequested()) {
    when(executionResult.executionPlanDescription()).thenReturn(planDescription);
  }
  when(executionResult.iterator()).thenReturn(iterator);
  return executionResult;
}
