{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ExecutionResultSerializer serializer=new ExecutionResultSerializer(baos);
  serializer.begin(1337l);
  serializer.finish(iterator(new UnableToStartTransactionError(null),new UnknownStatementError("SOME STRING",null)));
  Map<String,Object> result=deserialize(baos);
  assertThat(((Integer)result.get("txId")),equalTo(1337));
  assertThat(result.keySet().size(),equalTo(3));
  List<Map> errors=(List<Map>)result.get("errors");
  assertThat(errors.size(),equalTo(2));
  assertThat((Long.valueOf((Integer)errors.get(0).get("code"))),equalTo(Neo4jError.Code.UNABLE_TO_START_TRANSACTION.getCode()));
  assertThat((Long.valueOf((Integer)errors.get(1).get("code"))),equalTo(Neo4jError.Code.UNKNOWN_STATEMENT_ERROR.getCode()));
  assertThat(((String)errors.get(1).get("message")),containsString("SOME STRING"));
}
