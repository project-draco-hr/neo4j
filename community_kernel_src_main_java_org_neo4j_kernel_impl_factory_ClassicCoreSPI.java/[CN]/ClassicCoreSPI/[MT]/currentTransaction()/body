{
  assertDatabaseAvailable();
  KernelTransaction tx=dataSource.threadToTransactionBridge.getKernelTransactionBoundToThisThread(false);
  if (tx == null) {
    throw new NotInTransactionException();
  }
  return tx;
}
