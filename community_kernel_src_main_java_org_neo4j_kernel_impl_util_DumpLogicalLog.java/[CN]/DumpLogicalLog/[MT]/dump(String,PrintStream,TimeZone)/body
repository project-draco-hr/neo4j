{
  int logsFound=0;
  for (  String fileName : filenamesOf(filenameOrDirectory,getLogPrefix())) {
    logsFound++;
    out.println("=== " + fileName + " ===");
    StoreChannel fileChannel=fileSystem.open(new File(fileName),"r");
    ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
    long logVersion, prevLastCommittedTx;
    try {
      long[] header=VersionAwareLogEntryReader.readLogHeader(buffer,fileChannel,false);
      logVersion=header[0];
      prevLastCommittedTx=header[1];
    }
 catch (    IOException ex) {
      out.println("Unable to read timestamp information, no records in logical log.");
      out.println(ex.getMessage());
      fileChannel.close();
      throw ex;
    }
    out.println("Logical log version: " + logVersion + " with prev committed tx["+ prevLastCommittedTx+ "]");
    LogDeserializer deserializer=new LogDeserializer(instantiateCommandReaderFactory());
    ReadableLogChannel logChannel=new ReadAheadLogChannel(new PhysicalLogVersionedStoreChannel(fileChannel,logVersion),LogVersionBridge.NO_MORE_CHANNELS,4096);
    try (IOCursor<LogEntry> cursor=deserializer.logEntries(logChannel)){
      while (cursor.next()) {
        out.println(cursor.get().toString(timeZone));
      }
    }
   }
  return logsFound;
}
