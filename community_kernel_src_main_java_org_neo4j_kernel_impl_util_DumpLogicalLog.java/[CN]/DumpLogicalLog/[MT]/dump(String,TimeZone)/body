{
  int logsFound=0;
  for (  String fileName : filenamesOf(filenameOrDirectory,getLogPrefix())) {
    logsFound++;
    System.out.println("=== " + fileName + " ===");
    StoreChannel fileChannel=fileSystem.open(new File(fileName),"r");
    ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
    long logVersion, prevLastCommittedTx, logFormat;
    try {
      long[] header=LogIoUtils.readLogHeader(buffer,fileChannel,true);
      logVersion=header[0];
      prevLastCommittedTx=header[1];
      logFormat=header[2];
    }
 catch (    IOException ex) {
      System.out.println("Unable to read timestamp information, " + "no records in logical log.");
      System.out.println(ex.getMessage());
      fileChannel.close();
      throw ex;
    }
    System.out.println("Logical log format:" + logFormat + " version:"+ logVersion+ " with prev committed tx["+ prevLastCommittedTx+ "]");
    long logEntriesFound=0;
    XaCommandFactory cf=instantiateCommandFactory();
    while (readAndPrintEntry(fileChannel,buffer,cf,timeZone)) {
      logEntriesFound++;
    }
    fileChannel.close();
  }
  return logsFound;
}
