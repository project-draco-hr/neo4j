{
  if (depth > maxDepth) {
    return;
  }
  Node toNode=fromRel.getOtherNode(fromNode);
  trail.add(fromRel);
  trail.add(toNode);
  Set<Relationship> childRels=new HashSet<Relationship>();
  for (  Relationship childRel : toNode.getRelationships(relationshipType,direction)) {
    if (!traversedRels.add(childRel.getId())) {
      continue;
    }
    childRels.add(childRel);
    result.add(constructPath(trail,childRel,childRel.getOtherNode(toNode)));
  }
  for (  Relationship childRel : childRels) {
    traverse(traversedRels,result,trail,toNode,childRel,depth + 1,maxDepth);
  }
  trail.removeLast();
  trail.removeLast();
}
