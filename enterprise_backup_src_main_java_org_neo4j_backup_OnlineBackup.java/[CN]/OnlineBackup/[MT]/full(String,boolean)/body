{
  if (directoryContainsDb(targetDirectory)) {
    throw new RuntimeException(targetDirectory + " already contains a database");
  }
  BackupClient client=new BackupClient(hostNameOrIp,port,new NotYetExistingGraphDatabase(targetDirectory));
  try {
    Response<Void> response=client.fullBackup(new ToFileStoreWriter(targetDirectory));
    GraphDatabaseService targetDb=startTemporaryDb(targetDirectory,VerificationLevel.NONE);
    try {
      unpackResponse(response,targetDb,MasterUtil.txHandlerForFullCopy());
    }
  finally {
      targetDb.shutdown();
    }
    if (verification) {
      StoreAccess newStore=new StoreAccess(targetDirectory);
      try {
        new ConsistencyCheck(newStore).run();
      }
  finally {
        newStore.close();
      }
    }
  }
  finally {
    client.shutdown();
    StringLogger.close(targetDirectory);
  }
  return this;
}
