{
  if (!directoryContainsDb(targetDirectory)) {
    throw new RuntimeException(targetDirectory + " doesn't contain a database");
  }
  ConfigParam keepLogs=new ConfigParam(){
    @Override public void configure(    Map<String,String> config){
      config.put(GraphDatabaseSettings.keep_logical_logs.name(),GraphDatabaseSetting.TRUE);
    }
  }
;
  GraphDatabaseAPI targetDb=startTemporaryDb(targetDirectory,VerificationLevel.valueOf(verification),keepLogs);
  long backupStartTime=System.currentTimeMillis();
  OnlineBackup result=null;
  try {
    result=incremental(targetDb);
  }
  finally {
    targetDb.shutdown();
  }
  if (result != null) {
    bumpLogFile(targetDirectory,backupStartTime);
  }
  return result;
}
