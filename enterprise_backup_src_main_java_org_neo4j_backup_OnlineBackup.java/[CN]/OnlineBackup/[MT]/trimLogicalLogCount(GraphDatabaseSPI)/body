{
  for (  XaDataSource ds : targetDb.getXaDataSourceManager().getAllRegisteredDataSources()) {
    long currentVersion=ds.getCurrentLogVersion();
    while (ds.getLogicalLogLength(currentVersion) <= 16 && currentVersion > 0) {
      currentVersion--;
    }
    currentVersion--;
    while (ds.getLogicalLogLength(currentVersion) > 0) {
      ds.deleteLogicalLog(currentVersion);
      currentVersion--;
    }
  }
}
