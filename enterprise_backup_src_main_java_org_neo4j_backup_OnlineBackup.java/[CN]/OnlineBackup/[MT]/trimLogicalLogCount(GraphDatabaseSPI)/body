{
  for (  XaDataSource ds : targetDb.getXaDataSourceManager().getAllRegisteredDataSources()) {
    try {
      ds.rotateLogicalLog();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
    long currentVersion=ds.getCurrentLogVersion() - 1;
    while (ds.getLogicalLogLength(currentVersion) <= 16 && currentVersion > 0) {
      currentVersion--;
    }
    currentVersion--;
    while (ds.getLogicalLogLength(currentVersion) > 0) {
      ds.deleteLogicalLog(currentVersion);
      currentVersion--;
    }
  }
}
