{
  Tx[] oldTxs=original.lastAppliedTransactions();
  Tx[] newTxs=new Tx[oldTxs.length];
  for (int i=0; i < oldTxs.length; i++) {
    Tx oldTx=oldTxs[i];
    String dsName=oldTx.getDataSourceName();
    long originalTxId=oldTx.getTxId();
    Long diff=diffPerDataSource.get(dsName);
    if (diff == null) {
      diff=Long.valueOf(0L);
    }
    long newTxId=originalTxId + diff;
    newTxs[i]=SlaveContext.lastAppliedTx(dsName,newTxId);
  }
  return SlaveContext.anonymous(newTxs);
}
