{
  IdMapper mapper=new EncodingIdMapper(NumberArrayFactory.HEAP,new StringEncoder(),new Radix.String());
  ResourceIterable<Object> ids=IteratorUtil.<Object>resourceIterable(Arrays.<Object>asList("10","9","10"));
  try (ResourceIterator<Object> iterator=ids.iterator()){
    for (int i=0; iterator.hasNext(); i++) {
      mapper.put(iterator.next(),i);
    }
  }
   try {
    mapper.prepare(ids);
    fail("Should have failed");
  }
 catch (  IllegalStateException e) {
    assertTrue(e.getMessage().contains("10"));
  }
}
