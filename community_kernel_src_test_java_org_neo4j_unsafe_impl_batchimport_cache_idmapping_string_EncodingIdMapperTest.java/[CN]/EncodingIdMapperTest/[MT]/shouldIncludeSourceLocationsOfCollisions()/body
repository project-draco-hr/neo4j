{
  IdMapper mapper=new EncodingIdMapper(NumberArrayFactory.HEAP,new StringEncoder(),new Radix.String());
  final List<Object> idList=Arrays.<Object>asList("10","9","10");
  InputIterable<Object> ids=wrap("source",idList);
  try (ResourceIterator<Object> iterator=ids.iterator()){
    for (int i=0; iterator.hasNext(); i++) {
      mapper.put(iterator.next(),i,GLOBAL);
    }
  }
   try {
    mapper.prepare(ids);
    fail("Should have failed");
  }
 catch (  IllegalStateException e) {
    assertThat(e.getMessage(),containsString("10"));
    assertThat(e.getMessage(),containsString("source:1"));
    assertThat(e.getMessage(),containsString("source:3"));
  }
}
