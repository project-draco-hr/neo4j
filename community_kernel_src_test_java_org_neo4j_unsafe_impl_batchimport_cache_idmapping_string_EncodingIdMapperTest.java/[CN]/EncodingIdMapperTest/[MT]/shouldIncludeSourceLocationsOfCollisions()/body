{
  IdMapper mapper=new EncodingIdMapper(NumberArrayFactory.HEAP,new StringEncoder(),new Radix.String(),NO_MONITOR);
  final List<Object> idList=Arrays.<Object>asList("10","9","10");
  InputIterable<Object> ids=wrap("source",idList);
  Group group=new Group.Adapter(GLOBAL.id(),"global");
  try (ResourceIterator<Object> iterator=ids.iterator()){
    for (int i=0; iterator.hasNext(); i++) {
      mapper.put(iterator.next(),i,group);
    }
  }
   try {
    mapper.prepare(ids,badCollector(new ByteArrayOutputStream(),0),NONE);
    fail("Should have failed");
  }
 catch (  DuplicateInputIdException e) {
    assertThat(e.getMessage(),containsString("10"));
    assertThat(e.getMessage(),containsString("source:1"));
    assertThat(e.getMessage(),containsString("source:3"));
  }
}
