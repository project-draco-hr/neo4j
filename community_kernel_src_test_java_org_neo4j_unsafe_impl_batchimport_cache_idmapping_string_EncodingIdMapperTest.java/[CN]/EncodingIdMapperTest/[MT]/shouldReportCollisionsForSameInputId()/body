{
  IdMapper mapper=new EncodingIdMapper(NumberArrayFactory.HEAP,new StringEncoder(),new Radix.String(),NO_MONITOR);
  InputIterable<Object> ids=wrap("source",Arrays.<Object>asList("10","9","10"));
  try (ResourceIterator<Object> iterator=ids.iterator()){
    for (int i=0; iterator.hasNext(); i++) {
      mapper.put(iterator.next(),i,GLOBAL);
    }
  }
   Collector collector=mock(Collector.class);
  mapper.prepare(ids,collector,NONE);
  verify(collector,times(1)).collectDuplicateNode("10",2,GLOBAL.name(),"source:1","source:3");
  verifyNoMoreInteractions(collector);
}
