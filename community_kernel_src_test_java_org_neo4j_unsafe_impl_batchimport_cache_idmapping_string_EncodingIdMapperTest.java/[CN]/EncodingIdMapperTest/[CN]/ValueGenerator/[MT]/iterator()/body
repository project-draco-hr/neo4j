{
  if (!values.isEmpty()) {
    return resourceIterator(values.iterator(),EMPTY);
  }
  return resourceIterator(new PrefetchingIterator<Object>(){
    private int cursor;
    @Override protected Object fetchNextOrNull(){
      if (cursor < size) {
        while (true) {
          Object value=generator.newInstance();
          if (deduper.add(value)) {
            values.add(value);
            cursor++;
            return value;
          }
        }
      }
      return null;
    }
  }
,EMPTY);
}
