{
synchronized (connectedSlaveChannels) {
    Collection<Channel> channelsToRemove=new ArrayList<Channel>();
    for (    Map.Entry<Channel,SlaveContext> entry : connectedSlaveChannels.entrySet()) {
      if (!channelIsOpen(entry.getKey())) {
        msgLog.logMessage("Found dead channel " + entry.getKey() + ", "+ entry.getValue());
        try {
          finishOffConnection(entry.getKey(),entry.getValue());
        }
 catch (        Throwable failure) {
          msgLog.logMessage("Could not finish off connection",failure);
          continue;
        }
        msgLog.logMessage("Removed " + entry.getKey() + ", "+ entry.getValue());
        channelsToRemove.add(entry.getKey());
      }
    }
    for (    Channel channel : channelsToRemove) {
      connectedSlaveChannels.remove(channel);
      channelBuffers.remove(channel);
      partialRequests.remove(channel);
    }
  }
}
