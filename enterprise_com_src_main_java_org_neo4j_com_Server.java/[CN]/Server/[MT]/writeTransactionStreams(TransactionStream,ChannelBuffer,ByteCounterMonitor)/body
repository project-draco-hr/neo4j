{
  if (!txStream.hasNext()) {
    buffer.writeByte(0);
    return;
  }
  buffer.writeByte(1);
  Map<String,Integer> datasourceId=new HashMap<String,Integer>();
  writeString(buffer,NeoStoreXaDataSource.DEFAULT_DATA_SOURCE_NAME);
  for (  Pair<Long,TransactionRepresentation> tx : IteratorUtil.asIterable(txStream)) {
    buffer.writeByte(datasourceId.get(tx.first()));
    buffer.writeLong(tx.first());
    BlockLogBuffer blockBuffer=new BlockLogBuffer(buffer,bufferMonitor);
    blockBuffer.done();
  }
  buffer.writeByte(0);
}
