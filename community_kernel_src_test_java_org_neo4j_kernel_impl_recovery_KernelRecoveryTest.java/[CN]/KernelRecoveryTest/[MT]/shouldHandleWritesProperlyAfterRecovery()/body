{
  EphemeralFileSystemAbstraction fs=fsRule.get();
  GraphDatabaseService db=newDB(fs);
  long node1;
  try (Transaction tx=db.beginTx()){
    node1=db.createNode().getId();
    tx.success();
  }
   EphemeralFileSystemAbstraction crashedFs=fs.snapshot();
  db.shutdown();
  db=newDB(crashedFs);
  long node2;
  try (Transaction tx=db.beginTx()){
    node2=db.createNode().getId();
    tx.success();
  }
   db.shutdown();
  File logFile=new File("target/test-data/impermanent-db/" + PhysicalLogFile.DEFAULT_NAME + PhysicalLogFile.DEFAULT_VERSION_SUFFIX+ "0");
  assertThat(logEntries(crashedFs,logFile),containsExactly(startEntry(-1,-1),commandEntry(node1,NodeCommand.class),commitEntry(2),startEntry(-1,-1),commandEntry(node2,NodeCommand.class),commitEntry(3)));
}
