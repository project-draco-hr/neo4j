{
  try {
    while (!end) {
      if (groupRecord.inUse() && checkType(groupRecord.getType())) {
        while (groupChainIndex < GROUP_CHAINS.length) {
          GroupChain groupChain=GROUP_CHAINS[groupChainIndex++];
          long chainStart=groupChain.chainStart(groupRecord);
          if (chainStart != Record.NO_NEXT_RELATIONSHIP.intValue() && (direction == Direction.BOTH || groupChain.matchesDirection(direction))) {
            return chainStart;
          }
        }
      }
      if (!Record.NULL_REFERENCE.is(groupRecord.getNext())) {
        groupStore.forceGetRecord(groupRecord.getNext(),groupRecord);
      }
 else {
        end=true;
      }
      groupChainIndex=0;
    }
  }
 catch (  InvalidRecordException e) {
  }
  return Record.NO_NEXT_RELATIONSHIP.intValue();
}
