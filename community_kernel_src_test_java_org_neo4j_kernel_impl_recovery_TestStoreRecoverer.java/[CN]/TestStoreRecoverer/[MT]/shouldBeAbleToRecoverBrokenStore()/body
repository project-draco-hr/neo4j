{
  File store=createIntactStore();
  createLogFileForNextVersionWithSomeDataInIt(store);
  StoreRecoverer recoverer=new StoreRecoverer(fileSystem);
  assertThat(recoverer.recoveryNeededAt(store,logRepository(store),new HashMap<String,String>()),is(true));
  new TestGraphDatabaseFactory().setFileSystem(fileSystem).newImpermanentDatabase(store.getPath()).shutdown();
  assertThat(recoverer.recoveryNeededAt(store,logRepository(store),new HashMap<String,String>()),is(false));
}
