{
  NeoStoreUtil util=new NeoStoreUtil(store,fileSystem);
  LifeSupport life=new LifeSupport();
  DeadSimpleTransactionIdStore transactionIdStore=new DeadSimpleTransactionIdStore(2);
  TransactionMetadataCache positionCache=new TransactionMetadataCache(10,10);
  PhysicalLogFiles logFiles=new PhysicalLogFiles(store,PhysicalLogFile.DEFAULT_NAME,fileSystem);
  LogFile logFile=life.add(new PhysicalLogFile(fileSystem,logFiles,1000,LogPruneStrategies.NO_PRUNING,transactionIdStore,new DeadSimpleLogVersionRepository(util.getLogVersion()),mock(PhysicalLogFile.Monitor.class),mock(LogRotationControl.class),positionCache,mock(Visitor.class)));
  life.start();
  try (TransactionAppender appender=new PhysicalTransactionAppender(logFile.getWriter(),new DefaultTxIdGenerator(Providers.<TransactionIdStore>singletonProvider(transactionIdStore)),positionCache)){
    appender.append(singleNodeTransaction());
  }
  finally {
    life.shutdown();
  }
}
