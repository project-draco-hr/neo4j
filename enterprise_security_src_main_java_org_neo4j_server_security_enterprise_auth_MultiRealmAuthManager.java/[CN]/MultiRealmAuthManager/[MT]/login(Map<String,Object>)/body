{
  EnterpriseAuthSubject subject;
  ShiroAuthToken token=new ShiroAuthToken(authToken);
  try {
    subject=new StandardEnterpriseAuthSubject(this,(ShiroSubject)securityManager.login(null,token));
    securityLog.info(subject,"logged in");
  }
 catch (  UnsupportedTokenException e) {
    throw new InvalidAuthTokenException(e.getCause().getMessage());
  }
catch (  ExcessiveAttemptsException e) {
    subject=new StandardEnterpriseAuthSubject(this,new ShiroSubject(securityManager,AuthenticationResult.TOO_MANY_ATTEMPTS));
    securityLog.info(subject,"Login fail for user `%s` - too many failed attempts.");
  }
catch (  AuthenticationException e) {
    subject=new StandardEnterpriseAuthSubject(this,new ShiroSubject(securityManager,AuthenticationResult.FAILURE));
    securityLog.info(subject,"Login fail for user `%s`");
  }
  return subject;
}
