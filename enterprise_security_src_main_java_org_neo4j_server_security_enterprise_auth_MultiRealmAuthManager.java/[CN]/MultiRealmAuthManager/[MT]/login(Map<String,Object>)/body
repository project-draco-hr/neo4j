{
  Subject subject=new Subject.Builder(securityManager).buildSubject();
  ShiroAuthToken token=new ShiroAuthToken(authToken);
  AuthenticationResult result=AuthenticationResult.FAILURE;
  try {
    subject.login(token);
    result=AuthenticationResult.SUCCESS;
  }
 catch (  UnsupportedTokenException e) {
    throw new InvalidAuthTokenException(e.getCause().getMessage());
  }
catch (  AuthenticationException e) {
    result=AuthenticationResult.FAILURE;
  }
  return new ShiroAuthSubject(this,subject,result);
}
