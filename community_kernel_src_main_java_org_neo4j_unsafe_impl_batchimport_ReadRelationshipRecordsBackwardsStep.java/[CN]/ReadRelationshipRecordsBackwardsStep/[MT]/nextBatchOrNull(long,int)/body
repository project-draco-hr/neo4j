{
  int size=(int)min(batchSize,id);
  RelationshipRecord[] batch=new RelationshipRecord[size];
  boolean seenReservedId=false;
  for (int i=0; i < size; i++) {
    cursor.next(--id);
    RelationshipRecord newRecord=record.clone();
    batch[i]=newRecord;
    seenReservedId|=IdValidator.isReservedId(newRecord.getId());
  }
  batch=removeRecordWithReservedId(batch,seenReservedId);
  return batch.length > 0 ? batch : null;
}
