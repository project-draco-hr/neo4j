{
  JsonNode row=data.get(index++).get("row");
  TreeMap<String,Object> map=new TreeMap();
  for (int i=0; i < columns.size(); i++) {
    String key=columns.get(i).asText();
    JsonNode value=row.get(i);
    if (value instanceof TextNode) {
      map.put(key,row.get(i).asText());
    }
 else     if (value instanceof ArrayNode) {
      ArrayNode aNode=(ArrayNode)value;
      ArrayList<String> listValue=new ArrayList(aNode.size());
      for (int j=0; j < aNode.size(); j++) {
        listValue.add(aNode.get(j).asText());
      }
      map.put(key,listValue);
    }
 else     if (value instanceof ObjectNode) {
      map.put(key,value);
    }
 else     if (value instanceof IntNode) {
      map.put(key,value.getIntValue());
    }
 else {
      throw new RuntimeException("Unhandled REST value type '" + value.getClass() + "'. Need String (TextNode), List (ArrayNode), Object (ObjectNode) or int (IntNode).");
    }
  }
  return map;
}
