{
  StringLogger logger=logging.getMessagesLog(transition.getOldState().getClass());
  if (logger.isDebugEnabled()) {
    if (transition.getOldState() == HeartbeatState.heartbeat) {
      return;
    }
    StringBuilder line=new StringBuilder(transition.getOldState().getClass().getSuperclass().getSimpleName() + ": " + transition);
    if (transition.getMessage().hasHeader(FROM)) {
      line.append(" from:" + transition.getMessage().getHeader(FROM));
    }
    if (transition.getMessage().hasHeader(INSTANCE)) {
      line.append(" instance:" + transition.getMessage().getHeader(INSTANCE));
    }
    if (transition.getMessage().hasHeader(CONVERSATION_ID)) {
      line.append(" conversation-id:" + transition.getMessage().getHeader(CONVERSATION_ID));
    }
    String msg=line.toString();
    if (msg.equals(lastLogMessage)) {
      return;
    }
    logger.debug(line.toString());
    lastLogMessage=msg;
  }
}
