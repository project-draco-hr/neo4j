{
  assertInUnterminatedTransaction();
  Iterable<RelationshipTypeToken> relationshipTypes=this.relationshipTypes.getAllTokens();
  if (inUse) {
    relationshipTypes=filter(new Predicate<Token>(){
      @Override public boolean test(      Token token){
        Statement statement=statementCtxSupplier.get();
        long count=statement.readOperations().countsForRelationship(ANY_LABEL,token.id(),ANY_LABEL);
        return count > 0;
      }
    }
,relationshipTypes);
  }
  return cast(relationshipTypes);
}
