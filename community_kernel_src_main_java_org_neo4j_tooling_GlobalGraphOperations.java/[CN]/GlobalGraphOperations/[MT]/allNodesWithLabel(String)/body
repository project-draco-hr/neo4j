{
  ReadStatement statement=statementCtxProvider.readStatement();
  long labelId=statement.labelGetForName(label);
  if (labelId == KeyReadOperations.NO_SUCH_LABEL) {
    statement.close();
    return emptyIterator();
  }
  final PrimitiveLongIterator nodeIds=statement.nodesGetForLabel(labelId);
  return cleanupService.resourceIterator(map(new FunctionFromPrimitiveLong<Node>(){
    @Override public Node apply(    long nodeId){
      return nodeManager.getNodeById(nodeId);
    }
  }
,nodeIds),statement);
}
