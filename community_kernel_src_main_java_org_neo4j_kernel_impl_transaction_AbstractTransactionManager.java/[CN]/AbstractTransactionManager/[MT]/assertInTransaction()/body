{
  try {
    if (getTransaction() == null) {
      throw new NotInTransactionException();
    }
  }
 catch (  SystemException e) {
    throw new IllegalStateException("Unable to determine transaction state",e);
  }
}
