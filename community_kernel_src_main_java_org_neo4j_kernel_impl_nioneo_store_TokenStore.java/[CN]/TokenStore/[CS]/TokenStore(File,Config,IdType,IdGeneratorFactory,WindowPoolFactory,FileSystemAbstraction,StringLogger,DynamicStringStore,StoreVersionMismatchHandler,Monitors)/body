{
  super(fileName,configuration,idType,idGeneratorFactory,windowPoolFactory,fileSystemAbstraction,stringLogger,versionMismatchHandler,monitors);
  this.nameStore=nameStore;
  pageCache=new WindowPoolPageCache(windowPoolFactory,fileSystemAbstraction);
  try {
    storeFile=pageCache.map(fileName,getRecordSize() * 128,getRecordSize());
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
  pageSize=storeFile.pageSize();
}
