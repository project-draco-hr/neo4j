{
  UniquenessConstraint constraint1=new UniquenessConstraint(10,66);
  UniquenessConstraint constraint2=new UniquenessConstraint(11,99);
  UniquenessConstraint constraint3=new UniquenessConstraint(11,88);
  StatementContext delegate=mock(StatementContext.class);
  when(delegate.getConstraints(10,66)).thenAnswer(asAnswer(Collections.emptyList()));
  when(delegate.getConstraints(11,88)).thenAnswer(asAnswer(Collections.emptyList()));
  when(delegate.getConstraints(11,99)).thenAnswer(asAnswer(Collections.emptyList()));
  when(delegate.getConstraints(10)).thenAnswer(asAnswer(Collections.emptyList()));
  when(delegate.getConstraints(11)).thenAnswer(asAnswer(asIterable(constraint2)));
  TxState state=new TxState(mock(OldTxStateBridge.class),mock(PersistenceManager.class),mock(IdGeneration.class));
  StateHandlingStatementContext context=new StateHandlingStatementContext(delegate,mock(SchemaStateOperations.class),state);
  context.addUniquenessConstraint(10,66);
  context.addUniquenessConstraint(11,88);
  Set<UniquenessConstraint> result=asSet(asIterable(context.getConstraints(11)));
  assertEquals(asSet(constraint2,constraint3),result);
}
