{
  try {
    ensureResultsFieldOpen();
    out.writeStartObject();
    try {
      Iterable<String> columns=result.columns();
      writeColumns(columns);
      writeRows(columns,result.iterator(),configureWriters(resultDataContents));
      if (includeStats) {
        writeStats(result.getQueryStatistics());
      }
      if (result.planDescriptionRequested()) {
        writeRootPlanDescription(result.executionPlanDescription());
      }
    }
  finally {
      out.writeEndObject();
    }
  }
 catch (  IOException e) {
    throw loggedIOException(e);
  }
}
