{
  try {
    out.writeArrayFieldStart("data");
    while (data.hasNext()) {
      Map<String,Object> row=nextRow(data);
      try {
        out.writeStartArray();
        for (        String key : columns) {
          Object val=row.get(key);
          out.writeObject(val);
        }
      }
  finally {
        out.writeEndArray();
      }
    }
  }
  finally {
    out.writeEndArray();
  }
}
