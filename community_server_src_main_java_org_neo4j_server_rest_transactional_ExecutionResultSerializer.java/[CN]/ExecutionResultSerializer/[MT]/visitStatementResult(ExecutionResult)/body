{
  try {
    Iterable<String> columns=result.columns();
    Iterator<Map<String,Object>> data=result.iterator();
    try {
      out.writeStartObject();
      try {
        out.writeArrayFieldStart("columns");
        for (        String key : columns) {
          out.writeString(key);
        }
      }
  finally {
        out.writeEndArray();
      }
      try {
        out.writeArrayFieldStart("data");
        while (data.hasNext()) {
          Map<String,Object> row=nextRow(data);
          try {
            out.writeStartArray();
            for (            String key : columns) {
              Object val=row.get(key);
              out.writeObject(val);
            }
          }
  finally {
            out.writeEndArray();
          }
        }
      }
  finally {
        out.writeEndArray();
      }
    }
  finally {
      out.writeEndObject();
    }
  }
 catch (  IOException e) {
    handleIOException(e);
  }
}
