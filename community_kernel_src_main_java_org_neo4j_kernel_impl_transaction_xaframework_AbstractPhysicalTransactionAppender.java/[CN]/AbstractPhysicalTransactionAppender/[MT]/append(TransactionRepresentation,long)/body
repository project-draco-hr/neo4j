{
  channel.getCurrentPosition(positionMarker);
  LogPosition logPosition=positionMarker.newPosition();
  transactionLogWriter.append(transaction,transactionId);
  transactionMetadataCache.cacheTransactionMetadata(transactionId,logPosition,transaction.getMasterId(),transaction.getAuthorId(),LogEntryStart.checksum(transaction.additionalHeader(),transaction.getMasterId(),transaction.getAuthorId()));
  channel.emptyBufferIntoChannelAndClearIt();
}
