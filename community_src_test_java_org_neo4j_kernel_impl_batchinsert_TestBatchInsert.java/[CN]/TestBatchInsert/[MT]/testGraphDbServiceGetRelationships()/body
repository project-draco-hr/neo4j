{
  BatchInserter batchInserter=newBatchInserter();
  GraphDatabaseService graphDb=batchInserter.getGraphDbService();
  Node startNode=graphDb.createNode();
  for (int i=0; i < 5; i++) {
    Node endNode=graphDb.createNode();
    startNode.createRelationshipTo(endNode,relTypeArray[i]);
  }
  try {
    startNode.createRelationshipTo(startNode,relTypeArray[0]);
    fail("Could create relationship with same start and end node");
  }
 catch (  IllegalArgumentException e) {
  }
  for (int i=0; i < 5; i++) {
    assertTrue(startNode.getSingleRelationship(relTypeArray[i],Direction.OUTGOING) != null);
  }
  for (int i=0; i < 5; i++) {
    Iterator<Relationship> relItr=startNode.getRelationships(relTypeArray[i],Direction.OUTGOING).iterator();
    relItr.next();
    assertTrue(!relItr.hasNext());
  }
  for (int i=0; i < 5; i++) {
    Iterator<Relationship> relItr=startNode.getRelationships(relTypeArray[i]).iterator();
    relItr.next();
    assertTrue(!relItr.hasNext());
  }
  graphDb.shutdown();
}
