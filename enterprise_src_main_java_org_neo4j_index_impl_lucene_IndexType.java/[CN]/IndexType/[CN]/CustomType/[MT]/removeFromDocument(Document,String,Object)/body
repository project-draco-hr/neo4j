{
  String stringValue=value.toString();
  String exactKey=exactKey(key);
  Set<String> values=new HashSet<String>(Arrays.asList(document.getValues(exactKey)));
  if (!values.remove(stringValue)) {
    return;
  }
  document.removeFields(exactKey);
  document.removeFields(key);
  for (  String existingValue : values) {
    addToDocument(document,key,existingValue);
  }
}
