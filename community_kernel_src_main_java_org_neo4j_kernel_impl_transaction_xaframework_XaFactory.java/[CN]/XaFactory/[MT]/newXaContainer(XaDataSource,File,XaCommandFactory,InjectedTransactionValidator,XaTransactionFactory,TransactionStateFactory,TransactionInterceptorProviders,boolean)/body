{
  if (logicalLog == null || cf == null || tf == null) {
    throw new IllegalArgumentException("Null parameter, " + "LogicalLog[" + logicalLog + "] CommandFactory["+ cf+ "TransactionFactory["+ tf+ "]");
  }
  XaResourceManager rm=new XaResourceManager(xaDataSource,tf,txIdGenerator,txManager,recoveryVerifier,logicalLog.getName(),monitors);
  long rotateAtSize=config.get(logical_log_rotation_threshold);
  XaLogicalLog log;
  if (readOnly) {
    log=new NoOpLogicalLog(logging);
  }
 else   if (providers.shouldInterceptDeserialized() && providers.hasAnyInterceptorConfigured()) {
    log=new InterceptingXaLogicalLog(logicalLog,rm,cf,tf,providers,monitors,fileSystemAbstraction,logging,pruneStrategy,stateFactory,kernelHealth,rotateAtSize,injectedTxValidator);
  }
 else {
    log=new XaLogicalLog(logicalLog,rm,cf,tf,fileSystemAbstraction,monitors,logging,pruneStrategy,stateFactory,kernelHealth,rotateAtSize,injectedTxValidator);
  }
  rm.setLogicalLog(log);
  tf.setLogicalLog(log);
  return new XaContainer(rm,log);
}
