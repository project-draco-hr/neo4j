{
  if (logicalLog == null || cf == null || tf == null) {
    throw new IllegalArgumentException("Null parameter, " + "LogicalLog[" + logicalLog + "] CommandFactory["+ cf+ "TransactionFactory["+ tf+ "]");
  }
  XaResourceManager rm=new XaResourceManager(xaDataSource,tf,txIdGenerator,txManager,recoveryVerifier,logicalLog);
  XaLogicalLog log;
  if (config.getBoolean(Configuration.intercept_deserialized_transactions) && providers != null) {
    log=new InterceptingXaLogicalLog(logicalLog,rm,cf,tf,providers,dependencyResolver,logBufferFactory,fileSystemAbstraction,stringLogger);
  }
 else {
    log=new XaLogicalLog(logicalLog,rm,cf,tf,logBufferFactory,fileSystemAbstraction,stringLogger);
  }
  rm.setLogicalLog(log);
  tf.setLogicalLog(log);
  return new XaContainer(rm,log);
}
