{
  Set<Long> set=new HashSet<>();
  while (iterator.hasNext()) {
    long value=iterator.next();
    if (!set.add(value) && !allowDuplicates) {
      throw new IllegalStateException("Duplicates found. Tried to add " + value + " to "+ set);
    }
  }
  return set;
}
