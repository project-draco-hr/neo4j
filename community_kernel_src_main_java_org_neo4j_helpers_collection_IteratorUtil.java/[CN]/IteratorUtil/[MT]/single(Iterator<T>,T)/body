{
  try {
    T result=iterator.hasNext() ? iterator.next() : itemIfNone;
    if (iterator.hasNext()) {
      throw new NoSuchElementException("More than one element in " + iterator + ". First element is '"+ result+ "' and the second element is '"+ iterator.next()+ "'");
    }
    return result;
  }
  finally {
    if (iterator instanceof ResourceIterator) {
      ((ResourceIterator)iterator).close();
    }
  }
}
