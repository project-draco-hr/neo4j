{
  File luceneDir=new File("lucene");
  fs.get().mkdir(luceneDir);
  Directory directory=new DirectoryFactory.InMemoryDirectoryFactory().open(luceneDir);
  IndexWriterConfig config=new IndexWriterConfig(Version.LUCENE_36,null);
  TrackingLuceneIndexWriter indexWriter=new TrackingLuceneIndexWriter(directory,config);
  TrackingLuceneIndexWriter indexWriterSpy=spy(indexWriter);
  when(indexWriterSpy.maxDocLimit()).thenReturn(maxDocLimit);
  return indexWriterSpy;
}
