{
  try {
    Object consoleReader=Class.forName("jline.console.ConsoleReader").newInstance();
    consoleReader.getClass().getMethod("setBellEnabled",Boolean.TYPE).invoke(consoleReader,false);
    consoleReader.getClass().getMethod("setExpandEvents",Boolean.TYPE).invoke(consoleReader,false);
    consoleReader.getClass().getMethod("setHistoryEnabled",Boolean.TYPE).invoke(consoleReader,true);
    Object completer=Class.forName(JLineConsole.class.getPackage().getName() + "." + "ShellTabCompleter").getConstructor(ShellClient.class).newInstance(client);
    Class<?> completerClass=Class.forName("jline.console.completer.Completer");
    consoleReader.getClass().getMethod("addCompleter",completerClass).invoke(consoleReader,completer);
    Class<?> historyClass=Class.forName("jline.console.history.History");
    Object history=Class.forName("jline.console.history.FileHistory").getConstructor(File.class).newInstance(new File(System.getProperty("user.home"),".neo4j_shell_history"));
    consoleReader.getClass().getMethod("setHistory",historyClass).invoke(consoleReader,history);
    return new JLineConsole(consoleReader,client);
  }
 catch (  RuntimeException e) {
    throw e;
  }
catch (  Exception e) {
    return null;
  }
}
