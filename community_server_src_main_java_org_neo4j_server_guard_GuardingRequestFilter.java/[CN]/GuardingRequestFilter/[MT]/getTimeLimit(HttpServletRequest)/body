{
  long timeLimit=timeout;
  String headerValue=request.getHeader("max-execution-time");
  if (headerValue != null) {
    long maxHeader=Long.parseLong(headerValue);
    if (timeLimit < 0 || (maxHeader > 0 && maxHeader < timeLimit)) {
      return maxHeader;
    }
  }
  return timeLimit;
}
