{
  StubReplicator replicator=new StubReplicator();
  CurrentReplicatedLockState stateMachine=new ReplicatedLockStateMachine<>(member(0),replicator);
  replicator.replicate(new ReplicatedLockRequest<>(member(1),0));
  replicator.replicate(new ReplicatedLockRequest<>(member(2),1));
  assertEquals(1,stateMachine.currentLockSession().id());
  replicator.replicate(new ReplicatedLockRequest<>(member(3),0));
  assertEquals(1,stateMachine.currentLockSession().id());
  replicator.replicate(new ReplicatedLockRequest<>(member(4),2));
  assertEquals(2,stateMachine.currentLockSession().id());
}
