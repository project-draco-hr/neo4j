{
  this.pageCache=pageCache;
  this.filePageSize=filePageSize;
  this.cursorPool=new CursorPool(this);
  this.tracer=tracer;
  this.exclusiveMapping=exclusiveMapping;
  PageEvictionCallback onEviction=new MuninnPageEvictionCallback(this);
  swapper=swapperFactory.createPageSwapper(file,filePageSize,onEviction,createIfNotExists);
  if (truncateExisting) {
    swapper.truncate();
  }
  long lastPageId=swapper.getLastPageId();
  int initialChunks=1 + computeChunkId(lastPageId);
  Object[][] tt=new Object[initialChunks][];
  for (int i=0; i < initialChunks; i++) {
    tt[i]=new Object[translationTableChunkSize];
  }
  translationTable=tt;
  initialiseLastPageId(lastPageId);
}
