{
  unpacker.unpackStructHeader();
  int type=(int)unpacker.unpackLong();
switch (type) {
case MessageTypes.MSG_RUN:
    unpackRunMessage(output);
  break;
case MessageTypes.MSG_DISCARD_ALL:
unpackDiscardAllMessage(output);
break;
case MessageTypes.MSG_PULL_ALL:
unpackPullAllMessage(output);
break;
case MessageTypes.MSG_RECORD:
unpackRecordMessage(output);
break;
case MessageTypes.MSG_SUCCESS:
unpackSuccessMessage(output);
break;
case MessageTypes.MSG_FAILURE:
unpackFailureMessage(output);
break;
case MessageTypes.MSG_ACK_FAILURE:
unpackAckFailureMessage(output);
break;
case MessageTypes.MSG_IGNORED:
unpackIgnoredMessage(output);
break;
default :
throw new IOException("Unknown message type: " + type);
}
}
