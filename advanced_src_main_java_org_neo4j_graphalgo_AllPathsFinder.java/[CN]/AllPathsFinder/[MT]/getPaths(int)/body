{
  List<List<PropertyContainer>> result=new ArrayList<List<PropertyContainer>>();
  if (maxDepth == 0) {
    return result;
  }
  Set<Long> traversedRels=new HashSet<Long>();
  LinkedList<PropertyContainer> trail=new LinkedList<PropertyContainer>();
  trail.add(startNode);
  Set<Relationship> rels=new HashSet<Relationship>();
  for (  Relationship rel : startNode.getRelationships(relationshipType,direction)) {
    rels.add(rel);
    traversedRels.add(rel.getId());
    result.add(constructPath(trail,rel,rel.getOtherNode(startNode)));
  }
  for (  Relationship rel : rels) {
    traverse(traversedRels,result,trail,startNode,rel,2,maxDepth);
  }
  return result;
}
