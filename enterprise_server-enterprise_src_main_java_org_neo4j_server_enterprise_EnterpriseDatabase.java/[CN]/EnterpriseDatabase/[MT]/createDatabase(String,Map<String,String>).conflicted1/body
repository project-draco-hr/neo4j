{
  List<IndexProvider> indexProviders=Iterables.toList(Service.load(IndexProvider.class));
  List<KernelExtensionFactory<?>> kernelExtensions=Iterables.toList(Iterables.<KernelExtensionFactory<?>,KernelExtensionFactory>cast(Service.load(KernelExtensionFactory.class)));
  List<CacheProvider> cacheProviders=Iterables.toList(Service.load(CacheProvider.class));
  List<TransactionInterceptorProvider> txInterceptorProviders=Iterables.toList(Service.load(TransactionInterceptorProvider.class));
  List<IndexPopulatorMapperProvider> indexPopulatorMappers=Iterables.toList(Service.load(IndexPopulatorMapperProvider.class));
  return new HighlyAvailableGraphDatabase(databaseStoreDirectory,databaseProperties,indexProviders,kernelExtensions,cacheProviders,txInterceptorProviders,indexPopulatorMappers);
}
