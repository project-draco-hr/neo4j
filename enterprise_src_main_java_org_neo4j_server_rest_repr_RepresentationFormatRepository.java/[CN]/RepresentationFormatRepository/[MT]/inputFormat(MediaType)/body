{
  if (type == null)   return NULL_FORMAT;
  RepresentationFormat format=formats.get(type);
  if (format != null) {
    return format;
  }
  format=formats.get(new MediaType(type.getType(),type.getSubtype()));
  if (format != null) {
    return format;
  }
  throw new MediaTypeNotSupportedException(formats.keySet(),type);
}
