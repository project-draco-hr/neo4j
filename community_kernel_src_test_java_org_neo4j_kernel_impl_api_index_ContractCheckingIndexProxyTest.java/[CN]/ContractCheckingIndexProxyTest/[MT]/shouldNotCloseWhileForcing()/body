{
  final DoubleLatch latch=new DoubleLatch();
  final IndexProxy inner=new IndexProxy.Adapter(){
    @Override public void force(){
      latch.startAndAwaitFinish();
    }
  }
;
  final IndexProxy outer=new ContractCheckingIndexProxy(inner);
  outer.create();
  new Thread(new Runnable(){
    @Override public void run(){
      outer.force();
    }
  }
).start();
  try {
    latch.awaitStart();
    outer.close();
  }
  finally {
    latch.finish();
  }
}
