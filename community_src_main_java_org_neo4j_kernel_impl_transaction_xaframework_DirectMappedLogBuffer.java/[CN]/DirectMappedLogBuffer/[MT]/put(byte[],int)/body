{
  int bytesToWrite=bytes.length - offset;
  if (bytesToWrite > BUFFER_SIZE) {
    bytesToWrite=BUFFER_SIZE;
  }
  if (byteBuffer == null || (BUFFER_SIZE - byteBuffer.position()) < bytesToWrite) {
    getNewDirectBuffer();
  }
  byteBuffer.put(bytes,offset,bytesToWrite);
  offset+=bytesToWrite;
  if (offset < bytes.length) {
    put(bytes,offset);
  }
}
