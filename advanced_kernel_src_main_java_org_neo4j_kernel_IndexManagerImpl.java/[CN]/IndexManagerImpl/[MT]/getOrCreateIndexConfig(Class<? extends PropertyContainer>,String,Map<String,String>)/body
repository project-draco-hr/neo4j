{
  Pair<Map<String,String>,Boolean> result=findIndexConfig(cls,indexName,suppliedConfig,graphDbImpl.getConfig().getParams());
  if (result.other()) {
    IndexCreatorThread creator=new IndexCreatorThread(cls,indexName,result.first());
    creator.start();
    try {
      creator.join();
      if (creator.exception != null) {
        throw new TransactionFailureException("Index creation failed for " + indexName + ", "+ result.first(),creator.exception);
      }
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
    }
  }
  return result.first();
}
