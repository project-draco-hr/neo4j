{
  OperatingSystemMXBean osBean=ManagementFactory.getOperatingSystemMXBean();
  long mem;
  try {
    Class<?> beanClass=Thread.currentThread().getContextClassLoader().loadClass("com.sun.management.OperatingSystemMXBean");
    Method method=beanClass.getMethod("getFreePhysicalMemorySize");
    mem=(Long)method.invoke(osBean);
  }
 catch (  Exception e) {
    mem=-1;
  }
catch (  LinkageError e) {
    mem=-1;
  }
  return mem;
}
