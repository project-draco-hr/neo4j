{
  ArrayMap<Integer,PropertyData> result=new ArrayMap<Integer,PropertyData>(9,false,true);
  long nextProp=startingAt;
  while (nextProp != Record.NO_NEXT_PROPERTY.intValue()) {
    PropertyRecord propRecord=getPropertyRecord(nextProp,false);
    if (!propRecord.isCreated() && propRecord.isChanged()) {
      propRecord=getPropertyStore().getRecord(propRecord.getId());
    }
    for (    PropertyBlock block : propRecord.getPropertyBlocks()) {
      if (block.isLight()) {
        getPropertyStore().makeHeavy(block);
      }
      if (!block.isCreated() && !propRecord.isChanged()) {
        result.put(block.getKeyIndexId(),block.newPropertyData(propRecord,propertyGetValueOrNull(block)));
      }
      for (      DynamicRecord valueRecord : block.getValueRecords()) {
        valueRecord.setInUse(false);
        propRecord.addDeletedRecord(valueRecord);
      }
      block.setChanged();
    }
    nextProp=propRecord.getNextProp();
    propRecord.setInUse(false);
    propRecord.setChanged();
    propRecord.getPropertyBlocks().clear();
  }
  return result;
}
