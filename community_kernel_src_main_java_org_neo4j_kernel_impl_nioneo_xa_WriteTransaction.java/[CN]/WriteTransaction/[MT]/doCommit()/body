{
  if (!isRecovered() && !prepared) {
    throw new XAException("Cannot commit non prepared transaction[" + getIdentifier() + "]");
  }
  if (isRecovered()) {
    applyCommit(true);
    return;
  }
  if (!isRecovered() && getCommitTxId() != neoStore.getLastCommittedTx() + 1) {
    throw new RuntimeException("Tx id: " + getCommitTxId() + " not next transaction ("+ neoStore.getLastCommittedTx()+ ")");
  }
  applyCommit(false);
}
