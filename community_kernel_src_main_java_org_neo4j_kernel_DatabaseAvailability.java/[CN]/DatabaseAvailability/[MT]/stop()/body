{
  availabilityGuard.deny(this);
  long deadline=Clock.SYSTEM_CLOCK.currentTimeMillis() + 20 * 1000;
  while (transactionMonitor.getNumberOfActiveTransactions() > 0 && Clock.SYSTEM_CLOCK.currentTimeMillis() < deadline) {
    Thread.yield();
  }
}
