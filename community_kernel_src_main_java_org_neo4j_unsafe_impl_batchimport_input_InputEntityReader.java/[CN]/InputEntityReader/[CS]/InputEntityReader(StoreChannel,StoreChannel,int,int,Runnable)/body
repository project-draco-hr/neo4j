{
  tokens=new PrimitiveIntObjectMap[HIGH_TOKEN_TYPE];
  tokens[PROPERTY_KEY_TOKEN]=Primitive.intObjectMap();
  tokens[LABEL_TOKEN]=Primitive.intObjectMap();
  tokens[RELATIONSHIP_TYPE_TOKEN]=Primitive.intObjectMap();
  tokens[GROUP_TOKEN]=Primitive.intObjectMap();
  this.previousGroups=new Group[groupSlots];
  for (int i=0; i < groupSlots; i++) {
    previousGroups[i]=Group.GLOBAL;
  }
  this.channel=reader(channel,bufferSize);
  this.closeAction=closeAction;
  readHeader(header);
}
