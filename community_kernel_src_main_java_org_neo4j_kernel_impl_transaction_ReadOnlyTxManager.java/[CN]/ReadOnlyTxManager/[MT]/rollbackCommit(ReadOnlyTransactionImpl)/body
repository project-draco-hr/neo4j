{
  try {
    tx.doRollback();
  }
 catch (  XAException e) {
    logger.error("Unable to rollback marked transaction. " + "Some resources may be commited others not. " + "Neo4j kernel should be SHUTDOWN for "+ "resource maintance and transaction recovery ---->",e);
    throw Exceptions.withCause(new HeuristicMixedException("Unable to rollback " + " ---> error code for rollback: " + e.errorCode),e);
  }
  tx.doAfterCompletion();
  txThreadMap.remove();
  tx.setStatus(Status.STATUS_NO_TRANSACTION);
  throw new RollbackException("Failed to commit, transaction rolled back");
}
