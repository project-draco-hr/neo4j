{
  Integer previousDepth=nodeScanDepths.get(node);
  if (previousDepth != null && previousDepth >= searchDepth) {
    return;
  }
  nodes.add(node);
  nodeScanDepths.put(node,searchDepth);
  if (searchDepth == 0 && includeBoundaryEdges) {
    for (    Relationship relationship : node.getRelationships(relationshipType,direction)) {
      if (nodes.contains(relationship.getOtherNode(node))) {
        edges.add(relationship);
      }
    }
  }
  if (searchDepth <= 0) {
    return;
  }
  for (  Relationship relationship : node.getRelationships(relationshipType,direction)) {
    edges.add(relationship);
    internalAddSubGraphFromCentralNode(relationship.getOtherNode(node),searchDepth - 1,relationshipType,direction,includeBoundaryEdges,nodeScanDepths);
  }
}
