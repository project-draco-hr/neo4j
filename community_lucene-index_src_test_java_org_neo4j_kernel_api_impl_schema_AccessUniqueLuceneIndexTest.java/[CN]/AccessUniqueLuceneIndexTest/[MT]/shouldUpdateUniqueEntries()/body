{
  PartitionedIndexStorage indexStorage=getIndexStorage();
  LuceneIndexAccessor accessor=createAccessor(indexStorage);
  updateAndCommit(accessor,asList(add(1l,"value1")));
  updateAndCommit(accessor,asList(change(1l,"value1","value2")));
  accessor.close();
  assertEquals(asList(1l),getAllNodes(indexStorage,"value2"));
  assertEquals(emptyList(),getAllNodes(indexStorage,"value1"));
}
