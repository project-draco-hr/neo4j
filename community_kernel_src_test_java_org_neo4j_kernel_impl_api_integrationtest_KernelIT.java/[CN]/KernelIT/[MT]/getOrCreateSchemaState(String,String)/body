{
  Transaction tx=db.beginTx();
  Statement statement=statementContextProvider.instance();
  String state=statement.readOperations().schemaStateGetOrCreate(key,new Function<String,String>(){
    @Override public String apply(    String s){
      return maybeSetThisState;
    }
  }
);
  tx.success();
  tx.finish();
  return state;
}
