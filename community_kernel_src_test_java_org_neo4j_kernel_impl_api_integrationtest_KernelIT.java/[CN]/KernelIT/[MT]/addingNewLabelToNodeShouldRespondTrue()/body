{
  Transaction tx=db.beginTx();
  Node node=db.createNode();
  StatementOperations context=statementContextProvider.getCtxForWriting().asStatementOperations();
  StatementState statement=statementContextProvider.statementForWriting();
  long labelId=context.labelGetOrCreateForName(statement,"mylabel");
  context.nodeAddLabel(statement,node.getId(),labelId);
  context.close(statement);
  tx.success();
  tx.finish();
  tx=db.beginTx();
  context=statementContextProvider.getCtxForWriting().asStatementOperations();
  statement=statementContextProvider.statementForWriting();
  boolean added=context.nodeAddLabel(statement,node.getId(),labelId);
  assertFalse("Shouldn't have been added now",added);
  tx.finish();
}
