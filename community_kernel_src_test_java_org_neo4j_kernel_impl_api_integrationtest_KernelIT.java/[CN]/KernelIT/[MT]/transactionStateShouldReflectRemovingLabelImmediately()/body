{
  Transaction tx=db.beginTx();
  StatementOperations context=statementContextProvider.getCtxForWriting().asStatementOperations();
  StatementState statement=statementContextProvider.statementForWriting();
  Node node=db.createNode();
  long labelId1=context.labelGetOrCreateForName(statement,"labello1");
  long labelId2=context.labelGetOrCreateForName(statement,"labello2");
  context.nodeAddLabel(statement,node.getId(),labelId1);
  context.nodeAddLabel(statement,node.getId(),labelId2);
  context.close(statement);
  tx.success();
  tx.finish();
  tx=db.beginTx();
  context=statementContextProvider.getCtxForWriting().asStatementOperations();
  statement=statementContextProvider.statementForWriting();
  context.nodeRemoveLabel(statement,node.getId(),labelId2);
  PrimitiveLongIterator labelsIterator=context.nodeGetLabels(statement,node.getId());
  Set<Long> labels=asSet(labelsIterator);
  assertFalse(context.nodeHasLabel(statement,node.getId(),labelId2));
  assertEquals(asSet(labelId1),labels);
  context.close(statement);
  tx.success();
  tx.finish();
}
