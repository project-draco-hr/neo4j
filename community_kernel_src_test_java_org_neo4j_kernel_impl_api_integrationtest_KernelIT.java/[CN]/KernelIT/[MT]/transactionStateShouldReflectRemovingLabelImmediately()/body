{
  Transaction tx=db.beginTx();
  StatementContext statement=statementContextProvider.getCtxForWriting();
  Node node=db.createNode();
  long labelId1=statement.getOrCreateLabelId("labello1");
  long labelId2=statement.getOrCreateLabelId("labello2");
  statement.addLabelToNode(labelId1,node.getId());
  statement.addLabelToNode(labelId2,node.getId());
  statement.close();
  tx.success();
  tx.finish();
  tx=db.beginTx();
  statement=statementContextProvider.getCtxForWriting();
  statement.removeLabelFromNode(labelId2,node.getId());
  Iterator<Long> labelsIterator=statement.getLabelsForNode(node.getId());
  Set<Long> labels=asSet(labelsIterator);
  assertFalse(statement.isLabelSetOnNode(labelId2,node.getId()));
  assertEquals(asSet(labelId1),labels);
  statement.close();
  tx.success();
  tx.finish();
}
