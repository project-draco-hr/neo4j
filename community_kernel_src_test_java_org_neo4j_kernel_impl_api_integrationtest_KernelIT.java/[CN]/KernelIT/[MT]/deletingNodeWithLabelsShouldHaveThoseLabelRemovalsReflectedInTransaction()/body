{
  Transaction tx=db.beginTx();
  Label label=label("labello");
  Node node=db.createNode(label);
  tx.success();
  tx.finish();
  tx=db.beginTx();
  StatementContext statement=statementContextProvider.getCtxForWriting();
  statement.nodeDelete(node.getId());
  long labelId=statement.labelGetForName(label.name());
  Set<Long> labels=asSet(statement.nodeGetLabels(node.getId()));
  boolean labelIsSet=statement.nodeHasLabel(node.getId(),labelId);
  Set<Long> nodes=asSet(statement.nodesGetForLabel(labelId));
  statement.close();
  tx.success();
  tx.finish();
  assertEquals(emptySetOf(Long.class),nodes);
  assertEquals(emptySetOf(Long.class),labels);
  assertFalse("Label should not be set on node here",labelIsSet);
}
