{
  Transaction tx=db.beginTx();
  StatementContext statement=statementContextProvider.getCtxForWriting();
  Node node=db.createNode();
  long labelId1=statement.labelGetOrCreateForName("labello1");
  statement.nodeAddLabel(node.getId(),labelId1);
  statement.close();
  tx.success();
  tx.finish();
  tx=db.beginTx();
  statement=statementContextProvider.getCtxForWriting();
  statement.nodeRemoveLabel(node.getId(),labelId1);
  statement.close();
  tx.success();
  tx.finish();
  tx=db.beginTx();
  statement=statementContextProvider.getCtxForWriting();
  Iterator<Long> labels=statement.nodeGetLabels(node.getId());
  statement.close();
  tx.success();
  tx.finish();
  assertThat(asSet(labels),equalTo(Collections.<Long>emptySet()));
}
