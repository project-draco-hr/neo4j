{
  File dbDir=dir.directory();
  cluster=Cluster.start(dbDir,3,0,new SharedDiscoveryService());
  HashSet<File> storeDirs=new HashSet<>();
  for (int i=0; i < cluster.numberOfCoreServers(); i++) {
    CoreGraphDatabase theDb=cluster.getCoreServerById(i);
    try (Transaction tx=theDb.beginTx()){
      Node node=theDb.createNode(label("demo"));
      node.setProperty("server",i);
      tx.success();
    }
     storeDirs.add(new File(theDb.getStoreDir()));
  }
  cluster.shutdown();
  for (  File storeDir : storeDirs) {
    isConsistent(storeDir);
  }
}
