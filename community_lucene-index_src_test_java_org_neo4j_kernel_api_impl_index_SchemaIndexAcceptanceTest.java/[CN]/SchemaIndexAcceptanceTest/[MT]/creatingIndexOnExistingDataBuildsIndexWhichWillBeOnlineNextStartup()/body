{
  Transaction tx=db.beginTx();
  Node node1=createNode(label,"name","One");
  Node node2=createNode(label,"name","Two");
  Node node3=createNode(label,"name","Three");
  tx.success();
  tx.finish();
  tx=db.beginTx();
  IndexDefinition index=db.schema().indexCreator(label).on(key).create();
  tx.success();
  tx.finish();
  awaitIndexState(db,index,IndexState.ONLINE);
  restart();
  assertEquals(IndexState.ONLINE,db.schema().getIndexState(index));
  assertEquals(asSet(node1),asUniqueSet(db.findNodesByLabelAndProperty(label,"name","One")));
  assertEquals(asSet(node2),asUniqueSet(db.findNodesByLabelAndProperty(label,"name","Two")));
  assertEquals(asSet(node3),asUniqueSet(db.findNodesByLabelAndProperty(label,"name","Three")));
}
