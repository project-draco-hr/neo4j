{
  long nodeId=1l;
  int propertyKey=2;
  int value=1337;
  WritableTransactionState state=new WritableTransactionState(null,null,new DevNullLoggingService(),null,null,null);
  OldTxStateBridge bridge=new OldTxStateBridgeImpl(null,state);
  NodeImpl node=new NodeImpl(nodeId,-1,-1);
  state.getOrCreateCowPropertyAddMap(node).put(2,PropertyDatas.forInt(propertyKey,-1l,value));
  DiffSets<Long> nodes=bridge.getNodesWithChangedProperty(propertyKey,value);
  assertEquals(asSet(nodeId),nodes.getAdded());
  assertEquals(asSet(),nodes.getRemoved());
}
