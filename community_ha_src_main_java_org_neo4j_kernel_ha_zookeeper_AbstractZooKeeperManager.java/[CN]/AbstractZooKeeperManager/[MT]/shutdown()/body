{
  try {
    invalidateMaster();
    cachedMaster=Pair.<Master,Machine>of(null,Machine.NO_MACHINE);
    getZooKeeper().close();
  }
 catch (  InterruptedException e) {
    throw new ZooKeeperException("Error closing zookeeper connection",e);
  }
}
