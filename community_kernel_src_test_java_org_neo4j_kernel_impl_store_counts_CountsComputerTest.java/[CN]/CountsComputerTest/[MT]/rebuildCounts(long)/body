{
  cleanupCountsForRebuilding();
  StoreFactory storeFactory=new StoreFactory(fs,dir,pageCache,NullLogProvider.getInstance());
  try (Lifespan life=new Lifespan();NeoStores neoStores=storeFactory.openNeoStores(false)){
    NodeStore nodeStore=neoStores.getNodeStore();
    RelationshipStore relationshipStore=neoStores.getRelationshipStore();
    int highLabelId=(int)neoStores.getLabelTokenStore().getHighId();
    int highRelationshipTypeId=(int)neoStores.getRelationshipTypeTokenStore().getHighId();
    CountsComputer countsComputer=new CountsComputer(lastCommittedTransactionId,nodeStore,relationshipStore,highLabelId,highRelationshipTypeId);
    CountsTracker countsTracker=createCountsTracker();
    life.add(countsTracker.setInitializer(countsComputer));
  }
 }
