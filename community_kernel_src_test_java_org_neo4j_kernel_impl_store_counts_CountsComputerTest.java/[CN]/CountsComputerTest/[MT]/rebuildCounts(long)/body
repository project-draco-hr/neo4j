{
  cleanupCountsForRebuilding();
  StoreFactory storeFactory=new StoreFactory(fs,dir,pageCache,StringLogger.DEV_NULL,new Monitors());
  try (Lifespan life=new Lifespan();NodeStore nodeStore=storeFactory.newNodeStore();RelationshipStore relationshipStore=storeFactory.newRelationshipStore()){
    int highLabelId=(int)storeFactory.getHighId(StoreFile.LABEL_TOKEN_STORE,LabelTokenStore.RECORD_SIZE);
    int highRelationshipTypeId=(int)storeFactory.getHighId(StoreFile.RELATIONSHIP_TYPE_TOKEN_STORE,RelationshipTypeTokenStore.RECORD_SIZE);
    CountsComputer countsComputer=new CountsComputer(lastCommittedTransactionId,nodeStore,relationshipStore,highLabelId,highRelationshipTypeId);
    life.add(storeFactory.newCountsStore().setInitializer(countsComputer));
  }
 }
