{
  filter.file(file);
  File tempFile=new File(file.getAbsolutePath() + ".tmp");
  fileSystem.deleteFile(tempFile);
  try (StoreChannel in=fileSystem.open(file,"r");StoreChannel out=fileSystem.open(tempFile,"rw")){
    ByteBuffer buffer=ByteBuffer.allocate(1024 * 1024);
    LogHeader logHeader=transferLogicalLogHeader(in,out,buffer);
    PhysicalLogVersionedStoreChannel outChannel=new PhysicalLogVersionedStoreChannel(out,logHeader.logVersion,logHeader.logFormatVersion);
    final WritableLogChannel outBuffer=new PhysicalWritableLogChannel(outChannel);
    PhysicalLogVersionedStoreChannel inChannel=new PhysicalLogVersionedStoreChannel(in,logHeader.logVersion,logHeader.logFormatVersion);
    ReadableLogChannel inBuffer=new ReadAheadLogChannel(inChannel,NO_MORE_CHANNELS,DEFAULT_READ_AHEAD_SIZE);
    LogEntryReader<ReadableLogChannel> entryReader=new LogEntryReaderFactory().create();
    LogEntry entry;
    while ((entry=entryReader.readLogEntry(inBuffer)) != null) {
      if (filter.accept(entry)) {
      }
    }
  }
   return tempFile;
}
