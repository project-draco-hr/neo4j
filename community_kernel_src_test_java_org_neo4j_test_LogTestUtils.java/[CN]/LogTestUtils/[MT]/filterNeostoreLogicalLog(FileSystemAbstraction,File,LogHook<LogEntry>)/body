{
  filter.file(file);
  File tempFile=new File(file.getAbsolutePath() + ".tmp");
  fileSystem.deleteFile(tempFile);
  StoreChannel in=fileSystem.open(file,"r");
  StoreChannel out=fileSystem.open(tempFile,"rw");
  final LogBuffer outBuffer=new DirectMappedLogBuffer(out,new Monitors().newMonitor(ByteCounterMonitor.class));
  ByteBuffer buffer=ByteBuffer.allocate(1024 * 1024);
  transferLogicalLogHeader(in,outBuffer,buffer);
  return tempFile;
}
