{
  StoreChannel channel=null;
  try {
    channel=fs.open(log,"r");
    LogHeader header=LogHeaderReader.readLogHeader(ByteBuffer.allocate(LogHeader.LOG_HEADER_SIZE),channel,true);
    PhysicalLogVersionedStoreChannel logVersionedChannel=new PhysicalLogVersionedStoreChannel(channel,header.logVersion,header.logFormatVersion);
    VersionableReadableClosablePositionAwareChannel logChannel=new ReadAheadPositionableReadableChannel(logVersionedChannel,LogVersionBridge.NO_MORE_CHANNELS);
    return new LogEntryCursor(new VersionAwareLogEntryReader<>(new RecordStorageCommandReaderFactory()),logChannel);
  }
 catch (  Throwable t) {
    if (channel != null) {
      try {
        channel.close();
      }
 catch (      IOException e) {
        t.addSuppressed(e);
      }
    }
    throw new RuntimeException(t);
  }
}
