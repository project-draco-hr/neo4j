{
  ByteBuffer buffer=ByteBuffer.allocateDirect(9 + MAXGTRIDSIZE + MAXBQUALSIZE * 10);
  try (StoreChannel file=fileSystem.open(new File(logPath),"r")){
    LogHeader logHeader=readLogHeader(buffer,file,true);
    LogDeserializer deserializer=new LogDeserializer();
    PhysicalLogVersionedStoreChannel channel=new PhysicalLogVersionedStoreChannel(file,logHeader.logVersion,logHeader.logFormatVersion);
    ReadableLogChannel logChannel=new ReadAheadLogChannel(channel,NO_MORE_CHANNELS,4096);
    try (IOCursor<LogEntry> cursor=deserializer.logEntries(logChannel)){
      int entryNo=0;
      while (cursor.next()) {
        assertThat("The log contained more entries than we expected!",entryNo < expectedEntries.length,is(true));
        LogEntry expectedEntry=expectedEntries[entryNo];
        assertThat("Unexpected entry at entry number " + entryNo,cursor.get(),is(expectedEntry));
        entryNo++;
      }
      if (entryNo < expectedEntries.length) {
        fail("Log ended prematurely. Expected to find '" + expectedEntries[entryNo].toString() + "' as log entry number "+ entryNo+ ", instead there were no more log entries.");
      }
    }
   }
 }
