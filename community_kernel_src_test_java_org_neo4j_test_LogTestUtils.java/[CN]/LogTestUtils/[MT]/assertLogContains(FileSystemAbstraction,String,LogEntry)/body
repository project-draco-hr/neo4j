{
  ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
  try (StoreChannel fileChannel=fileSystem.open(new File(logPath),"r")){
    VersionAwareLogEntryReader.readLogHeader(buffer,fileChannel,true);
    LogDeserializer deserializer=new LogDeserializer();
    ReadableLogChannel logChannel=new ReadAheadLogChannel(new PhysicalLogVersionedStoreChannel(fileChannel),LogVersionBridge.NO_MORE_CHANNELS,4096);
    try (IOCursor<LogEntry> cursor=deserializer.logEntries(logChannel)){
      int entryNo=0;
      while (cursor.next()) {
        assertThat("The log contained more entries than we expected!",entryNo < expectedEntries.length,is(true));
        LogEntry expectedEntry=expectedEntries[entryNo];
        assertThat("Unexpected entry at entry number " + entryNo,cursor.get(),is(expectedEntry));
        entryNo++;
      }
      if (entryNo < expectedEntries.length) {
        fail("Log ended prematurely. Expected to find '" + expectedEntries[entryNo].toString() + "' as log entry number "+ entryNo+ ", instead there were no more log entries.");
      }
    }
   }
 }
