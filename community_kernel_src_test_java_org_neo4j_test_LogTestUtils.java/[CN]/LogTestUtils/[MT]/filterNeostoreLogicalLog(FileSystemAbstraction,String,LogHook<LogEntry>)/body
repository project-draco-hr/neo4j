{
  PhysicalLogFiles logFiles=new PhysicalLogFiles(new File(storeDir),fileSystem);
  final List<File> files=new ArrayList<>();
  logFiles.accept(new LogVersionVisitor(){
    @Override public void visit(    File file,    long logVersion){
      files.add(file);
    }
  }
);
  for (  File file : files) {
    File filteredLog=filterNeostoreLogicalLog(fileSystem,file,filter);
    replace(filteredLog,file);
  }
  return files.toArray(new File[files.size()]);
}
