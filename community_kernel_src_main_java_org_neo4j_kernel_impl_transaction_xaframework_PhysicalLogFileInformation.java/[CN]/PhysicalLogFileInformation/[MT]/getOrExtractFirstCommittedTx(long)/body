{
  Long header=transactionMetadataCache.getHeader(version);
  if (header != null) {
    return header + 1;
  }
  if (logFiles.versionExists(version)) {
    long[] headerLongs=logFiles.extractHeader(version);
    long previousVersionLastCommittedTx=headerLongs[1];
    transactionMetadataCache.putHeader(version,previousVersionLastCommittedTx);
    return previousVersionLastCommittedTx + 1;
  }
  return -1;
}
