{
  long logHeader=transactionMetadataCache.getLogHeader(version);
  if (logHeader != -1) {
    return logHeader + 1;
  }
  if (logFiles.versionExists(version)) {
    long[] headerLongs=logFiles.extractHeader(version);
    long previousVersionLastCommittedTx=headerLongs[1];
    transactionMetadataCache.putHeader(version,previousVersionLastCommittedTx);
    return previousVersionLastCommittedTx + 1;
  }
  return -1;
}
