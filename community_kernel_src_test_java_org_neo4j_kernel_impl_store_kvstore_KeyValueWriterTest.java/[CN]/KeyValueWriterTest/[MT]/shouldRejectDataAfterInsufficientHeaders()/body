{
  value.fill((byte)0xFF);
  assertTrue(writer.writeHeader(key,value));
  key.putByte(2,(byte)0x77);
  try {
    writer.writeData(key,value);
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEquals("Cannot write data when expecting header.",e.getMessage());
  }
}
