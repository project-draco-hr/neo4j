{
  writesPerRecord=new long[maxPages * recordsPerPage];
  try (PageCursor cursor=pagedFile.io(0,PF_EXCLUSIVE_LOCK)){
    while (!condition.fulfilled()) {
      int pageNumber=Random.nextInt(maxPages);
      assertTrue("I must be able to access pages",cursor.next(pageNumber));
      int recordIndex=Random.nextInt(recordsPerPage);
      recordVerifierUpdater.verifyChecksumAndUpdateCount(cursor,recordIndex,counterNumber);
      writesPerRecord[pageNumber * recordsPerPage + recordIndex]++;
      assertFalse("Exclusive lock, so never a need to retry",cursor.shouldRetry());
    }
  }
   return this;
}
