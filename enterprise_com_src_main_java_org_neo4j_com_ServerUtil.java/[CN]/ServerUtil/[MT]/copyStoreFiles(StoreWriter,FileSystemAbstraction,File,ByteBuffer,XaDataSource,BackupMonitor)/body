{
  try (ResourceIterator<File> files=ds.listStoreFiles()){
    while (files.hasNext()) {
      File storeFile=files.next();
      copyFile(writer,fs,baseDir,temporaryBuffer,storeFile,backupMonitor);
    }
  }
 catch (  IOException e) {
    throw new ServerFailureException(e);
  }
}
