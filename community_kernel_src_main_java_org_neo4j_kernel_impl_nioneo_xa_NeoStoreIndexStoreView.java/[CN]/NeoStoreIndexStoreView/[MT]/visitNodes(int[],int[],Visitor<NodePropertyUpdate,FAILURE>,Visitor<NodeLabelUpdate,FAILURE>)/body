{
  LabelsReference labelsReference=new LabelsReference();
  NodePropertyUpdateProcessor<FAILURE> propertyUpdateProcessor=new NodePropertyUpdateProcessor<>(propertyStore,multipleIntPredicate(propertyKeyIds),labelsReference,propertyUpdateVisitor);
  Predicate<NodeRecord> predicate=new NodeLabelFilterPredicate(nodeStore,multipleIntPredicate(labelIds),labelsReference);
  RecordStore.Processor<FAILURE> processor=new NodeProcessor<>(propertyUpdateProcessor,predicate,labelsReference,labelUpdateVisitor);
  return new ProcessStoreScan<>(processor,Predicates.<NodeRecord>TRUE());
}
