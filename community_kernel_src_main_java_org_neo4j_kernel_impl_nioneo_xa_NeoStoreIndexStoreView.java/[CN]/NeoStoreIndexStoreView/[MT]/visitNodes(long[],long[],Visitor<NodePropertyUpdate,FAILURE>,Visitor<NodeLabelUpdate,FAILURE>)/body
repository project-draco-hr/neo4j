{
  LabelsReference labelsReference=new LabelsReference();
  NodePropertyUpdateProcessor<FAILURE> propertyUpdateProcessor=new NodePropertyUpdateProcessor<>(propertyStore,multipleLongPredicate(propertyKeyIds),labelsReference,propertyUpdateVisitor);
  Predicate<NodeRecord> predicate=new NodeLabelFilterPredicate(nodeStore,multipleLongPredicate(labelIds),labelsReference);
  RecordStore.Processor<FAILURE> processor=new NodeProcessor<>(propertyUpdateProcessor,predicate,labelsReference,labelUpdateVisitor);
  return new ProcessStoreScan<>(processor,Predicates.<NodeRecord>TRUE());
}
