{
  long firstPropertyId=nodeStore.forceGetRecord(nodeId).getNextProp();
  if (firstPropertyId == Record.NO_NEXT_PROPERTY.intValue()) {
    return emptyIterator();
  }
  final Set<Long> propertyKeys=asSet(asIterable(propertyKeysIterator));
  return flatMap(new Function<PropertyRecord,Iterator<Pair<Integer,Object>>>(){
    @Override public Iterator<Pair<Integer,Object>> apply(    PropertyRecord propertyRecord){
      return filter(notNull(),map(propertiesThatAreIn(propertyKeys),propertyRecord.getPropertyBlocks().iterator()));
    }
  }
,propertyStore.getPropertyRecordChain(firstPropertyId).iterator());
}
