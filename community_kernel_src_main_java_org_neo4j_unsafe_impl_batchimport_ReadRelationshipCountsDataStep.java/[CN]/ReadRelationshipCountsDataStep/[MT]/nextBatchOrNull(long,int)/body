{
  if (id >= highestId) {
    return null;
  }
  long[] batch=new long[batchSize * 3];
  int i=0;
  for (; i < batchSize && ++id <= highestId; ) {
    if (cursor.next(id)) {
      int index=i++ * 3;
      batch[index++]=record.getFirstNode();
      batch[index++]=record.getType();
      batch[index++]=record.getSecondNode();
    }
  }
  return i == batchSize ? batch : Arrays.copyOf(batch,i * 3);
}
