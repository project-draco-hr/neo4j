{
  boolean interesting=false;
  if (entry instanceof LogEntry.Start) {
    List<LogEntry> list=new LinkedList<LogEntry>();
    list.add(entry);
    transactions.put(entry.getIdentifier(),list);
  }
 else   if (entry instanceof LogEntry.Commit) {
    if (((LogEntry.Commit)entry).getTxId() == txId) {
      interesting=true;
      identifier=entry.getIdentifier();
      List<LogEntry> entries=transactions.get(identifier);
      entries.add(entry);
      writeToBuffer(entries);
    }
  }
 else   if (entry instanceof LogEntry.Command || entry instanceof LogEntry.Prepare) {
    List<LogEntry> list=transactions.get(entry.getIdentifier());
    if (list != null) {
      list.add(entry);
    }
  }
 else   if (entry instanceof LogEntry.Done) {
    transactions.remove(entry.getIdentifier());
  }
 else {
    throw new RuntimeException("Unknown entry: " + entry);
  }
  return interesting;
}
