{
  LogEntry.Start startEntry=xidIdentMap.get(identifier);
  log.position(startEntry.getStartPosition());
  List<LogEntry> logEntryList=new ArrayList<LogEntry>();
  LogEntry entry;
  while ((entry=LogIoUtils.readEntry(buffer,log,cf)) != null) {
    if (entry.getIdentifier() != identifier) {
      continue;
    }
    if (entry instanceof LogEntry.Prepare) {
      break;
    }
    if (entry instanceof LogEntry.Start || entry instanceof LogEntry.Command) {
      logEntryList.add(entry);
    }
 else {
      throw new RuntimeException("Expected start or command entry but found: " + entry);
    }
  }
  if (logEntryList.isEmpty()) {
    throw new IOException("Transaction for internal identifier[" + identifier + "] not found in current log");
  }
  return logEntryList;
}
