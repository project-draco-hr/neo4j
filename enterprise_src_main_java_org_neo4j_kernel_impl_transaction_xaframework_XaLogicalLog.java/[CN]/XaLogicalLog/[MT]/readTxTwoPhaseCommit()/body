{
  LogEntry.TwoPhaseCommit commit=LogIoUtils.readTxTwoPhaseCommit(buffer,fileChannel);
  if (commit == null) {
    return false;
  }
  int identifier=commit.getIdentifier();
  long txId=commit.getTxId();
  LogEntry.Start entry=xidIdentMap.get(identifier);
  if (entry == null) {
    return false;
  }
  Xid xid=entry.getXid();
  if (xid == null) {
    return false;
  }
  try {
    XaTransaction xaTx=xaRm.getXaTransaction(xid);
    xaTx.setCommitTxId(txId);
    xaRm.injectTwoPhaseCommit(xid);
  }
 catch (  XAException e) {
    e.printStackTrace();
    throw new IOException(e.getMessage());
  }
  return true;
}
