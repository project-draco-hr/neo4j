def _index_and_remove_item(self, idx, item):
    with self.graphdb.transaction:
        idx['akey']['avalue'] = item
        idx['akey']['bvalue'] = item
        idx['bkey']['avalue'] = item
        self.assertEqual(len(list(idx['akey']['avalue'])), 1)
        self.assertEqual(len(list(idx['akey']['bvalue'])), 1)
        self.assertEqual(len(list(idx['bkey']['avalue'])), 1)
        del idx['akey']['avalue'][item]
        self.assertEqual(len(list(idx['akey']['avalue'])), 0)
        self.assertEqual(len(list(idx['akey']['bvalue'])), 1)
        self.assertEqual(len(list(idx['bkey']['avalue'])), 1)
        del idx['akey'][item]
        self.assertEqual(len(list(idx['akey']['avalue'])), 0)
        self.assertEqual(len(list(idx['akey']['bvalue'])), 0)
        self.assertEqual(len(list(idx['bkey']['avalue'])), 1)
        del idx[item]
        self.assertEqual(len(list(idx['akey']['avalue'])), 0)
        self.assertEqual(len(list(idx['akey']['bvalue'])), 0)
        self.assertEqual(len(list(idx['bkey']['avalue'])), 0)
        del idx['akey']['avalue'][item]
        del idx['akey'][item]
        del idx[item]
