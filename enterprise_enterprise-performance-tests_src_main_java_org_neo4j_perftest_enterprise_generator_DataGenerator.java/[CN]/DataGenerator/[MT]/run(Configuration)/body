{
  String storeDir=configuration.get(store_dir);
  FileUtils.deleteRecursively(new File(storeDir));
  DataGenerator generator=new DataGenerator(configuration);
  BatchInserter batchInserter=BatchInserters.inserter(storeDir,batchInserterConfig(configuration));
  try {
    generator.generateData(batchInserter);
  }
  finally {
    batchInserter.shutdown();
  }
  StoreAccess stores=new StoreAccess(storeDir);
  try {
    printCount(stores.getNodeStore());
    printCount(stores.getRelationshipStore());
    printCount(stores.getPropertyStore());
    printCount(stores.getStringStore());
    printCount(stores.getArrayStore());
    if (configuration.get(report_stats)) {
      PropertyStats stats=new PropertyStats();
      stats.applyFiltered(stores.getPropertyStore(),RecordStore.IN_USE);
      System.out.println(stats);
    }
  }
  finally {
    stores.close();
  }
}
