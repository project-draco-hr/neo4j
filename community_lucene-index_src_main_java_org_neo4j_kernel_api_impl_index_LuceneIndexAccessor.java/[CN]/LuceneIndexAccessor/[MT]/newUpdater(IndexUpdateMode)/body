{
switch (mode) {
case ONLINE:
    return new LuceneIndexUpdater(writer,false);
case RECOVERY:
  return new LuceneIndexUpdater(writer,true);
default :
throw new IllegalArgumentException("Unsupported update mode: " + mode);
}
}
