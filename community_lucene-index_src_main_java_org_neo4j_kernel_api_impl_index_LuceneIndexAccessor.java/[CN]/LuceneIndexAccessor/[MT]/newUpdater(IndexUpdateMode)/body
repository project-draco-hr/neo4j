{
  if (readOnly) {
    throw new UnsupportedOperationException("Index update is unsupported in read only mode.");
  }
switch (mode) {
case ONLINE:
    return new LuceneIndexUpdater(false);
case BATCHED:
  return new LuceneIndexUpdater(true);
default :
throw new ThisShouldNotHappenError("Stefan","Unsupported update mode");
}
}
