{
switch (mode) {
case ONLINE:
    return new LuceneIndexUpdater(false);
case RECOVERY:
  return new LuceneIndexUpdater(true);
default :
throw new IllegalArgumentException("Unsupported update mode: " + mode);
}
}
