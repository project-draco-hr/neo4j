{
  taskCoordinator.cancel();
  closeIndexResources();
  try {
    taskCoordinator.awaitCompletion();
  }
 catch (  InterruptedException e) {
    throw new IOException("Interrupted while waiting for concurrent tasks to complete.",e);
  }
  indexStorage.cleanupFolder(indexStorage.getIndexFolder());
}
