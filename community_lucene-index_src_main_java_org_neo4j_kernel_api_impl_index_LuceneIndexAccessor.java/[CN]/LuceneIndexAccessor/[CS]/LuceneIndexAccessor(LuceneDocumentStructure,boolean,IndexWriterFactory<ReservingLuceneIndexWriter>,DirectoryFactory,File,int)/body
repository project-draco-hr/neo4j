{
  this.documentStructure=documentStructure;
  this.readOnly=readOnly;
  this.indexFolder=indexFolder;
  this.bufferSizeLimit=bufferSizeLimit;
  this.dir=dirFactory.open(indexFolder);
  if (readOnly) {
    this.writer=null;
    searcherManager=createReadOnlySearchManager();
  }
 else {
    this.writer=indexWriterFactory.create(dir);
    this.searcherManager=new LuceneReferenceManager.Wrap<>(writer.createSearcherManager());
  }
}
