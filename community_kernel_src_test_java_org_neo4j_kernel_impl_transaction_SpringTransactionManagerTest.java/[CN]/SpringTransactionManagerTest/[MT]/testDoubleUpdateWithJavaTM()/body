{
  GraphDatabaseAPI db=(GraphDatabaseAPI)new TestGraphDatabaseFactory().newImpermanentDatabase();
  TransactionManager tm=new SpringTransactionManager(db);
  tm.begin();
  Node node;
  node=db.createNode();
  node.setProperty("name","Foo");
  tm.commit();
  Transaction transaction=db.beginTx();
  assertEquals("Foo",db.getNodeById(node.getId()).getProperty("name"));
  node.setProperty("name","Bar");
  transaction.success();
  transaction.finish();
  tm.begin();
  node.setProperty("name","FooBar");
  assertEquals("FooBar",db.getNodeById(node.getId()).getProperty("name"));
  tm.commit();
  db.shutdown();
}
