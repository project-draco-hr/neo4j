{
  try (TemporaryStoreDirectory tempStore=new TemporaryStoreDirectory(fs,localDatabase.storeDir())){
    storeFetcher.copyStore(source,expectedStoreId,tempStore.storeDir());
    copiedStoreRecovery.recoverCopiedStore(tempStore.storeDir());
    localDatabase.replaceWith(tempStore.storeDir());
  }
   log.info("Replaced store with one downloaded from %s",source);
}
