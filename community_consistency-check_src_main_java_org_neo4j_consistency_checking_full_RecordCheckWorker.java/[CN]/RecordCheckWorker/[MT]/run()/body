{
  while (!done || !recordsQ.isEmpty()) {
    RECORD record;
    try {
      record=recordsQ.poll(10,TimeUnit.MILLISECONDS);
      if (record != null) {
        if (!initialized) {
          awaitMyTurnToInitialize();
        }
        process(record);
        if (!initialized) {
          tellNextThreadToInitialize();
          initialized=true;
        }
      }
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
      break;
    }
  }
}
