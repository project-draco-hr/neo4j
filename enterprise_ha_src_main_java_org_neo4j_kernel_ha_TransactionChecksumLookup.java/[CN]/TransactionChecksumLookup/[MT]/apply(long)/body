{
  TransactionId lastCommittedTransaction=transactionIdStore.getLastCommittedTransaction();
  if (lastCommittedTransaction.transactionId() == txId) {
    return lastCommittedTransaction.checksum();
  }
  try {
    return logicalTransactionStore.getMetadataFor(txId).getChecksum();
  }
 catch (  NoSuchTransactionException e) {
    TransactionId lastUpgradeTransaction=transactionIdStore.getUpgradeTransaction();
    if (lastUpgradeTransaction.transactionId() == txId) {
      return lastUpgradeTransaction.checksum();
    }
    throw withMessage(e,e.getMessage() + " | transaction id store says last transaction is " + lastCommittedTransaction+ " and last upgrade transaction is "+ lastUpgradeTransaction);
  }
}
