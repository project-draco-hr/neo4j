{
  final byte markerByte=in.ensure(1).get();
switch (markerByte) {
case BYTES_8:
    return unpackBytes(unpackUINT8());
case BYTES_16:
  return unpackBytes(unpackUINT16());
case BYTES_32:
{
  long size=unpackUINT32();
  if (size <= Integer.MAX_VALUE) {
    return unpackBytes((int)size);
  }
 else {
    throw new Overflow("BYTES_32 too long for Java");
  }
}
default :
throw new Unexpected("Expected bytes, but got: " + toHexString(markerByte & 0xFF));
}
}
