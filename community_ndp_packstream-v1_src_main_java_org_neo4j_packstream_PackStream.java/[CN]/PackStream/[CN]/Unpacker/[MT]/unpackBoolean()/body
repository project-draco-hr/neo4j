{
  final byte markerByte=in.ensure(1).get();
switch (markerByte) {
case TRUE:
    return true;
case FALSE:
  return false;
default :
throw new Unexpected("Expected a boolean, but got: " + toHexString(markerByte));
}
}
