{
  final byte markerByte=in.ensure(1).peek();
  final byte markerHighNibble=(byte)(markerByte & 0xF0);
switch (markerHighNibble) {
case TINY_TEXT:
    return PackType.TEXT;
case TINY_LIST:
  return PackType.LIST;
case TINY_MAP:
return PackType.MAP;
case TINY_STRUCT:
return PackType.STRUCT;
}
switch (markerByte) {
case NULL:
return PackType.NULL;
case TRUE:
case FALSE:
return PackType.BOOLEAN;
case FLOAT_64:
return PackType.FLOAT;
case BYTES_8:
case BYTES_16:
case BYTES_32:
return PackType.BYTES;
case TEXT_8:
case TEXT_16:
case TEXT_32:
return PackType.TEXT;
case LIST_8:
case LIST_16:
case LIST_32:
return PackType.LIST;
case MAP_8:
case MAP_16:
case MAP_32:
return PackType.MAP;
case STRUCT_8:
case STRUCT_16:
return PackType.STRUCT;
default :
return PackType.INTEGER;
}
}
