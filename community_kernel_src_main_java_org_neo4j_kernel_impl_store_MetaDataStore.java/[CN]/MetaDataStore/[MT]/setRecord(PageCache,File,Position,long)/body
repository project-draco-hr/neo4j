{
  long previousValue=FIELD_NOT_INITIALIZED;
  try (PagedFile pagedFile=pageCache.map(neoStore,getPageSize(pageCache))){
    int recordOffset=RECORD_SIZE * position.id;
    try (PageCursor pageCursor=pagedFile.io(0,PagedFile.PF_EXCLUSIVE_LOCK)){
      if (pageCursor.next()) {
        long record;
        byte inUse;
        do {
          pageCursor.setOffset(recordOffset);
          inUse=pageCursor.getByte();
          record=pageCursor.getLong();
          if (inUse == Record.IN_USE.byteValue()) {
            previousValue=record;
          }
          pageCursor.setOffset(recordOffset);
          pageCursor.putByte(Record.IN_USE.byteValue());
          pageCursor.putLong(value);
        }
 while (pageCursor.shouldRetry());
      }
    }
   }
   return previousValue;
}
