{
  if (logIndex > state.appendIndex) {
    return -1;
  }
  long term=state.terms.get(logIndex);
  if (term == -1 && logIndex >= state.prevIndex) {
    RaftLogEntry entry=readLogEntry(logIndex);
    term=(entry != null) ? entry.term() : -1;
  }
  return term;
}
