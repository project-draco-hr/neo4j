{
  long highId=nodeStore.getHighestPossibleIdInUse();
  System.out.println("Starting at " + highId);
  NodeRecord heavilyReusedRecord=new NodeRecord(-1);
  for (long nodeId=highId; nodeId >= 0; nodeId--) {
    long firstRel=nodeRelationshipLink.getFirstRel(nodeId,this);
    if (firstRel == -1) {
      continue;
    }
    NodeRecord record=nodeStore.getRecord(nodeId,heavilyReusedRecord);
    record.setNextRel(firstRel);
    if (nodeRelationshipLink.isDense(nodeId)) {
      record.setDense(true);
    }
    nodeStore.updateRecord(record);
    itemProcessed();
  }
  nodeStore.flushAll();
}
