{
  RaftMessageEncoder encoder=new RaftMessageEncoder(serializer);
  RaftMessageDecoder decoder=new RaftMessageDecoder(serializer);
  LinkedList<Object> resultingBuffers=new LinkedList<>();
  ArrayList<Object> thingsRead=new ArrayList<>(1);
  CoreMember sender=new CoreMember(address("127.0.0.1:5001"),address("127.0.0.2:5001"));
  RaftMessages.Heartbeat<CoreMember> message=new RaftMessages.Heartbeat<>(sender,1,2,3);
  encoder.encode(setupContext(),message,resultingBuffers);
  assertEquals(1,resultingBuffers.size());
  decoder.decode(null,(ByteBuf)resultingBuffers.get(0),thingsRead);
  assertEquals(1,thingsRead.size());
  assertEquals(message,thingsRead.get(0));
}
