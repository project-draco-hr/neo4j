{
  RaftMessageEncoder encoder=new RaftMessageEncoder(serializer);
  RaftMessageDecoder decoder=new RaftMessageDecoder(serializer);
  LinkedList<Object> resultingBuffers=new LinkedList<>();
  ArrayList<Object> thingsRead=new ArrayList<>(1);
  encoder.encode(setupContext(),message,resultingBuffers);
  assertEquals(1,resultingBuffers.size());
  decoder.decode(null,(ByteBuf)resultingBuffers.get(0),thingsRead);
  assertEquals(1,thingsRead.size());
  assertEquals(message,thingsRead.get(0));
}
