{
  Config readOnlyConfig=new Config(stringMap(GraphDatabaseSettings.read_only.name(),Settings.TRUE));
  LuceneSchemaIndexProvider readOnlyIndexProvider=getLuceneSchemaIndexProvider(readOnlyConfig,new DirectoryFactory.InMemoryDirectoryFactory());
  expectedException.expect(IllegalStateException.class);
  getIndexAccessor(readOnlyConfig,readOnlyIndexProvider);
}
