{
  try (TokenFutures.CompletableFutureTokenId tokenFuture=tokenFutures.createFuture(tokenName)){
    ReplicatedTokenRequest tokenRequest=new ReplicatedTokenRequest(type,tokenName,createCommands(tokenName));
    try {
      replicator.replicate(tokenRequest);
      return tokenFuture.get(timeoutMillis,TimeUnit.MILLISECONDS);
    }
 catch (    Replicator.ReplicationFailedException|InterruptedException|ExecutionException|TimeoutException e) {
      throw new org.neo4j.graphdb.TransactionFailureException("Could not create token",e);
    }
  }
 }
