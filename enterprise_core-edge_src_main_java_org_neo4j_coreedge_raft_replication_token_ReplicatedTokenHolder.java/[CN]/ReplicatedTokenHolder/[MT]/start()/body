{
  if (lastCommittedIndex == Long.MAX_VALUE) {
    throw new IllegalStateException("lastCommittedIndex must be set before start.");
  }
  tokenCache.clear();
  replicator.subscribe(this);
}
