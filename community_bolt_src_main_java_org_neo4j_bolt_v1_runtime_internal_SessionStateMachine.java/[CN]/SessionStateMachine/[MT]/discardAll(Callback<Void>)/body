{
  before(callback);
  try {
    state=state.discardAll(this);
  }
  finally {
    after();
  }
}
