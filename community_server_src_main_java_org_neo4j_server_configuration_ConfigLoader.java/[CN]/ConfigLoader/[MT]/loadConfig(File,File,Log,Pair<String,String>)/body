{
  if (log == null) {
    throw new IllegalArgumentException("log cannot be null ");
  }
  HashMap<String,String> settings=calculateSettings(configFile,legacyConfigFile,log,configOverrides);
  Config config=new Config(settings,settingsClasses.calculate(settings));
  config.setLogger(log);
  return config;
}
