{
  masterElectedLatch=new CountDownLatch(1);
  final HighAvailabilityEvents events=db.getDependencyResolver().resolveDependency(HighAvailabilityEvents.class);
  events.addHighAvailabilityEventListener(new HighAvailabilityListener.Adapter(){
    @Override public void memberIsAvailable(    String role,    URI instanceClusterUri,    Iterable<URI> instanceUris){
      if (role.equals(HighAvailabilityEvents.MASTER)) {
        masterElectedLatch.countDown();
        events.removeHighAvailabilityEventListener(this);
      }
    }
  }
);
}
