{
  masterElectedLatch=new CountDownLatch(1);
  final ClusterMemberEvents events=db.getDependencyResolver().resolveDependency(ClusterMemberEvents.class);
  events.addClusterMemberListener(new ClusterMemberListener.Adapter(){
    @Override public void memberIsAvailable(    String role,    URI instanceClusterUri,    URI roleUri){
      if (role.equals(HighAvailabilityModeSwitcher.MASTER)) {
        masterElectedLatch.countDown();
        events.removeClusterMemberListener(this);
      }
    }
  }
);
}
