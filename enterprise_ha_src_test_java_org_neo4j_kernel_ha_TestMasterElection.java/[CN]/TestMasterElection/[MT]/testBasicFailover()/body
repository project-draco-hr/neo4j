{
  assertTrue(master.isMaster());
  assertTrue(!slave1.isMaster());
  assertTrue(!slave2.isMaster());
  startListenForNewMaster(slave2);
  master.shutdown();
  master=null;
  assertTrue(masterElectedLatch.await(30,SECONDS));
  assertTrue(slave1.isMaster());
  assertTrue(!slave2.isMaster());
}
