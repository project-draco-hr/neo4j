{
  channel.putLong(snapshot.getTxId());
  channel.putInt(snapshot.getMap().size());
  for (  Map.Entry<CountsKey,long[]> pair : snapshot.getMap().entrySet()) {
    CountsKey key=pair.getKey();
    long[] value=pair.getValue();
switch (key.recordType()) {
case ENTITY_NODE:
      NodeKey nodeKey=(NodeKey)key;
    channel.put(ENTITY_NODE.code);
  channel.putInt(nodeKey.getLabelId());
channel.putLong(value[0]);
break;
case ENTITY_RELATIONSHIP:
RelationshipKey relationshipKey=(RelationshipKey)key;
channel.put(ENTITY_RELATIONSHIP.code);
channel.putInt(relationshipKey.getStartLabelId());
channel.putInt(relationshipKey.getTypeId());
channel.putInt(relationshipKey.getEndLabelId());
channel.putLong(value[0]);
break;
case INDEX_SAMPLE:
IndexSampleKey indexSampleKey=(IndexSampleKey)key;
channel.put(INDEX_SAMPLE.code);
channel.putInt(indexSampleKey.labelId());
channel.putInt(indexSampleKey.propertyKeyId());
channel.putLong(value[0]);
channel.putLong(value[1]);
break;
case INDEX_STATISTICS:
IndexStatisticsKey indexStatisticsKey=(IndexStatisticsKey)key;
channel.put(INDEX_STATISTICS.code);
channel.putInt(indexStatisticsKey.labelId());
channel.putInt(indexStatisticsKey.propertyKeyId());
channel.putLong(value[0]);
channel.putLong(value[1]);
break;
}
}
}
