{
  File dbDir=dir.directory();
  cluster=Cluster.start(dbDir,3,2,discoveryServiceFactory);
  CoreGraphDatabase db=cluster.getCoreServerById(0);
  KernelAPI kernel=db.getDependencyResolver().resolveDependency(KernelAPI.class);
  KernelTransaction transaction=kernel.newTransaction(Type.implicit,READ);
  Statement statement=transaction.acquireStatement();
  List<Object[]> levels=asList(statement.readOperations().procedureCallRead(procedureName("dbms","cluster","discoverConsistencyLevels"),new Object[0]));
  assertThat(levels,containsInAnyOrder(new Object[]{RYOW_CORE.name()},new Object[]{RYOW_EDGE.name()}));
  List<Object[]> coreMembers=asList(statement.readOperations().procedureCallRead(procedureName("dbms","cluster","discoverMembers"),new Object[]{RYOW_CORE.name()}));
  assertEquals(3,coreMembers.size());
  assertThat(coreMembers,containsInAnyOrder(new Object[]{"127.0.0.1:8000"},new Object[]{"127.0.0.1:8001"},new Object[]{"127.0.0.1:8002"}));
  List<Object[]> edgeMembers=asList(statement.readOperations().procedureCallRead(procedureName("dbms","cluster","discoverMembers"),new Object[]{RYOW_EDGE.name()}));
  assertEquals(2,edgeMembers.size());
  assertThat(edgeMembers,containsInAnyOrder(new Object[]{"127.0.0.1:9000"},new Object[]{"127.0.0.1:9001"}));
}
