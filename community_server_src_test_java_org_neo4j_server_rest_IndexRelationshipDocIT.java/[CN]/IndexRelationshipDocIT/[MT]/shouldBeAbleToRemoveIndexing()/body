{
  String key1="kvkey1";
  String key2="kvkey2";
  String value1="value1";
  String value2="value2";
  String indexName=indexes.newInstance();
  long relationship=helper.createRelationship("some type");
  helper.setRelationshipProperties(relationship,MapUtil.map(key1,value1,key1,value2,key2,value1,key2,value2));
  helper.addRelationshipToIndex(indexName,key1,value1,relationship);
  helper.addRelationshipToIndex(indexName,key1,value2,relationship);
  helper.addRelationshipToIndex(indexName,key2,value1,relationship);
  helper.addRelationshipToIndex(indexName,key2,value2,relationship);
  assertEquals(1,helper.getIndexedRelationships(indexName,key1,value1).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key1,value2).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key2,value1).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key2,value2).size());
  JaxRsResponse response=RestRequest.req().delete(functionalTestHelper.relationshipIndexUri() + indexName + "/"+ key1+ "/"+ value1+ "/"+ relationship);
  assertEquals(204,response.getStatus());
  assertEquals(0,helper.getIndexedRelationships(indexName,key1,value1).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key1,value2).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key2,value1).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key2,value2).size());
  response=RestRequest.req().delete(functionalTestHelper.relationshipIndexUri() + indexName + "/"+ key2+ "/"+ relationship);
  assertEquals(204,response.getStatus());
  assertEquals(0,helper.getIndexedRelationships(indexName,key1,value1).size());
  assertEquals(1,helper.getIndexedRelationships(indexName,key1,value2).size());
  assertEquals(0,helper.getIndexedRelationships(indexName,key2,value1).size());
  assertEquals(0,helper.getIndexedRelationships(indexName,key2,value2).size());
  response=RestRequest.req().delete(functionalTestHelper.relationshipIndexUri() + indexName + "/"+ relationship);
  assertEquals(204,response.getStatus());
  assertEquals(0,helper.getIndexedRelationships(indexName,key1,value1).size());
  assertEquals(0,helper.getIndexedRelationships(indexName,key1,value2).size());
  assertEquals(0,helper.getIndexedRelationships(indexName,key2,value1).size());
  assertEquals(0,helper.getIndexedRelationships(indexName,key2,value2).size());
  response=RestRequest.req().delete(functionalTestHelper.indexRelationshipUri(indexName));
  assertEquals(204,response.getStatus());
  assertFalse(asList(helper.getRelationshipIndexes()).contains(indexName));
}
