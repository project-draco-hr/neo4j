{
  final Config config=dependencies.config();
  final GraphDatabaseService gdb=dependencies.db();
  final GraphDatabaseAPI api=(GraphDatabaseAPI)gdb;
  final LogService logging=dependencies.logService();
  final Log log=logging.getInternalLog(Sessions.class);
  final LifeSupport life=new LifeSupport();
  final JobScheduler scheduler=dependencies.scheduler();
  Netty4LogBridge.setLogProvider(logging.getInternalLogProvider());
  Sessions sessions=new MonitoredSessions(dependencies.monitors(),new ThreadedSessions(life.add(new StandardSessions(api,dependencies.usageData(),logging,dependencies.txBridge())),scheduler,logging),Clock.systemUTC());
  List<NettyServer.ProtocolInitializer> connectors=new ArrayList<>();
  List<Configuration> view=config.view(Settings.connector_group);
  for (  Configuration connector : view) {
    final HostnamePort socketAddress=connector.get(Settings.socket_address);
    if (connector.get(Settings.enabled)) {
      SslContext sslCtx;
      boolean requireEncryption=false;
switch (connector.get(Settings.tls_level)) {
case REQUIRED:
        requireEncryption=true;
case OPTIONAL:
      KeyStoreInformation keyStore=createKeyStore(config,log);
    sslCtx=SslContextBuilder.forServer(keyStore.getCertificatePath(),keyStore.getPrivateKeyPath()).build();
  break;
default :
sslCtx=null;
break;
}
connectors.add(new SocketTransport(socketAddress,sslCtx,logging.getInternalLogProvider(),newVersions(logging,requireEncryption ? new EncryptionRequiredSessions(sessions) : sessions)));
}
}
if (connectors.size() > 0) {
life.add(new NettyServer(scheduler.threadFactory(boltNetworkIO),connectors));
log.info("Bolt Server extension loaded.");
}
return life;
}
