{
  boolean haveTriedReInstantiate=false;
  while (true) {
    try {
      return getMasterInternal();
    }
 catch (    KeeperException e) {
      if (!haveTriedReInstantiate && e.code() == KeeperException.Code.SESSIONEXPIRED) {
        instantiateZooKeeper();
        haveTriedReInstantiate=true;
        continue;
      }
      throw new ZooKeeperException("Unable to get master",e);
    }
  }
}
