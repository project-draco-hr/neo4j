{
  GraphDatabaseAPI db=(GraphDatabaseAPI)new GraphDatabaseFactory().newEmbeddedDatabase(backupDir.getAbsolutePath());
  try {
    LogicalTransactionStore transactionStore=db.getDependencyResolver().resolveDependency(LogicalTransactionStore.class);
    TransactionIdStore transactionIdStore=db.getDependencyResolver().resolveDependency(TransactionIdStore.class);
    TransactionMetadata metadata=transactionStore.getMetadataFor(transactionIdStore.getLastCommittingTransactionId());
    return Pair.of(metadata.getMasterId(),metadata.getChecksum());
  }
 catch (  NoSuchTransactionException e) {
    return null;
  }
 finally {
    db.shutdown();
  }
}
