{
  defaultBackupPortHostParams();
  Config config=dbRule.getConfigCopy();
  dbRule.setConfig(OnlineBackupSettings.online_backup_enabled,"false");
  Config withOnlineBackupDisabled=dbRule.getConfigCopy();
  createAndIndexNode(dbRule,1);
  final StringLogger msgLog=mock(StringLogger.class);
  final ConsoleLogger console=mock(ConsoleLogger.class);
  Logging logging=new SingleLoggingService(msgLog){
    @Override public ConsoleLogger getConsoleLog(    Class loggingClass){
      return console;
    }
  }
;
  OnlineBackupKernelExtension backup=new OnlineBackupKernelExtension(config,dbRule,dbRule.getDependencyResolver().resolveDependency(KernelPanicEventGenerator.class),logging,monitors);
  backup.start();
  backupService().doFullBackup(BACKUP_HOST,backupPort,backupDir.getAbsolutePath(),false,withOnlineBackupDisabled,BackupClient.BIG_READ_TIMEOUT,false);
  verify(console).log("Full backup started...");
  verify(console).log("Full backup finished.");
  createAndIndexNode(dbRule,2);
  backupService().doIncrementalBackupOrFallbackToFull(BACKUP_HOST,backupPort,backupDir.getAbsolutePath(),false,withOnlineBackupDisabled,BackupClient.BIG_READ_TIMEOUT,false);
  backup.stop();
  verify(console).log("Incremental backup started...");
  verify(console).log("Incremental backup finished.");
}
