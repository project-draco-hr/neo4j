{
  Map<String,String> config=defaultBackupPortHostParams();
  config.put(GraphDatabaseSettings.keep_logical_logs.name(),"false");
  GraphDatabaseAPI db=createDb(storeDir,config);
  BackupService backupService=new BackupService(fileSystem);
  createAndIndexNode(db,1);
  backupService.doFullBackup(BACKUP_HOST,backupPort,backupDir.getAbsolutePath(),false,new Config(defaultBackupPortHostParams()));
  db.shutdown();
  FileUtils.deleteRecursively(storeDir);
  db=createDb(storeDir,config);
  try {
    backupService.doIncrementalBackupOrFallbackToFull(BACKUP_HOST,backupPort,backupDir.getAbsolutePath(),false,new Config(defaultBackupPortHostParams()));
    fail("Should have thrown exception.");
  }
 catch (  MismatchingStoreIdException e) {
  }
  assertTrue(backupDir.exists());
  db.shutdown();
}
