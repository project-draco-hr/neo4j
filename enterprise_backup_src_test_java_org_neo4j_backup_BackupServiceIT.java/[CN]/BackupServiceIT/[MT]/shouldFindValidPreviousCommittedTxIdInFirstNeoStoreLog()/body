{
  GraphDatabaseAPI db=createDb(storeDir,defaultBackupPortHostParams());
  createAndIndexNode(db,1);
  createAndIndexNode(db,2);
  createAndIndexNode(db,3);
  createAndIndexNode(db,4);
  NeoStore neoStore=db.getDependencyResolver().resolveDependency(NeoStore.class);
  neoStore.flush();
  long txId=neoStore.getLastCommittedTransactionId();
  BackupService backupService=new BackupService(fileSystem);
  backupService.doFullBackup(BACKUP_HOST,backupPort,backupDir.getAbsolutePath(),false,new Config(defaultBackupPortHostParams()),BackupClient.BIG_READ_TIMEOUT);
  db.shutdown();
  checkPreviousCommittedTxIdFromFirstLog(txId);
}
