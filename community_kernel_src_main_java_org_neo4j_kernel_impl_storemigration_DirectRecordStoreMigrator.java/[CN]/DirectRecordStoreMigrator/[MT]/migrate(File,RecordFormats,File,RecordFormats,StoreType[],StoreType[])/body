{
  StoreType[] storesToOpen=ArrayUtil.concat(types,additionalTypesToOpen);
  try (NeoStores fromStores=new StoreFactory(fromStoreDir,config,new DefaultIdGeneratorFactory(fs),pageCache,fs,NullLogProvider.getInstance(),fromFormat).openNeoStores(true,storesToOpen);NeoStores toStores=new StoreFactory(toStoreDir,withPersistedStoreHeadersAsConfigFrom(fromStores,storesToOpen),new DefaultIdGeneratorFactory(fs),pageCache,fs,NullLogProvider.getInstance(),toFormat).openNeoStores(true,storesToOpen)){
    for (    StoreType type : types) {
      if (type.isRecordStore() && type != StoreType.META_DATA && toFormat.hasStore(type) && fromFormat.hasStore(type)) {
        migrate(fromStores.getRecordStore(type),toStores.getRecordStore(type));
      }
    }
  }
 }
