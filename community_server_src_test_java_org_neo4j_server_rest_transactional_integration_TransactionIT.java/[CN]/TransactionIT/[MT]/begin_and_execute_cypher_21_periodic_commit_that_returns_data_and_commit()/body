{
  ServerTestUtils.withCSVFile(1,new ServerTestUtils.BlockWithCSVFileURL(){
    @Override public void execute(    String url) throws Exception {
      long nodesInDatabaseBeforeTransaction=countNodes();
      Response response=http.POST("/db/data/transaction/commit",quotedJson("{ 'statements': [ { 'statement': 'CYPHER 2.1 USING PERIODIC COMMIT LOAD CSV FROM" + " \\\"" + url + "\\\" AS line CREATE (n {id: 23}) RETURN n' } ] }"));
      assertThat(response.status(),equalTo(200));
      assertThat(response,containsNoErrors());
      JsonNode columns=response.get("results").get(0).get("columns");
      assertThat(columns.toString(),equalTo("[\"n\"]"));
      assertThat(countNodes(),equalTo(nodesInDatabaseBeforeTransaction + 1));
    }
  }
);
}
