{
  Node start, end;
  try {
    start=node(startNodeId);
  }
 catch (  NodeNotFoundException e) {
    throw new StartNodeNotFoundException();
  }
  try {
    end=node(endNodeId);
  }
 catch (  NodeNotFoundException e) {
    throw new EndNodeNotFoundException();
  }
  final RelationshipRepresentation result;
  Transaction tx=graphDb.beginTx();
  try {
    result=new RelationshipRepresentation(set(start.createRelationshipTo(end,DynamicRelationshipType.withName(type)),properties));
    tx.success();
  }
  finally {
    tx.finish();
  }
  return result;
}
