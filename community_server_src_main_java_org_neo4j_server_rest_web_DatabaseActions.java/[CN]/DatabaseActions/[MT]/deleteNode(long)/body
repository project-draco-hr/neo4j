{
  Node node=node(nodeId);
  Transaction tx=beginTx();
  try {
    node.delete();
    tx.success();
  }
  finally {
    try {
      tx.finish();
    }
 catch (    TransactionFailureException e) {
      throw new OperationFailureException(String.format("The node with id %d cannot be deleted. Check that the node is orphaned before deletion.",nodeId));
    }
  }
}
