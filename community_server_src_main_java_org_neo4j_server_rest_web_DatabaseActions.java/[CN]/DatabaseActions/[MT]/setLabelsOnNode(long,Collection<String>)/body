{
  Node node=node(nodeId);
  Transaction tx=beginTx();
  try {
    for (    Label label : node.getLabels()) {
      node.removeLabel(label);
    }
    for (    String labelName : labels) {
      node.addLabel(label(labelName));
    }
    tx.success();
  }
 catch (  ConstraintViolationException e) {
    throw new BadInputException("Unable to add label, see nested exception.",e);
  }
 finally {
    tx.finish();
  }
}
