{
synchronized (System.err) {
    Map<Thread,StackTraceElement[]> allStackTraces=Thread.getAllStackTraces();
    for (    Map.Entry<Thread,StackTraceElement[]> entry : allStackTraces.entrySet()) {
      System.err.println("Stack Trace for " + entry.getKey().getName());
      StackTraceElement[] elements=entry.getValue();
      for (      StackTraceElement element : elements) {
        System.err.println("\tat " + element.toString());
      }
      System.err.println();
    }
  }
}
