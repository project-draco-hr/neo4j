{
  EnumSet<Thread.State> set=EnumSet.of(first,rest);
  long deadline=maxWaitMillis + System.currentTimeMillis();
  Thread.State currentState;
  do {
    currentState=thread.getState();
    if (System.currentTimeMillis() > deadline) {
      throw new AssertionError("Timed out waiting for thread state of <" + set + ">: "+ thread+ " (state = "+ thread.getState()+ ")");
    }
  }
 while (!set.contains(currentState));
}
