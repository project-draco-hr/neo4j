{
  applyDocuments(writer,indexType,documents);
  if (writer != null && !recovery) {
    dataSource.invalidateIndexSearcher(identifier);
  }
  if (searcher != null) {
    searcher.close();
  }
}
