{
  Config config=buildProperties();
  ByteArrayOutputStream outputStream=new ByteArrayOutputStream();
  new GraphDatabaseFactory().newEmbeddedDatabase(storeDirectory).shutdown();
  PerformRecoveryIfNecessary task=new PerformRecoveryIfNecessary(config,new HashMap<String,String>(),new PrintStream(outputStream),DevNullLoggingService.DEV_NULL);
  assertThat("Recovery task should run successfully.",task.run(),is(true));
  assertThat("Database should exist.",new File(storeDirectory).exists(),is(true));
  assertThat("Recovery should not print anything.",outputStream.toString(),is(""));
}
