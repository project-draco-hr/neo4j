{
  FakeClock clock=new FakeClock();
  AuthenticationStrategy authStrategy=new RateLimitedAuthenticationStrategy(clock,3);
  User user=new User("user",Credential.forPassword("right"),false);
  assertThat(authStrategy.authenticate(user,"wrong"),equalTo(AuthenticationResult.FAILURE));
  assertThat(authStrategy.authenticate(user,"wrong"),equalTo(AuthenticationResult.FAILURE));
  assertThat(authStrategy.authenticate(user,"wrong"),equalTo(AuthenticationResult.FAILURE));
  assertThat(authStrategy.authenticate(user,"wrong"),equalTo(AuthenticationResult.TOO_MANY_ATTEMPTS));
  clock.forward(5,TimeUnit.SECONDS);
  assertThat(authStrategy.authenticate(user,"wrong"),equalTo(AuthenticationResult.FAILURE));
}
