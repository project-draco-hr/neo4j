{
  final long propcount=getNodeManager().getNumberOfIdsInUse(PropertyStore.class);
  Node node=getGraphDb().createNode();
  node.setProperty("one",1);
  node.setProperty("two",2);
  node.setProperty("three",3);
  node.setProperty("four",4);
  newTransaction();
  assertEquals("Invalid assumption: property record count",propcount + 1,getNodeManager().getNumberOfIdsInUse(PropertyStore.class));
  assertEquals("Invalid assumption: property record count",propcount + 1,getNodeManager().getNumberOfIdsInUse(PropertyStore.class));
  node.setProperty("final",666);
  newTransaction();
  assertEquals("Invalid assumption: property record count",propcount + 2,getNodeManager().getNumberOfIdsInUse(PropertyStore.class));
  node.delete();
  commit();
  assertEquals("All property records should be freed",propcount,getNodeManager().getNumberOfIdsInUse(PropertyStore.class));
}
