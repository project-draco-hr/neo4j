{
  final long propcount=getIdGenerator(IdType.PROPERTY).getNumberOfIdsInUse();
  Node node=getGraphDb().createNode();
  node.setProperty("one",1);
  node.setProperty("two",2);
  node.setProperty("three",3);
  node.setProperty("four",4);
  newTransaction();
  assertEquals("Invalid assumption: property record count",propcount + 1,getIdGenerator(IdType.PROPERTY).getNumberOfIdsInUse());
  assertEquals("Invalid assumption: property record count",propcount + 1,getIdGenerator(IdType.PROPERTY).getNumberOfIdsInUse());
  node.setProperty("final",666);
  newTransaction();
  assertEquals("Invalid assumption: property record count",propcount + 2,getIdGenerator(IdType.PROPERTY).getNumberOfIdsInUse());
  node.delete();
  commit();
  assertEquals("All property records should be freed",propcount,getIdGenerator(IdType.PROPERTY).getNumberOfIdsInUse());
}
