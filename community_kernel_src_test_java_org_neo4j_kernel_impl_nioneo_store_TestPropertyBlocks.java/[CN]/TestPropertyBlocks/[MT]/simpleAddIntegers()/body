{
  long inUseBefore=propertyRecordsInUse();
  Node node=getGraphDb().createNode();
  for (int i=0; i < PropertyType.getPayloadSizeLongs(); i++) {
    node.setProperty("prop" + i,i);
    assertEquals(inUseBefore + 1,propertyRecordsInUse());
    assertEquals(i,node.getProperty("prop" + i));
  }
  newTransaction();
  for (int i=0; i < PropertyType.getPayloadSizeLongs(); i++) {
    assertEquals(i,node.removeProperty("prop" + i));
    if (i == PropertyType.getPayloadSizeLongs() - 1) {
      assertEquals(inUseBefore,propertyRecordsInUse());
    }
 else {
      assertEquals(inUseBefore + 1,propertyRecordsInUse());
    }
  }
  commit();
}
