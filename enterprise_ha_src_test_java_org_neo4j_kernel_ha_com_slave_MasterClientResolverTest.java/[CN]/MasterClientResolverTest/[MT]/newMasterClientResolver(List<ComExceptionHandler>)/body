{
  MasterClientResolver resolver=new MasterClientResolver(new DevNullLoggingService(),StringLogger.DEV_NULL,mock(ResponseUnpacker.class),mock(ClusterClient.class),mock(ClusterMemberAvailability.class),1,1,1,1024);
  MasterClientResolver resolverSpy=spy(resolver);
  doAnswer(new Answer<Void>(){
    @Override public Void answer(    InvocationOnMock invocation) throws Throwable {
      ComExceptionHandler handler=(ComExceptionHandler)invocation.getArguments()[1];
      comExceptionHandlers.add(handler);
      return null;
    }
  }
).when(resolverSpy).addComExceptionHandler(any(MasterClient.class),any(ComExceptionHandler.class));
  return resolverSpy;
}
