{
  MasterClientResolver resolver=new MasterClientResolver(new DevNullLoggingService(),ResponseUnpacker.NO_OP_RESPONSE_UNPACKER,mock(InvalidEpochExceptionHandler.class),1,1,1,1024);
  LifeSupport life=new LifeSupport();
  try {
    life.start();
    MasterClient masterClient1=resolver.instantiate("cluster://localhost",44,new Monitors(),StoreId.DEFAULT,life);
    assertThat(masterClient1,instanceOf(MasterClient214.class));
  }
  finally {
    life.shutdown();
  }
  IllegalProtocolVersionException illegalProtocolVersionException=new IllegalProtocolVersionException(MasterClient210.PROTOCOL_VERSION.getApplicationProtocol(),MasterClient214.PROTOCOL_VERSION.getApplicationProtocol(),"Protocol is too modern");
  resolver.handle(illegalProtocolVersionException);
  life=new LifeSupport();
  try {
    life.start();
    MasterClient masterClient2=resolver.instantiate("cluster://localhost",55,new Monitors(),StoreId.DEFAULT,life);
    assertThat(masterClient2,instanceOf(MasterClient210.class));
  }
  finally {
    life.shutdown();
  }
}
