{
  MasterClientResolver resolver=new MasterClientResolver(new DevNullLoggingService(),mock(ResponseUnpacker.class),1,1,1,1024);
  LifeSupport life=new LifeSupport();
  try {
    life.start();
    MasterClient masterClient1=resolver.instantiate("cluster://localhost",44,new Monitors(),StoreId.DEFAULT,life);
    assertThat(masterClient1,instanceOf(MasterClient214.class));
  }
  finally {
    life.shutdown();
  }
  resolver.versionMismatched(PROTOCOL_VERSION.getApplicationProtocol(),INTERNAL_PROTOCOL_VERSION);
  life=new LifeSupport();
  try {
    life.start();
    MasterClient masterClient2=resolver.instantiate("cluster://localhost",55,new Monitors(),StoreId.DEFAULT,life);
    assertThat(masterClient2,instanceOf(MasterClient210.class));
  }
  finally {
    life.shutdown();
  }
}
