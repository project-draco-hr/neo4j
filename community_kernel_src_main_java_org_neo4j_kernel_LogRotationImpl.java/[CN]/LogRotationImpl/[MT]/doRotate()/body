{
  long currentVersion=logFile.currentLogVersion();
  monitor.startedRotating(currentVersion);
  kernelHealth.assertHealthy(IOException.class);
  msgLog.info(PrintFormat.prefix(currentVersion) + " Awaiting all transactions closed...");
  logRotationControl.awaitAllTransactionsClosed();
  msgLog.info(PrintFormat.prefix(currentVersion) + " Starting store flush...");
  logRotationControl.forceEverything();
  kernelHealth.assertHealthy(IOException.class);
  msgLog.info(PrintFormat.prefix(currentVersion) + " Preparing new log file...");
  logFile.rotate();
  monitor.finishedRotating(currentVersion);
}
