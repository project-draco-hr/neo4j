{
  Transaction tx=database.beginTx();
  final int count=1000;
  for (int i=0; i < count; i++) {
    Node node=database.createNode();
    node.setProperty("foo",0);
  }
  tx.success();
  tx.finish();
  ExecutorService executor=Executors.newFixedThreadPool(1);
  final AtomicBoolean done=new AtomicBoolean(false);
  executor.submit(new DataChecker2(count,done,database){
    @Override protected int getNodeValue(    int i){
      Node node=database.getNodeById(i + 1);
      this.tx.acquireReadLock(node);
      return (Integer)node.getProperty("foo");
    }
  }
);
  new DataChanger(database,count,done).call();
}
