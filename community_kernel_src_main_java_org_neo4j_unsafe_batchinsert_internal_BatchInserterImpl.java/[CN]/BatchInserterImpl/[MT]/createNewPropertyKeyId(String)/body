{
  int keyId=(int)propertyKeyTokenStore.nextId();
  PropertyKeyTokenRecord record=new PropertyKeyTokenRecord(keyId);
  record.setInUse(true);
  record.setCreated();
  Collection<DynamicRecord> keyRecords=propertyKeyTokenStore.allocateNameRecords(encodeString(stringKey));
  record.setNameId((int)Iterables.first(keyRecords).getId());
  record.addNameRecords(keyRecords);
  propertyKeyTokenStore.updateRecord(record);
  propertyKeyTokens.addToken(new Token(stringKey,keyId));
  return keyId;
}
