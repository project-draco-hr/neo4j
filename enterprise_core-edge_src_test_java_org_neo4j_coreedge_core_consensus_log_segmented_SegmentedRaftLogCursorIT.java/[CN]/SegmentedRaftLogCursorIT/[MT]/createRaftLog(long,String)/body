{
  if (fileSystem == null) {
    fileSystem=new EphemeralFileSystemAbstraction();
  }
  File directory=new File(PHYSICAL_LOG_DIRECTORY_NAME);
  fileSystem.mkdir(directory);
  SegmentedRaftLog newRaftLog=new SegmentedRaftLog(fileSystem,directory,rotateAtSize,new DummyRaftableContentSerializer(),NullLogProvider.getInstance(),pruneStrategy,8,Clock.systemUTC(),new OnDemandJobScheduler());
  life.add(newRaftLog);
  life.init();
  life.start();
  return newRaftLog;
}
