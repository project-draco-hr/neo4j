{
  File source=new File(sourceFile);
  try {
    File target=File.createTempFile(getClass().getSimpleName(),".jar");
    JarOutputStream stream=new JarOutputStream(new FileOutputStream(target),manifest);
    try {
      if (source.isFile()) {
        try {
          copy(new JarFile(source),stream);
        }
 catch (        IOException e) {
          throw new IllegalArgumentException(String.format("Cannot open source file (%s) for reading.",source),e);
        }
      }
 else {
        create("",source,stream);
      }
    }
  finally {
      stream.close();
    }
    return target.getAbsolutePath();
  }
 catch (  IOException e) {
    throw new IllegalStateException("Cannot create target file.",e);
  }
}
