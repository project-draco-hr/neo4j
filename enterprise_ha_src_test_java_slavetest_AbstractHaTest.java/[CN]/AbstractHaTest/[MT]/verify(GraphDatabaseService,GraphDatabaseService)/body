{
  if (!shouldDoVerificationAfterTests()) {
    return;
  }
  for (  GraphDatabaseService otherDb : dbs) {
    int vNodeCount=0;
    int vRelCount=0;
    int vNodePropCount=0;
    int vRelPropCount=0;
    int vNodeIndexServicePropCount=0;
    int vNodeIndexProviderPropCount=0;
    Set<Node> otherNodes=IteratorUtil.addToCollection(otherDb.getAllNodes().iterator(),new HashSet<Node>());
    for (    Node node : refDb.getAllNodes()) {
      Node otherNode=otherDb.getNodeById(node.getId());
      int[] counts=verifyNode(node,otherNode,refDb,otherDb);
      vRelCount+=counts[0];
      vNodePropCount+=counts[1];
      vRelPropCount+=counts[2];
      vNodeIndexServicePropCount+=counts[3];
      vNodeIndexProviderPropCount+=counts[4];
      otherNodes.remove(otherNode);
      vNodeCount++;
    }
    assertTrue(otherNodes.isEmpty());
    if (expectsResults) {
      assertEquals(nodeCount,vNodeCount);
      assertEquals(relCount,vRelCount);
      assertEquals(nodePropCount,vNodePropCount);
      assertEquals(relPropCount,vRelPropCount);
      assertEquals(nodeIndexProviderPropCount,vNodeIndexProviderPropCount);
    }
  }
}
