{
  if (!configuration.get(ServerSettings.authorization_enabled) || security.userForToken(extractToken(auth)).privileges().APIAccess()) {
    String webAdminManagementUri=configuration.get(ServerInternalSettings.management_api_path).getPath();
    String dataUri=configuration.get(ServerInternalSettings.rest_api_path).getPath();
    return outputFormat.ok(new DiscoveryRepresentation(webAdminManagementUri,dataUri));
  }
 else {
    return outputFormat.ok(new AccessDeniedDiscoveryRepresentation(AuthenticationService.AUTHENTICATION_PATH));
  }
}
