{
  assertHealthy();
  if (filePageSize > cachePageSize) {
    throw new IllegalArgumentException("Cannot map files with a filePageSize (" + filePageSize + ") that is greater than the cachePageSize ("+ cachePageSize+ ")");
  }
  FileMapping current=mappedFiles;
  while (current != null) {
    if (current.file.equals(file)) {
      MuninnPagedFile pagedFile=current.pagedFile;
      pagedFile.incrementReferences();
      return pagedFile;
    }
    current=current.next;
  }
  MuninnPagedFile pagedFile=new MuninnPagedFile(file,this,filePageSize,swapperFactory,freelist,monitor);
  current=new FileMapping(file,pagedFile);
  current.next=mappedFiles;
  mappedFiles=current;
  return pagedFile;
}
