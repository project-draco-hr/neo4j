{
  String path="/" + clusterName;
  try {
    try {
      zooKeeper.create(path,storeIdSuggestion.serialize(),ZooDefs.Ids.OPEN_ACL_UNSAFE,CreateMode.PERSISTENT);
      return storeIdSuggestion;
    }
 catch (    KeeperException e) {
      if (e.code() == KeeperException.Code.NODEEXISTS) {
        try {
          return StoreId.deserialize(zooKeeper.getData(path,false,null));
        }
 catch (        KeeperException ex) {
          throw new ZooKeeperException("Unable to read cluster store id",ex);
        }
      }
 else {
        throw new ZooKeeperException("Unable to write cluster store id",e);
      }
    }
  }
 catch (  InterruptedException e) {
    throw new ZooKeeperException("createCluster interrupted",e);
  }
}
