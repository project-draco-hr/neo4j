{
  String indexName="bobTheIndex";
  String key="Name";
  long node1=helper.createNode();
  long node2=helper.createNode();
  helper.addNodeToIndex(indexName,key,"Builder2",node1);
  helper.addNodeToIndex(indexName,"Gender","Male",node1);
  helper.addNodeToIndex(indexName,key,"Builder",node2);
  helper.addNodeToIndex(indexName,"Gender","Male",node2);
  String entity=gen.get().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=Name:Build~0.1%20AND%20Gender:Male&order=relevance").entity();
  Collection<?> hits=(Collection<?>)JsonHelper.jsonToSingleValue(entity);
  assertEquals(2,hits.size());
  Iterator it=hits.iterator();
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node2)));
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node1)));
  entity=gen.get().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=Name:Build~0.1%20AND%20Gender:Male&order=index").entity();
  hits=(Collection<?>)JsonHelper.jsonToSingleValue(entity);
  assertEquals(2,hits.size());
  it=hits.iterator();
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node1)));
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node2)));
  entity=gen.get().expectedStatus(200).get(functionalTestHelper.indexNodeUri(indexName) + "?query=Name:Build~0.1%20AND%20Gender:Male&order=score").entity();
  hits=(Collection<?>)JsonHelper.jsonToSingleValue(entity);
  assertEquals(2,hits.size());
  it=hits.iterator();
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node2)));
  assertTrue(((String)((LinkedHashMap)it.next()).get("self")).endsWith(Long.toString(node1)));
}
