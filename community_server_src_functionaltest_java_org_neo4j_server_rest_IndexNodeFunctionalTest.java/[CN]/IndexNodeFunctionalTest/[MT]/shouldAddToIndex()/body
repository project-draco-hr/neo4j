{
  String indexName="favorites";
  String key="key";
  String value="the value";
  value=URIHelper.encode(value);
  int nodeId=0;
  gen.get().expectedStatus(201).payload(JsonHelper.createJsonFrom(functionalTestHelper.nodeUri(nodeId))).post(functionalTestHelper.indexNodeUri(indexName,key,value));
  ClientResponse response=Client.create().resource(functionalTestHelper.indexNodeUri(indexName,key,value)).accept(MediaType.APPLICATION_JSON_TYPE).get(ClientResponse.class);
  String entity=response.getEntity(String.class);
  Collection<?> hits=(Collection<?>)JsonHelper.jsonToSingleValue(entity);
  assertEquals(1,hits.size());
}
