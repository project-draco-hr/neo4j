{
  ConsistencySummaryStatistics summary=new ConsistencySummaryStatistics();
  ConsistencyReporter reporter=new ConsistencyReporter(new DirectDiffRecordAccess(diffs),new InconsistencyReport(new InconsistencyMessageLogger(logger),summary));
  StoreProcessor processor=new StoreProcessor(reporter);
  diffs.applyToAll(processor);
  if (diffs.getSchemaStore().hasChanges()) {
    if (0 == summary.getInconsistencyCountForRecordType(RecordType.SCHEMA)) {
      performFullCheckOfSchemaStore(diffs,reporter);
    }
  }
  return summary;
}
