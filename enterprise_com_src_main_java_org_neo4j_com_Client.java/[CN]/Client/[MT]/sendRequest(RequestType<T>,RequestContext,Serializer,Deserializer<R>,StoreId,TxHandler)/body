{
  ChannelContext channelContext=acquireChannelContext(type);
  Throwable failure=null;
  try {
    requestMonitor.beginRequest(channelContext.channel().getRemoteAddress(),type,context);
    protocol.serializeRequest(channelContext.channel(),channelContext.output(),type,context,serializer);
    Response<R> response=protocol.deserializeResponse(extractBlockingReadHandler(channelContext),channelContext.input(),getReadTimeout(type,readTimeout),deserializer,resourcePoolReleaser);
    if (type.responseShouldBeUnpacked()) {
      responseUnpacker.unpackResponse(response,txHandler);
    }
    if (shouldCheckStoreId(type)) {
      if (specificStoreId != null) {
        assertCorrectStoreId(response.getStoreId(),specificStoreId);
      }
 else {
        assertCorrectStoreId(response.getStoreId(),storeId);
      }
    }
    return response;
  }
 catch (  ComException e) {
    failure=e;
    comExceptionHandler.handle(e);
    throw e;
  }
catch (  Throwable e) {
    failure=e;
    throw Exceptions.launderedException(ComException.class,e);
  }
 finally {
    if (failure != null) {
      dispose(channelContext);
    }
    if (requestMonitor != null) {
      requestMonitor.endRequest(failure);
    }
  }
}
