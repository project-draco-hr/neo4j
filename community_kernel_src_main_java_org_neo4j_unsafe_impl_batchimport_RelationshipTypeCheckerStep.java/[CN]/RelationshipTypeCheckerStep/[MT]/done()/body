{
  sortedTypes=allTypes.entrySet().toArray(new Map.Entry[allTypes.size()]);
  if (sortedTypes.length > 0) {
    Comparator<Map.Entry<Object,AtomicLong>> comparator=sortedTypes[0].getKey() instanceof Integer ? SORT_BY_ID_DESC : SORT_BY_COUNT_DESC;
    Arrays.sort(sortedTypes,comparator);
  }
  for (int i=sortedTypes.length - 1; i >= 0; i--) {
    typeTokenRepository.getOrCreateId(sortedTypes[i].getKey());
  }
  super.done();
}
