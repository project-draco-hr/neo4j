{
  for (  InputRelationship relationship : batch.input) {
    Object type=relationship.typeAsObject();
    AtomicLong count=allTypes.get(type);
    if (count == null) {
      AtomicLong existing=allTypes.putIfAbsent(type,count=new AtomicLong());
      count=existing != null ? existing : count;
    }
    count.incrementAndGet();
  }
  sender.send(batch);
}
