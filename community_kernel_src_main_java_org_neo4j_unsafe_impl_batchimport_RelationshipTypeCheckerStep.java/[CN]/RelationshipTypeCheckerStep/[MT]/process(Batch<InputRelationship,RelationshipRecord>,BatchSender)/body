{
  for (  InputRelationship relationship : batch.input) {
    Object type=relationship.typeAsObject();
    AtomicLong count=allTypes.get(type);
    if (count == null) {
synchronized (allTypes) {
        if ((count=allTypes.get(type)) == null) {
          allTypes.put(type,count=new AtomicLong());
        }
      }
    }
    count.incrementAndGet();
  }
  totalCount+=batch.input.length;
  sender.send(batch);
}
