{
  BatchingRelationshipTypeTokenRepository repository=mock(BatchingRelationshipTypeTokenRepository.class);
  RelationshipTypeCheckerStep step=new RelationshipTypeCheckerStep(mock(StageControl.class),DEFAULT,repository);
  Batch<InputRelationship,RelationshipRecord> relationships=batchOfRelationshipsWithRandomTypes(10,true);
  step.process(relationships,mock(BatchSender.class));
  step.done();
  TreeSet<Integer> expected=idsOf(relationships);
  Object[] processed=step.getRelationshipTypes(100);
  int i=0;
  for (  Object expectedType : loop(expected.descendingIterator())) {
    assertEquals(expectedType,processed[i++]);
  }
}
