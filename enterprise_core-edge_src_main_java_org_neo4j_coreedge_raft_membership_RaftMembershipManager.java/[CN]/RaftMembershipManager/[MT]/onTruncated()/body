{
  Long logIndex=findLastMembershipEntry();
  if (logIndex != null) {
    RaftGroup<MEMBER> lastMembershipEntry=(RaftGroup<MEMBER>)entryLog.readEntryContent(logIndex);
    raftMembershipState.setVotingMembers(lastMembershipEntry.getMembers());
    raftMembershipState.logIndex(logIndex);
    try {
      stateStorage.persistStoreData(raftMembershipState);
    }
 catch (    IOException e) {
      throw new RaftStorageException(e);
    }
  }
 else {
    raftMembershipState.setVotingMembers(Collections.<MEMBER>emptySet());
  }
  uncommittedMemberChanges=0;
  for (long i=entryLog.commitIndex() + 1; i <= entryLog.appendIndex(); i++) {
    ReplicatedContent content=entryLog.readEntryContent(i);
    if (content instanceof RaftGroup) {
      uncommittedMemberChanges++;
    }
  }
}
