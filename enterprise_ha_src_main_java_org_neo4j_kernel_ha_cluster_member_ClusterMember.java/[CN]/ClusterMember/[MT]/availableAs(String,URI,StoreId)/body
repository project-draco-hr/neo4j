{
  Map<String,URI> copy=new HashMap<>(roles);
  if (role.equals(HighAvailabilityModeSwitcher.MASTER)) {
    copy.remove(HighAvailabilityModeSwitcher.SLAVE);
  }
 else   if (role.equals(HighAvailabilityModeSwitcher.SLAVE)) {
    copy.remove(HighAvailabilityModeSwitcher.MASTER);
    copy.remove(OnlineBackupKernelExtension.BACKUP);
  }
  copy.put(role,roleUri);
  return new ClusterMember(this.instanceId,copy,storeId,this.alive);
}
