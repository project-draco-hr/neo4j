{
  IdBlock block=direction.getBlock(this);
  if (block == null || !block.accepts(id)) {
    IdBlock newBlock=null;
    if (block == null && LowIdBlock.idIsLow(id)) {
      newBlock=new LowIdBlock();
    }
 else {
      newBlock=block != null ? block.upgradeToHighIdBlock() : new HighIdBlock();
    }
    direction.setBlock(this,newBlock);
    block=newBlock;
  }
  block.add(id);
}
