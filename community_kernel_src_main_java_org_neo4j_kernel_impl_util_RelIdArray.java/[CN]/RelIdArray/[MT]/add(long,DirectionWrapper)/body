{
  IdBlock lastBlock=direction.lastBlock(this);
  long highBits=id & 0xFFFFFFFF00000000L;
  if (lastBlock == null || lastBlock.getHighBits() != highBits) {
    IdBlock newLastBlock=highBits == 0 ? new LowIdBlock(direction) : new HighIdBlock(direction,highBits);
    newLastBlock.prev=lastBlock;
    direction.assignTopLevelBlock(this,newLastBlock);
    lastBlock=newLastBlock;
  }
  lastBlock.add((int)id);
}
