{
  IdBlock toBlock=direction.getLastBlock(this);
  IdBlock fromBlock=direction.getLastBlock(source);
  if (fromBlock != null) {
    if (toBlock == null) {
      direction.setLastBlock(this,fromBlock.copy());
    }
 else     if (toBlock.getHighBits() == fromBlock.getHighBits()) {
      toBlock.addAll(fromBlock);
      if (fromBlock.getPrev() != null) {
        boolean isTheOnlyOne=toBlock.getPrev() == null;
        IdBlock last=last(toBlock);
        last.setPrev(fromBlock.getPrev().copy());
        if (isTheOnlyOne) {
          direction.setLastBlock(this,last);
        }
      }
    }
 else {
      boolean isTheOnlyOne=toBlock.getPrev() == null;
      IdBlock last=last(toBlock);
      last.setPrev(fromBlock.copy());
      if (isTheOnlyOne) {
        direction.setLastBlock(this,last);
      }
    }
  }
}
