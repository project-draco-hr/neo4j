{
  super(params);
  caching=new Cache();
  String storeDir=(String)params.get("store_dir");
  this.baseStorePath=getStoreDir(storeDir);
  cleanWriteLocks(baseStorePath);
  this.indexStore=new IndexStore(storeDir);
  this.store=newIndexStore(storeDir);
  this.typeCache=new IndexTypeCache();
  boolean isReadOnly=params.containsKey("read_only") ? (Boolean)params.get("read_only") : false;
  if (!isReadOnly) {
    XaCommandFactory cf=new LuceneCommandFactory();
    XaTransactionFactory tf=new LuceneTransactionFactory(store);
    xaContainer=XaContainer.create(this.baseStorePath + "/lucene.log",cf,tf,params);
    try {
      xaContainer.openLogicalLog();
    }
 catch (    IOException e) {
      throw new RuntimeException("Unable to open lucene log in " + this.baseStorePath,e);
    }
    xaContainer.getLogicalLog().setKeepLogs(shouldKeepLog((String)params.get("keep_logical_logs"),DEFAULT_NAME));
    setLogicalLogAtCreationTime(xaContainer.getLogicalLog());
  }
 else {
    xaContainer=null;
  }
}
