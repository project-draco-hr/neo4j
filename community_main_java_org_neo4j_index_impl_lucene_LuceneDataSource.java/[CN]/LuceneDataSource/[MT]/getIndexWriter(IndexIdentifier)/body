{
  try {
    Directory dir=getDirectory(baseStorePath,identifier);
    directoryExists(dir);
    IndexType type=getType(identifier);
    IndexWriter writer=new IndexWriter(dir,type.analyzer,MaxFieldLength.UNLIMITED);
    return writer;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
