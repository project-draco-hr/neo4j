{
  ReplicatedIdAllocationStateMachine idAllocationStateMachine=new ReplicatedIdAllocationStateMachine(me,new InMemoryIdAllocationState());
  idAllocationStateMachine.onReplicated(new ReplicatedIdAllocationRequest(me,someType,0,1024),0);
  idAllocationStateMachine.onReplicated(new ReplicatedIdAllocationRequest(me,someType,0,1024),0);
  idAllocationStateMachine.onReplicated(new ReplicatedIdAllocationRequest(me,someType,0,1024),0);
  assertEquals(1024,idAllocationStateMachine.getFirstNotAllocated(someType));
}
