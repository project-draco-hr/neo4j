{
  IdAllocationState idAllocationState=new InMemoryIdAllocationStateStore();
  ReplicatedIdAllocationStateMachine firstIdAllocationStateMachine=new ReplicatedIdAllocationStateMachine(me,idAllocationState);
  firstIdAllocationStateMachine.onReplicated(new ReplicatedIdAllocationRequest(me,someType,0,1024),0);
  firstIdAllocationStateMachine.onReplicated(new ReplicatedIdAllocationRequest(me,someType,1024,1024),1);
  ReplicatedIdAllocationStateMachine secondIdAllocationStateMachine=new ReplicatedIdAllocationStateMachine(me,idAllocationState);
  assertEquals(firstIdAllocationStateMachine.getHighestIdRange(me,someType),secondIdAllocationStateMachine.getHighestIdRange(me,someType));
  assertEquals(firstIdAllocationStateMachine.getFirstNotAllocated(someType),secondIdAllocationStateMachine.getFirstNotAllocated(someType));
}
