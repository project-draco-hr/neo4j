{
  IdAllocationState idAllocationState=new IdAllocationState();
  ReplicatedIdAllocationStateMachine firstIdAllocationStateMachine=new ReplicatedIdAllocationStateMachine(me,new InMemoryStateStorage<>(idAllocationState),NullLogProvider.getInstance());
  firstIdAllocationStateMachine.applyCommand(new ReplicatedIdAllocationRequest(me,someType,0,1024),0);
  firstIdAllocationStateMachine.applyCommand(new ReplicatedIdAllocationRequest(me,someType,1024,1024),1);
  ReplicatedIdAllocationStateMachine secondIdAllocationStateMachine=new ReplicatedIdAllocationStateMachine(me,new InMemoryStateStorage<>(idAllocationState),NullLogProvider.getInstance());
  assertEquals(firstIdAllocationStateMachine.getHighestIdRange(me,someType),secondIdAllocationStateMachine.getHighestIdRange(me,someType));
  assertEquals(firstIdAllocationStateMachine.getFirstNotAllocated(someType),secondIdAllocationStateMachine.getFirstNotAllocated(someType));
  assertEquals(firstIdAllocationStateMachine.getFirstNotAllocated(someType),secondIdAllocationStateMachine.getFirstNotAllocated(someType));
}
