{
  JndiLdapContextFactory contextFactory=new JndiLdapContextFactory();
  contextFactory.setUrl("ldap://" + config.get(SecuritySettings.ldap_server));
  contextFactory.setAuthenticationMechanism(config.get(SecuritySettings.ldap_auth_mechanism));
  contextFactory.setReferral(config.get(SecuritySettings.ldap_referral));
  contextFactory.setSystemUsername(config.get(SecuritySettings.ldap_system_username));
  contextFactory.setSystemPassword(config.get(SecuritySettings.ldap_system_password));
  setContextFactory(contextFactory);
  setUserDnTemplate(config.get(SecuritySettings.ldap_user_dn_template));
  authenticationEnabled=config.get(SecuritySettings.ldap_authentication_enabled);
  authorizationEnabled=config.get(SecuritySettings.ldap_authorization_enabled);
}
