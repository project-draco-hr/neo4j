{
  if (authenticationEnabled) {
    String serverString=server((JndiLdapContextFactory)ldapContextFactory);
    try {
      AuthenticationInfo info=useStartTls ? queryForAuthenticationInfoUsingStartTls(token,ldapContextFactory) : super.queryForAuthenticationInfo(token,ldapContextFactory);
      securityLog.debug(withRealm("Authenticated user '%s' against %s",token.getPrincipal(),serverString));
      return info;
    }
 catch (    Exception e) {
      securityLog.error(withRealm("Failed to authenticate user '%s' against %s: %s",token.getPrincipal(),serverString,e.getMessage()));
      throw e;
    }
  }
 else {
    return null;
  }
}
