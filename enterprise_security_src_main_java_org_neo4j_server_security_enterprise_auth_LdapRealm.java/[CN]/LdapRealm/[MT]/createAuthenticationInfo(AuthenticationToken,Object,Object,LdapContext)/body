{
  log.debug("Successfully authenticated user '%s' through LDAP",token.getPrincipal());
  if (authorizationEnabled && !useSystemAccountForAuthorization) {
    String username=(String)token.getPrincipal();
    Set<String> roleNames=findRoleNamesForUser(username,ldapContext);
    cacheAuthorizationInfo(username,roleNames);
  }
  return new ShiroAuthenticationInfo(token.getPrincipal(),token.getCredentials(),getName(),AuthenticationResult.SUCCESS);
}
