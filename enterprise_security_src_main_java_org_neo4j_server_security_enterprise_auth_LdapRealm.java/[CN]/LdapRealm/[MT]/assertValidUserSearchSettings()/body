{
  boolean proceedWithSearch=true;
  if (userSearchBase == null || userSearchBase.isEmpty()) {
    securityLog.error("LDAP user search base is empty.");
    proceedWithSearch=false;
  }
  if (userSearchFilter == null || !userSearchFilter.contains("{0}")) {
    securityLog.warn("LDAP user search filter does not contain the argument placeholder {0}, " + "so the search result will be independent of the user principal.");
  }
  if (membershipAttributeNames == null || membershipAttributeNames.isEmpty()) {
    securityLog.error("LDAP group membership attribute names are empty. Authorization will not be possible.");
    proceedWithSearch=false;
  }
  if (!proceedWithSearch) {
    throw new IllegalArgumentException("Illegal LDAP user search settings, see security log for details.");
  }
}
