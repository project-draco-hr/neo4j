{
  Map<String,Collection<String>> map=new HashMap<>();
  if (groupToRoleMappingString != null) {
    for (    String groupAndRoles : groupToRoleMappingString.split(GROUP_DELIMITER)) {
      if (!groupAndRoles.isEmpty()) {
        String[] parts=groupAndRoles.split(KEY_VALUE_DELIMITER,2);
        if (parts.length != 2) {
          String errorMessage=String.format("Failed to parse setting %s: wrong number of fields",SecuritySettings.ldap_authorization_group_to_role_mapping.name());
          log.error(errorMessage);
          throw new IllegalArgumentException(errorMessage);
        }
        String group=parts[0];
        if (group.isEmpty()) {
          String errorMessage=String.format("Failed to parse setting %s: empty group name",SecuritySettings.ldap_authorization_group_to_role_mapping.name());
          log.error(errorMessage);
          throw new IllegalArgumentException(errorMessage);
        }
        Collection<String> roleList=new ArrayList<>();
        for (        String role : parts[1].split(ROLE_DELIMITER)) {
          if (!role.isEmpty()) {
            roleList.add(role);
          }
        }
        map.put(group,roleList);
      }
    }
  }
  return map;
}
