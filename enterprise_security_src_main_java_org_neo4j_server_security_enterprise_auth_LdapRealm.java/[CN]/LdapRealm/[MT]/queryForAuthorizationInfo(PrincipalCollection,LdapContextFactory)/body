{
  if (authorizationEnabled && useSystemAccountForAuthorization) {
    String username=(String)getAvailablePrincipal(principals);
    LdapContext ldapContext=ldapContextFactory.getSystemLdapContext();
    Set<String> roleNames;
    try {
      roleNames=findRoleNamesForUser(username,ldapContext);
    }
  finally {
      LdapUtils.closeContext(ldapContext);
    }
    return new SimpleAuthorizationInfo(roleNames);
  }
  return null;
}
