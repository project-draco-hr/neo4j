{
  if (authorizationEnabled) {
    String username=(String)getAvailablePrincipal(principals);
    if (useSystemAccountForAuthorization) {
      LdapContext ldapContext=useStartTls ? getSystemLdapContextUsingStartTls(ldapContextFactory) : ldapContextFactory.getSystemLdapContext();
      Set<String> roleNames;
      try {
        roleNames=findRoleNamesForUser(username,ldapContext);
      }
  finally {
        LdapUtils.closeContext(ldapContext);
      }
      return new SimpleAuthorizationInfo(roleNames);
    }
 else {
      AuthorizationInfo authorizationInfo=authorizationInfoCache.get(username);
      if (authorizationInfo == null) {
      }
      return authorizationInfo;
    }
  }
  return null;
}
