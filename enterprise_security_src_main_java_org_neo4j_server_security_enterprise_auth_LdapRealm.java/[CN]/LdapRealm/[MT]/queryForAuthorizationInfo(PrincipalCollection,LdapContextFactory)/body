{
  if (authorizationEnabled) {
    String username=(String)getAvailablePrincipal(principals);
    if (useSystemAccountForAuthorization) {
      LdapContext ldapContext=ldapContextFactory.getSystemLdapContext();
      Set<String> roleNames;
      try {
        roleNames=findRoleNamesForUser(username,ldapContext);
      }
  finally {
        LdapUtils.closeContext(ldapContext);
      }
      return new SimpleAuthorizationInfo(roleNames);
    }
 else {
      return authorizationInfoCache.get(username);
    }
  }
  return null;
}
