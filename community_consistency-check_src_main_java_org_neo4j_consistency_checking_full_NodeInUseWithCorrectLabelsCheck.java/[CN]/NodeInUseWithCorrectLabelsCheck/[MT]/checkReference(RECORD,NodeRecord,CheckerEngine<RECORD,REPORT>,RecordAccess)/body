{
  if (nodeRecord.inUse()) {
    NodeLabels nodeLabels=NodeLabelsField.parseLabelsField(nodeRecord);
    if (nodeLabels instanceof DynamicNodeLabels) {
      DynamicNodeLabels dynamicNodeLabels=(DynamicNodeLabels)nodeLabels;
      long firstRecordId=dynamicNodeLabels.getFirstDynamicRecordId();
      RecordReference<DynamicRecord> firstRecordReference=records.nodeLabels(firstRecordId);
      ExpectedNodeLabelsChecker expectedNodeLabelsChecker=new ExpectedNodeLabelsChecker(nodeRecord);
      LabelChainWalker<RECORD,REPORT> checker=new LabelChainWalker<>(expectedNodeLabelsChecker);
      engine.comparativeCheck(firstRecordReference,checker);
      nodeRecord.getDynamicLabelRecords();
    }
 else {
      long[] actualLabels=nodeLabels.get(null);
      REPORT report=engine.report();
      validateLabelIds(nodeRecord,actualLabels,report);
    }
  }
 else {
    engine.report().nodeNotInUse(nodeRecord);
  }
}
