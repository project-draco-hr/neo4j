{
  if (user.credentials().matchesPassword(password)) {
    throw new IllegalCredentialsException("Old password and new password cannot be the same.");
  }
  authManager.setPassword(this,user.name(),password);
}
