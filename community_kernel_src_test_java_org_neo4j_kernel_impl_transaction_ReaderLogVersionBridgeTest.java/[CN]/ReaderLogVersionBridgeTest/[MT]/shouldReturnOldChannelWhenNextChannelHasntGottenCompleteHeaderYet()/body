{
  final ReaderLogVersionBridge bridge=new ReaderLogVersionBridge(fs,logFiles);
  final StoreChannel nextVersionWithIncompleteHeader=mock(StoreChannel.class);
  when(nextVersionWithIncompleteHeader.read(any(ByteBuffer.class))).thenReturn(LOG_HEADER_SIZE / 2);
  when(channel.getVersion()).thenReturn(version);
  when(fs.fileExists(file)).thenReturn(true);
  when(logFiles.getLogFileForVersion(version + 1)).thenReturn(file);
  when(fs.open(file,"r")).thenReturn(nextVersionWithIncompleteHeader);
  final LogVersionedStoreChannel result=bridge.next(channel);
  assertEquals(channel,result);
  verify(channel,never()).close();
}
