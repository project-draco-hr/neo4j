{
  this.db=db;
  this.indexService=db instanceof HighlyAvailableGraphDatabase ? ((HighlyAvailableGraphDatabase)db).getIndexService() : new LuceneIndexService(db);
  this.indexProvider=db instanceof HighlyAvailableGraphDatabase ? ((HighlyAvailableGraphDatabase)db).getIndexProvider() : new LuceneIndexProvider(db);
}
