{
  if (log == null) {
    throw new IllegalArgumentException("log cannot be null");
  }
  Map<String,String> settings=calculateSettings(homeDir,configFile,log,configOverrides);
  Config config=new Config(settings,settingsClasses.calculate(settings));
  config.setLogger(log);
  return config;
}
