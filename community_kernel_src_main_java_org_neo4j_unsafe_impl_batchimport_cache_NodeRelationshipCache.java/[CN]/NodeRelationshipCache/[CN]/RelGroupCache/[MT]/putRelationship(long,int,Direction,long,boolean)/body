{
  long currentIndex=relGroupIndex;
  long previousIndex=EMPTY;
  while (currentIndex != EMPTY) {
    long foundType=NextFieldManipulator.getType(getField(currentIndex,INDEX_NEXT_AND_TYPE));
    if (foundType == type) {
      return putRelField(currentIndex,direction,relId,trueForIncrement);
    }
 else     if (foundType > type) {
      break;
    }
    previousIndex=currentIndex;
    currentIndex=NextFieldManipulator.getNext(getField(currentIndex,INDEX_NEXT_AND_TYPE));
  }
  long newIndex=nextFreeId();
  if (previousIndex == EMPTY) {
    array.swap(index(currentIndex,0),index(newIndex,0),ENTRY_SIZE);
    long swap=newIndex;
    newIndex=currentIndex;
    currentIndex=swap;
  }
  initializeGroup(newIndex,type);
  if (currentIndex != EMPTY) {
    setNextField(newIndex,currentIndex);
  }
  if (previousIndex != EMPTY) {
    setNextField(previousIndex,newIndex);
  }
  return putRelField(newIndex,direction,relId,trueForIncrement);
}
