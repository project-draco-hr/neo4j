{
  long currentIndex=relGroupIndex;
  long previousIndex=EMPTY;
  while (currentIndex != EMPTY) {
    long currentIndexRebased=rebase(currentIndex);
    ByteArray array=this.array.at(currentIndexRebased);
    long foundType=array.getShort(currentIndexRebased,TYPE_OFFSET);
    if (foundType == type) {
      return putRelField(array,currentIndex,direction,relId,trueForIncrement);
    }
 else     if (foundType > type) {
      break;
    }
    previousIndex=currentIndex;
    currentIndex=all48Bits(array,currentIndexRebased,NEXT_OFFSET);
  }
  long newIndex=nextFreeId();
  if (previousIndex == EMPTY) {
    array.swap(rebase(currentIndex),rebase(newIndex),1);
    long swap=newIndex;
    newIndex=currentIndex;
    currentIndex=swap;
  }
  ByteArray array=this.array.at(rebase(newIndex));
  initializeGroup(array,newIndex,type);
  if (currentIndex != EMPTY) {
    setNextField(array,newIndex,currentIndex);
  }
  if (previousIndex != EMPTY) {
    setNextField(this.array,previousIndex,newIndex);
  }
  return putRelField(array,newIndex,direction,relId,trueForIncrement);
}
