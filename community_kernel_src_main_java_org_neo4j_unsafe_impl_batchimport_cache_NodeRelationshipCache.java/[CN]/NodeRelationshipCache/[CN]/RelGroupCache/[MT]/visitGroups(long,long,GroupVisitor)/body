{
  long currentIndex=relGroupIndex;
  long first=-1;
  while (currentIndex != EMPTY) {
    long index=rebase(currentIndex);
    ByteArray array=this.array.at(index);
    int type=array.getShort(index,TYPE_OFFSET);
    long out=all48Bits(array,index,directionOffset(Direction.OUTGOING));
    long in=all48Bits(array,index,directionOffset(Direction.INCOMING));
    long loop=all48Bits(array,index,directionOffset(Direction.BOTH));
    long next=all48Bits(array,index,NEXT_OFFSET);
    long id=visitor.visit(nodeId,type,next,out,in,loop);
    if (first == -1) {
      first=id;
    }
    currentIndex=next;
  }
  return first;
}
