{
  long index=rebase(relGroupIndex);
  ByteArray array=this.array.at(index);
  int directionOffset=directionOffset(direction);
  long previousId;
  if (clear) {
    clearRelationships(array,index);
    previousId=EMPTY;
  }
 else {
    previousId=all48Bits(array,index,directionOffset);
  }
  array.set6ByteLong(index,directionOffset,relId);
  if (increment) {
    incrementCount(array,index,countOffset(direction));
  }
  return previousId;
}
