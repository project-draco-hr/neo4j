{
  long index=rebase(relGroupIndex);
  int directionOffset=directionOffset(direction);
  long previousId=all48Bits(array,index,directionOffset);
  array.set6BLong(index,directionOffset,relId);
  if (increment) {
    int countOffset=countOffset(direction);
    array.setInt(index,countOffset,array.getInt(index,countOffset) + 1);
  }
  return previousId;
}
