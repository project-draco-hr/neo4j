{
  StandardPageTable table=new StandardPageTable(1024);
  final BufferPageIO io=new BufferPageIO(ByteBuffer.wrap("expected".getBytes("UTF-8")));
  final PageTable.PinnablePage page=table.load(io,12,PageLock.EXCLUSIVE);
  final AtomicBoolean acquiredPage=new AtomicBoolean(false);
  Thread otherThread=new Thread(new Runnable(){
    @Override public void run(){
      page.pin(io,12,PageLock.SHARED);
      acquiredPage.set(true);
    }
  }
);
  otherThread.start();
  awaitThreadState(otherThread,Thread.State.WAITING);
  assertFalse(acquiredPage.get());
  page.unpin(PageLock.EXCLUSIVE);
  otherThread.join();
  assertTrue(acquiredPage.get());
}
