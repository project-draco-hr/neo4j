{
  try {
    long txId=dataSource.getLastCommittedTxId();
    RequestContext.Tx[] txs=new RequestContext.Tx[]{RequestContext.lastAppliedTx(dataSource.getName(),txId)};
    Pair<Integer,Long> master=dataSource.getName().equals(Config.DEFAULT_DATA_SOURCE_NAME) ? dataSource.getMasterForCommittedTx(txId) : Pair.of(XaLogicalLog.MASTER_ID_REPRESENTING_NO_MASTER,0L);
    return new RequestContext(sessionId,machineId,eventIdentifier,txs,master.first(),master.other());
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
