{
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(storeDir.getAbsolutePath());
  try {
    try (Transaction tx=db.beginTx()){
      db.schema().indexFor(label).on(key).create();
      tx.success();
    }
     try (Transaction tx=db.beginTx()){
      db.schema().awaitIndexesOnline(10,SECONDS);
      tx.success();
    }
     long nodeId;
    try (Transaction tx=db.beginTx()){
      Node node=db.createNode(label);
      nodeId=node.getId();
      tx.success();
    }
     long otherNodeId;
    try (Transaction tx=db.beginTx()){
      otherNodeId=db.createNode().getId();
      tx.success();
    }
     return new Long[]{nodeId,otherNodeId};
  }
  finally {
    db.shutdown();
  }
}
