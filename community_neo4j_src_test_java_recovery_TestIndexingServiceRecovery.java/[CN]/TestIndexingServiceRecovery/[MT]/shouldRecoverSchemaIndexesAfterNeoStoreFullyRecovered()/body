{
  File storeDir=forTest(getClass()).makeGraphDbDir();
  Long[] nodeIds=createSchemaData(storeDir);
  executeSubProcess(getClass(),30,SECONDS,args(storeDir.getAbsolutePath(),nodeIds));
  makeItLookLikeNeoStoreDataSourceDidntCommitLastTransaction(storeDir);
  Pair<Collection<Long>,Collection<NodePropertyUpdate>> updatesSeenDuringRecovery=recoverStore(storeDir);
  int labelId=0, propertyKey=0;
  assertEquals("Test contains invalid assumptions. Recovery process should have seen updates around these nodes",asSet(nodeIds),updatesSeenDuringRecovery.first());
  assertEquals(asSet(add(nodeIds[0],propertyKey,value,new long[]{labelId})),updatesSeenDuringRecovery.other());
}
