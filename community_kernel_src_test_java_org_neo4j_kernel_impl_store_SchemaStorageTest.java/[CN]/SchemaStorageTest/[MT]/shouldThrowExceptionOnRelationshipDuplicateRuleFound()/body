{
  TokenNameLookup tokenNameLookup=getDefaultTokenNameLookup();
  SchemaStorage schemaStorageSpy=Mockito.spy(storage);
  Mockito.when(schemaStorageSpy.loadAllSchemaRules()).thenReturn(IteratorUtil.<SchemaRule>iterator(getRelationshipPropertyExistenceConstraintRule(1l,TYPE1,PROP1),getRelationshipPropertyExistenceConstraintRule(2l,TYPE1,PROP1)));
  expectedException.expect(DuplicateEntitySchemaRuleException.class);
  expectedException.expect(new KernelExceptionUserMessageMatcher(tokenNameLookup,"Multiple constraints found for relationship type 'Type1' and property 'prop1'."));
  schemaStorageSpy.relationshipPropertyExistenceConstraint(typeId(TYPE1),propId(PROP1));
}
