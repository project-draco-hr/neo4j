{
  DispatcherTrapImpl callback;
  try {
    callback=new DispatcherTrapImpl(this,parameter);
  }
 catch (  RemoteException e) {
    throw new RuntimeException("Failed to create local RMI endpoint.",e);
  }
  ProcessBuilder builder=new ProcessBuilder("java","-cp",System.getProperty("java.class.path"),SubProcess.class.getName(),serialize(callback));
  Process process;
  try {
    process=builder.start();
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to start sub process",e);
  }
  String pid=getPid(process);
  pipe("[" + toString() + ":"+ pid+ "] ",process.getErrorStream(),System.err);
  pipe("[" + toString() + ":"+ pid+ "] ",process.getInputStream(),System.out);
  Dispatcher dispatcher=callback.get(process);
  if (dispatcher == null)   throw new IllegalStateException("failed to start sub process");
  return t.cast(Proxy.newProxyInstance(t.getClassLoader(),new Class[]{t},live(new Handler(t,dispatcher,process,"<" + toString() + ":"+ pid+ ">"))));
}
