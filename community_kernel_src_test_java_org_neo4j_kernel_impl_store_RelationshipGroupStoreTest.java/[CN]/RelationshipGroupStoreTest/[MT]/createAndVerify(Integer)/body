{
  int expectedThreshold=customThreshold != null ? customThreshold : defaultThreshold;
  StoreFactory factory=factory(customThreshold);
  NeoStores neoStores=factory.openNeoStores(true);
  assertEquals(expectedThreshold,neoStores.getRelationshipGroupStore().getDenseNodeThreshold());
  neoStores.close();
  neoStores=factory.openNeoStores(false);
  assertEquals(expectedThreshold,neoStores.getRelationshipGroupStore().getDenseNodeThreshold());
  neoStores.close();
  factory=factory(999999);
  neoStores=factory.openNeoStores(false);
  assertEquals(expectedThreshold,neoStores.getRelationshipGroupStore().getDenseNodeThreshold());
  neoStores.close();
}
