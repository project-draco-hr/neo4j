{
  final EmbeddedNeo neo=new EmbeddedNeo(relTypes,neoPath);
  try {
    final ShellServer server=new NeoShellServer(neo,relTypes);
    Runtime.getRuntime().addShutdownHook(new Thread(){
      @Override public void run(){
        try {
          server.shutdown();
        }
 catch (        RemoteException e) {
          e.printStackTrace();
        }
        neo.shutdown();
      }
    }
);
    server.makeRemotelyAvailable(AbstractServer.DEFAULT_PORT,AbstractServer.DEFAULT_NAME);
    return server;
  }
 catch (  RemoteException e) {
    throw new ShellException(e);
  }
}
