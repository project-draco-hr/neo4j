{
  NodeRecord before=command.getBefore();
  NodeRecord after=command.getAfter();
  NodeLabels labelFieldBefore=parseLabelsField(before);
  NodeLabels labelFieldAfter=parseLabelsField(after);
  if (!(labelFieldBefore.isInlined() && labelFieldAfter.isInlined() && before.getLabelField() == after.getLabelField())) {
    long[] labelsBefore=labelFieldBefore.getIfLoaded();
    long[] labelsAfter=labelFieldAfter.getIfLoaded();
    if (labelsBefore != null && labelsAfter != null) {
      labelUpdateConsumer.accept(NodeLabelUpdate.labelChanges(command.getKey(),labelsBefore,labelsAfter));
    }
  }
  return indexUpdatesExtractor.visitNodeCommand(command);
}
