{
  return new IndexUpdater(){
    @Override public Reservation validate(    Iterable<NodePropertyUpdate> updates) throws IOException {
      return Reservation.EMPTY;
    }
    @Override public void process(    NodePropertyUpdate update) throws IOException, IndexEntryConflictException {
switch (mode) {
case ONLINE:
        job.update(update);
      break;
case RECOVERY:
    throw new UnsupportedOperationException("Recovered updates shouldn't reach this place");
default :
  throw new ThisShouldNotHappenError("Stefan","Unsupported IndexUpdateMode");
}
}
@Override public void close() throws IOException, IndexEntryConflictException {
}
@Override public void remove(Iterable<Long> nodeIds){
throw new UnsupportedOperationException("Should not remove() from populating index.");
}
}
;
}
