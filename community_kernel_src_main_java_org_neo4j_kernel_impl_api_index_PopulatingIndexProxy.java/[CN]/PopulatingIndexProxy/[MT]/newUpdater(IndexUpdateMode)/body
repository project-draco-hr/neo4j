{
  return new CollectingIndexUpdater(){
    @Override public void close() throws IOException {
switch (mode) {
case ONLINE:
        job.update(updates);
      break;
case RECOVERY:
    throw new UnsupportedOperationException("Recovered updates shouldn't reach this place");
default :
  throw new ThisShouldNotHappenError("Stefan","Unsupported IndexUpdateMode");
}
}
}
;
}
