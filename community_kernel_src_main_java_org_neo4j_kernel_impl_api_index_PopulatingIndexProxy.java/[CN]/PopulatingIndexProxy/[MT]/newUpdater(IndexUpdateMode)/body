{
  return new IndexUpdater(){
    @Override public void process(    NodePropertyUpdate update) throws IOException, IndexEntryConflictException {
switch (mode) {
case ONLINE:
        job.update(update);
      break;
case RECOVERY:
    throw new UnsupportedOperationException("Recovered updates shouldn't reach this place");
default :
  throw new ThisShouldNotHappenError("Stefan","Unsupported IndexUpdateMode");
}
}
@Override public void close() throws IOException, IndexEntryConflictException {
}
}
;
}
