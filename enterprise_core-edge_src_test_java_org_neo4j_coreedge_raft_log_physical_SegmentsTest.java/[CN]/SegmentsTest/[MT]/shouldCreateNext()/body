{
  FileSystemAbstraction fsa=mock(FileSystemAbstraction.class,RETURNS_MOCKS);
  FileNames fileNames=mock(FileNames.class);
  ChannelMarshal<ReplicatedContent> contentMarshal=mock(ChannelMarshal.class);
  LogProvider logProvider=mock(LogProvider.class);
  Segments segments=new Segments(fsa,fileNames,Collections.emptyList(),contentMarshal,logProvider,-1);
  segments.rotate(10,11,12);
  segments.last().closeWriter();
  SegmentFile last=segments.last();
  assertEquals(10,last.header().prevFileLastIndex());
  assertEquals(11,last.header().prevIndex());
  assertEquals(12,last.header().prevTerm());
}
