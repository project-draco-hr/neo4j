{
  @SuppressWarnings("unchecked") StateStorage<ReplicatedLockTokenState> storage=mock(StateStorage.class);
  MemberId initialHoldingCoreMember=member(0);
  ReplicatedLockTokenState initialState=new ReplicatedLockTokenState(123,new ReplicatedLockTokenRequest(initialHoldingCoreMember,3));
  when(storage.getInitialState()).thenReturn(initialState);
  ReplicatedLockTokenStateMachine stateMachine=new ReplicatedLockTokenStateMachine(storage);
  LockToken initialToken=stateMachine.currentToken();
  assertEquals(initialState.get().owner(),initialToken.owner());
  assertEquals(initialState.get().id(),initialToken.id());
}
