{
  if (!dir.isDirectory()) {
    return 0;
  }
  File[] files=dir.listFiles();
  if (files == null) {
    logger.log(prefix + "<INACCESSIBLE>");
    return 0;
  }
  long total=0;
  List<File> fileList=Arrays.asList(files);
  Collections.sort(fileList,new Comparator<File>(){
    @Override public int compare(    File o1,    File o2){
      return o1.getName().compareTo(o2.getName());
    }
  }
);
  for (  File file : fileList) {
    long size;
    String filename=file.getName();
    if (file.isDirectory()) {
      logger.log(prefix + filename + ":");
      size=logStoreFiles(logger,prefix + "  ",file);
      filename="- Total";
    }
 else {
      size=file.length();
    }
    String fileModificationDate=getFileModificationDate(file);
    String bytes=Format.bytes(size);
    String fileInformation=String.format("%s%s: %s - %s",prefix,filename,fileModificationDate,bytes);
    logger.log(fileInformation);
    total+=size;
  }
  return total;
}
