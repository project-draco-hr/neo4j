{
  Process proc=null;
  try {
    proc=run("1");
    Thread.sleep(12000);
    HighlyAvailableGraphDatabase slave1=startDb(2);
    HighlyAvailableGraphDatabase slave2=startDb(3);
    assertTrue(!slave1.isMaster());
    assertTrue(!slave2.isMaster());
    proc.destroy();
    proc=null;
    Thread.sleep(60000);
    assertTrue(slave1.isMaster());
    assertTrue(!slave2.isMaster());
  }
  finally {
    if (proc != null) {
      proc.destroy();
    }
  }
}
