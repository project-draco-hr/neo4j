{
  if (Objects.equals(versionToMigrateFrom,StandardV2_1.STORE_VERSION) || Objects.equals(versionToMigrateFrom,StandardV2_2.STORE_VERSION)) {
    Iterable<StoreFile> countsStoreFiles=Iterables.iterable(StoreFile.COUNTS_STORE_LEFT,StoreFile.COUNTS_STORE_RIGHT);
    StoreFile.fileOperation(DELETE,fileSystem,storeDir,storeDir,countsStoreFiles,true,null,StoreFileType.STORE);
    File neoStore=new File(storeDir,DEFAULT_NAME);
    long lastTxId=MetaDataStore.getRecord(pageCache,neoStore,Position.LAST_TRANSACTION_ID);
    rebuildCountsFromScratch(storeDir,lastTxId,pageCache,selectForVersion(versionToMigrateTo));
  }
}
