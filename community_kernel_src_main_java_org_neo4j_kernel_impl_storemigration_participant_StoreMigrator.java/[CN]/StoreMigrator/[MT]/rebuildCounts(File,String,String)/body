{
switch (versionToMigrateFrom) {
case LowLimitV2_1.STORE_VERSION:
case LowLimitV2_2.STORE_VERSION:
    Iterable<StoreFile> countsStoreFiles=Iterables.iterable(StoreFile.COUNTS_STORE_LEFT,StoreFile.COUNTS_STORE_RIGHT);
  StoreFile.fileOperation(DELETE,fileSystem,storeDir,storeDir,countsStoreFiles,true,null,StoreFileType.STORE);
File neoStore=new File(storeDir,DEFAULT_NAME);
long lastTxId=MetaDataStore.getRecord(pageCache,neoStore,Position.LAST_TRANSACTION_ID);
rebuildCountsFromScratch(storeDir,lastTxId,pageCache,fromVersion(versionToMigrateTo));
break;
default :
}
}
