{
  BatchingNeoStores.createStore(fileSystem,migrationDir.getPath(),config);
  if (newFormat.dynamic().equals(oldFormat.dynamic())) {
    Iterable<StoreFile> storeFiles=iterable(StoreFile.NODE_LABEL_STORE);
    StoreFile.fileOperation(COPY,fileSystem,storeDir,migrationDir,storeFiles,true,ExistingTargetStrategy.FAIL,StoreFileType.values());
  }
 else {
    DirectRecordStoreMigrator migrator=new DirectRecordStoreMigrator(pageCache,fileSystem,config);
    StoreType[] storesToMigrate={StoreType.LABEL_TOKEN,StoreType.LABEL_TOKEN_NAME,StoreType.PROPERTY_KEY_TOKEN,StoreType.PROPERTY_KEY_TOKEN_NAME,StoreType.RELATIONSHIP_TYPE_TOKEN,StoreType.RELATIONSHIP_TYPE_TOKEN_NAME,StoreType.NODE_LABEL,StoreType.SCHEMA};
    MigrationProgressMonitor.Section section=SilentMigrationProgressMonitor.NO_OP_SECTION;
    migrator.migrate(storeDir,oldFormat,migrationDir,newFormat,section,storesToMigrate,StoreType.NODE);
  }
}
