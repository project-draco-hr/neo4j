{
  StringBuilder classpath=buildClassPath();
  try (RmiServer server=new RmiServer()){
    int port=server.getPort();
    server.export(RMI_RUN_NOTIFIER_NAME,new DelegatingRemoteRunNotifier(notifier));
    ProcessBuilder pb=new ProcessBuilder();
    pb.command("java","-ea","-Xbootclasspath/a:" + classpathEntryToBootWith,"-cp",classpath.toString(),getClass().getName(),String.valueOf(port),testClass.getName());
    pb.inheritIO();
    Process process=pb.start();
    process.waitFor();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
