{
  Pattern pattern=Pattern.compile(regexPattern);
  Collection<File> deletedFiles=new ArrayList<File>();
  for (  File file : directory.listFiles()) {
    if (pattern.matcher(file.getName()).find()) {
      if (!file.delete()) {
        throw new IOException("Couldn't delete file '" + file.getAbsolutePath() + "'");
      }
      deletedFiles.add(file);
    }
  }
  return deletedFiles.toArray(new File[deletedFiles.size()]);
}
