{
  Pattern pattern=Pattern.compile(regexPattern);
  Collection<File> deletedFiles=new ArrayList<>();
  File[] files=directory.listFiles();
  if (files == null) {
    throw new IllegalArgumentException(directory + " is not a directory");
  }
  for (  File file : files) {
    if (pattern.matcher(file.getName()).find()) {
      if (!file.delete()) {
        throw new IOException("Couldn't delete file '" + file.getAbsolutePath() + "'");
      }
      deletedFiles.add(file);
    }
  }
  return deletedFiles.toArray(new File[deletedFiles.size()]);
}
