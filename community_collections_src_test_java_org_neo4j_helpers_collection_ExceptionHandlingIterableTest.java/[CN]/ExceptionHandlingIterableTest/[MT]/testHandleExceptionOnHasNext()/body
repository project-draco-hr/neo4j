{
  IteratorUtil.count(new ExceptionHandlingIterable(new Iterable(){
    public Iterator iterator(){
      return new Iterator(){
        public boolean hasNext(){
          throw new RuntimeException("exception on next");
        }
        public Object next(){
          return null;
        }
        public void remove(){
        }
      }
;
    }
  }
){
    @Override protected boolean exceptionOnHasNext(    Throwable t){
      rethrow(new IllegalStateException());
      return super.exceptionOnHasNext(t);
    }
  }
);
}
