{
  String script=createScript("MATCH (n {name: 'I'}) SET n:Actor REMOVE n:Director RETURN labels(n)");
  Map<String,Object> output=jsonToMap(doCypherRestCall(cypherUri() + "?includeStats=true",script,Status.OK));
  @SuppressWarnings("unchecked") Map<String,Object> stats=(Map<String,Object>)output.get("stats");
  assertThat(stats,isA(Map.class));
  assertThat((Boolean)stats.get("contains_updates"),is(true));
  assertThat((Integer)stats.get("labels_added"),is(1));
  assertThat((Integer)stats.get("labels_removed"),is(1));
  assertThat((Integer)stats.get("nodes_created"),is(0));
  assertThat((Integer)stats.get("nodes_deleted"),is(0));
  assertThat((Integer)stats.get("properties_set"),is(0));
  assertThat((Integer)stats.get("relationships_created"),is(0));
  assertThat((Integer)stats.get("relationship_deleted"),is(0));
}
