{
  runTwoThreads(new Consumer<TestKernelTransaction>(){
    @Override public void accept(    TestKernelTransaction tx){
      tx.markForTermination();
    }
  }
,new Consumer<TestKernelTransaction>(){
    @Override public void accept(    TestKernelTransaction tx){
      close(tx);
      assertFalse(tx.shouldBeTerminated());
      tx.initialize();
    }
  }
);
}
