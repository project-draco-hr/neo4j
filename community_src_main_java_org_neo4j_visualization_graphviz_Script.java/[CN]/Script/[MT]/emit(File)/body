{
  GraphDatabaseService graphdb=createGraphDb();
  GraphvizWriter writer=new GraphvizWriter(styles.toArray(new StyleParameter[styles.size()]));
  try {
    Transaction tx=graphdb.beginTx();
    try {
      writer.emit(outfile,createGraphWalker(graphdb));
    }
  finally {
      tx.finish();
    }
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
 finally {
    graphdb.shutdown();
  }
}
