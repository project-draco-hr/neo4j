{
  if (protocol.isExpecting(CatchupClientProtocol.NextMessage.CORE_SNAPSHOT)) {
    listener.onSnapshotReceived(coreSnapshot);
    protocol.expect(CatchupClientProtocol.NextMessage.MESSAGE_TYPE);
  }
 else {
    ctx.fireChannelRead(coreSnapshot);
  }
}
