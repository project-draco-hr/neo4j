{
  if (CatchupClientProtocol.NextMessage.CORE_SNAPSHOT.equals(protocol.expecting())) {
    listener.onSnapshotReceived(coreSnapshot);
    protocol.expect(CatchupClientProtocol.NextMessage.MESSAGE_TYPE);
  }
 else {
    ctx.fireChannelRead(coreSnapshot);
  }
}
