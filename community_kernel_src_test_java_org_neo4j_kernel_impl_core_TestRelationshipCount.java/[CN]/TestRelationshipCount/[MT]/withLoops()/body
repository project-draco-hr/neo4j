{
  for (int i=0; i < 10; i++) {
    getGraphDb().createNode().createRelationshipTo(getGraphDb().createNode(),MyRelTypes.TEST);
  }
  Node node=getGraphDb().createNode();
  assertEquals(0,node.getDegree());
  node.createRelationshipTo(node,MyRelTypes.TEST);
  assertEquals(1,node.getDegree());
  Node otherNode=getGraphDb().createNode();
  Relationship rel2=node.createRelationshipTo(otherNode,MyRelTypes.TEST2);
  assertEquals(2,node.getDegree());
  assertEquals(1,otherNode.getDegree());
  newTransaction();
  assertEquals(2,node.getDegree());
  Relationship rel3=node.createRelationshipTo(node,MyRelTypes.TEST_TRAVERSAL);
  assertEquals(3,node.getDegree());
  assertEquals(1,otherNode.getDegree());
  rel2.delete();
  assertEquals(2,node.getDegree());
  assertEquals(0,otherNode.getDegree());
  rel3.delete();
  assertEquals(1,node.getDegree());
}
