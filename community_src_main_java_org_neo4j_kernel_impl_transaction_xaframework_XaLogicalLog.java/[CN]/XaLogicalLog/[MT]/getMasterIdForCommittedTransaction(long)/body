{
  if (txId == 1) {
    return MASTER_ID_REPRESENTING_NO_MASTER;
  }
  long version=findLogContainingTxId(txId);
  System.out.println("Found txId:" + txId + " in log version:"+ version);
  if (version == -1) {
    throw new RuntimeException("txId:" + txId + " not found in any logical log "+ "(starting at "+ logVersion+ " and searching backwards)");
  }
  ReadableByteChannel log=getLogicalLogOrMyself(version);
  List<LogEntry> logEntryList=extractTransactionFromLog(txId,version,log);
  for (  LogEntry entry : logEntryList) {
    if (entry instanceof LogEntry.Commit) {
      return ((LogEntry.Commit)entry).getMasterId();
    }
  }
  throw new RuntimeException("Unable to find commit entry in for txId[" + txId + "] in log["+ version+ "]");
}
