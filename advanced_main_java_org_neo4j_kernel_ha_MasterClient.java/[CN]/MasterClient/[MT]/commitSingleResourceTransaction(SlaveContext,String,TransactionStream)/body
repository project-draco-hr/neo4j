{
  return sendRequest(RequestType.COMMIT,context,new Serializer(){
    public void write(    ChannelBuffer buffer) throws IOException {
      writeString(buffer,resource);
      writeTransactionStream(buffer,transactionStream);
    }
  }
,new Deserializer<Long>(){
    @SuppressWarnings("boxing") public Long read(    ChannelBuffer buffer){
      return buffer.readLong();
    }
  }
);
}
