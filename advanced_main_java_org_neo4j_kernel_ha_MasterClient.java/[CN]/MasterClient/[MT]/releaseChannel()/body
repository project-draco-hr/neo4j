{
synchronized (channels) {
    Channel channel=channels.remove(Thread.currentThread());
    if (channel != null) {
      if (unusedChannels.size() < 5) {
        unusedChannels.push(channel);
      }
 else {
        new Exception("close channel " + channel).printStackTrace();
        channel.close();
      }
    }
  }
}
