{
  RaftMessages.RaftMessage message=storeIdAwareMessage.message();
  StoreId storeId=storeIdAwareMessage.storeId();
  if (storeId.equals(localDatabase.storeId())) {
    messageHandler.handle(message);
  }
 else {
    if (localDatabase.isEmpty()) {
      raftStateMachine.downloadSnapshot(message.from());
    }
 else {
      log.info("Discarding message owing to mismatched storeId and non-empty store. Expected: %s, " + "Encountered: %s",storeId,localDatabase.storeId());
    }
  }
}
