{
  try (SchemaIndex index=LuceneSchemaIndexBuilder.create().withIndexRootFolder(testDir.directory()).withIndexIdentifier("partitionedIndexForUpdates").build()){
    index.create();
    index.open();
    addDocumentToIndex(index,45);
    index.getIndexWriter().updateDocument(LuceneDocumentStructure.newTermForChangeOrRemove(100),LuceneDocumentStructure.documentRepresentingProperty(100,100));
    index.maybeRefreshBlocking();
    long documentsInIndex=Iterators.count(index.allDocumentsReader().iterator());
    assertEquals("Index should contain 45 added and 1 updated document.",46,documentsInIndex);
  }
 }
