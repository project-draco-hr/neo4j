{
  NodePropertyCommandsExtractor extractor=new NodePropertyCommandsExtractor();
  transaction.accept(extractor);
  if (extractor.noCommandsExtracted()) {
    return ValidatedIndexUpdates.NONE;
  }
  if (mode == TransactionApplicationMode.RECOVERY) {
    return newValidatedRecoveredUpdates(extractor.changedNodeIds(),indexing);
  }
  Iterable<NodePropertyUpdate> updates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,extractor.propertyCommandsByNodeIds,extractor.nodeCommandsById);
  return indexing.validate(updates);
}
