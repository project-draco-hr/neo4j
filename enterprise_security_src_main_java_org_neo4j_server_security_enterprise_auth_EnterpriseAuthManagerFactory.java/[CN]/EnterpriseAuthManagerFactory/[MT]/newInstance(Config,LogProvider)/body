{
  List<Realm> realms=new ArrayList<>(2);
  InternalFlatFileRealm internalRealm=createInternalRealm(config,logProvider);
  if (config.get(SecuritySettings.internal_authentication_enabled) || config.get(SecuritySettings.internal_authorization_enabled)) {
    realms.add(internalRealm);
  }
  if (config.get(SecuritySettings.ldap_authentication_enabled) || config.get(SecuritySettings.ldap_authorization_enabled)) {
    realms.add(new LdapRealm(config,logProvider));
  }
  if (config.get(SecuritySettings.plugin_authentication_enabled) || config.get(SecuritySettings.plugin_authorization_enabled)) {
  }
  long ttl=config.get(SecuritySettings.auth_caching_ttl);
  long maxCapacity=config.get(SecuritySettings.auth_cache_max_capacity);
  return new MultiRealmAuthManager(internalRealm,realms,new AuthCache.Manager(Clocks.systemClock(),ttl,maxCapacity));
}
