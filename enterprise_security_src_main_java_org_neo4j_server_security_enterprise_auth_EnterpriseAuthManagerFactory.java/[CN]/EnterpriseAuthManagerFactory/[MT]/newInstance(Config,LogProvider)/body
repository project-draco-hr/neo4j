{
  InternalFlatFileRealm internalRealm=createInternalRealm(config,logProvider);
  List<Realm> realms=new ArrayList<>(2);
  realms.add(internalRealm);
  if (config.get(SecuritySettings.external_auth_enabled)) {
    if (config.get(SecuritySettings.ldap_auth_enabled)) {
      realms.add(new LdapRealm(config));
    }
  }
  return new MultiRealmAuthManager(internalRealm,realms);
}
