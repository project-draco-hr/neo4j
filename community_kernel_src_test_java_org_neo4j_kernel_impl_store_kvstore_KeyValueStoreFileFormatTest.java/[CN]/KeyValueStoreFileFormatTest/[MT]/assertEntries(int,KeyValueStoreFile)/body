{
class Visitor implements KeyValueVisitor {
    int visited=0;
    @Override public boolean visit(    ReadableBuffer key,    ReadableBuffer value){
      if (++visited > expected) {
        fail("should not have more than " + expected + " data entries");
      }
      return true;
    }
    void done(){
      assertEquals("number of entries",expected,visited);
    }
  }
  Visitor visitor=new Visitor();
  file.scan(visitor);
  visitor.done();
}
