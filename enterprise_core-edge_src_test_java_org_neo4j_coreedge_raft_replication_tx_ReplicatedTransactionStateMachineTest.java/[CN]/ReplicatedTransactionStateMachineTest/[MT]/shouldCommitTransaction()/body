{
  LocalOperationId localOperationId=new LocalOperationId(0,0);
  int lockSessionId=23;
  ReplicatedTransaction tx=ReplicatedTransactionFactory.createImmutableReplicatedTransaction(physicalTx(lockSessionId),globalSession,localOperationId);
  TransactionCommitProcess localCommitProcess=mock(TransactionCommitProcess.class);
  final ReplicatedTransactionStateMachine listener=new ReplicatedTransactionStateMachine(localCommitProcess,globalSession,lockState(lockSessionId),new CommittingTransactionsRegistry());
  listener.onReplicated(tx,0);
  verify(localCommitProcess,times(1)).commit(any(TransactionToApply.class),any(CommitEvent.class),any(TransactionApplicationMode.class));
}
