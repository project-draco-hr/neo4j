{
  if (buffer.readableBytes() < 1) {
    throw new MarshallingException("Cannot read content type");
  }
  byte type=buffer.readByte();
  final ReplicatedContent content;
switch (type) {
case TX_CONTENT_TYPE:
    content=ReplicatedTransactionSerializer.deserialize(buffer);
  break;
case RAFT_MEMBER_SET_TYPE:
content=CoreMemberSetSerializer.deserialize(buffer);
break;
case ID_RANGE_REQUEST_TYPE:
content=ReplicatedIdAllocationRequestSerializer.deserialize(buffer);
break;
case TOKEN_REQUEST_TYPE:
content=ReplicatedTokenRequestSerializer.deserialize(buffer);
break;
case NEW_LEADER_BARRIER_TYPE:
content=new NewLeaderBarrier();
break;
case LOCK_TOKEN_REQUEST:
content=ReplicatedLockTokenSerializer.deserialize(buffer);
break;
default :
throw new MarshallingException(String.format("Unknown content type 0x%x",type));
}
return content;
}
