{
  int maxDocLimit=42;
  int toReserve=maxDocLimit + 42;
  ReservingLuceneIndexWriter indexWriter=newReservingLuceneIndexWriter(maxDocLimit);
  try {
    indexWriter.reserveInsertions(toReserve);
    fail("Should have thrown " + IndexCapacityExceededException.class.getSimpleName());
  }
 catch (  IndexCapacityExceededException e) {
    assertThat(e.getMessage(),startsWith("Unable to reserve"));
  }
}
