{
  Collection<RelationshipType> types=new ArrayList<>();
  Map<String,RelationshipGroupRecord> map=new HashMap<>();
  for (  Map.Entry<Integer,RelationshipGroupRecord> entry : rawGroups.entrySet()) {
    RelationshipType type=this.types.get(entry.getKey());
    types.add(type);
    map.put(type.name(),entry.getValue());
  }
  return Pair.of(types.toArray(new RelationshipType[types.size()]),map);
}
