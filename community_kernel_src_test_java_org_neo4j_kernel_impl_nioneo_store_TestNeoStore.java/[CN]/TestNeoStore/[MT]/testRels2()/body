{
  initializeStores();
  startTx();
  int relType1=(int)ds.nextId(RelationshipType.class);
  xaCon.getWriteTransaction().createRelationshipType(relType1,"relationshiptype1");
  long nodeIds[]=new long[3];
  for (int i=0; i < 3; i++) {
    nodeIds[i]=ds.nextId(Node.class);
    xaCon.getWriteTransaction().nodeCreate(nodeIds[i]);
    xaCon.getWriteTransaction().nodeAddProperty(nodeIds[i],pStore.nextId(),index("nisse"),new Integer(10 - i));
  }
  for (int i=0; i < 2; i++) {
    xaCon.getWriteTransaction().relationshipCreate(ds.nextId(Relationship.class),relType1,nodeIds[i],nodeIds[i + 1]);
  }
  xaCon.getWriteTransaction().relationshipCreate(ds.nextId(Relationship.class),relType1,nodeIds[0],nodeIds[2]);
  commitTx();
  startTx();
  for (int i=0; i < 3; i++) {
    RelationshipChainPosition pos=xaCon.getWriteTransaction().getRelationshipChainPosition(nodeIds[i]);
    for (    RelationshipRecord rel : both(xaCon.getWriteTransaction().getMoreRelationships(nodeIds[i],pos))) {
      xaCon.getWriteTransaction().relDelete(rel.getId());
    }
    xaCon.getWriteTransaction().nodeDelete(nodeIds[i]);
  }
  commitTx();
  ds.close();
}
