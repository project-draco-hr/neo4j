{
  LockManager lockManager=new LockManagerImpl(new RagManager());
  final Config config=new Config(MapUtil.stringMap(InternalAbstractGraphDatabase.Configuration.store_dir.name(),path.getPath(),InternalAbstractGraphDatabase.Configuration.neo_store.name(),"neo",InternalAbstractGraphDatabase.Configuration.logical_log.name(),file("nioneo_logical.log").getPath()),GraphDatabaseSettings.class);
  EphemeralFileSystemAbstraction fs=this.fs.get();
  StoreFactory sf=new StoreFactory(config,new DefaultIdGeneratorFactory(),new DefaultWindowPoolFactory(),fs,StringLogger.DEV_NULL,null);
  KernelHealth kernelHealth=mock(KernelHealth.class);
  NodeManager nodeManager=mock(NodeManager.class);
  @SuppressWarnings("rawtypes") List caches=Arrays.asList((Cache)mock(AutoLoadingCache.class),(Cache)mock(AutoLoadingCache.class));
  when(nodeManager.caches()).thenReturn(caches);
  Locks locks=mock(Locks.class);
  Locks.Client lockClient=mock(Locks.Client.class);
  when(locks.newClient()).thenReturn(lockClient);
  ds=new NeoStoreXaDataSource(config,sf,StringLogger.DEV_NULL,null,new DevNullLoggingService(),new KernelSchemaStateStore(),mock(TokenNameLookup.class),dependencyResolverForNoIndexProvider(nodeManager),mock(PropertyKeyTokenHolder.class),mock(LabelTokenHolder.class),mock(RelationshipTypeTokenHolder.class),locks,mock(SchemaWriteGuard.class),mock(TransactionEventHandlers.class),IndexingService.NO_MONITOR,fs,new Function<NeoStore,Function<List<LogEntry>,List<LogEntry>>>(){
    @Override public Function<List<LogEntry>,List<LogEntry>> apply(    NeoStore neoStore){
      return Functions.<List<LogEntry>>identity();
    }
  }
,mock(StoreUpgrader.class));
  ds.init();
  ds.start();
  pStore=xaCon.getPropertyStore();
  rtStore=xaCon.getRelationshipTypeStore();
}
