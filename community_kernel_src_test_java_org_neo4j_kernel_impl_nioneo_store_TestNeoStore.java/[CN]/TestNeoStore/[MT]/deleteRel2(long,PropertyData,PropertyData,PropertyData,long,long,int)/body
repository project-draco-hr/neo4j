{
  ArrayMap<Integer,PropertyData> props=xaCon.getWriteTransaction().relLoadProperties(rel,false);
  int count=0;
  for (  int keyId : props.keySet()) {
    long id=props.get(keyId).getId();
    PropertyRecord record=pStore.getRecord(id);
    PropertyBlock block=record.getPropertyBlock(props.get(keyId).getIndex());
    PropertyData data=block.newPropertyData(record);
    if (data.getIndex() == prop1.getIndex()) {
      assertEquals("prop1",MyPropertyKeyToken.getIndexFor(keyId).name());
      assertEquals("-string2",data.getValue());
    }
 else     if (data.getIndex() == prop2.getIndex()) {
      assertEquals("prop2",MyPropertyKeyToken.getIndexFor(keyId).name());
      assertEquals(new Integer(-2),data.getValue());
    }
 else     if (data.getIndex() == prop3.getIndex()) {
      assertEquals("prop3",MyPropertyKeyToken.getIndexFor(keyId).name());
      assertEquals(new Boolean(true),data.getValue());
      xaCon.getWriteTransaction().relRemoveProperty(rel,prop3);
    }
 else {
      throw new IOException();
    }
    count++;
  }
  assertEquals(3,count);
  assertEquals(3,xaCon.getWriteTransaction().relLoadProperties(rel,false).size());
  RelationshipRecord relData=xaCon.getWriteTransaction().relLoadLight(rel);
  assertEquals(firstNode,relData.getFirstNode());
  assertEquals(secondNode,relData.getSecondNode());
  assertEquals(relType,relData.getType());
  xaCon.getWriteTransaction().relDelete(rel);
  AtomicLong firstPos=getPosition(xaCon,firstNode);
  Iterator<RelationshipRecord> first=getMore(xaCon,firstNode,firstPos).iterator();
  AtomicLong secondPos=getPosition(xaCon,secondNode);
  Iterator<RelationshipRecord> second=getMore(xaCon,secondNode,secondPos).iterator();
  assertTrue(first.hasNext());
  assertTrue(second.hasNext());
}
