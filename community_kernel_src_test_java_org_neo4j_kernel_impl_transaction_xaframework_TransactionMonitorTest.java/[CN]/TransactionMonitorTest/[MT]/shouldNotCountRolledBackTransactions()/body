{
  GraphDatabaseService db=new TestGraphDatabaseFactory().newImpermanentDatabase();
  Monitors monitors=((GraphDatabaseAPI)db).getDependencyResolver().resolveDependency(Monitors.class);
  EideticTransactionMonitor monitor=new EideticTransactionMonitor();
  monitors.addMonitorListener(monitor,XaResourceManager.class.getName(),NeoStoreXaDataSource.DEFAULT_DATA_SOURCE_NAME);
  Transaction tx=db.beginTx();
  db.createNode();
  tx.failure();
  tx.finish();
  assertEquals(0,monitor.getCommitCount());
  assertEquals(0,monitor.getInjectOnePhaseCommitCount());
  assertEquals(0,monitor.getInjectTwoPhaseCommitCount());
  db.shutdown();
}
