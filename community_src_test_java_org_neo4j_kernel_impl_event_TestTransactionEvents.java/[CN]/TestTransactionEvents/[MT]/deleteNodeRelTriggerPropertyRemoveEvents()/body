{
  Node node1=getGraphDb().createNode();
  Node node2=getGraphDb().createNode();
  Relationship rel=node1.createRelationshipTo(node2,RelTypes.TXEVENT);
  node1.setProperty("test1","stringvalue");
  node1.setProperty("test2",1l);
  rel.setProperty("test1","stringvalue");
  rel.setProperty("test2",1l);
  rel.setProperty("test3",new int[]{1,2,3});
  commit();
  MyTxEventHandler handler=new MyTxEventHandler();
  getGraphDb().registerTransactionEventHandler(handler);
  newTransaction();
  getEmbeddedGraphDb().getConfig().getGraphDbModule().getNodeManager().clearCache();
  rel.delete();
  node1.delete();
  node2.delete();
  getEmbeddedGraphDb().getConfig().getGraphDbModule().getNodeManager().clearCache();
  commit();
  assertEquals("stringvalue",handler.nodeProps.get("test1"));
  assertEquals("stringvalue",handler.relProps.get("test1"));
  assertEquals(1l,handler.nodeProps.get("test2"));
  assertEquals(1l,handler.relProps.get("test2"));
  int[] intArray=(int[])handler.relProps.get("test3");
  assertEquals(3,intArray.length);
  assertEquals(1,intArray[0]);
  assertEquals(2,intArray[1]);
  assertEquals(3,intArray[2]);
}
