{
  boolean beforeSet=valueBefore != null;
  boolean afterSet=valueAfter != null;
  if (!beforeSet && afterSet)   return UpdateMode.ADDED;
  if (beforeSet && afterSet)   return UpdateMode.CHANGED;
  if (beforeSet && !afterSet)   return UpdateMode.REMOVED;
  throw new IllegalArgumentException("Neither before or after set");
}
