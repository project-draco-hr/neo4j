{
  TransactionIdStore transactionIdStore=new DeadSimpleTransactionIdStore(0l,0);
  LogRotationControl logRotationControl=mock(LogRotationControl.class);
  TransactionMetadataCache positionCache=new TransactionMetadataCache(10,1000);
  LifeSupport life=new LifeSupport();
  PhysicalLogFiles logFiles=new PhysicalLogFiles(testDir,DEFAULT_NAME,fs);
  Monitor monitor=new Monitors().newMonitor(PhysicalLogFile.Monitor.class);
  LogFile logFile=life.add(new PhysicalLogFile(fs,logFiles,1000,transactionIdStore,mock(LogVersionRepository.class),monitor,positionCache));
  life.add(new PhysicalLogicalTransactionStore(logFile,LogRotation.NO_ROTATION,positionCache,transactionIdStore,BYPASS,mock(KernelHealth.class),true));
  try {
    life.start();
  }
  finally {
    life.shutdown();
  }
}
