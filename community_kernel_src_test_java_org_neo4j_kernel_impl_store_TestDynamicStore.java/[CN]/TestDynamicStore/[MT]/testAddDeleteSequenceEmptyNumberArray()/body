{
  createEmptyStore(dynamicStoreFile(),30);
  DynamicArrayStore store=newStore();
  try {
    byte[] emptyToWrite=createBytes(0);
    long blockId=create(store,emptyToWrite);
    store.getLightRecords(blockId);
    byte[] bytes=(byte[])store.getArrayFor(store.getRecords(blockId));
    assertEquals(0,bytes.length);
    Collection<DynamicRecord> records=store.getLightRecords(blockId);
    for (    DynamicRecord record : records) {
      record.setInUse(false);
      store.updateRecord(record);
    }
  }
  finally {
    store.close();
    deleteBothFiles();
  }
}
