{
  Transaction tx=db.beginTx();
  Label label=label("labello");
  Node node=db.createNode(label);
  tx.success();
  tx.finish();
  tx=db.beginTx();
  StatementContext statement=statementContextProvider.getCtxForWriting();
  statement.deleteNode(node.getId());
  long labelId=statement.getLabelId(label.name());
  Set<Long> labels=asSet(statement.getLabelsForNode(node.getId()));
  boolean labelIsSet=statement.isLabelSetOnNode(labelId,node.getId());
  Set<Long> nodes=asSet(statement.getNodesWithLabel(labelId));
  statement.close();
  tx.success();
  tx.finish();
  assertEquals(asSet(),nodes);
  assertEquals(asSet(),labels);
  assertFalse("Label should not be set on node here",labelIsSet);
}
