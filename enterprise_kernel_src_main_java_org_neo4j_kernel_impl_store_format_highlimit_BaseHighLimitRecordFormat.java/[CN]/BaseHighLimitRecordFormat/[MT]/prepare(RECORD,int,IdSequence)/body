{
  if (record.inUse()) {
    int length=1 + requiredDataLength(record);
    boolean requiresSecondaryUnit=length > recordSize;
    record.setRequiresSecondaryUnit(requiresSecondaryUnit);
    if (record.requiresSecondaryUnit() && !record.hasSecondaryUnitId()) {
      record.setSecondaryUnitId(idSequence.nextId());
    }
  }
}
