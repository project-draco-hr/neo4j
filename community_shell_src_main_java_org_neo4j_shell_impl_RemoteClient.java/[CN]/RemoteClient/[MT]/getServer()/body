{
  boolean hadServer=this.server != null;
  boolean shouldTryToReconnect=this.server == null;
  try {
    if (!shouldTryToReconnect)     server.getName();
  }
 catch (  RemoteException e) {
    shouldTryToReconnect=true;
  }
  Exception originException=null;
  if (shouldTryToReconnect) {
    this.server=null;
    try {
      this.server=findRemoteServer();
      if (hadServer)       getOutput().println("[Reconnected to server]");
    }
 catch (    ShellException ee) {
      originException=ee;
    }
catch (    RemoteException ee) {
      originException=ee;
    }
  }
  if (this.server == null) {
    throw new RuntimeException("Server closed or cannot be reached anymore: " + originException.getMessage(),originException);
  }
  return this.server;
}
