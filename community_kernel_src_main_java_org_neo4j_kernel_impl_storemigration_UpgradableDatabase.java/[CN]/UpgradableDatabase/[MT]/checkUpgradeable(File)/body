{
  Result result=checkUpgradeableFor(storeDirectory,Legacy19Store.LEGACY_VERSION);
  if (result.outcome.isSuccessful()) {
    return Legacy19Store.LEGACY_VERSION;
  }
  result=checkUpgradeableFor(storeDirectory,Legacy20Store.LEGACY_VERSION);
  if (result.outcome.isSuccessful()) {
    return Legacy20Store.LEGACY_VERSION;
  }
  result=checkUpgradeableFor(storeDirectory,Legacy21Store.LEGACY_VERSION);
  if (result.outcome.isSuccessful()) {
    return Legacy21Store.LEGACY_VERSION;
  }
switch (result.outcome) {
case missingStoreFile:
    throw new StoreUpgrader.UpgradeMissingStoreFilesException(result.storeFilename);
case storeVersionNotFound:
  throw new StoreUpgrader.UpgradingStoreVersionNotFoundException(result.storeFilename);
case unexpectedUpgradingStoreVersion:
throw new StoreUpgrader.UnexpectedUpgradingStoreVersionException(result.storeFilename,Legacy21Store.LEGACY_VERSION,result.actualVersion);
default :
throw new IllegalArgumentException(result.outcome.name());
}
}
