{
  CatchupClientProtocol protocol=new CatchupClientProtocol();
  protocol.expect(NextMessage.TX_STREAM_FINISHED);
  EmbeddedChannel channel=new EmbeddedChannel(new TxStreamFinishedResponseEncoder(),new TxStreamFinishedResponseDecoder(protocol));
  final long arbitraryId=23;
  TxStreamFinishedResponse sent=new TxStreamFinishedResponse(arbitraryId);
  channel.writeOutbound(sent);
  channel.writeInbound(channel.readOutbound());
  TxStreamFinishedResponse received=(TxStreamFinishedResponse)channel.readInbound();
  assertNotSame(sent,received);
  assertEquals(sent,received);
}
