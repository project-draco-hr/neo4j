{
  JFileChooser jFileChooser=new JFileChooser();
  jFileChooser.setFileSelectionMode(DIRECTORIES_ONLY);
  jFileChooser.setCurrentDirectory(new File(directoryDisplay.getText()));
  jFileChooser.setDialogTitle("Select database");
  jFileChooser.setDialogType(CUSTOM_DIALOG);
  while (true) {
    int choice=jFileChooser.showOpenDialog(frame);
    if (choice != APPROVE_OPTION) {
      return;
    }
    File selectedFile=jFileChooser.getSelectedFile();
    try {
      model.setDatabaseDirectory(selectedFile);
      directoryDisplay.setText(model.getDatabaseDirectory().getAbsolutePath());
      return;
    }
 catch (    UnsuitableDirectoryException error) {
      int result=showWrappedConfirmDialog(frame,error.getMessage() + "\nPlease choose a different folder.","Invalid folder selected",OK_CANCEL_OPTION,ERROR_MESSAGE);
      if (result == CANCEL_OPTION) {
        return;
      }
    }
  }
}
