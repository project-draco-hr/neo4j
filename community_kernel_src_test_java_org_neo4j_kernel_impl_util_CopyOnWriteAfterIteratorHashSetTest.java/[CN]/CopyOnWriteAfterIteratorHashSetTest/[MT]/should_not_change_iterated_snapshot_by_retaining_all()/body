{
  CopyOnWriteAfterIteratorHashSet<String> set=newCOWSet("hullo","wurld","!");
  Snapshot<String> initialSnapshot=snapshot(set);
  set.retainAll(asList("!","!"));
  assertEquals(asSet("hullo","wurld","!"),initialSnapshot.toSet());
  assertEquals(asSet("!"),snapshot(set).toSet());
}
