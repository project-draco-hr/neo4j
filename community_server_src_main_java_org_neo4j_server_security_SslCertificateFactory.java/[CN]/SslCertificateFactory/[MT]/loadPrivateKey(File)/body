{
  DataInputStream dis=null;
  try {
    FileInputStream fis=new FileInputStream(privateKeyFile);
    dis=new DataInputStream(fis);
    byte[] keyBytes=new byte[(int)privateKeyFile.length()];
    dis.readFully(keyBytes);
    KeySpec keySpec=new PKCS8EncodedKeySpec(keyBytes);
    return KeyFactory.getInstance(KEY_ENCRYPTION).generatePrivate(keySpec);
  }
 catch (  FileNotFoundException e) {
    throw new IOException("Could not find private key file to use for SSL support, see nested exception.",e);
  }
 finally {
    if (dis != null) {
      try {
        dis.close();
      }
 catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
}
