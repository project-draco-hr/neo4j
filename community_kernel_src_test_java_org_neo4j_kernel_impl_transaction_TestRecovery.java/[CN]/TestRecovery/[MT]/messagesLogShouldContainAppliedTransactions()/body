{
  String path="target/test-data/recovery";
  deleteRecursively(new File(path));
  DatabaseAsSubProcess process=new ServerProcess().start(path);
  process.awaitStarted();
  int numberOfTransactions=10;
  for (int i=0; i < numberOfTransactions; i++) {
    process.createNode();
  }
  SubProcess.kill(process);
  Collection<String> toLookFor=asList("Injected one phase commit");
  assertEquals(0,countMentionsInMessagesLog(path,toLookFor));
  new EmbeddedGraphDatabase(path).shutdown();
  assertEquals(numberOfTransactions,countMentionsInMessagesLog(path,toLookFor));
}
