{
  if (buffer == null || buffer.isEmpty()) {
    return cursor;
  }
  try {
    if (buffer.contains(" ")) {
      AppCommandParser parser=new AppCommandParser((AppShellServer)client.getServer(),buffer.toString());
      App app=parser.app();
      List<String> appCandidates=app.completionCandidates(buffer,client.session());
      appCandidates=quote(appCandidates);
      if (appCandidates.size() == 1) {
        appCandidates.set(0,appCandidates.get(0) + " ");
      }
      candidates.addAll(appCandidates);
      return buffer.length() - TextUtil.lastWordOrQuoteOf(buffer,true).length();
    }
 else {
      return this.appNameCompletor.complete(buffer,cursor,candidates);
    }
  }
 catch (  ShellException e) {
    e.printStackTrace();
  }
  return cursor;
}
