{
  validateRequestType(request);
  validateResponseType(response);
  HttpServletRequest httpReq=(HttpServletRequest)request;
  String path=httpReq.getContextPath() + (httpReq.getPathInfo() == null ? "" : httpReq.getPathInfo());
  for (  UriPathWildcardMatcher uriPathWildcardMatcher : rules.keySet()) {
    if (uriPathWildcardMatcher.matches(path)) {
      HashSet<SecurityRule> securityRules=rules.get(uriPathWildcardMatcher);
      for (      SecurityRule securityRule : securityRules) {
        if (!securityRule.isAuthorized(httpReq)) {
          createUnauthorizedChallenge(response,securityRule);
          return;
        }
      }
    }
  }
  chain.doFilter(request,response);
}
