{
  for (  SecurityRule r : securityRules) {
    String rulePath=r.forUriPath();
    if (!rulePath.endsWith("*")) {
      rulePath=rulePath + "*";
    }
    UriPathWildcardMatcher uriPathWildcardMatcher=new UriPathWildcardMatcher(rulePath);
    HashSet<ForbiddingSecurityRule> ruleHashSet=rules.get(uriPathWildcardMatcher);
    if (ruleHashSet == null) {
      ruleHashSet=new HashSet<ForbiddingSecurityRule>();
      rules.put(uriPathWildcardMatcher,ruleHashSet);
    }
    ruleHashSet.add(fromSecurityRule(r));
  }
}
