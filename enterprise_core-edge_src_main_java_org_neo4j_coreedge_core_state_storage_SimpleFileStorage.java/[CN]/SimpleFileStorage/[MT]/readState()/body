{
  try (ReadableClosableChannel channel=new ReadAheadChannel<>(fileSystem.open(file,"r"))){
    return marshal.unmarshal(channel);
  }
 catch (  EndOfStreamException e) {
    log.error("End of stream reached: " + file);
    throw new IOException(e);
  }
}
