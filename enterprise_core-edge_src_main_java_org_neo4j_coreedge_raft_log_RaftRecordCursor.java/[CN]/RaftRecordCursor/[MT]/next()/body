{
  try {
    byte type=channel.get();
switch (PhysicalRaftLog.RecordType.forValue(type)) {
case APPEND:
      long appendIndex=channel.getLong();
    long term=channel.getLong();
  ReplicatedContent content=marshal.unmarshal(channel);
if (content == null) {
  return false;
}
lastFoundRecord=new RaftLogAppendRecord(appendIndex,new RaftLogEntry(term,content));
return true;
case COMMIT:
long commitIndex=channel.getLong();
lastFoundRecord=new RaftLogCommitRecord(commitIndex);
return true;
case TRUNCATE:
long truncateFromIndex=channel.getLong();
lastFoundRecord=new RaftLogTruncateRecord(truncateFromIndex);
return true;
default :
throw new IllegalStateException("Not really sure how we got here. Read type value was " + type);
}
}
 catch (ReadPastEndException notEnoughBytes) {
return false;
}
}
