{
  Path directory=roleFile.getParent();
  if (!Files.exists(directory)) {
    Files.createDirectories(directory);
  }
  Path tempFile=Files.createTempFile(directory,roleFile.getFileName().toString() + "-",".tmp");
  try {
    Files.write(tempFile,serialization.serialize(roles));
    Files.move(tempFile,roleFile,ATOMIC_MOVE,REPLACE_EXISTING);
  }
 catch (  Throwable e) {
    Files.delete(tempFile);
    throw e;
  }
}
