{
  long nextId=nextLocalId();
  if (nextId == VALUE_REPRESENTING_NULL) {
    IdAllocation allocation=acquirer.acquireIds(idType);
    log.info("Received id allocation " + allocation + " for "+ idType);
    nextId=storeLocally(allocation);
  }
  highId=max(highId,nextId + 1);
  return nextId;
}
