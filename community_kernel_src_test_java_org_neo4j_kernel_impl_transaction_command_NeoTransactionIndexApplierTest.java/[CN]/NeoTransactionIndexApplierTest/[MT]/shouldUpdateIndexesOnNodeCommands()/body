{
  final IndexTransactionApplier applier=new IndexTransactionApplier(indexingService,labelScanStore,nodeStore,propertyStore,cacheAccess,propertyLoader,transactionId,EXTERNAL);
  final NodeRecord before=new NodeRecord(11);
  final NodeRecord after=new NodeRecord(12);
  final Command.NodeCommand command=new Command.NodeCommand().init(before,after);
  final boolean result=applier.visitNodeCommand(command);
  applier.apply();
  assertFalse(result);
  final Map<Long,Command.NodeCommand> nodeCommands=Collections.singletonMap(command.getKey(),command);
  final LazyIndexUpdates expectedUpdates=new LazyIndexUpdates(nodeStore,propertyStore,emptyPropCommands,nodeCommands,propertyLoader);
  verify(indexingService,times(1)).updateIndexes(eq(expectedUpdates),eq(transactionId),eq(false));
}
