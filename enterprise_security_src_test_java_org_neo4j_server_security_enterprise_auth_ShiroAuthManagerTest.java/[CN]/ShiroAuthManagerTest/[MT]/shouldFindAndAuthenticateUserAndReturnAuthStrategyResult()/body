{
  final User user=newUser("jake","abc123",true);
  users.create(user);
  manager.start();
  when(authStrategy.isAuthenticationPermitted(user.name())).thenReturn(false);
  AuthSubject authSubject=manager.login("jake","abc123");
  AuthenticationResult result=authSubject.getAuthenticationResult();
  assertThat(result,equalTo(AuthenticationResult.TOO_MANY_ATTEMPTS));
}
