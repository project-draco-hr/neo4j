{
  ReferenceCache<TestCacheTypes.Entity> cache=new ReferenceCache<TestCacheTypes.Entity>("MyCache!",spyFactory);
  for (int i=0; i < MAX_NUM_PUT_BEFORE_POLL; i++) {
    cache.put(new TestCacheTypes.Entity(i));
  }
  for (int i=0; i < MAX_NUM_PUT_BEFORE_POLL / 2; i++) {
    spyFactory.clearAndQueueReferenceNo(i);
  }
  cache.put(new TestCacheTypes.Entity(MAX_NUM_PUT_BEFORE_POLL));
  assertEquals((MAX_NUM_PUT_BEFORE_POLL / 2) + 1,cache.size());
  for (int i=0; i < MAX_NUM_PUT_BEFORE_POLL / 2; i++) {
    assertNull(cache.get(i));
  }
}
