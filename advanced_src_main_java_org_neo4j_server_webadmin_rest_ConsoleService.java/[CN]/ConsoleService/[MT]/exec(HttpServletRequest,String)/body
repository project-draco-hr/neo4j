{
  try {
    Map<String,Object> args=jsonToMap(data);
    if (!args.containsKey("command")) {
      throw new IllegalArgumentException("Missing 'command' parameter in arguments.");
    }
    HttpSession session=req.getSession(true);
    log.info(session.toString());
    String sessionId=session.getId();
    List<String> resultLines=ConsoleSessions.getSession(sessionId).evaluate((String)args.get("command"));
    String entity=JsonHelper.createJsonFrom(resultLines);
    return addHeaders(Response.ok(entity)).build();
  }
 catch (  IllegalArgumentException e) {
    return buildExceptionResponse(Status.BAD_REQUEST,"Invalid request arguments.",e,JsonRenderers.DEFAULT);
  }
}
