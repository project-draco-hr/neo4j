{
  String hosts=config.get(HaSettings.initial_hosts);
  if (hosts.equals("")) {
    logger.logMessage("Creating cluster " + config.get(ClusterSettings.cluster_name));
    cluster.create(config.get(ClusterSettings.cluster_name));
  }
 else {
    try {
      for (      String host : hosts.split(",")) {
        if (serverId.toString().endsWith(host)) {
          continue;
        }
        logger.info("Attempting to join " + host);
        Future<ClusterConfiguration> clusterConfig=cluster.join(new URI("cluster://" + host));
        try {
          logger.info("Joined cluster:" + clusterConfig.get());
          return;
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
catch (        ExecutionException e) {
          logger.error("Could not join cluster member " + host);
        }
      }
      cluster.create(config.get(ClusterSettings.cluster_name));
    }
 catch (    URISyntaxException e) {
      e.printStackTrace();
    }
  }
}
