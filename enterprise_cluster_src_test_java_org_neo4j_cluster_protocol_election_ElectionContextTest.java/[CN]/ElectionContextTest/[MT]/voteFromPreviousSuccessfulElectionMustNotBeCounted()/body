{
  final String coordinatorRole="coordinator";
  HeartbeatContext heartbeatContext=mock(HeartbeatContext.class);
  when(heartbeatContext.getFailed()).thenReturn(Collections.<InstanceId>emptySet());
  ElectionContext context=new MultiPaxosContext(new InstanceId(1),Iterables.<ElectionRole,ElectionRole>iterable(new ElectionRole(coordinatorRole)),mock(ClusterConfiguration.class),mock(Executor.class),NullLogProvider.getInstance(),mock(ObjectInputStreamFactory.class),mock(ObjectOutputStreamFactory.class),mock(AcceptorInstanceStore.class),mock(Timeouts.class),mock(ElectionCredentialsProvider.class)).getElectionContext();
  ElectionContext.VoteRequest voteRequestBefore=context.voteRequestForRole(new ElectionRole(coordinatorRole));
  context.forgetElection(coordinatorRole);
  assertFalse(context.voted(coordinatorRole,new InstanceId(2),null,voteRequestBefore.getVersion() - 1));
}
