{
  if (log == null) {
    throw new IllegalArgumentException("log cannot be null ");
  }
  Config config=new Config();
  config.setLogger(log);
  if (configFile != null && configFile.exists()) {
    config.augment(loadFromFile(log,configFile));
  }
  config.augment(loadServerConfig(legacyConfigFile,log));
  config.augment(loadDBConfig(legacyDbTuningDefaultFile,config,log));
  overrideEmbeddedDefaults(config);
  applyUserOverrides(config,configOverrides);
  config.registerSettingsClasses(getDefaultSettingsClasses());
  return config;
}
