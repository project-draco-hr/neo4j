{
  if (startEntry == null) {
    if (logEntry == null || logEntry.getType() != LogEntry.TX_START) {
      throw new IOException("Unable to find start entry");
    }
 else {
      startEntry=(LogEntry.Start)logEntry;
    }
  }
  logEntry.setIdentifier(xidIdentifier);
  if (logEntry.getVersion() != LogEntry.CURRENT_LOG_ENTRY_VERSION) {
    if (entries == null) {
      entries=new LinkedList<>();
    }
    entries.add(logEntry);
    if ((logEntry.getType() == LogEntry.TX_1P_COMMIT || logEntry.getType() == LogEntry.TX_2P_COMMIT)) {
      entries=translator.apply(entries);
    }
    if (logEntry.getType() == LogEntry.DONE) {
      for (      LogEntry entry : entries) {
        entry.accept(handler);
      }
      entries=null;
    }
  }
 else {
    logEntry.accept(handler);
  }
  return true;
}
