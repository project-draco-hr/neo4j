{
  PropertyRecord record=propertyStore.getRecord(recordId);
  boolean changed=false;
  List<PropertyBlock> blocks=record.getPropertyBlocks();
  Iterator<PropertyBlock> it=blocks.iterator();
  while (it.hasNext()) {
    PropertyBlock block=it.next();
    if (block.getKeyIndexId() == propertyKeyId) {
      Object lastPropertyValue=propertyStore.getValue(block);
      try {
        if (!foundExact && index.contains(nodeRecord.getId(),lastPropertyValue)) {
          foundExact=true;
        }
 else {
          it.remove();
          changed=true;
        }
      }
 catch (      IOException e) {
        throw new InnerIterationIOException(e);
      }
    }
  }
  if (changed) {
    if (blocks.isEmpty()) {
      propertyRemover.fixUpPropertyLinksAroundUnusedRecord(nodeRecord,record);
    }
    propertyStore.updateRecord(record);
  }
}
