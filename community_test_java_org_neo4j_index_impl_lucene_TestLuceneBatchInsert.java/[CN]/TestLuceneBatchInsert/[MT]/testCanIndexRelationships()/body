{
  BatchInserter inserter=new BatchInserterImpl(PATH);
  BatchInserterIndexProvider indexProvider=new LuceneBatchInserterIndexProvider(inserter);
  BatchInserterIndex edgesIndex=indexProvider.relationshipIndex("edgeIndex",MapUtil.stringMap("provider","lucene","type","exact"));
  long nodeId1=inserter.createNode(MapUtil.map("ID","1"));
  long nodeId2=inserter.createNode(MapUtil.map("ID","2"));
  long relationshipId=inserter.createRelationship(nodeId1,nodeId2,EdgeType.KNOWS,null);
  edgesIndex.add(relationshipId,MapUtil.map("EDGE_TYPE",EdgeType.KNOWS.name()));
  edgesIndex.flush();
  assertEquals(String.format("Should return relationship id"),new Long(relationshipId),edgesIndex.query("EDGE_TYPE",EdgeType.KNOWS.name()).getSingle());
  indexProvider.shutdown();
  inserter.shutdown();
}
