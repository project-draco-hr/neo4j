{
  StoreFileChannel channel=mock(StoreFileChannel.class);
  FileSystemAbstraction fsa=mock(FileSystemAbstraction.class);
  when(fsa.open(any(File.class),anyString())).thenReturn(channel);
  doThrow(new IOException()).when(channel).writeAll(any(ByteBuffer.class),anyInt());
  DurableTermStore store=new DurableTermStore(fsa,new File(""));
  assertEquals(0,store.currentTerm());
  try {
    store.update(2);
    fail("Test setup should have caused an exception here");
  }
 catch (  Exception e) {
  }
  assertEquals(0,store.currentTerm());
}
