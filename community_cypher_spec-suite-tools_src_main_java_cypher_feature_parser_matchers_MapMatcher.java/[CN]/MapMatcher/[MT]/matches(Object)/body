{
  if (value instanceof Map) {
    Map realMap=(Map)value;
    Set<String> expectedKeys=map.keySet();
    Set actualKeys=realMap.keySet();
    if (expectedKeys.equals(actualKeys)) {
      for (      Map.Entry<String,ValueMatcher> entry : map.entrySet()) {
        if (!entry.getValue().matches(realMap.get(entry.getKey()))) {
          return false;
        }
      }
      return true;
    }
  }
  return false;
}
