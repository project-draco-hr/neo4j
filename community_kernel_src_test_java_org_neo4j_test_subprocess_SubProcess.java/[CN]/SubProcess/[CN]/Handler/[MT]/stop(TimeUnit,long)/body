{
  final CountDownLatch latch=new CountDownLatch(unit == null ? 0 : 1);
  Thread stopper=new Thread(){
    @Override public void run(){
      latch.countDown();
      try {
        dispatcher.stop();
      }
 catch (      RemoteException e) {
        process.destroy();
      }
    }
  }
;
  stopper.start();
  try {
    latch.await();
    timeout=System.currentTimeMillis() + (unit == null ? 0 : unit.toMillis(timeout));
    while (stopper.isAlive() && System.currentTimeMillis() < timeout) {
      Thread.sleep(1);
    }
  }
 catch (  InterruptedException e) {
  }
  if (stopper.isAlive()) {
    stopper.interrupt();
  }
  dead(this);
  return await(process);
}
