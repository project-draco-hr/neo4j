{
  File file=createBigTempFile(1);
  FileChannel channel=new BufferedFileChannel(new RandomAccessFile(file,"r").getChannel(),new Monitors().newMonitor(ByteCounterMonitor.class));
  ByteBuffer buffer=ByteBuffer.allocateDirect(15);
  int counter=0;
  int loopCounter=0;
  while (channel.read(buffer) != -1) {
    buffer.flip();
    while (buffer.hasRemaining()) {
      byte value=buffer.get();
      assertEquals(value,(byte)(counter % 10));
      counter++;
    }
    assertEquals(counter,channel.position());
    int newLimit=loopCounter % buffer.capacity();
    buffer.clear().limit(newLimit == 0 ? 1 : newLimit);
    loopCounter++;
  }
  channel.close();
  file.delete();
}
