{
  final StoreChannel rawChannel=fs.open(logFile,"r");
  final LogHeader header=readLogHeader(ByteBuffer.allocate(LOG_HEADER_SIZE),rawChannel,false,logFile);
  LogEntryReader<ReadableLogChannel> reader=readerFactory.apply(header);
  long lastCommittedTxId=Math.max(BASE_TX_ID,header.lastCommittedTxId);
  final PhysicalLogVersionedStoreChannel channel=new PhysicalLogVersionedStoreChannel(rawChannel,header.logVersion,header.logFormatVersion);
  final ReadableLogChannel readableChannel=new ReadAheadLogChannel(channel,NO_MORE_CHANNELS);
  final IOCursor<LogEntry> cursor=new LogEntrySortingCursor(reader,readableChannel);
  return Pair.of(new LogHeader(CURRENT_LOG_VERSION,header.logVersion,lastCommittedTxId),cursor);
}
