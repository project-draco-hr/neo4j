{
  HighlyAvailableGraphDatabase master=cluster.getMaster();
  createConstraint(master,LABEL,PROPERTY_KEY);
  createNode(master,LABEL).getId();
  cluster.sync();
  ClusterManager.RepairKit originalMasterRepairKit=cluster.fail(master);
  cluster.await(masterAvailable(master));
  takeTheLeadInAnEventualMasterSwitch(cluster.getMaster());
  cluster.sync();
  Thread.sleep(30000);
  originalMasterRepairKit.repair();
  cluster.await(allSeesAllAsAvailable());
  cluster.sync();
  cluster.stop();
  for (  HighlyAvailableGraphDatabase instance : cluster.getAllMembers()) {
    GraphDatabaseService db=new TestGraphDatabaseFactory().newEmbeddedDatabase(instance.getStoreDir());
    Label label=Label.label(LABEL);
    try (Transaction tx=db.beginTx()){
      Node node=db.createNode(label);
      node.setProperty(PROPERTY_KEY,PROPERTY_VALUE + "1");
      tx.success();
    }
     try (Transaction tx=db.beginTx()){
      ConstraintDefinition constraint=single(db.schema().getConstraints(label));
      constraint.drop();
      tx.success();
    }
     db.shutdown();
  }
}
