{
  final File confDir=TargetDirectory.forTest(this.getClass()).directory("confdir");
  FileUtils.forceMkdir(confDir);
  final File unwritableLogDir=createUnwritableDirectory();
  final File configFile=createConfigFile(createLogbackConfigFile(unwritableLogDir),confDir);
  server=ServerBuilder.server().withDefaultDatabaseTuning().withStartupHealthCheckRules(new HTTPLoggingPreparednessRule()).withProperty(Configurator.HTTP_LOGGING,"true").withProperty(Configurator.HTTP_LOG_CONFIG_LOCATION,configFile.getPath()).build();
  try {
    server.start();
    fail("should have thrown exception");
  }
 catch (  StartupHealthCheckFailedException e) {
    assertThat(e.getMessage(),containsString(String.format("HTTP log file [%s] does not exist",unwritableLogDir.getAbsolutePath() + File.separator + "http.log")));
  }
}
