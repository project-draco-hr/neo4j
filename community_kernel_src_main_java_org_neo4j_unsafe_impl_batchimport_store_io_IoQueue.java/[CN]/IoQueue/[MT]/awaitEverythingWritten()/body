{
  long endTime=System.currentTimeMillis() + MINUTES.toMillis(10);
  while (jobMonitor.hasActiveJobs()) {
    try {
      Thread.sleep(10);
    }
 catch (    InterruptedException e) {
      throw new RuntimeException(e);
    }
    if (System.currentTimeMillis() > endTime) {
      throw new RuntimeException("Didn't finish within designated time");
    }
  }
}
