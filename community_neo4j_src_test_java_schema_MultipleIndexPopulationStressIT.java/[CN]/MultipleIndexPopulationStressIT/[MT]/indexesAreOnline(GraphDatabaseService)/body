{
  try (Transaction tx=db.beginTx()){
    for (    IndexDefinition index : db.schema().getIndexes()) {
switch (db.schema().getIndexState(index)) {
case ONLINE:
        break;
case POPULATING:
      return false;
case FAILED:
    fail(index + " entered failed state: " + db.schema().getIndexFailure(index));
default :
  throw new UnsupportedOperationException();
}
}
tx.success();
}
 return true;
}
