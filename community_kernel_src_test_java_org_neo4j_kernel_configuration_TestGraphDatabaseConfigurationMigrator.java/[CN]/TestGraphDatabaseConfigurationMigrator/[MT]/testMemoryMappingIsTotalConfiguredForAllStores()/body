{
  ConfigurationMigrator migrator=new GraphDatabaseConfigurationMigrator();
  AssertableLogProvider logProvider=new AssertableLogProvider();
  Map<String,String> oldConfig=stringMap("neostore.nodestore.db.mapped_memory","12M","neostore.propertystore.db.mapped_memory","1G","neostore.propertystore.db.index.mapped_memory","1M","neostore.propertystore.db.index.keys.mapped_memory","13","neostore.propertystore.db.strings.mapped_memory","2","neostore.propertystore.db.arrays.mapped_memory","1","neostore.relationshipstore.db.mapped_memory","0");
  assertThat(migrator.apply(oldConfig,logProvider.getLog(getClass())).get(pagecache_memory.name()),equalTo("1074790416"));
  logProvider.assertAtLeastOnce(inLog(getClass()).warn("The neostore.*.db.mapped_memory settings have been replaced by the single 'dbms.pagecache.memory'. The sum of the old configuration will be used as the value for the new setting."));
}
