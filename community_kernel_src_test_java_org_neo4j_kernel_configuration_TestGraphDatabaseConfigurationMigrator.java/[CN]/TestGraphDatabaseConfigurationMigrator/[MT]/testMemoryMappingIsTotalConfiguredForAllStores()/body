{
  ConfigurationMigrator migrator=new GraphDatabaseConfigurationMigrator();
  TestLogger log=new TestLogger();
  Map<String,String> oldConfig=stringMap("neostore.nodestore.db.mapped_memory","12M","neostore.propertystore.db.mapped_memory","1G","neostore.propertystore.db.index.mapped_memory","1M","neostore.propertystore.db.index.keys.mapped_memory","13","neostore.propertystore.db.strings.mapped_memory","2","neostore.propertystore.db.arrays.mapped_memory","1","neostore.relationshipstore.db.mapped_memory","0");
  assertThat(migrator.apply(oldConfig,log).get(mapped_memory_total_size.name()),equalTo("1074790416"));
  log.assertAtLeastOnce(warn("The neostore.*.db.mapped_memory settings have been replaced by the single 'mapped_memory_total_size'. The sum of the old configuration will be used as the value for the new setting."));
}
