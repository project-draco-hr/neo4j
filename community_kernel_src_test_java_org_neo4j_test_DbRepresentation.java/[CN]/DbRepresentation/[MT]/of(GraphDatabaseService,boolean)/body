{
  Transaction tx=db.beginTx();
  try {
    DbRepresentation result=new DbRepresentation();
    for (    Node node : GlobalGraphOperations.at(db).getAllNodes()) {
      NodeRep nodeRep=new NodeRep(db,node,includeIndexes);
      result.nodes.put(node.getId(),nodeRep);
      result.highestNodeId=Math.max(node.getId(),result.highestNodeId);
      result.highestRelationshipId=Math.max(nodeRep.highestRelationshipId,result.highestRelationshipId);
    }
    return result;
  }
  finally {
    tx.finish();
  }
}
