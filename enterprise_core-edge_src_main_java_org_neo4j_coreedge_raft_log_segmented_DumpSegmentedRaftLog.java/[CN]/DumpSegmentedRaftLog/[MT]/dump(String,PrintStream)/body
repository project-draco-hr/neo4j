{
  LogProvider logProvider=NullLogProvider.getInstance();
  int logsFound=0;
  RecoveryProtocol recoveryProtocol=new RecoveryProtocol(fileSystem,new FileNames(new File(filenameOrDirectory)),marshal,logProvider);
  Segments segments=recoveryProtocol.run().segments;
  ListIterator<SegmentFile> segmentFileIterator=segments.getSegmentFileIteratorAtStart();
  SegmentFile currentSegmentFile;
  while (segmentFileIterator.hasNext()) {
    currentSegmentFile=segmentFileIterator.next();
    logsFound++;
    out.println("=== " + currentSegmentFile.getFilename() + " ===");
    SegmentHeader header=currentSegmentFile.header();
    out.println(header.toString());
    try (IOCursor<EntryRecord> cursor=currentSegmentFile.getReader(header.prevIndex() + 1)){
      while (cursor.next()) {
        out.println(cursor.get().toString());
      }
    }
   }
  return logsFound;
}
