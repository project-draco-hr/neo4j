{
  if (globalId == null || branchId == null) {
    throw new IllegalArgumentException("Null parameter, globalId=" + globalId + ", branchId= "+ branchId);
  }
  buffer.clear();
  buffer.put(BRANCH_ADD).put((byte)globalId.length).put((byte)branchId.length).put(globalId).put(branchId);
  buffer.flip();
  fileChannel.write(buffer);
  recordCount++;
}
