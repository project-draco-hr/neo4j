{
  if (globalId == null) {
    throw new IllegalArgumentException("Null global id");
  }
  if (branchId == null) {
    throw new IllegalArgumentException("Null branch id");
  }
  buffer.clear();
  buffer.put(BRANCH_ADD).put((byte)globalId.length).put((byte)branchId.length).put(globalId).put(branchId);
  buffer.flip();
  fileChannel.write(buffer);
  recordCount++;
}
