{
  NodePropertyUpdate update=NodePropertyUpdate.add(1,1,"foo",new long[]{1});
  IndexStoreView storeView=newStoreView(update);
  ExecutorService executor=mock(ExecutorService.class);
  when(executor.awaitTermination(anyLong(),any())).thenReturn(true);
  BatchingMultipleIndexPopulator batchingPopulator=new BatchingMultipleIndexPopulator(storeView,executor,NullLogProvider.getInstance());
  StoreScan<IndexPopulationFailedKernelException> storeScan=batchingPopulator.indexAllNodes();
  verify(executor,never()).shutdown();
  storeScan.run();
  verify(executor).shutdown();
  verify(executor).awaitTermination(anyLong(),any());
}
