{
  if (buffer.remaining() < 2) {
    return 0;
  }
  byte globalId[]=new byte[buffer.get()];
  byte branchId[]=new byte[buffer.get()];
  if (buffer.remaining() < globalId.length + branchId.length) {
    return 0;
  }
  buffer.get(globalId);
  buffer.get(branchId);
  Xid xid=new XidImpl(globalId,new byte[0]);
  if (!recordMap.containsKey(xid)) {
    throw new IOException(String.format("Branch[%s] found for [%s] but no record list found in map",UTF8.decode(branchId),xid));
  }
  recordMap.get(xid).add(new Record(BRANCH_ADD,globalId,branchId,seqNr));
  return 3 + globalId.length + branchId.length;
}
