{
  assertNotNull(globalId,"global id");
  if (!activeTransactions.remove(new ByteArrayKey(globalId))) {
    throw new IllegalStateException("Global ID " + Arrays.toString(globalId) + " not active");
  }
  byte globalIdSize=(byte)globalId.length;
  logBuffer.put(TX_DONE).put(globalIdSize).put(globalId);
  recordCount++;
}
