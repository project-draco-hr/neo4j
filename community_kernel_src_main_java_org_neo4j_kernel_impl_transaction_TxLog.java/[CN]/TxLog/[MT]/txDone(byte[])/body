{
  assertNotNull(globalId,"global id");
  if (!activeTransactions.remove(new ByteArrayKey(globalId)))   throw new IllegalStateException("Global ID " + Arrays.toString(globalId) + " not active");
  logBuffer.put(TX_DONE).put((byte)globalId.length).put(globalId);
  recordCount++;
}
