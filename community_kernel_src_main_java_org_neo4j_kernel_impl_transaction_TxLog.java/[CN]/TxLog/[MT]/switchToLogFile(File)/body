{
  if (newFile == null) {
    throw new IllegalArgumentException("Null filename");
  }
  force();
  Iterable<List<Record>> itr=getDanglingRecords();
  close();
  List<Record> records=new ArrayList<>();
  for (  List<Record> tx : itr) {
    records.addAll(tx);
  }
  Collections.sort(records,new Comparator<Record>(){
    @Override public int compare(    Record r1,    Record r2){
      return r1.getSequenceNumber() - r2.getSequenceNumber();
    }
  }
);
  Iterator<Record> recordItr=records.iterator();
  FileChannel fileChannel=fileSystem.open(newFile,"rw");
  fileChannel.position(fileChannel.size());
  logBuffer=new DirectMappedLogBuffer(fileChannel,bufferMonitor);
  name=newFile;
  truncate();
  while (recordItr.hasNext()) {
    Record record=recordItr.next();
    writeRecord(record,ForceMode.forced);
  }
  force();
}
