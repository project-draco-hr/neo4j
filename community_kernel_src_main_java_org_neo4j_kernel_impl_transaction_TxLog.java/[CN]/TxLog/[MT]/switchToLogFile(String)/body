{
  if (newFile == null) {
    throw new IllegalArgumentException("Null filename");
  }
  force();
  Iterator<List<Record>> itr=getDanglingRecords();
  close();
  List<Record> records=new ArrayList<Record>();
  while (itr.hasNext()) {
    records.addAll(itr.next());
  }
  Collections.sort(records,new Comparator<Record>(){
    public int compare(    Record r1,    Record r2){
      return r1.getSequenceNumber() - r2.getSequenceNumber();
    }
  }
);
  Iterator<Record> recordItr=records.iterator();
  FileChannel fileChannel=new RandomAccessFile(newFile,"rw").getChannel();
  fileChannel.position(fileChannel.size());
  logBuffer=new DirectMappedLogBuffer(fileChannel);
  name=newFile;
  truncate();
  while (recordItr.hasNext()) {
    Record record=recordItr.next();
    writeRecord(record);
  }
  force();
}
