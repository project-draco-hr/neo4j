{
  if (fileName == null) {
    throw new IllegalArgumentException("Null filename");
  }
  this.fileSystem=fileSystem;
  this.msgLog=msgLog;
  FileChannel fileChannel=fileSystem.open(fileName,"rw");
  fileChannel.position(fileChannel.size());
  logBuffer=new DirectMappedLogBuffer(fileChannel);
  this.name=fileName;
}
