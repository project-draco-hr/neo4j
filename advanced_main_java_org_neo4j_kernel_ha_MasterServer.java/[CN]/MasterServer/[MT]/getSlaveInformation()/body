{
  Set<Integer> machineIds=new HashSet<Integer>();
synchronized (connectedSlaveChannels) {
    for (    Collection<SlaveContext> contextSet : this.connectedSlaveChannels.values()) {
      for (      SlaveContext context : contextSet) {
        machineIds.add(context.machineId());
      }
    }
  }
  Map<Integer,Collection<SlaveContext>> ongoingTransactions=((MasterImpl)realMaster).getOngoingTransactions();
  for (  Integer machineId : machineIds) {
    if (!ongoingTransactions.containsKey(machineId)) {
      ongoingTransactions.put(machineId,Collections.<SlaveContext>emptyList());
    }
  }
  return new TreeMap<Integer,Collection<SlaveContext>>(ongoingTransactions);
}
