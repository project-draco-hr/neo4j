{
  ByteBuf transactionBuffer=Unpooled.buffer();
  NetworkFlushableChannelNetty4 channel=new NetworkFlushableChannelNetty4(transactionBuffer);
  try {
    TransactionSerializer.write(tx,channel);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
  byte[] txBytes=Arrays.copyOf(transactionBuffer.array(),transactionBuffer.writerIndex());
  transactionBuffer.release();
  return new ReplicatedTransaction(txBytes);
}
