{
  boolean result=false;
  for (int port=ports[0]; port <= ports[1]; port++) {
    if (port == toMatch.getPort()) {
      result=true;
      break;
    }
  }
  if (host == null && toMatch.getHost() == null) {
    return result;
  }
 else   if (host == null) {
    return false;
  }
  String toMatchHost=toMatch.getHost();
  return result && (host.equalsIgnoreCase(toMatchHost) || getHost(null).equalsIgnoreCase(getHostAddress(toMatchHost,toMatchHost)));
}
