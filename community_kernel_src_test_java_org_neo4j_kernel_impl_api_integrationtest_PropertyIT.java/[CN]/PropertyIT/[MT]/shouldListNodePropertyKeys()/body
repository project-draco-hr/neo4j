{
  newTransaction();
  Node node=db.createNode();
  node.setProperty("prop","value");
  assertThat(asSet(statement.nodeGetPropertyKeys(getState(),node.getId())),equalTo(asSet(statement.propertyKeyGetForName(getState(),"prop"))));
  commit();
  newTransaction();
  assertThat(asSet(statement.nodeGetPropertyKeys(getState(),node.getId())),equalTo(asSet(statement.propertyKeyGetForName(getState(),"prop"))));
  commit();
  newTransaction();
  node.removeProperty("prop");
  assertThat(asSet(statement.nodeGetPropertyKeys(getState(),node.getId())),equalTo(Collections.<Long>emptySet()));
  commit();
  newTransaction();
  assertThat(asSet(statement.nodeGetPropertyKeys(getState(),node.getId())),equalTo(Collections.<Long>emptySet()));
  commit();
}
