{
  long propertyKeyId;
  long nodeId;
{
    DataStatement statement=dataStatementInNewTransaction();
    Node node=db.createNode();
    propertyKeyId=statement.propertyKeyGetOrCreateForName("clown");
    nodeId=node.getId();
    statement.nodeSetProperty(nodeId,Property.stringProperty(propertyKeyId,"bozo"));
    commit();
  }
{
    DataStatement statement=dataStatementInNewTransaction();
    Object previous=statement.nodeRemoveProperty(nodeId,propertyKeyId).value();
    assertEquals("bozo",previous);
    assertFalse("node should not have property",statement.nodeHasProperty(nodeId,propertyKeyId));
    commit();
  }
{
    DataStatement statement=dataStatementInNewTransaction();
    assertFalse(statement.nodeHasProperty(nodeId,propertyKeyId));
  }
}
