{
  RequestContext.Tx[] oldTxs=original.lastAppliedTransaction();
  RequestContext.Tx[] newTxs=new RequestContext.Tx[oldTxs.length];
  for (int i=0; i < oldTxs.length; i++) {
    RequestContext.Tx oldTx=oldTxs[i];
    String dsName=oldTx.getDataSourceName();
    long originalTxId=oldTx.getTxId();
    Long diff=diffPerDataSource.get(dsName);
    if (diff == null) {
      diff=0L;
    }
    long newTxId=originalTxId + diff;
    newTxs[i]=RequestContext.lastAppliedTx(dsName,newTxId);
  }
  return RequestContext.anonymous(newTxs);
}
