{
  Set<Member> coreMembers=emptySet();
  boolean attemptedConnection=false;
  while (coreMembers.isEmpty() && !attemptedConnection) {
    if (hazelcastInstance == null) {
      try {
        attemptedConnection=true;
        hazelcastInstance=connector.connectToHazelcast();
      }
 catch (      IllegalStateException e) {
        log.info("Unable to connect to core cluster");
        break;
      }
    }
    try {
      coreMembers=hazelcastInstance.getCluster().getMembers();
    }
 catch (    HazelcastInstanceNotActiveException e) {
      hazelcastInstance=null;
    }
  }
  Set<BoltAddress> edgeMembers=edgeMembers(hazelcastInstance);
  return new HazelcastClusterTopology(coreMembers,edgeMembers);
}
