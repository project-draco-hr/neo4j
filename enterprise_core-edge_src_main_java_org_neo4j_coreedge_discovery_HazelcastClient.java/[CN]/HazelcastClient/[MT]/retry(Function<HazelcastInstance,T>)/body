{
  boolean attemptedConnection=false;
  RuntimeException exception=null;
  while (!attemptedConnection) {
    if (hazelcastInstance == null) {
      try {
        attemptedConnection=true;
        hazelcastInstance=connector.connectToHazelcast();
      }
 catch (      IllegalStateException e) {
        log.info("Unable to connect to core cluster");
        break;
      }
    }
    try {
      return hazelcastAccessor.apply(hazelcastInstance);
    }
 catch (    HazelcastInstanceNotActiveException e) {
      hazelcastInstance=null;
      exception=e;
    }
  }
  throw exception;
}
