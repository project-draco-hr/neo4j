{
  CountsSnapshot countsSnapshot=countStore.snapshot(txId);
  Map<CountsKey,long[]> snapshotMap=countsSnapshot.getMap();
  Map<CountsKey,long[]> expectedMap=intermediateStateTestManager.getIntermediateMap((int)countsSnapshot.getTxId());
  Assert.assertTrue("Counts store snapshot was recorded with transaction ID less than the requested value.",countsSnapshot.getTxId() >= txId);
  Assert.assertEquals("Counts store snapshot has an incorrect number of k/v pairs.",snapshotMap.size(),expectedMap.size());
  compareMaps(expectedMap,snapshotMap);
}
