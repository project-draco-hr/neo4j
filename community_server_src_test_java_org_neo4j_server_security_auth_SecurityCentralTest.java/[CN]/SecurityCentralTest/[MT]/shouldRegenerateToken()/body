{
  SecurityCentral security=new SecurityCentral(new FakeClock(),new InMemoryUserRepository());
  security.newUser("neo4j","neo4j",true,Privileges.ADMIN);
  String oldToken=security.userForName("neo4j").token();
  security.userForToken(oldToken);
  User updatedUser=security.regenerateToken("neo4j");
  assertThat(security.userForName("neo4j").token(),equalTo(updatedUser.token()));
  assertThat(security.userForToken(updatedUser.token()).name(),equalTo("neo4j"));
  assertThat(security.userForToken(oldToken).name(),equalTo(SecurityCentral.UNAUTHENTICATED.name()));
}
