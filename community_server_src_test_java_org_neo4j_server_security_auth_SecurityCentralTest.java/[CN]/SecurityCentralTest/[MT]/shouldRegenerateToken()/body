{
  SecurityCentral security=new SecurityCentral(new FakeClock(),new InMemoryUserRepository());
  security.newUser("neo4j",Privileges.ADMIN);
  String oldToken=security.userForName("neo4j").token();
  security.userForToken(oldToken);
  String newToken=security.regenerateToken("neo4j");
  assertThat(security.userForName("neo4j").token(),equalTo(newToken));
  assertThat(security.userForToken(newToken).name(),equalTo("neo4j"));
  assertThat(security.userForToken(oldToken).name(),equalTo(SecurityCentral.UNAUTHENTICATED.name()));
}
