{
  RandomAccessFile file=new RandomAccessFile(new File(storeDir,"nioneo_logical.log.v0"),"r");
  ByteBuffer buffer=allocate(10000);
  XaCommandReader reader=new PhysicalLogNeoXaCommandReader(buffer);
  try {
    FileChannel channel=file.getChannel();
    readLogHeader(buffer,channel,true);
    long lastOne=-1;
    int counted=0;
    for (LogEntry entry; (entry=readEntry(buffer,channel,reader)) != null; ) {
      if (entry instanceof TwoPhaseCommit) {
        long txId=((TwoPhaseCommit)entry).getTxId();
        if (lastOne != -1) {
          assertEquals(lastOne + 1,txId);
        }
        lastOne=txId;
        counted++;
      }
    }
    assertEquals(expectedCount,counted);
  }
  finally {
    file.close();
  }
}
