{
  try (NodePropertyCommandsExtractor extractor=new NodePropertyCommandsExtractor()){
    try (TransactionApplier txApplier=extractor.startTx(new TransactionToApply(transaction))){
      transaction.accept(txApplier);
    }
 catch (    IOException cause) {
      databaseHealth.panic(cause);
      throw cause;
    }
    if (!extractor.containsAnyNodeOrPropertyUpdate()) {
      return ValidatedIndexUpdates.NONE;
    }
    Iterable<NodePropertyUpdate> updates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,extractor.propertyCommandsByNodeIds,extractor.nodeCommandsById);
    return indexing.validate(updates,updateMode);
  }
 catch (  Exception cause) {
    databaseHealth.panic(cause);
    throw new IOException(cause);
  }
}
