{
  return new TypeSafeDiagnosingMatcher<Neo4jMatchers.Deferred<IndexDefinition>>(){
    @Override protected boolean matchesSafely(    Neo4jMatchers.Deferred<IndexDefinition> indexes,    Description description){
      for (      IndexDefinition current : indexes.collection()) {
        Schema.IndexState currentState=db.schema().getIndexState(current);
        if (!currentState.equals(expectedState)) {
          description.appendValue(current).appendText(" has state ").appendValue(currentState);
          return false;
        }
      }
      return true;
    }
    @Override public void describeTo(    Description description){
      description.appendText("all indexes have state " + expectedState);
    }
  }
;
}
