{
  client.connect(address).send(TransportTestUtil.acceptedVersions(1,0,0,0)).send(TransportTestUtil.chunk(init("TestClient/1.1",emptyMap()),run("RETURN 1 AS n"),reset(),run("UNWIND [1,2,3] AS a RETURN a, a * a AS a_squared"),pullAll()));
  assertThat(client,eventuallyRecieves(new byte[]{0,0,0,1}));
  assertThat(client,eventuallyRecieves(msgSuccess(),msgSuccess(map("fields",asList("n"))),msgSuccess(),msgSuccess(map("fields",asList("a","a_squared"))),msgRecord(eqRecord(equalTo(1l),equalTo(1l))),msgRecord(eqRecord(equalTo(2l),equalTo(4l))),msgRecord(eqRecord(equalTo(3l),equalTo(9l))),msgSuccess()));
}
