{
  client.connect(address).send(TransportTestUtil.acceptedVersions(1,0,0,0)).send(TransportTestUtil.chunk(init("TestClient/1.1",emptyMap()),run("CREATE (n:Test {age: 2}) RETURN n.age AS age"),pullAll()));
  assertThat(client,eventuallyReceives(new byte[]{0,0,0,1}));
  assertThat(client,TransportTestUtil.eventuallyReceives(msgSuccess(),msgSuccess(allOf(hasEntry(is("fields"),equalTo(singletonList("age"))),hasKey("result_available_after"))),msgRecord(eqRecord(equalTo(2L))),msgSuccess()));
  client.send(TransportTestUtil.chunk(run("CALL db.labels() YIELD label"),pullAll()));
  assertThat(client,TransportTestUtil.eventuallyReceives(msgSuccess(allOf(hasEntry(is("fields"),equalTo(singletonList("label"))),hasKey("result_available_after"))),msgRecord(eqRecord(Matchers.equalTo("Test"))),msgSuccess()));
}
