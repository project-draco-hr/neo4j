{
  NodeImpl nodeImpl=new NodeImpl(1337l);
  RelationshipLoader loader=mock(RelationshipLoader.class);
  CacheUpdateListener cacheUpdateListener=mock(CacheUpdateListener.class);
  when(loader.getRelationshipChainPosition(anyLong())).thenReturn(new SingleChainPosition(1));
  when(loader.getMoreRelationships(any(NodeImpl.class),any(DirectionWrapper.class),any(int[].class))).thenThrow(new InvalidRecordException("LURING!"));
  try {
    nodeImpl.getAllRelationships(loader,RelIdArray.DirectionWrapper.BOTH,cacheUpdateListener);
    fail("Should throw exception");
  }
 catch (  NotFoundException e) {
  }
}
