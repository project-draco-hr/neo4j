{
  BasicAuthManager manager=mock(BasicAuthManager.class);
  BasicAuthentication authentication=new BasicAuthentication(manager,mock(LogProvider.class));
  when(manager.authenticate(anyString(),anyString())).thenReturn(AuthenticationResult.SUCCESS);
  exception.expect(AuthenticationException.class);
  exception.expect(hasStatus(Status.Security.AuthenticationFailed));
  exception.expectMessage("Authorization token must contain: 'scheme : basic'");
  authentication.authenticate(map("scheme","UNKNOWN","principal","bob","credentials","secret"));
}
