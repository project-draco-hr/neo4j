{
  int originalCount=eagerlyCount(server.getDatabase().graph.getAllNodes());
  originalCount--;
  ClientResponse response=CLIENT.resource(functionalTestHelper.dataUri() + "node/1").accept(MediaType.APPLICATION_JSON).get(ClientResponse.class);
  String entity=response.getEntity(String.class);
  Map<String,Object> map=JsonHelper.jsonToMap(entity);
  HashMap<?,?> extensionsMap=(HashMap<?,?>)map.get("extensions");
  assertNotNull(extensionsMap);
  assertFalse(extensionsMap.isEmpty());
  final String GRAPH_CLONER_KEY="GraphCloner";
  assertTrue(extensionsMap.keySet().contains(GRAPH_CLONER_KEY));
  final String CLONE_SUBGRAPH_KEY="clonedSubgraph";
  String clonedSubgraphUri=(String)((HashMap<?,?>)extensionsMap.get(GRAPH_CLONER_KEY)).get(CLONE_SUBGRAPH_KEY);
  assertNotNull(clonedSubgraphUri);
  final String CLONE_DEPTH_MUCH_LARGER_THAN_THE_GRAPH="99";
  response.close();
  response=CLIENT.resource(clonedSubgraphUri).type(MediaType.APPLICATION_FORM_URLENCODED).entity("depth=" + CLONE_DEPTH_MUCH_LARGER_THAN_THE_GRAPH).post(ClientResponse.class);
  assertEquals(200,response.getStatus());
  int doubleTheNumberOfNodes=(originalCount * 2) + 1;
  assertEquals(doubleTheNumberOfNodes,eagerlyCount(server.getDatabase().graph.getAllNodes()));
  response.close();
}
