{
  NeoStoreDataSource dataSource=getDataSource();
  LabelScanStore labelScanStore=dataSource.getLabelScanStore();
  Node node=createTestNode();
  List<Long> labels=readNodeLabels(labelScanStore,node);
  assertEquals("Label scan store see 1 label for node",1,labels.size());
  labelScanStore.force();
  labelScanStore.shutdown();
  corruptIndex(dataSource);
  labelScanStore.init();
  labelScanStore.start();
  List<Long> rebuildLabels=readNodeLabels(labelScanStore,node);
  assertEquals("Store should rebuild corrupted index",labels,rebuildLabels);
}
