{
  try {
    final StreamingOutput stream=new StreamingOutput(){
      public void write(      final OutputStream output) throws IOException, WebApplicationException {
        Transaction tx=database.getGraph().beginTx();
        try {
          final ServletOutputStream servletOutputStream=new ServletOutputStream(){
            public void write(            int i) throws IOException {
              output.write(i);
            }
          }
;
          new StreamingBatchOperations(webServer).readAndExecuteOperations(uriInfo,httpHeaders,body,servletOutputStream);
          tx.success();
        }
 catch (        Exception e) {
          Log.warn("Error executing batch request ",e);
          tx.failure();
        }
 finally {
          tx.finish();
        }
      }
    }
;
    return Response.ok(stream).type(HttpHeaderUtils.mediaTypeWithCharsetUtf8(MediaType.APPLICATION_JSON_TYPE)).build();
  }
 catch (  Exception e) {
    return output.serverError(e);
  }
}
