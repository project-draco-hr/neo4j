{
  GraphDatabaseService graphDb=db.getGraphDatabaseService();
  Relationship rel;
  try (Transaction tx=graphDb.beginTx()){
    Node node=graphDb.createNode();
    node.createRelationshipTo(graphDb.createNode(),withName("KNOWS"));
    rel=node.createRelationshipTo(graphDb.createNode(),withName("KNOWS"));
    node.createRelationshipTo(graphDb.createNode(),withName("KNOWS"));
    tx.success();
  }
   long before=numberOfRelationships(), during;
  try (Transaction tx=graphDb.beginTx()){
    rel.delete();
    during=countsForRelationship(null,null,null);
    tx.success();
  }
   long after=numberOfRelationships();
  assertEquals(3,before);
  assertEquals(2,during);
  assertEquals(2,after);
}
