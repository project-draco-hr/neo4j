{
  DirectoryFactory dirFactory=mock(DirectoryFactory.class);
  FileNotFoundException toThrow=new FileNotFoundException("/some/path/somewhere");
  when(dirFactory.open(any(File.class))).thenThrow(toThrow);
  LuceneSchemaIndexProvider p=new LuceneSchemaIndexProvider(dirFactory,forTest(getClass()).makeGraphDbDir());
  InternalIndexState initialState=p.getInitialState(1l);
  assertThat(initialState,equalTo(InternalIndexState.FAILED));
  assertThat(p.getPopulationFailure(1l),equalTo("File not found: " + toThrow.getMessage()));
}
