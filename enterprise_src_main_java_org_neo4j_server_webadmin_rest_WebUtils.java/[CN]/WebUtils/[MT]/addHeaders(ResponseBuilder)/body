{
  String entity=(String)builder.clone().build().getEntity();
  if (entity != null) {
    byte[] entityAsBytes;
    try {
      entityAsBytes=entity.getBytes(UTF8);
    }
 catch (    UnsupportedEncodingException e) {
      throw new RuntimeException("Could not encode string as UTF-8",e);
    }
    builder=builder.entity(entityAsBytes);
    builder=builder.header(HttpHeaders.CONTENT_LENGTH,String.valueOf(entityAsBytes.length));
    builder=builder.header(HttpHeaders.CONTENT_ENCODING,UTF8);
  }
  return builder;
}
