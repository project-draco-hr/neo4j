{
  if (nodeRecord.inUse()) {
    long[] expectedLabels=record.getNodeLabelRange().labels(nodeRecord.getId());
    NodeLabels nodeLabels=NodeLabelsField.parseLabelsField(nodeRecord);
    if (nodeLabels instanceof DynamicNodeLabels) {
      DynamicNodeLabels dynamicNodeLabels=(DynamicNodeLabels)nodeLabels;
      long firstRecordId=dynamicNodeLabels.getFirstDynamicRecordId();
      RecordReference<DynamicRecord> firstRecordReference=records.nodeLabels(firstRecordId);
      engine.comparativeCheck(firstRecordReference,new LabelChainWalker<LabelScanDocument,ConsistencyReport.LabelScanConsistencyReport>(new ExpectedNodeLabelsChecker(nodeRecord,expectedLabels)));
      nodeRecord.getDynamicLabelRecords();
    }
 else {
      long[] actualLabels=nodeLabels.get(null);
      ConsistencyReport.LabelScanConsistencyReport report=engine.report();
      validateLabelIds(nodeRecord,expectedLabels,actualLabels,report);
    }
  }
 else {
    engine.report().nodeNotInUse(nodeRecord);
  }
}
