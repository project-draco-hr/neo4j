{
  final NeoTransactionStoreApplier applier=newApplier(true);
  final PropertyKeyTokenRecord record=new PropertyKeyTokenRecord(42);
  final Command.PropertyKeyTokenCommand command=new Command.PropertyKeyTokenCommand().init(record);
  final Token token=new Token("token",21);
  when(propertyKeyTokenStore.getToken((int)command.getKey())).thenReturn(token);
  final boolean result=applier.visitPropertyKeyTokenCommand(command);
  applyAndClose(applier);
  assertTrue(result);
  verify(propertyKeyTokenStore,times(1)).setHighestPossibleIdInUse(record.getId());
  verify(propertyKeyTokenStore,times(1)).updateRecord(record);
  verify(cacheAccess,times(1)).addPropertyKeyToken(token);
}
