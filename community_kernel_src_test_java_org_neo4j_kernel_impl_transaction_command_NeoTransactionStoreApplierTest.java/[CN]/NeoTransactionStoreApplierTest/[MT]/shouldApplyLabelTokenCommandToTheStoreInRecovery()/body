{
  final NeoCommandHandler applier=newApplier(true);
  final LabelTokenRecord record=new LabelTokenRecord(42);
  final Command.LabelTokenCommand command=(LabelTokenCommand)new Command.LabelTokenCommand().init(record);
  final Token token=new Token("token",21);
  when(labelTokenStore.getToken((int)command.getKey())).thenReturn(token);
  final boolean result=applier.visitLabelTokenCommand(command);
  applyAndClose(applier);
  assertTrue(result);
  verify(labelTokenStore,times(1)).setHighestPossibleIdInUse(record.getId());
  verify(labelTokenStore,times(1)).updateRecord(record);
  verify(cacheAccess,times(1)).addLabelToken(token);
}
