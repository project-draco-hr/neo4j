{
  super("lucene");
  this.graphDb=graphDb;
  Config config=getGraphDbConfig();
  TxModule txModule=config.getTxModule();
  boolean isReadOnly=isReadOnly(graphDb);
  Map<Object,Object> params=new HashMap<Object,Object>(config.getParams());
  params.put("read_only",isReadOnly);
  params.put("index_config",new HashMap<String,Map<String,String>>());
  dataSource=(LuceneDataSource)txModule.registerDataSource(DATA_SOURCE_NAME,LuceneDataSource.class.getName(),LuceneDataSource.DEFAULT_BRANCH_ID,params,true);
  broker=isReadOnly ? new ReadOnlyConnectionBroker(txModule.getTxManager(),dataSource) : new ConnectionBroker(txModule.getTxManager(),dataSource);
}
