{
  IndexIdentifier identifier=new IndexIdentifier(LuceneCommand.NODE,dataSource.nodeEntityType,indexName,config);
synchronized (dataSource.indexes) {
    LuceneIndex index=dataSource.indexes.get(identifier);
    if (index == null) {
      index=new LuceneIndex.NodeIndex(this,identifier);
      dataSource.indexes.put(identifier,index);
    }
    index.setIdentifier(identifier);
    return index;
  }
}
