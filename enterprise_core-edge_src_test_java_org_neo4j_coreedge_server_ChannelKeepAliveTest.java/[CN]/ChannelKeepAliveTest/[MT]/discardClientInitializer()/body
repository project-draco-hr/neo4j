{
  ChannelInitializer<SocketChannel> channelInitializer=new ChannelInitializer<SocketChannel>(){
    @Override protected void initChannel(    SocketChannel channel) throws Exception {
      final SimpleChannelInboundHandler<ByteBuf> clientHandler=new SimpleChannelInboundHandler<ByteBuf>(){
        @Override protected void channelRead0(        ChannelHandlerContext ctx,        ByteBuf msg) throws Exception {
          int size=msg.readInt();
          byte[] bytes=new byte[size];
          msg.readBytes(bytes);
        }
      }
;
      ChannelPipeline pipeline=channel.pipeline();
      pipeline.addLast(new LengthFieldBasedFrameDecoder(Integer.MAX_VALUE,0,4,0,4));
      pipeline.addLast(clientHandler);
    }
  }
;
  return channelInitializer;
}
