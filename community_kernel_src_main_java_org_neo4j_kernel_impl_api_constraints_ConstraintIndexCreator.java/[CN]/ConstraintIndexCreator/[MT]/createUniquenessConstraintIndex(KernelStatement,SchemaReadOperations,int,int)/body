{
  IndexDescriptor descriptor=transactor.execute(createConstraintIndex(labelId,propertyKeyId));
  UniquenessConstraint constraint=new UniquenessConstraint(labelId,propertyKeyId);
  try {
    long indexId=schema.indexGetCommittedId(state,descriptor);
    awaitIndexPopulation(constraint,indexId);
    return indexId;
  }
 catch (  SchemaRuleNotFoundException e) {
    throw new IllegalStateException(String.format("Index (%s) that we just created does not exist.",descriptor));
  }
catch (  InterruptedException e) {
    Thread.interrupted();
    throw new CreateConstraintFailureException(constraint,e);
  }
}
