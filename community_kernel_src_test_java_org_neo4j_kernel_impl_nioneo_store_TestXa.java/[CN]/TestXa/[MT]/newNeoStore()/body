{
  final Config config=new Config(MapUtil.stringMap(InternalAbstractGraphDatabase.Configuration.store_dir.name(),path().getPath(),InternalAbstractGraphDatabase.Configuration.neo_store.name(),file("neo").getPath(),InternalAbstractGraphDatabase.Configuration.logical_log.name(),file(LOGICAL_LOG_DEFAULT_NAME).getPath()),GraphDatabaseSettings.class);
  StoreFactory sf=new StoreFactory(config,new DefaultIdGeneratorFactory(),new DefaultWindowPoolFactory(),fileSystem,StringLogger.DEV_NULL,null);
  PlaceboTm txManager=new PlaceboTm(lockManager,TxIdGenerator.DEFAULT);
  for (  File file : fileSystem.listFiles(path())) {
    if (file.isFile() && file.getName().startsWith(LOGICAL_LOG_DEFAULT_NAME + ".v")) {
      fileSystem.deleteFile(file);
    }
  }
  KernelHealth kernelHealth=mock(KernelHealth.class);
  NeoStoreXaDataSource neoStoreXaDataSource=new NeoStoreXaDataSource(config,sf,lockManager,StringLogger.DEV_NULL,new XaFactory(config,TxIdGenerator.DEFAULT,txManager,fileSystem,new Monitors(),new DevNullLoggingService(),RecoveryVerifier.ALWAYS_VALID,LogPruneStrategies.NO_PRUNING,kernelHealth),TransactionStateFactory.noStateFactory(new DevNullLoggingService()),new TransactionInterceptorProviders(Collections.<TransactionInterceptorProvider>emptyList(),new DependencyResolver.Adapter(){
    @Override public <T>T resolveDependency(    Class<T> type,    SelectionStrategy selector){
      return (T)config;
    }
  }
),null);
  neoStoreXaDataSource.start();
  return neoStoreXaDataSource;
}
