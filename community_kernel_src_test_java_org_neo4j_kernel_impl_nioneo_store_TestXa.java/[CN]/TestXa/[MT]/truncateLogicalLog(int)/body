{
  StoreChannel af=fileSystem.open(new File(logBaseFileName.getPath() + ".active"),"r");
  ByteBuffer buffer=ByteBuffer.allocate(1024);
  af.read(buffer);
  af.close();
  buffer.flip();
  char active=buffer.asCharBuffer().get();
  buffer.clear();
  StoreChannel fileChannel=fileSystem.open(new File(logBaseFileName.getPath() + "." + active),"rw");
  if (fileChannel.size() > size) {
    fileChannel.truncate(size);
  }
 else {
    fileChannel.position(size);
    ByteBuffer buf=ByteBuffer.allocate(1);
    buf.put((byte)0).flip();
    fileChannel.write(buf);
  }
  fileChannel.force(false);
  fileChannel.close();
}
