{
  MetaDataStore metaDataStore=newMetaDataStore();
  long[] originalClosedTransaction=metaDataStore.getLastClosedTransaction();
  long transactionId=originalClosedTransaction[0] + 1;
  long version=1l;
  long byteOffset=777l;
  metaDataStore.transactionClosed(transactionId,version,byteOffset);
  long[] closedTransactionFlags=metaDataStore.getLastClosedTransaction();
  assertEquals(version,closedTransactionFlags[1]);
  assertEquals(byteOffset,closedTransactionFlags[2]);
  metaDataStore.close();
  metaDataStore=newMetaDataStore();
  long[] lastClosedTransactionFlags=metaDataStore.getLastClosedTransaction();
  assertEquals(version,lastClosedTransactionFlags[1]);
  assertEquals(byteOffset,lastClosedTransactionFlags[2]);
  metaDataStore.close();
}
