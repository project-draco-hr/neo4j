{
  Args arguments=Args.withFlags(RECOVERY,PROP_OWNER).parse(args);
  String storeDir=determineStoreDirectory(arguments);
  Config tuningConfiguration=readTuningConfiguration(storeDir,arguments);
  attemptRecoveryOrCheckStateOfLogicalLogs(arguments,storeDir);
  StringLogger logger=StringLogger.SYSTEM;
  try {
    consistencyCheckService.runFullConsistencyCheck(storeDir,tuningConfiguration,ProgressMonitorFactory.textual(System.err),logger);
  }
 catch (  ConsistencyCheckIncompleteException e) {
    throw new ToolFailureException("Check aborted due to exception",e);
  }
 finally {
    logger.flush();
  }
}
