{
  User user=userRepository.findByName((String)principals.getPrimaryPrincipal());
  if (user == null) {
    throw new AuthenticationException("User " + principals.getPrimaryPrincipal() + " does not exist");
  }
  Set<String> roles=roleRepository.findByUsername(user.name());
  return new SimpleAuthorizationInfo(roles);
}
