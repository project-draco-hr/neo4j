{
  UsernamePasswordToken usernamePasswordToken=(UsernamePasswordToken)token;
  User user=userRepository.findByName(usernamePasswordToken.getUsername());
  if (user.passwordChangeRequired()) {
    throw new ExpiredCredentialsException("Password change required");
  }
  return new SimpleAuthenticationInfo(user.name(),user.credentials(),getName());
}
