{
  long end=System.currentTimeMillis() + TimeUnit.SECONDS.toMillis(maxSeconds);
  while (System.currentTimeMillis() < end) {
    if (predicate.accept(this)) {
      return;
    }
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
    }
  }
  throw new IllegalStateException("Awaited condition never met, waited " + maxSeconds + " for "+ predicate);
}
