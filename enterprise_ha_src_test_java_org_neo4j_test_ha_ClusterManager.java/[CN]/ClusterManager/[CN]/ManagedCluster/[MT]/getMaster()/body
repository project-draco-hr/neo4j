{
  for (  HighlyAvailableGraphDatabase graphDatabaseService : getAllMembers()) {
    if (graphDatabaseService.isAvailable(0) && graphDatabaseService.isMaster()) {
      return graphDatabaseService;
    }
  }
  throw new IllegalStateException("No master found in cluster " + name);
}
