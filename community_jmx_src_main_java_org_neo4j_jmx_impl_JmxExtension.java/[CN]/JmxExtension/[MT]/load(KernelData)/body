{
  ManagementSupport support=ManagementSupport.load();
  MBeanServer mbs=support.getMBeanServer();
  List<Neo4jMBean> beans=new LinkedList<Neo4jMBean>();
  try {
    Neo4jMBean bean=new KernelBean(kernel,support);
    mbs.registerMBean(bean,bean.objectName);
    beans.add(bean);
  }
 catch (  Exception e) {
    log.info("Failed to register Kernel JMX Bean");
  }
  for (  ManagementBeanProvider provider : Service.load(ManagementBeanProvider.class)) {
    try {
      for (      Neo4jMBean bean : provider.loadBeans(kernel,support)) {
        mbs.registerMBean(bean,bean.objectName);
        beans.add(bean);
      }
    }
 catch (    Exception e) {
      log.info("Failed to register JMX Bean " + provider + " ("+ e+ ")");
    }
  }
  try {
    Neo4jMBean bean=new ConfigurationBean(kernel,support);
    mbs.registerMBean(bean,bean.objectName);
    beans.add(bean);
  }
 catch (  Exception e) {
    log.info("Failed to register Configuration JMX Bean");
  }
  return new JmxData(kernel,support,beans.toArray(new Neo4jMBean[beans.size()]));
}
