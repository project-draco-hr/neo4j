{
  this.discoveryServiceFactory=discoveryServiceFactory;
  List<AdvertisedSocketAddress> initialHosts=buildAddresses(noOfCoreServers);
  this.parentDir=parentDir;
  ExecutorService executor=Executors.newCachedThreadPool();
  try {
    startCoreServers(executor,noOfCoreServers,initialHosts,coreParams);
    startEdgeServers(executor,noOfEdgeServers,initialHosts);
  }
  finally {
    executor.shutdownNow();
  }
}
