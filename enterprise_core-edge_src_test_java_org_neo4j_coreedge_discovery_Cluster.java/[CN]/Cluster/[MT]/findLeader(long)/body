{
  long leaderWaitEndTime=leaderWaitTimeout + System.currentTimeMillis();
  CoreGraphDatabase leader;
  while ((leader=getLeader()) == null && (System.currentTimeMillis() < leaderWaitEndTime)) {
    LockSupport.parkNanos(MILLISECONDS.toNanos(1000));
  }
  if (leader == null) {
    throw new NoLeaderTimeoutException();
  }
  return leader;
}
