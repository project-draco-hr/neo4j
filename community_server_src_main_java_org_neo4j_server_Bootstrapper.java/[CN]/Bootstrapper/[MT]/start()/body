{
  try {
    dependencies=dependencies.monitors(new Monitors());
    BufferingConsoleLogger consoleBuffer=new BufferingConsoleLogger();
    configurator=createConfigurationBuilder(consoleBuffer);
    dependencies=dependencies.logging(createLogging(configurator,dependencies.monitors()));
    log=dependencies.logging().getConsoleLog(getClass());
    consoleBuffer.replayInto(log);
    life.start();
    checkCompatibility();
    server=createNeoServer();
    server.start();
    addShutdownHook();
    return OK;
  }
 catch (  TransactionFailureException tfe) {
    log.error(format("Failed to start Neo Server on port [%d], because ",configurator.configuration().get(ServerSettings.webserver_port)) + tfe + ". Another process may be using database location "+ server.getDatabase().getLocation(),tfe);
    return GRAPH_DATABASE_STARTUP_ERROR_CODE;
  }
catch (  IllegalArgumentException e) {
    log.error(format("Failed to start Neo Server on port [%s]",configurator.configuration().get(ServerSettings.webserver_port)),e);
    return WEB_SERVER_STARTUP_ERROR_CODE;
  }
catch (  Exception e) {
    log.error(format("Failed to start Neo Server on port [%s]",configurator.configuration().get(ServerSettings.webserver_port)),e);
    return WEB_SERVER_STARTUP_ERROR_CODE;
  }
}
