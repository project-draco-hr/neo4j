def __iter__(self):
    if (self.get_db() == None):
        raise RuntimeError('You have to provide a graph database instance to the query set before you can retrieve results.')
    hits = self._start_nodes
    if (len(self._lookups) > 0):
        index_query = ' AND '.join(self._lookups)
    elif (len(hits) == 0):
        index_query = '*:*'
    else:
        index_query = False
    if index_query:
        hits = chain(hits, self._index(self.get_db()).query(index_query))
    try:
        for entity in hits:
            for predicate in self._filters:
                if (not predicate(entity)):
                    break
            else:
                yield Neo4jEntity.__new__(self._Entity, entity)
    finally:
        try:
            hits.close()
        except:
            pass
