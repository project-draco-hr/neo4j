def __new__(Node, name, bases, body):
    Node = type.__new__(Node, name, bases, body)
    for (attr, value) in body.items():
        if isinstance(value, Factory):
            setattr(Node, attr, value.create(Node, attr))
    return Node
