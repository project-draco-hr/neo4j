{
  for (LogEntry entry; null != (entry=readEntry(source)); ) {
    if (entry instanceof LogEntry.Command) {
      Command command=(Command)((LogEntry.Command)entry).getXaCommand();
      command.accept(new CommandVisitor(entry.getIdentifier(),visitor));
    }
 else     if (entry instanceof LogEntry.Start) {
      LogEntry.Start start=(LogEntry.Start)entry;
      visitor.visitStart(start.getIdentifier(),start.getXid().getGlobalTransactionId(),start.getMasterId(),start.getLocalId(),start.getTimeWritten());
    }
 else     if (entry instanceof LogEntry.Prepare) {
      LogEntry.Prepare prepare=(LogEntry.Prepare)entry;
      visitor.visitPrepare(prepare.getIdentifier(),prepare.getTimeWritten());
    }
 else     if (entry instanceof LogEntry.OnePhaseCommit) {
      LogEntry.OnePhaseCommit commit=(LogEntry.OnePhaseCommit)entry;
      visitor.visitCommit(commit.getIdentifier(),false,commit.getTxId(),commit.getTimeWritten());
    }
 else     if (entry instanceof LogEntry.TwoPhaseCommit) {
      LogEntry.TwoPhaseCommit commit=(LogEntry.TwoPhaseCommit)entry;
      visitor.visitCommit(commit.getIdentifier(),true,commit.getTxId(),commit.getTimeWritten());
    }
 else     if (entry instanceof LogEntry.Done) {
      LogEntry.Done done=(LogEntry.Done)entry;
      visitor.visitDone(done.getIdentifier());
    }
  }
}
