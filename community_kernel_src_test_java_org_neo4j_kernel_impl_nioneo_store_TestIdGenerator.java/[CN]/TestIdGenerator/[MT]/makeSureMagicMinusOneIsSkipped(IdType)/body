{
  deleteIdGeneratorFile();
  IdGeneratorImpl.createGenerator(fs,idGeneratorFile());
  IdGenerator idGenerator=new IdGeneratorImpl(fs,idGeneratorFile(),1,type.getMaxValue(),false,0);
  long id=(long)Math.pow(2,32) - 3;
  idGenerator.setHighId(id);
  assertEquals(id,idGenerator.nextId());
  assertEquals(id + 1,idGenerator.nextId());
  assertEquals(id + 3,idGenerator.nextId());
  assertEquals(id + 4,idGenerator.nextId());
  assertEquals(id + 5,idGenerator.nextId());
  closeIdGenerator(idGenerator);
}
