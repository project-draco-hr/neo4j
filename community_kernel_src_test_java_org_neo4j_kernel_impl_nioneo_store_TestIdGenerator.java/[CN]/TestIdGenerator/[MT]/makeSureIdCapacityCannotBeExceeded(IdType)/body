{
  deleteIdGeneratorFile();
  IdGeneratorImpl.createGenerator(idGeneratorFile());
  IdGenerator idGenerator=new IdGeneratorImpl(idGeneratorFile(),1,type.getMaxValue());
  long id=type.getMaxValue() - 3;
  idGenerator.setHighId(id);
  assertEquals(id,idGenerator.nextId());
  assertEquals(id + 1,idGenerator.nextId());
  assertEquals(id + 2,idGenerator.nextId());
  try {
    idGenerator.nextId();
    fail("Id capacity shouldn't be able to be exceeded");
  }
 catch (  StoreFailureException e) {
  }
}
