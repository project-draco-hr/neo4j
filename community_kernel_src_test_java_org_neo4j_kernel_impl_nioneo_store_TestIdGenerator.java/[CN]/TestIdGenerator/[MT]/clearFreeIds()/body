{
  IdGeneratorImpl.createGenerator(idGeneratorFile());
  IdGenerator generator=new IdGeneratorImpl(idGeneratorFile(),10,100,false);
  long[] ids=new long[35];
  for (int i=0; i < ids.length; i++)   ids[i]=generator.nextId();
  for (  long id : ids)   generator.freeId(id);
  long nextExpectedId=ids[ids.length - 1] + 1;
  generator.close();
  generator=new IdGeneratorImpl(idGeneratorFile(),10,100,false);
  generator.clearFreeIds();
  assertEquals(nextExpectedId++,generator.nextId());
  generator.close();
  generator=new IdGeneratorImpl(idGeneratorFile(),10,100,false);
  assertEquals(nextExpectedId,generator.nextId());
  for (int i=0; i < ids.length; i++)   ids[i]=generator.nextId();
  for (  long id : ids)   generator.freeId(id);
  nextExpectedId=ids[ids.length - 1] + 1;
  generator.close();
  generator=new IdGeneratorImpl(idGeneratorFile(),10,100,false);
  generator.clearFreeIds();
  assertEquals(nextExpectedId++,generator.nextId());
  generator.close();
}
