{
  Vagrant v=vagrant(Box.WINDOWS_2008_R2_AMD64,"win2008","windows-2008R2-amd64-plain");
  v.up();
  try {
    v.copyFromHost(System.getProperty("user.dir") + "/target/classes/installer-windows-1.6-SNAPSHOT-windows-community.msi","/home/vagrant/installer.msi");
    CygwinShell sh=new CygwinShell(v.ssh());
    sh.run(":> install.log");
    sh.runDOS("msiexec /quiet /L* install.log /i installer.msi INSTALL_DIR=\"C:\\neo4j install with spaces\"");
    sh.run("net stop neo4j");
    sh.run("echo org.neo4j.server.webserver.address=0.0.0.0 >> /cygdrive/c/neo4j\\ install\\ with\\ spaces/conf/neo4j-server.properties");
    sh.run("net start neo4j");
    checkDataRest();
    sh.run("net stop neo4j");
    sh.run(":> uninstall.log");
    sh.runDOS("msiexec /quiet /L*v uninstall.log /x installer.msi");
    sh.close();
    try {
      checkDataRest();
      fail("Server is still listening to port 7474 even after uninstall");
    }
 catch (    ClientHandlerException e) {
    }
  }
 catch (  ShellException e) {
    System.out.println(e.getResult().getOutput());
    throw e;
  }
 finally {
    v.rollback();
  }
}
