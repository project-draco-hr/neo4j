{
  DependencyResolver dependencyResolver=getDependencyResolver();
  GraphDatabaseQueryService graph=dependencyResolver.resolveDependency(GraphDatabaseQueryService.class);
  InternalTransaction transaction=graph.beginTransaction(KernelTransaction.Type.implicit,AccessMode.Static.FULL);
  Statement statement=dependencyResolver.resolveDependency(ThreadToStatementContextBridge.class).get();
  Neo4jTransactionalContext context=new Neo4jTransactionalContext(graph,transaction,statement,query,parameters,new PropertyContainerLocker());
  return new ShellQuerySession(session,context);
}
