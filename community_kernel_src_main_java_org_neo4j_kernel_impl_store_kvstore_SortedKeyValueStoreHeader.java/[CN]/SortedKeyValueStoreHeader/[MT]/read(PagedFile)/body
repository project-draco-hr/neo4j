{
  try (PageCursor page=pagedFile.io(0,PF_SHARED_LOCK)){
    if (page.next()) {
      short headerRecords;
      short versionLength;
      int dataRecords;
      long lastTxId;
      byte[] storeFormatVersion=null;
      int versionSpace=-1;
      byte[] tail=null;
      do {
        page.setOffset(0);
        headerRecords=page.getShort();
        versionLength=page.getShort();
        dataRecords=page.getInt();
        lastTxId=page.getLong();
        if (versionLength >= 0) {
          storeFormatVersion=new byte[versionLength];
          page.getBytes(storeFormatVersion);
          versionSpace=headerRecords * RECORD_SIZE - META_HEADER_SIZE;
          int tailLength=versionSpace - versionLength - 1;
          if (tailLength >= 0) {
            tail=new byte[tailLength];
            page.getBytes(tail);
          }
        }
      }
 while (page.shouldRetry());
      checkConsistentHeader(versionLength,versionSpace);
      checkZeroPadded(tail);
      return new SortedKeyValueStoreHeader(storeFormatVersion,dataRecords,lastTxId);
    }
 else {
      throw new IOException("Could not read count store header page");
    }
  }
 }
