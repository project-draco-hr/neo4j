{
  boolean fail=false;
  long nextId=record.getNextBlock();
  if (!Record.NO_NEXT_BLOCK.value(nextId)) {
    DynamicRecord next=store.forceGetRecord(nextId);
    if (!next.inUse())     fail|=inconsistent(store,record,next,NEXT_DYNAMIC_NOT_IN_USE);
    if (record.getLength() < store.getRecordSize() - store.getRecordHeaderSize())     fail|=inconsistent(store,record,NON_FULL_DYNAMIC_WITH_NEXT);
  }
  if (record.getId() != 0 && record.getLength() > store.getRecordSize() - store.getRecordHeaderSize()) {
    fail|=inconsistent(store,record,DYNAMIC_LENGTH_TOO_LARGE);
  }
  if (store instanceof DiffRecordStore<?>) {
    DiffRecordStore<DynamicRecord> diffs=(DiffRecordStore<DynamicRecord>)store;
    DynamicRecord prev=diffs.forceGetRaw(record.getId());
    if (prev.inUse())     fail|=inconsistent(store,record,prev,OVERWRITE_USED_DYNAMIC);
  }
  return fail;
}
