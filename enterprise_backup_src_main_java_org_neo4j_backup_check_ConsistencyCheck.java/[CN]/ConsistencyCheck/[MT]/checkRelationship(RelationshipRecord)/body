{
  boolean fail=false;
  if (rel.getType() < 0)   fail|=inconsistent(rels,rel,INVALID_TYPE_ID);
 else {
    RelationshipTypeRecord type=relTypes.forceGetRecord(rel.getType());
    if (!type.inUse())     fail|=inconsistent(rels,rel,relTypes,type,TYPE_NOT_IN_USE);
  }
  for (  RelationshipField field : relFields) {
    long otherId=field.relOf(rel);
    if (otherId == field.none) {
      Long nodeId=field.nodeOf(rel);
      if (nodeId != null) {
        NodeRecord node=nodes.forceGetRecord(nodeId);
        if (!node.inUse() || node.getNextRel() != rel.getId())         fail|=inconsistent(rels,rel,nodes,node,field.noBackReference);
      }
    }
 else {
      RelationshipRecord other=rels.forceGetRecord(otherId);
      if (!other.inUse())       fail|=inconsistent(rels,rel,other,field.notInUse);
 else       if (!field.invConsistent(rel,other))       fail|=inconsistent(rels,rel,other,field.differentChain);
    }
  }
  for (  NodeField field : nodeFields) {
    long nodeId=field.get(rel);
    if (nodeId < 0)     fail|=inconsistent(rels,rel,field.invalidReference);
 else {
      NodeRecord node=nodes.forceGetRecord(nodeId);
      if (!node.inUse())       fail|=inconsistent(rels,rel,nodes,node,field.notInUse);
    }
  }
  if (props != null) {
    long propId=rel.getNextProp();
    if (!Record.NO_NEXT_PROPERTY.value(propId)) {
      PropertyRecord prop=props.forceGetRecord(propId);
      if (!prop.inUse())       fail|=inconsistent(rels,rel,props,prop,PROPERTY_NOT_IN_USE);
 else       if (prop.getNodeId() != -1 || (prop.getRelId() != -1 && prop.getRelId() != rel.getId()))       fail|=inconsistent(rels,rel,props,prop,PROPERTY_FOR_OTHER);
    }
  }
  return fail;
}
