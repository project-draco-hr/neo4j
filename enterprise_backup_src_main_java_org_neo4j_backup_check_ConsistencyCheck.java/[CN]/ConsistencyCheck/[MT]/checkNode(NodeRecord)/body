{
  boolean fail=false;
  long relId=node.getNextRel();
  if (!Record.NO_NEXT_RELATIONSHIP.value(relId)) {
    RelationshipRecord rel=rels.forceGetRecord(relId);
    if (!rel.inUse() || !(rel.getFirstNode() == node.getId() || rel.getSecondNode() == node.getId()))     fail|=report(node,rel,"invalid relationship reference");
  }
  if (props != null) {
    long propId=node.getNextProp();
    if (!Record.NO_NEXT_PROPERTY.value(propId)) {
      PropertyRecord prop=props.forceGetRecord(propId);
      if (!prop.inUse())       fail|=report(node,prop,"invalid property reference");
    }
  }
  return fail;
}
