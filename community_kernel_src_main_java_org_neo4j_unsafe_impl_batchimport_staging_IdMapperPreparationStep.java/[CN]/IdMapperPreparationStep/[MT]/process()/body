{
  idMapper.prepare(allIds,new ProgressListener(){
    private final String[] stages={"SORT","DETECT","RESOLVE"};
    private volatile int stage=0;
    @Override public void started(){
      resetStats();
      changeName(stages[stage++]);
    }
    @Override public void set(    long progress){
      throw new UnsupportedOperationException("Shouldn't be required");
    }
    @Override public void failed(    Throwable e){
      issuePanic(e);
    }
    @Override public synchronized void add(    long progress){
      progress(progress);
    }
    @Override public void done(){
    }
  }
);
}
