{
  long lastCommittedTransaction=0;
  while (!isCompleted()) {
    try {
      TransactionRepresentationCommitProcess transactionCommit=createTransactionCommitProcess();
      PhysicalTransactionRepresentation transactionRepresentation=createPhysicalTransactionRepresentation();
      randomSleep();
      lastCommittedTransaction=transactionCommit.commit(transactionRepresentation,new LockGroup(),CommitEvent.NULL,TransactionApplicationMode.INTERNAL);
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
  completedLatch.countDown();
  return lastCommittedTransaction;
}
