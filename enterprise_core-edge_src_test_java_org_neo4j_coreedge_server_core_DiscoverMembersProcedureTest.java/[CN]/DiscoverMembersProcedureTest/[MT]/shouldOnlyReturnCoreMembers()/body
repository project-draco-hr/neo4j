{
  final ReadOnlyTopologyService coreTopologyService=mock(ReadOnlyTopologyService.class);
  Map<CoreMember,BoltAddress> coreMembers=new HashMap<>();
  coreMembers.put(coreMemberAtRaftPort(9000),address(1));
  coreMembers.put(coreMemberAtRaftPort(9001),address(2));
  coreMembers.put(coreMemberAtRaftPort(9002),address(3));
  final ClusterTopology clusterTopology=new ClusterTopology(false,coreMembers,addresses(4,5,6));
  when(coreTopologyService.currentTopology()).thenReturn(clusterTopology);
  final DiscoverMembersProcedure proc=new DiscoverMembersProcedure(coreTopologyService,NullLogProvider.getInstance());
  final List<Object[]> members=asList(proc.apply(null,new Object[0]));
  assertThat(members,containsInAnyOrder(new Object[]{address(1).getAdvertisedAddress().toString()},new Object[]{address(2).getAdvertisedAddress().toString()},new Object[]{address(3).getAdvertisedAddress().toString()}));
}
