{
  long thresholdValue=parseLongWithUnit(thresholdValueString);
  Threshold thresholdToUse;
switch (type) {
case "files":
    thresholdToUse=new FileCountThreshold(thresholdValue);
  break;
case "size":
thresholdToUse=new FileSizeThreshold(fileSystem,thresholdValue);
break;
case "txs":
case "entries":
thresholdToUse=new EntryCountThreshold(thresholdValue);
break;
case "hours":
thresholdToUse=new EntryTimespanThreshold(Clock.SYSTEM_CLOCK,TimeUnit.HOURS,thresholdValue);
break;
case "days":
thresholdToUse=new EntryTimespanThreshold(Clock.SYSTEM_CLOCK,TimeUnit.DAYS,thresholdValue);
break;
default :
throw new IllegalArgumentException("Invalid log pruning configuration value '" + originalConfigValue + "'. Invalid type '"+ type+ "', valid are files, size, txs, entries, hours, days.");
}
return thresholdToUse;
}
