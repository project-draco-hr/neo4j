{
  transaction=neo.beginTx();
  System.out.println("Generating graph");
  nodes=new long[numberOfNodes];
  ProgressBar progressBar=new ProgressBar(numberOfNodes * minimumDegree);
  int[] edges=new int[numberOfNodes * minimumDegree * 2];
  for (int v=0; v < numberOfNodes; ++v) {
    nodes[v]=neo.createNode().getId();
    renewTransaction();
    for (int i=0; i < minimumDegree; ++i) {
      if (v == 0) {
        break;
      }
      int offset=2 * (v * minimumDegree + i);
      edges[offset]=v;
      int j=random.nextInt(2 * v * minimumDegree);
      edges[offset + 1]=edges[j];
      Node node1=neo.getNodeById(nodes[edges[offset]]);
      Node node2=neo.getNodeById(nodes[edges[offset + 1]]);
      node1.createRelationshipTo(node2,relationshipType);
      renewTransaction();
      progressBar.Print();
    }
  }
  transaction.success();
  transaction.finish();
}
