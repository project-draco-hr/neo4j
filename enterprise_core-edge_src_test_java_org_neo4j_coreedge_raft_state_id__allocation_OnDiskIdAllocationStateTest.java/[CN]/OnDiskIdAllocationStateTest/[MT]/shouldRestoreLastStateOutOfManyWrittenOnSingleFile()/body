{
  final int numberOfEntiesBeforeSwitchingFiles=10;
  EphemeralFileSystemAbstraction fsa=new EphemeralFileSystemAbstraction();
  fsa.mkdir(testDir.directory());
  OnDiskIdAllocationState store=new OnDiskIdAllocationState(fsa,testDir.directory(),numberOfEntiesBeforeSwitchingFiles,mock(Supplier.class),NullLogProvider.getInstance());
  for (int i=1; i < 3; i++) {
    store.lastIdRangeLength(someType,i * 1024);
    store.logIndex(i);
  }
  OnDiskIdAllocationState restoredOne=new OnDiskIdAllocationState(fsa,testDir.directory(),1,mock(Supplier.class),NullLogProvider.getInstance());
  assertEquals(1024 * 2,restoredOne.lastIdRangeLength(someType));
  assertEquals(2,restoredOne.logIndex());
}
