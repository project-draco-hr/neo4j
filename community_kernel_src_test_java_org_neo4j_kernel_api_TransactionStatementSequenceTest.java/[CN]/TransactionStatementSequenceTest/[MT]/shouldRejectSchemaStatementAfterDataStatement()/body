{
  KernelTransactionImplementation tx=newTransaction();
  tx.acquireDataStatement().close();
  try {
    tx.acquireSchemaStatement().close();
    fail("expected exception");
  }
 catch (  InvalidTransactionTypeException e) {
    assertEquals("Cannot perform schema updates in a transaction that has performed data updates.",e.getMessage());
  }
}
