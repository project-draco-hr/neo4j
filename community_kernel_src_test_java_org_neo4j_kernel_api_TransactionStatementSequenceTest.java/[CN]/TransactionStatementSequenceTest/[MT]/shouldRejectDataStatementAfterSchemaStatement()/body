{
  KernelTransaction tx=kernelTransaction(AccessMode.Static.FULL);
  tx.acquireStatement().schemaWriteOperations();
  try {
    tx.acquireStatement().dataWriteOperations();
    fail("expected exception");
  }
 catch (  InvalidTransactionTypeKernelException e) {
    assertEquals("Cannot perform data updates in a transaction that has performed schema updates.",e.getMessage());
  }
}
