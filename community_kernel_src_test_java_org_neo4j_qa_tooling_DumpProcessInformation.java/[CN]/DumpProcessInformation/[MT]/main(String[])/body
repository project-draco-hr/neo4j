{
  Args arg=new Args(args == null ? new String[0] : args);
  boolean doHeapDump=arg.getBoolean("heap",false,true);
  Predicate<String> processFilter=arg.orphans().isEmpty() ? Predicates.<String>TRUE() : stringContains(arg.orphans().get(0));
  String dumpDir=arg.get("dir","data");
  File dirFile=dumpDir != null ? new File(dumpDir) : null;
  dirFile.mkdirs();
  for (  Pair<Long,String> pid : getJPids(processFilter)) {
    doThreadDump(pid,dirFile);
    if (doHeapDump)     doHeapDump(pid,dirFile);
  }
}
