{
  int primaryEndOffset=primaryCursor.getOffset() + recordSize - 1;
  Reference.encode(record.getSecondaryId(),primaryCursor,PAGE_CURSOR_ADAPTER);
  DataAdapter<PageCursor> dataAdapter=new SecondaryPageCursorWriteDataAdapter(pageIdForRecord(record.getSecondaryId(),storeFile.pageSize(),recordSize),offsetForId(record.getSecondaryId(),storeFile.pageSize(),recordSize),primaryEndOffset);
  writer.accept(dataAdapter);
}
