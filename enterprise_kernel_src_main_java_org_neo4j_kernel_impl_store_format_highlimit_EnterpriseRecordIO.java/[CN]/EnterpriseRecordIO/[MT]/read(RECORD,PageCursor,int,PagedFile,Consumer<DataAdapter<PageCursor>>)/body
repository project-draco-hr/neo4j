{
  int primaryEndOffset=primaryCursor.getOffset() + recordSize - 1;
  long secondaryId=Reference.decode(primaryCursor,PAGE_CURSOR_ADAPTER);
  @SuppressWarnings("resource") SecondaryPageCursorReadDataAdapter readAdapter=new SecondaryPageCursorReadDataAdapter(primaryCursor,storeFile,pageIdForRecord(secondaryId,storeFile.pageSize(),recordSize),offsetForId(secondaryId,storeFile.pageSize(),recordSize),primaryEndOffset,PagedFile.PF_SHARED_READ_LOCK);
  try (SecondaryPageCursorControl secondaryPageCursorControl=readAdapter){
    do {
      secondaryPageCursorControl.reposition();
      reader.accept(readAdapter);
    }
 while (secondaryPageCursorControl.shouldRetry());
    record.setSecondaryUnitId(secondaryId);
  }
 }
