{
  int expectedVersionLength=UTF8.encode(buildTypeDescriptorAndVersion(getTypeDescriptor())).length;
  long fileSize=getFileChannel().size();
  if ((fileSize - expectedVersionLength) % blockSize != 0 && !isReadOnly()) {
    setStoreNotOk();
  }
  if (getStoreOk() && !isReadOnly()) {
    getFileChannel().truncate(fileSize - expectedVersionLength);
  }
}
