{
  long blockId=record.getId();
  registerIdFromUpdateRecord(blockId);
  try (PageCursor cursor=storeFile.io(pageIdForRecord(blockId),PF_EXCLUSIVE_LOCK,record,offsetForId(blockId),encodeBlockSizeFlags(getBlockSize(),IO_WRITE))){
    cursor.next();
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
  if (!record.inUse() && !isInRecoveryMode()) {
    freeId(blockId);
  }
}
