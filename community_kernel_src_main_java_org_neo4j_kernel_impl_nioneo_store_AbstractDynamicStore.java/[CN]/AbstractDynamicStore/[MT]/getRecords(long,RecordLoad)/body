{
  List<DynamicRecord> recordList=new LinkedList<>();
  long blockId=startBlockId;
  while (blockId != Record.NO_NEXT_BLOCK.intValue()) {
    PageCursor cursor=pageCache.newCursor();
    try {
      storeFile.pin(cursor,PageLock.SHARED,pageIdForRecord(blockId));
    }
 catch (    IOException e) {
      throw new UnderlyingStorageException(e);
    }
    try {
      DynamicRecord record=getRecord(blockId,cursor,loadFlag);
      if (!record.inUse()) {
        return recordList;
      }
      recordList.add(record);
      blockId=record.getNextBlock();
    }
  finally {
      storeFile.unpin(cursor);
    }
  }
  return recordList;
}
