{
  List<DynamicRecord> recordList=new LinkedList<>();
  long blockId=startBlockId;
  while (blockId != Record.NO_NEXT_BLOCK.intValue()) {
    PersistenceWindow window=acquireWindow(blockId,OperationType.READ);
    try {
      DynamicRecord record=getRecord(blockId,window,loadFlag);
      if (!record.inUse()) {
        return recordList;
      }
      recordList.add(record);
      blockId=record.getNextBlock();
    }
  finally {
      releaseWindow(window);
    }
  }
  return recordList;
}
