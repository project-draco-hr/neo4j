{
  if (!record.isLight()) {
    return;
  }
  if (record.getLength() == 0) {
    record.setData(NO_DATA);
  }
  long blockId=record.getId();
  PersistenceWindow window=acquireWindow(blockId,OperationType.READ);
  try {
    Buffer buf=window.getBuffer();
    int offset=(int)(blockId - buf.position()) * getBlockSize() + BLOCK_HEADER_SIZE;
    buf.setOffset(offset);
    byte bytes[]=new byte[record.getLength()];
    buf.get(bytes);
    record.setData(bytes);
  }
  finally {
    releaseWindow(window);
  }
}
