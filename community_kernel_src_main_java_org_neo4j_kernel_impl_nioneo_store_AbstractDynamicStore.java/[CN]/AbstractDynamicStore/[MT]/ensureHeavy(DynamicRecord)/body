{
  if (!record.isLight()) {
    return;
  }
  if (record.getLength() == 0) {
    record.setData(NO_DATA);
  }
  long blockId=record.getId();
  PersistenceWindow window=acquireWindow(blockId,OperationType.READ);
  PageCursor cursor=pageCache.newCursor();
  try {
    storeFile.pin(cursor,PageLock.SHARED,pageIdForRecord(blockId));
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
  try {
    int offset=(int)(blockId - window.position()) * getBlockSize() + BLOCK_HEADER_SIZE;
    cursor.setOffset(offset);
    byte bytes[]=new byte[record.getLength()];
    cursor.getBytes(bytes);
    record.setData(bytes);
  }
  finally {
    storeFile.unpin(cursor);
  }
}
