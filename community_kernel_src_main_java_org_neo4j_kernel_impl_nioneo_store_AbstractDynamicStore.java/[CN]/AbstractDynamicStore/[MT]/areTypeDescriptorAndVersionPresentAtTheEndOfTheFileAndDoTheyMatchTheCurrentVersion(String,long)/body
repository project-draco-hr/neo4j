{
  byte bytes[]=new byte[UTF8.encode(expectedTypeDescriptorAndVersion).length];
  ByteBuffer buffer=ByteBuffer.wrap(bytes);
  getFileChannel().position(fileSize - bytes.length);
  getFileChannel().read(buffer);
  String foundTypeDescriptorAndVersion=UTF8.decode(bytes);
  if (expectedTypeDescriptorAndVersion.equals(foundTypeDescriptorAndVersion)) {
    return true;
  }
 else {
    if (foundTypeDescriptorAndVersion.startsWith(getTypeDescriptor())) {
      String foundVersion=foundTypeDescriptorAndVersion.substring(getTypeDescriptor().length() + 1);
      throw new NotCurrentStoreVersionException(ALL_STORES_VERSION,foundVersion,"",canAutomaticallyUpgradeFrom(foundVersion));
    }
    return false;
  }
}
