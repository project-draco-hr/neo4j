{
  Transaction transaction=db.beginTx();
  try {
    Node node=db.getNodeById(nodeId);
    assertEquals("Property '" + key + "'='"+ value+ "' mismatch on "+ node+ " for "+ db,value,node.getProperty(key));
    assertTrue("Index '" + key + "' not found for "+ db,db.index().existsForNodes(key));
    assertEquals("Index '" + key + "'='"+ value+ "' mismatch on "+ node+ " for "+ db,node,db.index().forNodes(key).get(key,value).getSingle());
  }
  finally {
    transaction.finish();
  }
}
