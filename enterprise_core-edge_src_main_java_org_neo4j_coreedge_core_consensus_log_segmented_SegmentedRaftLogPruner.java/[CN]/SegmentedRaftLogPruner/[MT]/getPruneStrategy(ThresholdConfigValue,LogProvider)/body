{
  String type=configValue.type;
switch (type) {
case "size":
    return new SizeBasedLogPruningStrategy(parsedConfigOption.value);
case "txs":
case "entries":
  return new EntryBasedLogPruningStrategy(parsedConfigOption.value,logProvider);
case "hours":
case "days":
throw new IllegalArgumentException("Time based pruning not supported yet for the segmented raft log, got '" + type + "'.");
case "false":
return new NoPruningPruningStrategy();
default :
throw new IllegalArgumentException("Invalid log pruning configuration value '" + configValue.value + "'. Invalid type '"+ type+ "', valid are files, size, txs, entries, hours, days.");
}
}
