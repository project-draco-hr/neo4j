{
  ZooKeeperClusterClient clusterClient=new ZooKeeperClusterClient(from,clusterName);
  Pair<String,Integer> masterServer=null;
  try {
    clusterClient.waitForSyncConnected();
    Machine master=clusterClient.getMaster();
    masterServer=master.getServer();
    if (masterServer != null) {
      int backupPort=clusterClient.getBackupPort(master.getMachineId());
      return String.format(ServerAddressFormat,masterServer.first(),backupPort);
    }
    throw new ComException("Master couldn't be found from cluster managed by " + from);
  }
  finally {
    clusterClient.shutdown();
  }
}
