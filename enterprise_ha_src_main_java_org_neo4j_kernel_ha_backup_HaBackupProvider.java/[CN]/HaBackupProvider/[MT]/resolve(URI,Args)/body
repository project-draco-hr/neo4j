{
  String master=null;
  try {
    System.out.println("Asking coordinator service at '" + address + "' for master");
    String clusterName=args.get(HaSettings.cluster_name.name(),null);
    if (clusterName == null) {
      clusterName=args.get("cluster",ConfigurationDefaults.getDefault(HaSettings.cluster_name,HaSettings.class));
    }
    master=getMasterServerInCluster(address.getSchemeSpecificPart().substring(2),clusterName);
    System.out.println("Found master '" + master + "' in cluster");
  }
 catch (  ComException e) {
    throw e;
  }
catch (  RuntimeException e) {
    if (e.getCause() instanceof KeeperException) {
      KeeperException zkException=(KeeperException)e.getCause();
      System.out.println("Couldn't connect to '" + address + "', "+ zkException.getMessage());
    }
    throw e;
  }
  URI toReturn=null;
  try {
    toReturn=new URI(master);
  }
 catch (  URISyntaxException e) {
  }
  return toReturn;
}
