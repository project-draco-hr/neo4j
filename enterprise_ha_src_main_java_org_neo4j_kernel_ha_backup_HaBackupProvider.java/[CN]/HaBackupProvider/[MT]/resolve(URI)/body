{
  String master=null;
  try {
    System.out.println("Asking ZooKeeper service at '" + address + "' for master");
    master=getMasterServerInCluster(address.getPort() == -1 ? address.getHost() : String.format(ServerAddressFormat,address.getHost(),address.getPort()));
    System.out.println("Found master '" + master + "' in cluster");
  }
 catch (  ComException e) {
    throw e;
  }
catch (  RuntimeException e) {
    if (e.getCause() instanceof KeeperException) {
      KeeperException zkException=(KeeperException)e.getCause();
      System.out.println("Couldn't connect to '" + address + "', "+ zkException.getMessage());
    }
    throw e;
  }
  URI toReturn=null;
  try {
    toReturn=new URI(master);
  }
 catch (  URISyntaxException e) {
  }
  return toReturn;
}
