{
  int contestedPort=9999;
  try (ServerSocket socket=new ServerSocket(contestedPort,0,InetAddress.getByName(Jetty9WebServer.DEFAULT_ADDRESS))){
    InMemoryAppender appender=new InMemoryAppender(AbstractNeoServer.log);
    CommunityNeoServer server=CommunityServerBuilder.server().onPort(contestedPort).usingDatabaseDir(folder.getRoot().getAbsolutePath()).onHost(Jetty9WebServer.DEFAULT_ADDRESS).build();
    try {
      server.start();
      fail("Should have reported failure to start");
    }
 catch (    ServerStartupException e) {
      assertThat(e.getMessage(),containsString("Starting Neo4j Server failed"));
    }
    assertThat(appender.toString(),containsString(String.format(": Failed to start Neo Server")));
    server.stop();
  }
 }
