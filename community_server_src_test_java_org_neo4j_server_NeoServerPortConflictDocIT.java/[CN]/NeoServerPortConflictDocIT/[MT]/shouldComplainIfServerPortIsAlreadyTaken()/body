{
  int contestedPort=9999;
  try (ServerSocket ignored=new ServerSocket(contestedPort,0,InetAddress.getByName(Jetty9WebServer.DEFAULT_ADDRESS))){
    AssertableLogProvider logProvider=new AssertableLogProvider();
    CommunityNeoServer server=CommunityServerBuilder.server(logProvider).onPort(contestedPort).usingDatabaseDir(folder.cleanDirectory(name.getMethodName()).getAbsolutePath()).onHost(Jetty9WebServer.DEFAULT_ADDRESS).build();
    try {
      server.start();
      fail("Should have reported failure to start");
    }
 catch (    ServerStartupException e) {
      assertThat(e.getMessage(),containsString("Starting Neo4j Server failed"));
    }
    logProvider.assertAtLeastOnce(AssertableLogProvider.inLog(containsString("CommunityNeoServer")).error("Failed to start Neo Server on port %d: %s",9999,startsWith("java.net.BindException: Address already in use")));
    server.stop();
  }
 }
