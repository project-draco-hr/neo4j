{
  int contestedPort=9999;
  ServerSocket socket=new ServerSocket(contestedPort,0,InetAddress.getByName(Jetty6WebServer.DEFAULT_ADDRESS));
  InMemoryAppender appender=new InMemoryAppender(CommunityNeoServer.log);
  CommunityNeoServer server=ServerBuilder.server().onPort(contestedPort).onHost(Jetty6WebServer.DEFAULT_ADDRESS).usingDatabaseDir(folder.getRoot().getAbsolutePath()).build();
  try {
    server.start();
    fail("Should have reported failure to start");
  }
 catch (  ServerStartupException e) {
  }
  assertThat(appender.toString(),containsString(String.format(": Failed to start Neo Server")));
  socket.close();
  server.stop();
}
