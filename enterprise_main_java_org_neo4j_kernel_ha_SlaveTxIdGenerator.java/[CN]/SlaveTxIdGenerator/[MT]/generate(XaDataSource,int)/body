{
  try {
    Response<Long> response=broker.getMaster().commitSingleResourceTransaction(broker.getSlaveContext(),((TxManager)txManager).getEventIdentifier(),dataSource.getName(),new TransactionStream(Arrays.asList(dataSource.getPreparedTransaction(identifier))));
    return receiver.receive(response);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
