{
  try {
    Response<Long> response=broker.getMaster().commitSingleResourceTransaction(receiver.getSlaveContext(),txManager.getEventIdentifier(),dataSource.getName(),new TransactionStream(Arrays.asList(dataSource.getPreparedTransaction(identifier))));
    return receiver.receive(response);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  ZooKeeperException e) {
    receiver.somethingIsWrong(e);
    throw e;
  }
catch (  HaCommunicationException e) {
    receiver.somethingIsWrong(e);
    throw e;
  }
}
