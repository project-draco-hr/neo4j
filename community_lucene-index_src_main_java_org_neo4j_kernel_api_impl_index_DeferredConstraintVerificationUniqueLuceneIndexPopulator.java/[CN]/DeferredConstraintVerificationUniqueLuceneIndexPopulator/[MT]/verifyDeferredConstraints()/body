{
  searcherManager.maybeRefresh();
  try (IndexSearcher searcher=searcherManager.acquire()){
    IndexReader indexReader=searcher.getIndexReader();
    TermEnum terms=indexReader.terms();
    while (terms.next()) {
      Term term=terms.term();
      if (!NODE_ID_KEY.equals(term.field()) && terms.docFreq() > 1) {
        TopDocs duplicateEntries=searcher.search(new TermQuery(term),2);
        if (duplicateEntries.totalHits > 1) {
          long nodeId1=getNodeId(indexReader,duplicateEntries,0);
          long nodeId2=getNodeId(indexReader,duplicateEntries,1);
          Object propertyValue=documentStructure.propertyValue(term);
          throw new PreexistingIndexEntryConflictException(propertyValue,nodeId1,nodeId2);
        }
      }
    }
  }
 }
