{
  TermEnum terms=reader.terms();
  Map<String,Integer> counters=new HashMap<>();
  for (  LuceneDocumentStructure.ValueEncoding encoding : LuceneDocumentStructure.ValueEncoding.values()) {
    counters.put(encoding.key(),0);
  }
  while (terms.next()) {
    Term term=terms.term();
    String field=term.field();
    if (counters.containsKey(field)) {
      counters.put(field,counters.get(field) + 1);
    }
  }
  long actualTermCount=0;
  for (  Integer counter : counters.values()) {
    actualTermCount+=counter;
  }
  return actualTermCount;
}
