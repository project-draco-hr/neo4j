{
  Integer port=(Integer)getConfig(config,"port","DEFAULT_PORT");
  String name=(String)getConfig(config,"name","DEFAULT_NAME");
  try {
    Class<?> shellServerClass=Class.forName("org.neo4j.shell.neo.NeoShellServer");
    Object shellServer=shellServerClass.getConstructor(GraphDatabaseService.class).newInstance(graphDb);
    shellServer.getClass().getMethod("makeRemotelyAvailable",Integer.TYPE,String.class).invoke(shellServer,port,name);
    return shellServer;
  }
 catch (  Exception e) {
    throw new RemoteException("Couldn't start shell '" + name + "' at port "+ port,e);
  }
}
