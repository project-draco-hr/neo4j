{
  if (start.equals(end)) {
    return Arrays.asList(Path.singular(start));
  }
  Map<Integer,Collection<Hit>> hits=new HashMap<Integer,Collection<Hit>>();
  Collection<Long> sharedVisitedRels=new HashSet<Long>();
  ValueHolder<Integer> sharedFrozenDepth=new ValueHolder<Integer>(null);
  ValueHolder<Boolean> sharedStop=new ValueHolder<Boolean>(false);
  ValueHolder<Integer> sharedCurrentDepth=new ValueHolder<Integer>(0);
  final DirectionData startData=new DirectionData("start",start,sharedVisitedRels,sharedFrozenDepth,sharedStop,sharedCurrentDepth);
  final DirectionData endData=new DirectionData("end",end,sharedVisitedRels,sharedFrozenDepth,sharedStop,sharedCurrentDepth);
  while (startData.hasNext() || endData.hasNext()) {
    goOneStep(startData,endData,hits,stopAsap,startData);
    goOneStep(endData,startData,hits,stopAsap,startData);
  }
  return least(hits);
}
