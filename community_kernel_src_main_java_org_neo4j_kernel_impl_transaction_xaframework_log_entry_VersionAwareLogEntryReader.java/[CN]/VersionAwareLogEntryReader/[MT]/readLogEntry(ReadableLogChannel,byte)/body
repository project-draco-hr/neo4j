{
  try {
    channel.getCurrentPosition(positionMarker);
    LogEntryParserDispatcher dispatcher=logEntryParserFactory.newInstance(logFormatVersion);
    while (true) {
      byte type=channel.get();
      byte version=0;
      if (type < 0) {
        version=type;
        type=channel.get();
      }
      LogEntryParser reader=dispatcher.dispatch(type);
      if (reader == null) {
        LogPosition position=positionMarker.newPosition();
        throw new IOException("Log format version: " + logFormatVersion + " - Unknown entry["+ type+ "] at "+ "position "+ position+ " and entry version "+ version);
      }
      LogEntry entry=reader.parse(version,channel,positionMarker,commandReaderFactory);
      if (!reader.skip()) {
        return entry;
      }
    }
  }
 catch (  ReadPastEndException e) {
    return null;
  }
}
