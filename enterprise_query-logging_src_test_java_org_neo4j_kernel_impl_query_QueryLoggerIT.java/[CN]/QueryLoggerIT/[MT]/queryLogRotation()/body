{
  final File logFilename=new File(testDirectory.graphDbDir(),"query.log");
  final File shiftedLogFilename=new File(testDirectory.graphDbDir(),"query.log.1");
  GraphDatabaseService database=databaseBuilder.setConfig(GraphDatabaseSettings.log_queries,Settings.TRUE).setConfig(GraphDatabaseSettings.log_queries_filename,logFilename.getPath()).setConfig(GraphDatabaseSettings.log_queries_rotation_threshold,"1").newGraphDatabase();
  database.execute(QUERY);
  database.execute(QUERY);
  Thread.sleep(TimeUnit.SECONDS.toMillis(1));
  database.execute(QUERY);
  database.shutdown();
  List<String> lines=readAllLines(logFilename);
  assertEquals(1,lines.size());
  List<String> shiftedLines=readAllLines(shiftedLogFilename);
  assertEquals(2,shiftedLines.size());
}
