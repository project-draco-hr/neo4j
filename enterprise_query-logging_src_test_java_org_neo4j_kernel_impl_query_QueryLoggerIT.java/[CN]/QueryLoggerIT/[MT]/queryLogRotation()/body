{
  final File logFilename=new File(testDirectory.graphDbDir(),"queries.log");
  final File shiftedLogFilename=new File(testDirectory.graphDbDir(),"queries.log.1");
  GraphDatabaseService database=databaseBuilder.setConfig(GraphDatabaseSettings.log_queries,Settings.TRUE).setConfig(GraphDatabaseSettings.log_queries_filename,logFilename.getPath()).setConfig(GraphDatabaseSettings.log_queries_rotation_threshold,"1M").newGraphDatabase();
  String longQuery=createLongQuery();
  database.execute(longQuery);
  database.execute(longQuery);
  database.execute(longQuery);
  database.shutdown();
  List<String> lines=readAllLines(logFilename);
  assertEquals(1,lines.size());
  List<String> shiftedLines=readAllLines(shiftedLogFilename);
  assertEquals(2,shiftedLines.size());
}
