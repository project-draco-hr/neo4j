{
  Stack<Long> skipStack=new Stack<>();
  SkipStackGenerator skipStackGenerator=new SkipStackGenerator(fromIndex,skipStack);
  logFile.accept(skipStackGenerator);
  LogPosition startPosition=skipStackGenerator.logStartPosition;
  if (startPosition == null) {
    throw new RaftLogCompactedException();
  }
  RaftLogMetadataCache.RaftLogEntryMetadata logEntryInfo=metadataCache.getMetadata(fromIndex);
  if (logEntryInfo != null && !logEntryInfo.getStartPosition().equals(LogPosition.UNSPECIFIED) && logEntryInfo.getStartPosition().getLogVersion() == startPosition.getLogVersion()) {
    startPosition=logEntryInfo.getStartPosition();
  }
  return new PhysicalRaftLogEntryCursor(new RaftRecordCursor<>(logFile.getReader(startPosition),marshal),skipStack,fromIndex);
}
