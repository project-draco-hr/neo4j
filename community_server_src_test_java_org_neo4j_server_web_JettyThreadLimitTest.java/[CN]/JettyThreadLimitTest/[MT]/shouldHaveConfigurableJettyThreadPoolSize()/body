{
  Jetty6WebServer server=new Jetty6WebServer(DevNullLoggingService.DEV_NULL);
  final int maxThreads=7;
  server.setMaxThreads(maxThreads);
  server.setPort(7480);
  try {
    server.start();
    QueuedThreadPool threadPool=(QueuedThreadPool)server.getJetty().getThreadPool();
    threadPool.start();
    int configuredMaxThreads=maxThreads * Runtime.getRuntime().availableProcessors();
    loadThreadPool(threadPool,configuredMaxThreads + 1);
    int threads=threadPool.getThreads();
    assertTrue(threads <= maxThreads);
  }
  finally {
    server.stop();
  }
}
