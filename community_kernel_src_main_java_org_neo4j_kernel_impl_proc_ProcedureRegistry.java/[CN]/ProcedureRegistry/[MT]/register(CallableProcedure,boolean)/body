{
  ProcedureSignature signature=proc.signature();
  QualifiedName name=signature.name();
  String descriptiveName=signature.toString();
  validateSignature(descriptiveName,signature.inputSignature(),"input");
  validateSignature(descriptiveName,signature.outputSignature(),"output");
  if (!signature.isVoid() && signature.outputSignature().isEmpty()) {
    throw new ProcedureException(Status.Procedure.ProcedureRegistrationFailed,"Procedures with zero output fields must be declared as VOID");
  }
  CallableProcedure oldImplementation=procedures.get(name);
  if (oldImplementation == null) {
    procedures.put(name,proc);
  }
 else {
    if (overrideCurrentImplementation) {
      procedures.put(name,proc);
    }
 else {
      throw new ProcedureException(Status.Procedure.ProcedureRegistrationFailed,"Unable to register procedure, because the name `%s` is already in use.",name);
    }
  }
}
