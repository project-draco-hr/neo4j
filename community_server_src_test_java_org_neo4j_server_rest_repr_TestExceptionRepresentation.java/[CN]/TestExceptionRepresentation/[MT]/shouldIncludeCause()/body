{
  ExceptionRepresentation rep=new ExceptionRepresentation(new RuntimeException("Hoho",new RuntimeException("Haha",new RuntimeException("HAHA!"))));
  Map<String,Object> output=new HashMap<String,Object>();
  MappingSerializer serializer=new MappingSerializer(new MapWrappingWriter(output),URI.create(""),mock(ExtensionInjector.class));
  rep.serialize(serializer);
  assertThat(output.containsKey("cause"),is(true));
  assertThat(output.get("cause"),is(Map.class));
  assertThat((String)((Map<String,Object>)output.get("cause")).get("message"),is("Haha"));
  assertThat(((Map<String,Object>)output.get("cause")).get("cause"),is(Map.class));
  assertThat((String)((Map<String,Object>)((Map<String,Object>)output.get("cause")).get("cause")).get("message"),is("HAHA!"));
}
