{
  DefaultFileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();
  tuningConfiguration=configForStoreDir(tuningConfiguration,new File(storeDir));
  ConfiguringPageCacheFactory pageCacheFactory=new ConfiguringPageCacheFactory(fileSystem,tuningConfiguration,PageCacheTracer.NULL);
  PageCache pageCache=pageCacheFactory.getOrCreatePageCache();
  try {
    return runFullConsistencyCheck(storeDir,tuningConfiguration,progressFactory,logger,fileSystem,pageCache);
  }
  finally {
    try {
      pageCache.close();
    }
 catch (    IOException e) {
      logger.error("Failure during shutdown of the page cache",e);
    }
  }
}
