{
  stopDb();
  config=new HashMap<String,String>();
  config.put(Config.NODE_KEYS_INDEXABLE,"nodeProp1, nodeProp2");
  config.put(Config.RELATIONSHIP_KEYS_INDEXABLE,"relProp1, relProp2");
  config.put(Config.NODE_AUTO_INDEXING,"true");
  config.put(Config.RELATIONSHIP_AUTO_INDEXING,"true");
  startDb();
  assertTrue(graphDb.index().getNodeAutoIndexer().isEnabled());
  assertTrue(graphDb.index().getRelationshipAutoIndexer().isEnabled());
  newTransaction();
  Node node1=graphDb.createNode();
  Node node2=graphDb.createNode();
  Node node3=graphDb.createNode();
  Relationship rel12=node1.createRelationshipTo(node2,DynamicRelationshipType.withName("DYNAMIC"));
  Relationship rel23=node2.createRelationshipTo(node3,DynamicRelationshipType.withName("DYNAMIC"));
  Relationship rel31=node3.createRelationshipTo(node1,DynamicRelationshipType.withName("DYNAMIC"));
  node1.setProperty("nodeProp1","node1Value1");
  node1.setProperty("nodePropNonIndexable1","node1ValueNonIndexable");
  node2.setProperty("nodeProp2","node2Value1");
  node2.setProperty("nodePropNonIndexable2","node2ValueNonIndexable");
  node3.setProperty("nodeProp1","node3Value1");
  node3.setProperty("nodeProp2","node3Value2");
  node3.setProperty("nodePropNonIndexable3","node3ValueNonIndexable");
  rel12.setProperty("relProp1","rel12Value1");
  rel12.setProperty("relPropNonIndexable1","rel12ValueNonIndexable");
  rel23.setProperty("relProp2","rel23Value1");
  rel23.setProperty("relPropNonIndexable2","rel23ValueNonIndexable");
  rel31.setProperty("relProp1","rel31Value1");
  rel31.setProperty("relProp2","rel31Value2");
  rel31.setProperty("relPropNonIndexable3","rel31ValueNonIndexable");
  newTransaction();
  AutoIndexer<Node> autoNodeIndexer=graphDb.index().getNodeAutoIndexer();
  assertEquals(node1,autoNodeIndexer.getAutoIndex().get("nodeProp1","node1Value1").getSingle());
  assertEquals(node2,autoNodeIndexer.getAutoIndex().get("nodeProp2","node2Value1").getSingle());
  assertEquals(node3,autoNodeIndexer.getAutoIndex().get("nodeProp1","node3Value1").getSingle());
  assertEquals(node3,autoNodeIndexer.getAutoIndex().get("nodeProp2","node3Value2").getSingle());
  assertFalse(autoNodeIndexer.getAutoIndex().get("nodePropNonIndexable1","node1ValueNonIndexable").hasNext());
  assertFalse(autoNodeIndexer.getAutoIndex().get("nodePropNonIndexable2","node2ValueNonIndexable").hasNext());
  assertFalse(autoNodeIndexer.getAutoIndex().get("nodePropNonIndexable3","node3ValueNonIndexable").hasNext());
  AutoIndexer<Relationship> autoRelIndexer=graphDb.index().getRelationshipAutoIndexer();
  assertEquals(rel12,autoRelIndexer.getAutoIndex().get("relProp1","rel12Value1").getSingle());
  assertEquals(rel23,autoRelIndexer.getAutoIndex().get("relProp2","rel23Value1").getSingle());
  assertEquals(rel31,autoRelIndexer.getAutoIndex().get("relProp1","rel31Value1").getSingle());
  assertEquals(rel31,autoRelIndexer.getAutoIndex().get("relProp2","rel31Value2").getSingle());
  assertFalse(autoRelIndexer.getAutoIndex().get("relPropNonIndexable1","rel12ValueNonIndexable").hasNext());
  assertFalse(autoRelIndexer.getAutoIndex().get("relPropNonIndexable2","rel23ValueNonIndexable").hasNext());
  assertFalse(autoRelIndexer.getAutoIndex().get("relPropNonIndexable3","rel31ValueNonIndexable").hasNext());
}
