{
  stopDb();
  config=new HashMap<String,String>();
  config.put(GraphDatabaseSettings.node_keys_indexable.name(),"propName");
  config.put(GraphDatabaseSettings.node_auto_indexing.name(),"true");
  startDb();
  AutoIndexer<Node> autoIndexer=graphDb.index().getNodeAutoIndexer();
  assertTrue(autoIndexer.isEnabled());
  autoIndexer.setEnabled(false);
  assertFalse(autoIndexer.isEnabled());
  newTransaction();
  Node node1=graphDb.createNode();
  Node node2=graphDb.createNode();
  node1.setProperty("propName","node");
  newTransaction();
  assertFalse(autoIndexer.getAutoIndex().get("nodeProp1","node1").hasNext());
  autoIndexer.setEnabled(true);
  node2.setProperty("propName","node");
  newTransaction();
  assertEquals(node2,autoIndexer.getAutoIndex().get("propName","node").getSingle());
}
