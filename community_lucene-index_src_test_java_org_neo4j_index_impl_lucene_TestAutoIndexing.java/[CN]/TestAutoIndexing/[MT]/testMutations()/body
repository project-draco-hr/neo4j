{
  graphDb.index().getNodeAutoIndexer().startAutoIndexingProperty("nodeProp1");
  graphDb.index().getNodeAutoIndexer().startAutoIndexingProperty("nodeProp2");
  graphDb.index().getNodeAutoIndexer().setEnabled(true);
  Transaction tx=graphDb.beginTx();
  Node node1=null, node2=null, node3=null, node4=null;
  try {
    node1=graphDb.createNode();
    node2=graphDb.createNode();
    node3=graphDb.createNode();
    node4=graphDb.createNode();
    node1.setProperty("nodeProp1","nodeProp1Value");
    node2.setProperty("nodeProp2","nodeProp2Value");
    node3.setProperty("nodeProp1","nodeProp3Value");
    node4.setProperty("nodeProp2","nodeProp4Value");
    tx.success();
  }
 catch (  Exception e) {
    tx.failure();
  }
 finally {
    tx.finish();
  }
  AutoIndexer<Node> nodeAutoIndexer=graphDb.index().getNodeAutoIndexer();
  nodeAutoIndexer.stopAutoIndexingProperty("nodeProp1");
  tx=graphDb.beginTx();
  try {
    node1.setProperty("nodeProp1","nodeProp1Value2");
    node2.setProperty("nodeProp2","nodeProp2Value2");
    node4.removeProperty("nodeProp2");
    tx.success();
  }
 catch (  Exception e) {
    tx.failure();
  }
 finally {
    tx.finish();
  }
  ReadOnlyIndex<Node> nodeAutoIndex=nodeAutoIndexer.getAutoIndex();
  assertFalse(nodeAutoIndex.get("nodeProp1","nodeProp1Value").hasNext());
  assertFalse(nodeAutoIndex.get("nodeProp1","nodeProp1Value2").hasNext());
  assertFalse(nodeAutoIndex.get("nodeProp2","nodeProp2Value").hasNext());
  assertEquals(node2,nodeAutoIndex.get("nodeProp2","nodeProp2Value2").getSingle());
  assertEquals(node3,nodeAutoIndex.get("nodeProp1","nodeProp3Value").getSingle());
  assertFalse(nodeAutoIndex.get("nodeProp2","nodeProp4Value").hasNext());
}
