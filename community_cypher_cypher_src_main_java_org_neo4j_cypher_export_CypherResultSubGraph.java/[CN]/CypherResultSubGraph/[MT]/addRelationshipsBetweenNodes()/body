{
  Set<Node> newNodes=new HashSet<Node>();
  for (  Node node : nodes.values()) {
    for (    Relationship relationship : node.getRelationships()) {
      if (!relationships.containsKey(relationship.getId())) {
        continue;
      }
      final Node other=relationship.getOtherNode(node);
      if (nodes.containsKey(other.getId()) || newNodes.contains(other)) {
        continue;
      }
      newNodes.add(other);
    }
  }
  for (  Node node : newNodes) {
    add(node);
  }
}
