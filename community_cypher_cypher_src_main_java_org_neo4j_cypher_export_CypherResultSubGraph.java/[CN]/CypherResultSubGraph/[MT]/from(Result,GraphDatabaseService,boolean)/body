{
  final CypherResultSubGraph graph=new CypherResultSubGraph();
  final List<String> columns=result.columns();
  for (  Map<String,Object> row : loop(result)) {
    for (    String column : columns) {
      final Object value=row.get(column);
      graph.addToGraph(value);
    }
  }
  for (  IndexDefinition def : gds.schema().getIndexes()) {
    if (graph.getLabels().contains(def.getLabel())) {
      graph.addIndex(def);
    }
  }
  for (  ConstraintDefinition def : gds.schema().getConstraints()) {
    if (graph.getLabels().contains(def.getLabel())) {
      graph.addConstraint(def);
    }
  }
  if (addBetween) {
    graph.addRelationshipsBetweenNodes();
  }
  return graph;
}
