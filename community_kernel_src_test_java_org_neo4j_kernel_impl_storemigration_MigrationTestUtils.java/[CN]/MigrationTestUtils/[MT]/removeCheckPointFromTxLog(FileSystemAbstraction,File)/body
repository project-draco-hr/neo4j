{
  PhysicalLogFiles logFiles=new PhysicalLogFiles(workingDirectory,fileSystem);
  LogEntryReader<ReadableClosablePositionAwareChannel> logEntryReader=new VersionAwareLogEntryReader<>();
  LatestCheckPointFinder finder=new LatestCheckPointFinder(logFiles,fileSystem,logEntryReader);
  LatestCheckPointFinder.LatestCheckPoint latestCheckPoint=finder.find(logFiles.getHighestLogVersion());
  if (latestCheckPoint.commitsAfterCheckPoint) {
    return;
  }
  assertNotNull(latestCheckPoint.checkPoint);
  LogPosition logPosition=latestCheckPoint.checkPoint.getLogPosition();
  File logFile=logFiles.getLogFileForVersion(logPosition.getLogVersion());
  fileSystem.truncate(logFile,logPosition.getByteOffset());
}
