{
  final Iterable<StoreFile> storeFilesWithGivenVersions=Iterables.filter(ALL_EXCEPT_COUNTS_STORE,StoreFile.legacyStoreFilesForVersion(version));
  for (  StoreFile storeFile : storeFilesWithGivenVersions) {
    StoreChannel channel=fileSystem.open(new File(workingDirectory,storeFile.storeFileName()),"r");
    int length=UTF8.encode(version).length;
    byte[] bytes=new byte[length];
    ByteBuffer buffer=ByteBuffer.wrap(bytes);
    channel.position(channel.size() - length);
    channel.read(buffer);
    channel.close();
    String foundVersion=UTF8.decode(bytes);
    if (!version.equals(foundVersion)) {
      return false;
    }
  }
  return true;
}
