{
  if (CatchupClientProtocol.NextMessage.MESSAGE_TYPE.equals(protocol.expecting())) {
    ResponseMessageType responseMessageType=from(((ByteBuf)msg).readByte());
switch (responseMessageType) {
case STORE_ID:
      protocol.expect(CatchupClientProtocol.NextMessage.STORE_ID);
    break;
case TX:
  protocol.expect(CatchupClientProtocol.NextMessage.TX_PULL_RESPONSE);
break;
case FILE:
protocol.expect(CatchupClientProtocol.NextMessage.FILE_HEADER);
break;
case STORE_COPY_FINISHED:
protocol.expect(CatchupClientProtocol.NextMessage.STORE_COPY_FINISHED);
break;
case CORE_SNAPSHOT:
protocol.expect(CatchupClientProtocol.NextMessage.CORE_SNAPSHOT);
break;
case TX_STREAM_FINISHED:
protocol.expect(CatchupClientProtocol.NextMessage.TX_STREAM_FINISHED);
break;
default :
log.warn("No handler found for message type %s",responseMessageType);
}
ReferenceCountUtil.release(msg);
}
 else {
ctx.fireChannelRead(msg);
}
}
