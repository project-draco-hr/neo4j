{
  return new Supplier<T>(){
    volatile V lastValue=null;
    T instance=null;
    @Override public T get(){
      V value=supplier.get();
      if (value == lastValue) {
        return instance;
      }
      T adaptedValue=adaptor.apply(value);
synchronized (this) {
        if (value != lastValue) {
          instance=adaptedValue;
          lastValue=value;
        }
      }
      return instance;
    }
  }
;
}
