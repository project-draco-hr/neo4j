{
  byte[] entityAsBytes;
  try {
    entityAsBytes=entity.getBytes(UTF8);
    if (!mustFail)     representationWriteHandler.onRepresentationWritten();
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException("Could not encode string as UTF-8",e);
  }
 finally {
    representationWriteHandler.onRepresentationFinal();
  }
  return entityAsBytes;
}
