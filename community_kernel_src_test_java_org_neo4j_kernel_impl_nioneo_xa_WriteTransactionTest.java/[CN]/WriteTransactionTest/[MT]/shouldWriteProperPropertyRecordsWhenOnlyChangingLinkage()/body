{
  WriteTransaction tx=newWriteTransaction(NO_INDEXING);
  int nodeId=0;
  tx.nodeCreate(nodeId);
  Token index=new Token("key",0);
  tx.nodeAddProperty(nodeId,index,string(70));
  prepareAndCommit(tx);
  Visitor<XaCommand,RuntimeException> verifier=new Visitor<XaCommand,RuntimeException>(){
    @Override public boolean visit(    XaCommand element){
      if (element instanceof PropertyCommand) {
        PropertyCommand propertyCommand=(PropertyCommand)element;
        verifyPropertyRecord(propertyCommand.getBefore());
        verifyPropertyRecord(propertyCommand.getAfter());
        return true;
      }
      return false;
    }
    private void verifyPropertyRecord(    PropertyRecord record){
      if (record.getPrevProp() != Record.NO_NEXT_PROPERTY.intValue()) {
        for (        PropertyBlock block : record.getPropertyBlocks())         assertTrue(block.isLight());
      }
    }
  }
;
  tx=newWriteTransaction(NO_INDEXING,verifier);
  Token index2=new Token("key2",1);
  tx.nodeAddProperty(nodeId,index2,string(40));
  prepareAndCommit(tx);
}
