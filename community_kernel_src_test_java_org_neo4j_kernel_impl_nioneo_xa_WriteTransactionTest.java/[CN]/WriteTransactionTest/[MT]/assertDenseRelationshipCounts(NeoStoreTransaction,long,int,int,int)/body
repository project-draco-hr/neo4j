{
  RelationshipGroupRecord group=tx.getRelationshipGroup(tx.nodeLoadLight(nodeId),type).forReadingData();
  assertNotNull(group);
  RelationshipRecord rel;
  long relId=group.getFirstOut();
  if (relId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    rel=tx.relLoadLight(relId);
    assertEquals("Stored relationship count for OUTGOING differs",outCount,rel.getFirstPrevRel());
    assertEquals("Manually counted relationships for OUTGOING differs",outCount,manuallyCountRelationships(tx,nodeId,relId));
  }
  relId=group.getFirstIn();
  if (relId != Record.NO_NEXT_RELATIONSHIP.intValue()) {
    rel=tx.relLoadLight(relId);
    assertEquals("Stored relationship count for INCOMING differs",inCount,rel.getSecondPrevRel());
    assertEquals("Manually counted relationships for INCOMING differs",inCount,manuallyCountRelationships(tx,nodeId,relId));
  }
}
