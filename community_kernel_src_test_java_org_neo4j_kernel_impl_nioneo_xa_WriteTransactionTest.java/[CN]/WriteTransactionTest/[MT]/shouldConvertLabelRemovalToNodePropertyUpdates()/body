{
  long nodeId=0;
  NeoStoreTransaction writeTransaction=newWriteTransaction(mockIndexing).first();
  int propertyKey1=1, propertyKey2=2, labelId=3;
  long[] labelIds=new long[]{labelId};
  Object value1="first", value2=4;
  writeTransaction.nodeCreate(nodeId);
  writeTransaction.nodeAddProperty(nodeId,propertyKey1,value1);
  writeTransaction.nodeAddProperty(nodeId,propertyKey2,value2);
  writeTransaction.addLabelToNode(labelId,nodeId);
  prepareAndCommit(writeTransaction);
  CapturingIndexingService indexingService=new CapturingIndexingService();
  writeTransaction=newWriteTransaction(indexingService).first();
  writeTransaction.removeLabelFromNode(labelId,nodeId);
  prepareAndCommit(writeTransaction);
  assertEquals(asSet(remove(nodeId,propertyKey1,value1,labelIds),remove(nodeId,propertyKey2,value2,labelIds)),indexingService.updates);
}
