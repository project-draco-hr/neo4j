{
  new Thread(){
    @Override public void run(){
      assertHealthy();
      try {
        try {
          lastProcessingTimestamp=currentTimeMillis();
          process();
        }
  finally {
          endOfUpstream();
        }
      }
 catch (      Throwable e) {
        issuePanic(e);
      }
    }
  }
.start();
  return 0;
}
