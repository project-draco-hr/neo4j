{
  if (startNode == nodeId) {
    return endNode == nodeId ? Direction.BOTH : Direction.OUTGOING;
  }
  if (endNode == nodeId) {
    return Direction.INCOMING;
  }
  throw new InvalidRecordException("Node " + nodeId + " neither start nor end node of relationship "+ relationshipId+ " with startNode:"+ startNode+ " and endNode:"+ endNode);
}
