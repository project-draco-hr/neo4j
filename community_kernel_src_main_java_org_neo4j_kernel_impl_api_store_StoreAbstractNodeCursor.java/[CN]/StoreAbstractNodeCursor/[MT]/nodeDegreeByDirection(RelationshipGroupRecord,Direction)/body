{
  long loopCount=countByFirstPrevPointer(group.getFirstLoop());
switch (direction) {
case OUTGOING:
    return countByFirstPrevPointer(group.getFirstOut()) + loopCount;
case INCOMING:
  return countByFirstPrevPointer(group.getFirstIn()) + loopCount;
case BOTH:
return countByFirstPrevPointer(group.getFirstOut()) + countByFirstPrevPointer(group.getFirstIn()) + loopCount;
default :
throw new IllegalArgumentException(direction.name());
}
}
