{
  if (relationshipId == Record.NO_NEXT_RELATIONSHIP.intValue()) {
    return 0;
  }
  cursors.relationship().next(relationshipId,record,FORCE);
  if (record.getFirstNode() == nodeRecord.getId()) {
    return record.getFirstPrevRel();
  }
  if (record.getSecondNode() == nodeRecord.getId()) {
    return record.getSecondPrevRel();
  }
  throw new InvalidRecordException("Node " + nodeRecord.getId() + " neither start nor end node of "+ record);
}
