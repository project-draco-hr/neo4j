{
  if (nodeRecord.isDense()) {
    long groupId=nodeRecord.getNextRel();
    return new DegreeItemDenseCursor(groupId);
  }
 else {
    final PrimitiveIntObjectMap<int[]> degrees=Primitive.intObjectMap(5);
    try (Cursor<RelationshipItem> relationship=relationships(Direction.BOTH)){
      while (relationship.next()) {
        RelationshipItem rel=relationship.get();
        int[] byType=degrees.get(rel.type());
        if (byType == null) {
          degrees.put(rel.type(),byType=new int[3]);
        }
        byType[directionOf(nodeRecord.getId(),rel.id(),rel.startNode(),rel.endNode()).ordinal()]++;
      }
    }
     final PrimitiveIntIterator keys=degrees.iterator();
    return new DegreeItemIterator(keys,degrees);
  }
}
