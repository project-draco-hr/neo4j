{
  Session session=null;
  String cmd=StringUtils.join(cmds," ");
  try {
    session=client.startSession();
    Shell.logOutput(vmName + " $ ",cmd);
    Command command=session.exec(cmd);
    String msg=Shell.outputToString(vmName,command.getInputStream()) + Shell.outputToString(vmName,command.getErrorStream());
    try {
      int x=command.getExitStatus();
      return new Result(x,msg,cmd);
    }
 catch (    NullPointerException e) {
      e.printStackTrace();
      return new Result(-1,msg,cmd);
    }
  }
 catch (  Exception e) {
    throw new ShellException(e);
  }
 finally {
    if (session != null) {
      try {
        session.close();
      }
 catch (      Exception e) {
        throw new ShellException(e);
      }
    }
  }
}
