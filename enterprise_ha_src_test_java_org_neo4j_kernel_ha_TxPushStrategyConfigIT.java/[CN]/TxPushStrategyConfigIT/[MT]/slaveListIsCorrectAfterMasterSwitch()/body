{
  ManagedCluster cluster=startCluster(3,1,HaSettings.TxPushStrategy.fixed_ascending);
  cluster.shutdown(cluster.getMaster());
  cluster.await(masterAvailable());
  HighlyAvailableGraphDatabase newMaster=cluster.getMaster();
  cluster.await(masterSeesSlavesAsAvailable(1));
  createTransaction(cluster,newMaster);
  assertLastTransactions(cluster,lastTx(FIRST_SLAVE,BASE_TX_ID + 1),lastTx(SECOND_SLAVE,BASE_TX_ID + 1));
}
