{
  if (transaction == null) {
    throw new NotInTransactionException();
  }
  if (transaction.shouldBeTerminated()) {
    throw new TransactionTerminatedException();
  }
}
