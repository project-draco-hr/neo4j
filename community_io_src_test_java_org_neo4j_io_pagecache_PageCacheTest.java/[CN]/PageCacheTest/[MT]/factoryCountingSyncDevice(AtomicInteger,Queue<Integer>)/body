{
  SingleFilePageSwapperFactory factory=new SingleFilePageSwapperFactory(){
    @Override public void syncDevice(){
      super.syncDevice();
      syncDeviceCounter.getAndIncrement();
    }
    @Override public PageSwapper createPageSwapper(    File file,    int filePageSize,    PageEvictionCallback onEviction,    boolean createIfNotExist) throws IOException {
      PageSwapper delegate=super.createPageSwapper(file,filePageSize,onEviction,createIfNotExist);
      return new DelegatingPageSwapper(delegate){
        @Override public void force() throws IOException {
          super.force();
          assertThat(syncDeviceCounter.get(),is(expectedCountsInForce.poll()));
        }
      }
;
    }
  }
;
  factory.setFileSystemAbstraction(fs);
  return factory;
}
