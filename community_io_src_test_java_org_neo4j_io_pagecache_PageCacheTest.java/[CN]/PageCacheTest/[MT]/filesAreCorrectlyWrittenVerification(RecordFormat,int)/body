{
  return new Phase(){
    @Override public void run(    PageCache pageCache,    FileSystemAbstraction fs,    Set<File> filesTouched) throws Exception {
      for (      File file : filesTouched) {
        try (PagedFile pf=pageCache.map(file,pageCachePageSize);PageCursor cursor=pf.io(0,PF_SHARED_LOCK)){
          for (int pageId=0; pageId < filePageCount && cursor.next(); pageId++) {
            try {
              recordFormat.assertRecordsWrittenCorrectly(cursor);
            }
 catch (            Throwable th) {
              th.addSuppressed(new Exception("pageId = " + pageId));
              throw th;
            }
          }
        }
         try (StoreChannel channel=fs.open(file,"r")){
          recordFormat.assertRecordsWrittenCorrectly(file,channel);
        }
       }
    }
  }
;
}
