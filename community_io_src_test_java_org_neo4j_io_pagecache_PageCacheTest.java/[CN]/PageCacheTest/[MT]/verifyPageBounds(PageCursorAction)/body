{
  generateFileWithRecords(file,1,recordSize);
  getPageCache(fs,maxPages,pageCachePageSize,PageCacheMonitor.NULL);
  PagedFile pagedFile=pageCache.map(file,filePageSize);
  try (PageCursor cursor=pagedFile.io(0,PF_SHARED_LOCK)){
    cursor.next();
    for (int i=0; i < 100000; i++) {
      action.apply(cursor);
    }
  }
  finally {
    pageCache.unmap(file);
  }
}
