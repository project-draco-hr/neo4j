{
  int pageSize=1024 * 1024 * 8;
  getPageCache(fs,10,pageSize,PageCacheMonitor.NULL);
  ThreadLocalRandom rng=ThreadLocalRandom.current();
  try (PagedFile pagedFile=pageCache.map(file,filePageSize);PageCursor cursor=pagedFile.io(0,PF_EXCLUSIVE_LOCK)){
    assertTrue(cursor.next());
    for (int i=0; i < pageSize - 8; i++) {
      cursor.setOffset(i);
      long x=rng.nextLong();
      cursor.putLong(x);
      cursor.setOffset(i);
      String reason="Failed to read back the value that was written at " + "offset " + toHexString(i);
      assertThat(reason,toHexString(cursor.getLong()),is(toHexString(x)));
    }
  }
 }
