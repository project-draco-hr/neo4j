{
  final AuthorizationFilter filter=new AuthorizationFilter(authManager,logProvider,Pattern.compile("/"),Pattern.compile("/browser.*"));
  when(servletRequest.getMethod()).thenReturn("GET");
  when(servletRequest.getContextPath()).thenReturn("/db/data");
  filter.doFilter(servletRequest,servletResponse,filterChain);
  verifyNoMoreInteractions(filterChain);
  verify(servletResponse).setStatus(401);
  verify(servletResponse).addHeader(HttpHeaders.WWW_AUTHENTICATE,"Basic realm=\"Neo4j\"");
  verify(servletResponse).addHeader(HttpHeaders.CONTENT_TYPE,"application/json; charset=UTF-8");
  assertThat(outputStream.toString(StandardCharsets.UTF_8.name()),containsString("\"code\" : \"Neo.ClientError" + ".Security.AuthorizationFailed\""));
  assertThat(outputStream.toString(StandardCharsets.UTF_8.name()),containsString("\"message\" : \"No authorization header supplied.\""));
}
