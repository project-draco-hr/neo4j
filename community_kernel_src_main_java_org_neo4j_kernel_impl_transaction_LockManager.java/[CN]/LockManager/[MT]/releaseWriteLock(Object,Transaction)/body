{
  if (resource == null) {
    throw new IllegalResourceException("Null parameter");
  }
  RWLock lock=null;
synchronized (resourceLockMap) {
    lock=resourceLockMap.get(resource);
    if (lock == null) {
      throw new LockNotFoundException("Lock not found for: " + resource);
    }
    if (!lock.isMarked() && lock.getReadCount() == 0 && lock.getWriteCount() == 1 && lock.getWaitingThreadsCount() == 0) {
      resourceLockMap.remove(resource);
    }
    lock.releaseWriteLock(tx);
  }
}
