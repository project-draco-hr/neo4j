{
  if (null == labelScanStore) {
    IndexStorageFactory storageFactory=new IndexStorageFactory(DirectoryFactory.PERSISTENT,fileSystem,LabelScanStoreProvider.getStoreDirectory(storeDir));
    IndexStorage indexStorage=storageFactory.labelScanStorage();
    labelScanStore=new LuceneLabelScanStore(new NodeRangeDocumentLabelScanStorageStrategy(),indexStorage,IndexWriterFactories.standard(),fullStoreStream,LuceneLabelScanStore.loggerMonitor(logProvider));
    try {
      labelScanStore.init();
      labelScanStore.start();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  return labelScanStore;
}
