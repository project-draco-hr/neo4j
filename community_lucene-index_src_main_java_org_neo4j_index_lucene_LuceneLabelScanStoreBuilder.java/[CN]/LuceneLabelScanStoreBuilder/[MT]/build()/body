{
  if (null == labelScanStore) {
    PartitionedIndexStorage indexStorage=new PartitionedIndexStorage(DirectoryFactory.PERSISTENT,fileSystem,LabelScanStoreProvider.getStoreDirectory(storeDir),LuceneLabelScanStore.INDEX_IDENTIFIER);
    LuceneLabelScanIndex index=new LuceneLabelScanIndex(indexStorage);
    labelScanStore=new LuceneLabelScanStore(index,fullStoreStream,logProvider,LuceneLabelScanStore.Monitor.EMPTY);
    try {
      labelScanStore.init();
      labelScanStore.start();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  return labelScanStore;
}
