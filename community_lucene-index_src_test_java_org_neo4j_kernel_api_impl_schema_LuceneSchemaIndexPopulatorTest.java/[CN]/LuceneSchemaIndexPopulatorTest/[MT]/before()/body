{
  directory=new RAMDirectory();
  DirectoryFactory directoryFactory=new DirectoryFactory.Single(new DirectoryFactory.UncloseableDirectory(directory));
  provider=new LuceneSchemaIndexProvider(fs.get(),directoryFactory,testDir.directory("folder"));
  indexDescriptor=new IndexDescriptor(42,propertyKeyId);
  indexStoreView=mock(IndexStoreView.class);
  IndexConfiguration indexConfig=IndexConfiguration.NON_UNIQUE;
  IndexSamplingConfig samplingConfig=new IndexSamplingConfig(new Config());
  index=provider.getPopulator(indexId,indexDescriptor,indexConfig,samplingConfig);
  index.create();
}
