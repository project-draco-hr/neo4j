{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  if (!subject.isAdmin() && !subject.doesUsernameMatch(username)) {
    throw new AuthorizationViolationException(PERMISSION_DENIED);
  }
  subject.getUserManager().getUser(username);
  Long killCount=0L;
  for (  HaltableUserSession session : getSessionManager().getActiveSessions()) {
    if (session.username().equals(username)) {
      session.markForHalting(Status.Session.InvalidSession,Status.Session.InvalidSession.code().description());
      killCount+=1;
    }
  }
  return Stream.of(new SessionResult(username,killCount));
}
