{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  subject.getUserManager().getUser(username);
  if (subject.isAdmin() || subject.doesUsernameMatch(username)) {
    return subject;
  }
  throw new AuthorizationViolationException(PERMISSION_DENIED);
}
