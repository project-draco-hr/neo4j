{
  StandardEnterpriseAuthSubject subject=StandardEnterpriseAuthSubject.castOrFail(authSubject);
  if (subject.isAdmin() || subject.doesUsernameMatch(username)) {
    subject.getUserManager().getUser(username);
    return subject;
  }
  throw new AuthorizationViolationException(PERMISSION_DENIED);
}
