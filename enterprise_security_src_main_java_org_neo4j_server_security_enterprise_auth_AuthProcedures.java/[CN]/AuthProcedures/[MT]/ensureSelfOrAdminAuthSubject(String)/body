{
  EnterpriseAuthSubject subject=EnterpriseAuthSubject.castOrFail(authSubject);
  assert(subject.getUserManager().getUser(username) != null);
  if (subject.isAdmin() || subject.doesUsernameMatch(username)) {
    return subject;
  }
  throw new AuthorizationViolationException(PERMISSION_DENIED);
}
