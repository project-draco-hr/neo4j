{
  ShiroAuthSubject shiroSubject=ShiroAuthSubject.castOrFail(authSubject);
  if (!shiroSubject.isAdmin()) {
    throw new AuthorizationViolationException(PERMISSION_DENIED);
  }
  shiroSubject.getRoleManager().addUserToRole(username,roleName);
}
