{
  StandardEnterpriseAuthSubject subject=StandardEnterpriseAuthSubject.castOrFail(authSubject);
  if (!subject.isAdmin() && !subject.doesUsernameMatch(username)) {
    throw new AuthorizationViolationException(PERMISSION_DENIED);
  }
  subject.getUserManager().getUser(username);
  return terminateConnectionsForValidUser(username);
}
