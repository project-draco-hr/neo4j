{
  Map<String,Node> graph=data.get();
  Set<Node> unique=new HashSet<Node>();
  Node n=graph.get("a");
  while (unique.add(n)) {
    Transaction transaction=graphdb.beginTx();
    try {
      n=n.getSingleRelationship(DynamicRelationshipType.withName("TO"),Direction.OUTGOING).getEndNode();
    }
  finally {
      transaction.finish();
    }
  }
  assertEquals(graph.size(),unique.size());
}
