{
  Configuration config=movingAverageConfig(10);
  DynamicProcessorAssigner assigner=new DynamicProcessorAssigner(config,5);
  ControlledStep<?> slowStep=new ControlledStep<>("slow",true);
  slowStep.setStat(Keys.avg_processing_time,10);
  slowStep.setStat(Keys.done_batches,10);
  ControlledStep<?> fastStep=new ControlledStep<>("fast",true);
  fastStep.setStat(Keys.avg_processing_time,2);
  fastStep.setStat(Keys.done_batches,10);
  StageExecution[] execution=executionOf(config,slowStep,fastStep);
  assigner.start(execution);
  assigner.check(execution);
  assertEquals(5,slowStep.numberOfProcessors());
  assertEquals(1,fastStep.numberOfProcessors());
}
