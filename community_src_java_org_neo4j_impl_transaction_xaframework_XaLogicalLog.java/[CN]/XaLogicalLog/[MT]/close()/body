{
  if (xidIdentMap.size() > 0) {
    log.info("Active transactions: " + xidIdentMap.size());
    log.info("Closing dirty log: " + fileName);
    writeBuffer.force();
    fileChannel.close();
    return;
  }
  writeBuffer.force();
  writeBuffer=null;
  fileChannel.close();
  File file=new File(fileName);
  if (!file.exists()) {
    throw new IOException("Logical log[" + fileName + "] not found");
  }
  try {
    file.delete();
  }
 catch (  Exception e) {
    try {
      Thread.sleep(500);
      file.delete();
    }
 catch (    Throwable t) {
      log.warning("Unable to delete clean logical log[" + fileName + "]"+ e);
      log.info("Since you're not using a real operating system " + "you will be punished for it at next startup");
    }
  }
}
