{
  CharSeeker headerSeeker=null;
  try {
    headerSeeker=headerCharSeekerFactory.open(dataSeeker,config);
    Mark mark=new Mark();
    Extractors extractors=new Extractors(config.arrayDelimiter());
    Extractor<?> idExtractor=idType.extractor(extractors);
    int[] delimiter=new int[]{config.delimiter()};
    List<Header.Entry> columns=new ArrayList<>();
    for (int i=0; !mark.isEndOfLine() && headerSeeker.seek(mark,delimiter); i++) {
      String entryString=headerSeeker.tryExtract(mark,extractors.string()) ? extractors.string().value() : null;
      HeaderEntrySpec spec=new HeaderEntrySpec(entryString);
      if (spec.name == null && spec.type == null) {
        columns.add(new Header.Entry(null,Type.IGNORE,null,null));
      }
 else {
        columns.add(entry(i,spec.name,spec.type,spec.groupName,extractors,idExtractor));
      }
    }
    Entry[] entries=columns.toArray(new Header.Entry[columns.size()]);
    validateHeader(entries);
    return new Header(entries);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    if (headerSeeker != null) {
      headerCharSeekerFactory.close(headerSeeker);
    }
  }
}
