{
  CharSeeker headerSeeker=null;
  try {
    headerSeeker=headerCharSeekerFactory.open(dataSeeker,config);
    Mark mark=new Mark();
    Extractors extractors=new Extractors(config.arrayDelimiter());
    Extractor<?> idExtractor=idType.extractor(extractors);
    int[] delimiter=new int[]{config.delimiter()};
    List<Header.Entry> columns=new ArrayList<>();
    for (int i=0; !mark.isEndOfLine() && headerSeeker.seek(mark,delimiter); i++) {
      String entryString=headerSeeker.extract(mark,extractors.string()).value();
      int typeIndex=entryString.lastIndexOf(':');
      String name;
      String typeSpec;
      if (typeIndex != -1) {
        name=entryString.substring(0,typeIndex);
        if (name.length() == 0) {
          name=null;
        }
        typeSpec=entryString.substring(typeIndex + 1);
      }
 else {
        name=entryString;
        typeSpec=null;
      }
      columns.add(entry(i,name,typeSpec,extractors,idExtractor));
    }
    Entry[] entries=columns.toArray(new Header.Entry[columns.size()]);
    validateHeader(entries);
    return new Header(entries);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    if (headerSeeker != null) {
      headerCharSeekerFactory.close(headerSeeker);
    }
  }
}
