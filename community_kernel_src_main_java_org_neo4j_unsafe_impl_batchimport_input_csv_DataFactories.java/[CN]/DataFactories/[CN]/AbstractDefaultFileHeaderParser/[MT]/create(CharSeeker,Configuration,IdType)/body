{
  CharSeeker headerSeeker=null;
  try {
    headerSeeker=headerCharSeekerFactory.open(dataSeeker,config);
    Mark mark=new Mark();
    Extractors extractors=new Extractors(config.arrayDelimiter());
    Extractor<?> idExtractor=idType.extractor(extractors);
    int[] delimiter=new int[]{config.delimiter()};
    List<Header.Entry> columns=new ArrayList<>();
    for (int i=0; !mark.isEndOfLine() && headerSeeker.seek(mark,delimiter); i++) {
      String entryString=headerSeeker.tryExtract(mark,extractors.string()) ? extractors.string().value() : null;
      int typeIndex=entryString != null ? entryString.lastIndexOf(':') : -1;
      String name;
      String typeSpec;
      if (typeIndex != -1) {
        name=typeIndex > 0 ? entryString.substring(0,typeIndex) : null;
        typeSpec=entryString.substring(typeIndex + 1);
      }
 else {
        name=entryString;
        typeSpec=null;
      }
      if (name == null && typeSpec == null) {
        columns.add(new Header.Entry(null,Type.IGNORE,null));
      }
 else {
        columns.add(entry(i,name,typeSpec,extractors,idExtractor));
      }
    }
    Entry[] entries=columns.toArray(new Header.Entry[columns.size()]);
    validateHeader(entries);
    return new Header(entries);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    if (headerSeeker != null) {
      headerCharSeekerFactory.close(headerSeeker);
    }
  }
}
