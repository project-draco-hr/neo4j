{
  Map<String,Entry> properties=new HashMap<>();
  Map<Type,Entry> singletonEntries=new HashMap<>();
  for (  Entry entry : entries) {
switch (entry.type()) {
case PROPERTY:
      Entry existingPropertyEntry=properties.get(entry.name());
    if (existingPropertyEntry != null) {
      throw new DuplicateHeaderException(existingPropertyEntry,entry);
    }
  properties.put(entry.name(),entry);
break;
case ID:
case START_NODE:
case END_NODE:
case RELATIONSHIP_TYPE:
Entry existingSingletonEntry=singletonEntries.get(entry.type());
if (existingSingletonEntry != null) {
throw new DuplicateHeaderException(existingSingletonEntry,entry);
}
singletonEntries.put(entry.type(),entry);
break;
}
}
for (Type type : mandatoryTypes) {
if (!singletonEntries.containsKey(type)) {
throw new MissingHeaderException(type);
}
}
}
