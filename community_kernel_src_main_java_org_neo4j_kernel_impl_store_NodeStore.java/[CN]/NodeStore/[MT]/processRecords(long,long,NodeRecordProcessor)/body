{
  long startPageId=pageIdForRecord(fromRecordId);
  long currentPageId=startPageId;
  long endPageId=pageIdForRecord(toRecordId);
  long currentRecordId=fromRecordId;
  NodeRecord record=new NodeRecord(0);
  int recordsPerPage=storeFile.pageSize() / getRecordSize();
  try (PageCursor cursor=storeFile.io(startPageId,PF_SHARED_LOCK | PF_READ_AHEAD)){
    while (currentPageId <= endPageId && cursor.next()) {
      for (int i=0; i < recordsPerPage; i++) {
        record.setId(currentRecordId);
        int offset=offsetForId(currentRecordId);
        do {
          cursor.setOffset(offset);
          byte inUseByte=cursor.getByte();
          boolean isInUse=isInUse(inUseByte);
          readIntoRecord(cursor,record,inUseByte,isInUse);
        }
 while (cursor.shouldRetry());
        if (record.inUse()) {
          processor.process(record);
        }
        currentRecordId++;
      }
      currentPageId++;
    }
  }
 }
