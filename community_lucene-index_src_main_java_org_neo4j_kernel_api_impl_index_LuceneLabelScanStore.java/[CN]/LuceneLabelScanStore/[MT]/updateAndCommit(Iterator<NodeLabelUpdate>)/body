{
  while (updates.hasNext()) {
    NodeLabelUpdate update=updates.next();
    Term documentTerm=documentStructure.newQueryForChangeOrRemove(update.getNodeId());
    if (update.getLabelsAfter().length > 0) {
      Document document=documentStructure.newDocument(update.getNodeId());
      for (      long label : update.getLabelsAfter()) {
        document.add(documentStructure.newField(LABEL_FIELD_IDENTIFIER,label));
      }
      writer.updateDocument(documentTerm,document);
    }
 else {
      writer.deleteDocuments(documentTerm);
    }
  }
  searcherManager.maybeRefresh();
}
