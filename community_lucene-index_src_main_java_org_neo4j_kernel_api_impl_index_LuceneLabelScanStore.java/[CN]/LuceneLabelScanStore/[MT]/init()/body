{
  monitor.init();
  try {
    directory=indexStorage.openDirectory(indexStorage.getIndexFolder());
    DirectoryReader.open(indexStorage.getIndexDirectory()).close();
    writer=writerFactory.create(indexStorage.getIndexDirectory());
  }
 catch (  IndexNotFoundException e) {
    monitor.noIndex();
    prepareRebuildOfIndex();
    writer=writerFactory.create(indexStorage.getIndexDirectory());
  }
catch (  LockObtainFailedException e) {
    monitor.lockedIndex(e);
    throw e;
  }
catch (  IOException e) {
    monitor.corruptIndex(e);
    throw new IOException("Label scan store could not be read, and needs to be rebuilt. " + "To trigger a rebuild, ensure the database is stopped, delete the files in '" + indexStorage.getIndexFolder() + "', and then start the database again.");
  }
  searcherManager=writer.createSearcherManager();
}
