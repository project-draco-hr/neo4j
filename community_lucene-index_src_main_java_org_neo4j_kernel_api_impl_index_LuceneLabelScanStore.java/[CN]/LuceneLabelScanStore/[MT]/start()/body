{
  if (needsRebuild) {
    monitor.rebuilding();
    updateAndCommit(fullStoreStream.iterator());
    monitor.rebuilt(fullStoreStream.highestNodeId());
    needsRebuild=false;
  }
}
