{
  out.writeArrayFieldStart("nodes");
  try {
    for (    Node node : nodes) {
      out.writeStartObject();
      try {
        long nodeId=node.getId();
        out.writeStringField("id",Long.toString(nodeId));
        if (txStateChecker.isNodeDeletedInCurrentTx(nodeId)) {
          markDeleted(out);
        }
 else {
          out.writeArrayFieldStart("labels");
          try {
            for (            Label label : node.getLabels()) {
              out.writeString(label.name());
            }
          }
  finally {
            out.writeEndArray();
          }
          writeProperties(out,node);
        }
      }
  finally {
        out.writeEndObject();
      }
    }
  }
  finally {
    out.writeEndArray();
  }
}
