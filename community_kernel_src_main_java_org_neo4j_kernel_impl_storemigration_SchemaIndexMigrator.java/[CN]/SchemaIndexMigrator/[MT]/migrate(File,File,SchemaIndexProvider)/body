{
switch (versionToUpgradeFrom(storeDir)) {
case Legacy20Store.LEGACY_VERSION:
case Legacy21Store.LEGACY_VERSION:
    deleteIndexesContainingArrayValues(storeDir,schemaIndexProvider);
  break;
default :
throw new IllegalStateException("Unknown version to upgrade from: " + versionToUpgradeFrom(storeDir));
}
}
