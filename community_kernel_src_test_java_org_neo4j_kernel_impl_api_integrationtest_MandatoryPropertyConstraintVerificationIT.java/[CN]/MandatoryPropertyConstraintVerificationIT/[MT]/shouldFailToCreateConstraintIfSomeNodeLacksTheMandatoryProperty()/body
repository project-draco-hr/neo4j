{
  try (Transaction tx=db.beginTx()){
    db.createNode(label("Foo"));
    tx.success();
  }
   try {
    try (Transaction tx=db.beginTx()){
      db.schema().constraintFor(label("Foo")).assertPropertyExists("bar").create();
      tx.success();
    }
     fail("expected exception");
  }
 catch (  ConstraintViolationException e) {
    assertThat(e.getCause(),instanceOf(CreateConstraintFailureException.class));
  }
}
