{
  RaftState state=raftState().myself(myself).build();
  Follower follower=new Follower();
  int localAppendIndex=2;
  int localCommitIndex=localAppendIndex - 1;
  int term=0;
  appendSomeEntriesToLog(state,follower,localAppendIndex + 1,term);
  Outcome raftTestMemberOutcome=new Outcome(FOLLOWER,state);
  raftTestMemberOutcome.setCommitIndex(localCommitIndex);
  state.update(raftTestMemberOutcome);
  assertEquals(localAppendIndex,state.entryLog().appendIndex());
  assertEquals(localCommitIndex,state.commitIndex());
  Outcome outcome=follower.handle(appendEntriesRequest().leaderTerm(term).prevLogIndex(2).prevLogTerm(term).leaderCommit(localCommitIndex + 4).build(),state,log());
  state.update(outcome);
  assertEquals(2,state.commitIndex());
}
