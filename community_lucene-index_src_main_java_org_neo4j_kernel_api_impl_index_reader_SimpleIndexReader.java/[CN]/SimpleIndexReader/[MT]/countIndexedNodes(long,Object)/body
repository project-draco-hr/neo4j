{
  Query nodeIdQuery=new TermQuery(LuceneDocumentStructure.newTermForChangeOrRemove(nodeId));
  Query valueQuery=LuceneDocumentStructure.newSeekQuery(propertyValue);
  BooleanQuery.Builder nodeIdAndValueQuery=new BooleanQuery.Builder().setDisableCoord(true);
  nodeIdAndValueQuery.add(nodeIdQuery,BooleanClause.Occur.MUST);
  nodeIdAndValueQuery.add(valueQuery,BooleanClause.Occur.MUST);
  try {
    TotalHitCountCollector collector=new TotalHitCountCollector();
    getIndexSearcher().search(nodeIdAndValueQuery.build(),collector);
    return collector.getTotalHits();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
