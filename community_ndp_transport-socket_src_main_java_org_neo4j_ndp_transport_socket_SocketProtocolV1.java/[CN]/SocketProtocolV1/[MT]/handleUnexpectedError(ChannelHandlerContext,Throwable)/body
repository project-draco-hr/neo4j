{
  try {
    try {
      packer.handleFailureMessage(errorTranslator.translate(e));
      packer.flush();
    }
 catch (    Throwable e1) {
      log.error(String.format("Session %s: Secondary error while notifying client of problem: %s",session.key(),e.getMessage()),e);
    }
 finally {
      channelContext.close();
    }
  }
  finally {
    close();
  }
}
