{
  onBatchOfMessagesStarted();
  while (data.readableBytes() > 0) {
    int chunkSize=data.readUnsignedShort();
    if (chunkSize > 0) {
      if (chunkSize <= data.readableBytes()) {
        input.addChunk(data.readSlice(chunkSize));
      }
 else {
        throw new UnsupportedOperationException("Chunks split across packets not yet supported");
      }
    }
 else {
      processChunkedMessage(channelContext);
    }
  }
  onBatchOfMessagesDone();
}
