{
  ChannelBuffer readBuffer=readNext();
  byte header=readBuffer.readByte();
  more=(header & 0x1) != 0;
  failure=(header & 0x2) != 0;
  if ((header & 0xFC) != 0)   throw new ComException("Unexpected header " + header);
  if (!more && buffer == null) {
    buffer=readBuffer;
  }
 else {
    buffer=buffer == null ? ChannelBuffers.dynamicBuffer() : buffer;
    discardReadBytes();
    buffer.writeBytes(readBuffer);
  }
  if (failure)   readAndThrowFailureResponse();
}
