{
  this.storeDir=storeDir;
  this.txFactory=txFactory;
  TxModule txModule=newTxModule(inputParams);
  LockManager lockManager=lockManagerFactory.create(txModule);
  LockReleaser lockReleaser=new LockReleaser(lockManager,txModule.getTxManager());
  Config config=new Config(graphDbService,storeDir,inputParams,kernelPanicEventGenerator,txModule,lockManager,lockReleaser,idGeneratorFactory,new SyncHookFactory(),relTypeCreator,txIdFactory.create(txModule.getTxManager()));
  graphDbInstance=new GraphDbInstance(storeDir,true,config);
  Map<Object,Object> params=graphDbInstance.start(graphDbService);
  nodeManager=config.getGraphDbModule().getNodeManager();
  this.graphDbService=graphDbService;
  jmxShutdownHook=initJMX(params);
  enableRemoteShellIfConfigSaysSo(params);
}
