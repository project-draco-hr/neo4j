{
  StoreFileChannel channel=mock(StoreFileChannel.class);
  when(channel.read(any(ByteBuffer.class))).thenReturn(-1);
  FileSystemAbstraction fsa=mock(FileSystemAbstraction.class);
  when(fsa.open(any(File.class),anyString())).thenReturn(channel);
  OnDiskTermState state=new OnDiskTermState(fsa,testDir.directory(),100,mock(Supplier.class));
  state.update(100L);
  verify(channel).write(any(ByteBuffer.class));
  verify(channel).flush();
}
