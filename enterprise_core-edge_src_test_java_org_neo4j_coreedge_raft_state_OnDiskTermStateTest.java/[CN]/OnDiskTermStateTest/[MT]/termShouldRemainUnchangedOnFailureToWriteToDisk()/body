{
  StoreFileChannel channel=newFileChannelMock();
  FileSystemAbstraction fsa=newFileSystemMock(channel);
  doThrow(new IOException()).when(channel).writeAll(any(ByteBuffer.class));
  OnDiskTermState store=new OnDiskTermState(fsa,testDir.directory(),100,mock(Supplier.class));
  assertEquals(0,store.currentTerm());
  try {
    store.update(2);
    fail("Test setup should have caused an exception here");
  }
 catch (  Exception e) {
  }
  assertEquals(0,store.currentTerm());
}
