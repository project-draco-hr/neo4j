{
  if (nodeId < 0) {
    throw new IllegalArgumentException("Negative node id " + nodeId);
  }
  NodeImpl node=nodeCache.get(nodeId);
  if (node != null) {
    return new NodeProxy(nodeId,this);
  }
  node=new NodeImpl(nodeId,this);
  ReentrantLock loadLock=lockId(nodeId);
  try {
    if (nodeCache.get(nodeId) != null) {
      node=nodeCache.get(nodeId);
      return new NodeProxy(nodeId,this);
    }
    if (!persistenceManager.loadLightNode(nodeId)) {
      throw new NotFoundException("Node[" + nodeId + "]");
    }
    nodeCache.add(nodeId,node);
    return new NodeProxy(nodeId,this);
  }
  finally {
    loadLock.unlock();
  }
}
