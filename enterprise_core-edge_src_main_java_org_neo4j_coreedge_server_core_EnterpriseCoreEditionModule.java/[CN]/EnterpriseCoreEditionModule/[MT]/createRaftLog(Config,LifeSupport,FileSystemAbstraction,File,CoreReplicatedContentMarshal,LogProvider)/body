{
  RaftLogImplementation raftLogImplementation=RaftLogImplementation.valueOf(config.get(CoreEdgeClusterSettings.raft_log_implementation));
switch (raftLogImplementation) {
case IN_MEMORY:
{
      return new InMemoryRaftLog();
    }
case SEGMENTED:
{
    long rotateAtSize=config.get(CoreEdgeClusterSettings.raft_log_rotation_size);
    int readerPoolSize=config.get(CoreEdgeClusterSettings.raft_log_reader_pool_size);
    String pruningStrategyConfig=config.get(CoreEdgeClusterSettings.raft_log_pruning_strategy);
    return life.add(new SegmentedRaftLog(fileSystem,new File(clusterStateDirectory,RaftLog.PHYSICAL_LOG_DIRECTORY_NAME),rotateAtSize,marshal,logProvider,pruningStrategyConfig,readerPoolSize,systemUTC()));
  }
default :
throw new IllegalStateException("Unknown raft log implementation: " + raftLogImplementation);
}
}
