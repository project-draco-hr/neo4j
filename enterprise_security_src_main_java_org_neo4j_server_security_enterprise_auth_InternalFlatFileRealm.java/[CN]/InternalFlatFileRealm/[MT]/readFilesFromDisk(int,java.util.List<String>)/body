{
  if (attemptLeft < 0) {
    throw new RuntimeException("Unable to load valid flat file repositories! Attempts failed with:\n\t" + String.join("\n\t",failures));
  }
  try {
    final boolean valid;
    final boolean needsUpdate;
synchronized (this) {
      ListSnapshot<User> users=userRepository.getPersistedSnapshot();
      ListSnapshot<RoleRecord> roles=roleRepository.getPersistedSnapshot();
      needsUpdate=users.fromPersisted() || roles.fromPersisted();
      valid=needsUpdate && RoleRepository.validate(users.values(),roles.values());
      if (valid) {
        if (users.fromPersisted()) {
          userRepository.setUsers(users);
        }
        if (roles.fromPersisted()) {
          roleRepository.setRoles(roles);
        }
      }
    }
    if (needsUpdate && !valid) {
      failures.add("Role-auth file combination not valid.");
      Thread.sleep(10);
      readFilesFromDisk(attemptLeft - 1,failures);
    }
  }
 catch (  IOException|IllegalStateException|InterruptedException|InvalidArgumentsException e) {
    failures.add(e.getMessage());
    readFilesFromDisk(attemptLeft - 1,failures);
  }
}
