{
  roleRepository.assertValidRoleName(roleName);
  for (  String username : usernames) {
    userRepository.assertValidUsername(username);
  }
  SortedSet<String> userSet=new TreeSet<>(Arrays.asList(usernames));
  RoleRecord role=new RoleRecord.Builder().withName(roleName).withUsers(userSet).build();
synchronized (this) {
    roleRepository.create(role);
  }
  return role;
}
