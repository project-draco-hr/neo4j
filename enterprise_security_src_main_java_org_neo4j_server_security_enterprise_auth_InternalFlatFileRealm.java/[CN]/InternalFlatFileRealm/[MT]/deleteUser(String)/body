{
  boolean result=false;
synchronized (this) {
    User user=assertAndGetUser(username);
    if (userRepository.delete(user)) {
      removeUserFromAllRoles(username);
      result=true;
    }
 else {
      assertAndGetUser(username);
    }
  }
  clearCacheForUser(username);
  return result;
}
