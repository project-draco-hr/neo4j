{
  boolean result=false;
  try {
synchronized (this) {
      User user=getUser(username);
      if (userRepository.delete(user)) {
        removeUserFromAllRoles(username);
        result=true;
      }
 else {
        getUser(username);
      }
    }
    clearCacheForUser(username);
    securityLog.info("User deleted: `%s`",escape(username));
  }
 catch (  InvalidArgumentsException e) {
    securityLog.error("User deletion failed for user `%s`: %s",escape(username),e.getMessage());
  }
  return result;
}
