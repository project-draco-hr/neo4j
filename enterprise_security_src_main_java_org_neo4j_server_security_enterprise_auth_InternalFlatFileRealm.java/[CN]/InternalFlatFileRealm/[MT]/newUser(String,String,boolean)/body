{
  try {
    passwordPolicy.validatePassword(initialPassword);
    User user=new User.Builder().withName(username).withCredentials(Credential.forPassword(initialPassword)).withRequiredPasswordChange(requirePasswordChange).build();
    userRepository.create(user);
    securityLog.info("User created: `%s`" + (requirePasswordChange ? " (password change required)" : ""),escape(username));
    return user;
  }
 catch (  InvalidArgumentsException e) {
    securityLog.error("User creation failed for user `%s`: %s",escape(username),e.getMessage());
    throw e;
  }
}
