{
  final Collection<File> files=new ArrayList<File>();
  File neostoreFile=null;
  Pattern logFilePattern=getXaContainer().getLogicalLog().getHistoryFileNamePattern();
  for (  File dbFile : new File(storeDir).listFiles()) {
    String name=dbFile.getName();
    if (dbFile.isFile()) {
      if (name.equals("neostore")) {
        neostoreFile=dbFile;
      }
 else       if ((name.startsWith("neostore") || name.equals(IndexStore.INDEX_DB_FILE_NAME)) && !name.endsWith(".id")) {
        files.add(dbFile);
      }
 else       if (logFilePattern.matcher(dbFile.getName()).matches()) {
        files.add(dbFile);
      }
    }
  }
  files.add(neostoreFile);
  return new ClosableIterable<File>(){
    public Iterator<File> iterator(){
      return files.iterator();
    }
    public void close(){
    }
  }
;
}
