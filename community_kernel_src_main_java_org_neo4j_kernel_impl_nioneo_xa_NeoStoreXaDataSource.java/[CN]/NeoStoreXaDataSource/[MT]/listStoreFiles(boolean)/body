{
  final Collection<File> files=new ArrayList<File>();
  File neostoreFile=null;
  Pattern logFilePattern=getXaContainer().getLogicalLog().getHistoryFileNamePattern();
  for (  File dbFile : nonNull(storeDir.listFiles())) {
    String name=dbFile.getName();
    if (dbFile.isFile()) {
      if (name.equals(NeoStore.DEFAULT_NAME)) {
        neostoreFile=dbFile;
      }
 else       if ((name.startsWith(NeoStore.DEFAULT_NAME) || name.equals(IndexStore.INDEX_DB_FILE_NAME)) && !name.endsWith(".id")) {
        files.add(dbFile);
      }
 else       if (includeLogicalLogs && logFilePattern.matcher(dbFile.getName()).matches()) {
        files.add(dbFile);
      }
    }
  }
  files.add(neostoreFile);
  return new ClosableIterable<File>(){
    @Override public Iterator<File> iterator(){
      return files.iterator();
    }
    @Override public void close(){
    }
  }
;
}
