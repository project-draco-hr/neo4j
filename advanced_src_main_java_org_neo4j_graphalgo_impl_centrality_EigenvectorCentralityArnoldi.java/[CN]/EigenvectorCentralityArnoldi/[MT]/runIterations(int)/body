{
  if (maxNrIterations <= 0) {
    return 0;
  }
  int localIterations=0;
  while (localIterations < maxNrIterations) {
    Map<Node,Double> oldValues=values;
    localIterations+=runInternalArnoldi(3);
    if (timeToStop(oldValues,values)) {
      break;
    }
  }
  if (values.get(nodeSet.iterator().next()) < 0) {
    for (    Node node : nodeSet) {
      values.put(node,-values.get(node));
    }
  }
  return localIterations;
}
