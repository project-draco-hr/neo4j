{
  if (batch.next() != null) {
    throw new IllegalArgumentException("Only supports single-commit on slave --> master");
  }
  try {
    TransactionRepresentation representation=batch.transactionRepresentation();
    RequestContext context=requestContextFactory.newRequestContext(representation.getLockSessionId());
    try (Response<Long> response=master.commit(context,representation)){
      return response.response();
    }
   }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
