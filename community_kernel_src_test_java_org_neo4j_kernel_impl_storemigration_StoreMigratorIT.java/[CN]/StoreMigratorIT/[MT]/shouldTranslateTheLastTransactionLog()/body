{
  File unzippedStore=Unzip.unzip(LegacyStore.class,"legacy-store-with-transaction-logs.zip");
  File legacyStoreDir=new File(unzippedStore,"legacystore");
  LegacyStore legacyStore=new LegacyStore(fs,new File(legacyStoreDir,NeoStore.DEFAULT_NAME));
  NeoStore neoStore=storeFactory.createNeoStore(storeFileName);
  new StoreMigrator(monitor).migrate(legacyStore,neoStore);
  legacyStore.close();
  GraphDatabaseFactory factory=new GraphDatabaseFactory();
  GraphDatabaseAPI db=(GraphDatabaseAPI)factory.newEmbeddedDatabase(storeDir);
  DependencyResolver resolver=db.getDependencyResolver();
  XaDataSourceManager xaDataSourceManager=resolver.resolveDependency(XaDataSourceManager.class);
  NeoStoreXaDataSource neoStoreDataSource=xaDataSourceManager.getNeoStoreDataSource();
  XaContainer xaContainer=neoStoreDataSource.getXaContainer();
  XaLogicalLog logicalLog=xaContainer.getLogicalLog();
  LogExtractor logExtractor=logicalLog.getLogExtractor(5,6);
  InMemoryLogBuffer buf=new InMemoryLogBuffer();
  assertThat(logExtractor.extractNext(buf),is(5L));
  assertThat(logExtractor.getLastTxChecksum(),is(-161474256273L));
  assertThat(logExtractor.extractNext(buf),is(6L));
  assertThat(logExtractor.getLastTxChecksum(),is(-161474256273L));
  assertThat(logExtractor.extractNext(buf),is(-1L));
}
