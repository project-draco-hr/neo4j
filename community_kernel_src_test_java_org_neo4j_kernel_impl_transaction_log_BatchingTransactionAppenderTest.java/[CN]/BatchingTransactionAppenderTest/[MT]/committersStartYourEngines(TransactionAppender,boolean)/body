{
  ExecutorService executor=cleanup.add(Executors.newCachedThreadPool());
  Future[] futures=new Future[transactions.length];
  for (int i=0; i < transactions.length; i++) {
    final TransactionRepresentation transaction=createTransaction(transactions[i],i);
    futures[i]=executor.submit(new Callable<TransactionToApply>(){
      @Override public TransactionToApply call() throws IOException {
        TransactionToApply tx=new TransactionToApply(transaction);
        appender.append(tx,logAppendEvent);
        return tx;
      }
    }
);
  }
  return futures;
}
