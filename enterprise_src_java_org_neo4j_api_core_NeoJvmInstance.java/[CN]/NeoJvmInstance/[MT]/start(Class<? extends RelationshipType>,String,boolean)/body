{
  if (started) {
    throw new RuntimeException("A Neo instance already started");
  }
  if (clazz.getEnumConstants() == null) {
    throw new IllegalArgumentException("No enum constants found in " + clazz);
  }
  config=new Config();
  config.getTxModule().setTxLogDirectory(storeDir);
  Map<String,String> params=new java.util.HashMap<String,String>();
  params.put("neo_store",storeDir + "/neostore");
  params.put("create",String.valueOf(create));
  params.put("logical_log",storeDir + "/nioneo_logical.log");
  params.put("neostore.nodestore.db.mapped_memory","500k");
  params.put("neostore.propertystore.db.mapped_memory","1M");
  params.put("neostore.propertystore.db.keys.mapped_memory","1M");
  params.put("neostore.propertystore.db.strings.mapped_memory","1M");
  params.put("neostore.relationshipstore.db.mapped_memory","1M");
  byte resourceId[]="414141".getBytes();
  config.getTxModule().registerDataSource(DEFAULT_DATA_SOURCE_NAME,NIO_NEO_DB_CLASS,resourceId,params);
  System.setProperty("neo.tx_log_directory",storeDir);
  persistenceSource=new NioNeoDbPersistenceSource();
  config.setNeoPersistenceSource(DEFAULT_DATA_SOURCE_NAME,create);
  config.getNeoModule().setRelationshipTypes(clazz);
  config.getIdGeneratorModule().setPersistenceSourceInstance(persistenceSource);
  config.getEventModule().init();
  config.getTxModule().init();
  config.getPersistenceModule().init();
  persistenceSource.init();
  config.getIdGeneratorModule().init();
  config.getNeoModule().init();
  config.getEventModule().start();
  config.getTxModule().start();
  config.getPersistenceModule().start();
  persistenceSource.start();
  config.getIdGeneratorModule().start();
  config.getNeoModule().start();
  started=true;
}
