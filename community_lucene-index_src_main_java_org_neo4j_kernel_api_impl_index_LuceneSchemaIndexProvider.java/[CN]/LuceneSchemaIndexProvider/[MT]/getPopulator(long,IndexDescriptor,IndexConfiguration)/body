{
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(documentStructure,tracking(),writerStatus,directoryFactory,folderLayout.getFolder(indexId),failureStorage,indexId,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(NonUniqueLuceneIndexPopulator.DEFAULT_QUEUE_THRESHOLD,documentStructure,tracking(),writerStatus,directoryFactory,folderLayout.getFolder(indexId),failureStorage,indexId);
  }
}
