{
  PartitionedIndexStorage indexStorage=getIndexStorage(indexId);
  LuceneIndex luceneIndex=new LuceneIndex(indexStorage);
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(luceneIndex,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(luceneIndex,samplingConfig);
  }
}
