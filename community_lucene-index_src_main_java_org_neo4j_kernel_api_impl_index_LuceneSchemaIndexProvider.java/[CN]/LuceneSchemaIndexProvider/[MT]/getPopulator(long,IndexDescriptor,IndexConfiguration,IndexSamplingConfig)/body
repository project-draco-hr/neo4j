{
  IndexStorage populatorStorage=getIndexStorage(indexId);
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(documentStructure,IndexWriterFactories.standard(),SearcherManagerFactories.standard(),populatorStorage,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(documentStructure,IndexWriterFactories.standard(),populatorStorage,samplingConfig);
  }
}
