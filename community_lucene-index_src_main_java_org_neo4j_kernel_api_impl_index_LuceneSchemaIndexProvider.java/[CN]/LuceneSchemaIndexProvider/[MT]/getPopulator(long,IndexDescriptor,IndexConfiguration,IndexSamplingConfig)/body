{
  PartitionedIndexStorage indexStorage=getIndexStorage(indexId);
  LuceneSchemaIndex luceneIndex=new LuceneSchemaIndex(indexStorage,config,samplingConfig);
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(luceneIndex,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(luceneIndex,samplingConfig);
  }
}
