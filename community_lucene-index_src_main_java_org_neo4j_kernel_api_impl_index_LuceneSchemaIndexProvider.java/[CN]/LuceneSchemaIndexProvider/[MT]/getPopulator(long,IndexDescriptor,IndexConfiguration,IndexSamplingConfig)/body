{
  PartitionedIndexStorage populatorStorage=getIndexStorage(indexId);
  LuceneIndex luceneIndex=new LuceneIndex(populatorStorage);
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(luceneIndex,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(luceneIndex,samplingConfig);
  }
}
