{
  if (config.isUnique()) {
    return new UniqueLuceneIndexAccessor(documentStructure,IndexWriterFactories.reserving(),writerStatus,directoryFactory,folderLayout.getFolder(indexId));
  }
 else {
    return new NonUniqueLuceneIndexAccessor(documentStructure,IndexWriterFactories.reserving(),writerStatus,directoryFactory,folderLayout.getFolder(indexId),samplingConfig.bufferSize());
  }
}
