{
  try {
    String failure=failureStorage.loadIndexFailure(indexId);
    if (failure != null) {
      return InternalIndexState.FAILED;
    }
    try (Directory directory=directoryFactory.open(folderLayout.getFolder(indexId))){
      boolean status=writerStatus.isOnline(directory);
      return status ? InternalIndexState.ONLINE : InternalIndexState.POPULATING;
    }
   }
 catch (  CorruptIndexException e) {
    return InternalIndexState.FAILED;
  }
catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
