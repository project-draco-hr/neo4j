{
  String failure=failureStorage.loadIndexFailure(indexId);
  if (failure != null) {
    return InternalIndexState.FAILED;
  }
  File indexLocation=folderLayout.getFolder(indexId);
  try {
    try (Directory directory=directoryFactory.open(indexLocation)){
      boolean status=LuceneIndexWriter.isOnline(directory);
      return status ? InternalIndexState.ONLINE : InternalIndexState.POPULATING;
    }
   }
 catch (  IOException e) {
    log.error("Failed to open index:" + indexId + ", requesting re-population.",e);
    return InternalIndexState.POPULATING;
  }
}
