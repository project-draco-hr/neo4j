{
  LeaderLocator leaderLocator=mock(LeaderLocator.class);
  when(leaderLocator.getLeader()).thenThrow(NoLeaderFoundException.class);
  AcquireEndpointsProcedure procedure=new AcquireEndpointsProcedure(mock(CoreTopologyService.class),leaderLocator,NullLogProvider.getInstance());
  try {
    procedure.apply(null,new Object[]{"bam"});
  }
 catch (  ProcedureException e) {
    assertEquals(Status.Cluster.NoLeader,e.status());
  }
}
