{
  final LockAcquisition lockAcquisition=new LockAcquisition();
  Future<Void> future=executor.submit(new Callable<Void>(){
    @Override public Void call() throws Exception {
      try (Locks.Client client=newLockClient(lockAcquisition)){
        client.acquireShared(RESOURCE_TYPE,RESOURCE_ID);
        sharedLockAcquired.countDown();
        await(startExclusiveLock);
        client.acquireExclusive(RESOURCE_TYPE,RESOURCE_ID);
      }
       return null;
    }
  }
);
  lockAcquisition.setFuture(future);
  return lockAcquisition;
}
