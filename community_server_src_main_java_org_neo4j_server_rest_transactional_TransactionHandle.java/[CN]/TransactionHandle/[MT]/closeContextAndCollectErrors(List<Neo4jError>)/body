{
  if (errors.isEmpty()) {
    try {
      context.commit();
    }
 catch (    Exception e) {
      if (e.getCause() instanceof Status.HasStatus) {
        errors.add(new Neo4jError(((Status.HasStatus)e.getCause()).status(),e));
      }
 else {
        log.error("Failed to commit transaction.",e);
        errors.add(new Neo4jError(Status.Transaction.CouldNotCommit,e));
      }
    }
  }
 else {
    try {
      context.rollback();
    }
 catch (    Exception e) {
      log.error("Failed to rollback transaction.",e);
      errors.add(new Neo4jError(Status.Transaction.CouldNotRollback,e));
    }
  }
}
