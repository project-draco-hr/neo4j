{
  List<Neo4jError> errors=new LinkedList<>();
  try {
    try {
      StatementExecutionStrategy executionStrategy=selectExecutionStrategy(statements,errors);
switch (executionStrategy) {
case EXECUTE_STATEMENT_USING_PERIODIC_COMMIT:
        executePeriodicCommitStatement(statements,output,errors,request);
      break;
case EXECUTE_STATEMENT:
    ensureActiveTransaction();
  executeStatements(statements,output,errors,request);
closeContextAndCollectErrors(errors);
break;
case SKIP_EXECUTE_STATEMENT:
addToCollection(statements.errors(),errors);
break;
}
}
  finally {
registry.forget(id);
}
}
 catch (InternalBeginTransactionError e) {
errors.add(e.toNeo4jError());
}
 finally {
output.errors(errors);
output.finish();
}
}
