{
  ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
  StoreChannel fileChannel=fileSystem.open(input,"r");
  try {
    long[] header=LogIoUtils.readLogHeader(buffer,fileChannel,true);
    final List<LogEntry> entries=new ArrayList<LogEntry>();
    final CommandFactory cf=new CommandFactory();
    LogEntry entry;
    while ((entry=LogIoUtils.readEntry(buffer,fileChannel,cf)) != null) {
      entries.add(entry);
    }
    return Pair.of(header,entries);
  }
  finally {
    fileChannel.close();
  }
}
