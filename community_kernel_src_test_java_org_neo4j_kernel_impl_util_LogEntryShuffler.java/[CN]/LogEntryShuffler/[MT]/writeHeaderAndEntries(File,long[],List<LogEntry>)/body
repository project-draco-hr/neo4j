{
  StoreChannel fileChannel=fileSystem.open(output,"rw");
  try {
    fileChannel.write(LogIoUtils.writeLogHeader(ByteBuffer.allocateDirect(16),header[0],header[1]));
    final LogBuffer buffer=new DirectMappedLogBuffer(fileChannel,NO_COUNT);
    int written=0;
    for (    LogEntry entry : entries) {
      LogIoUtils.writeLogEntry(entry,buffer);
      written++;
    }
    buffer.force();
    return written;
  }
  finally {
    fileChannel.close();
  }
}
