{
  if (bufferPos >= buffer.length) {
    if (seekStartPos == 0) {
      throw new IllegalStateException("Tried to read in a value larger than buffer size " + charBuffer.capacity());
    }
    charBuffer.position(seekStartPos);
    charBuffer.compact();
    int position=charBuffer.position();
    reader.read(charBuffer);
    if (charBuffer.hasRemaining()) {
      charBuffer.put(EOF_CHAR);
    }
    bufferPos=position;
    bufferStartPos+=seekStartPos;
    seekStartPos=0;
  }
}
