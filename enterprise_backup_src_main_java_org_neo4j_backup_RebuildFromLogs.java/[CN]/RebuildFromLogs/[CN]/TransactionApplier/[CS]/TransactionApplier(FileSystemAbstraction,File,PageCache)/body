{
  this.fs=fs;
  this.graphdb=BackupService.startTemporaryDb(dbDirectory.getAbsoluteFile(),pageCache,stringMap());
  DependencyResolver resolver=graphdb.getDependencyResolver();
  this.neoStores=resolver.resolveDependency(NeoStores.class);
  this.storeApplier=resolver.resolveDependency(TransactionRepresentationStoreApplier.class).withLegacyIndexTransactionOrdering(IdOrderingQueue.BYPASS);
  this.indexingService=resolver.resolveDependency(IndexingService.class);
  KernelHealth kernelHealth=resolver.resolveDependency(KernelHealth.class);
  this.indexUpdatesValidator=new OnlineIndexUpdatesValidator(neoStores,resolver.resolveDependency(KernelHealth.class),new PropertyLoader(neoStores),indexingService,IndexUpdateMode.BATCHED);
}
