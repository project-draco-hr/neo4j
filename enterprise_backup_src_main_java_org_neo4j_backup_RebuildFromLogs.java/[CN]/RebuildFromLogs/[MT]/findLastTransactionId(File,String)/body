{
  long txId;
  try {
    FileChannel channel=new RandomAccessFile(new File(storeDir,logFileName),"r").getChannel();
    try {
      ByteBuffer buffer=ByteBuffer.allocateDirect(9 + Xid.MAXGTRIDSIZE + Xid.MAXBQUALSIZE * 10);
      txId=LogIoUtils.readLogHeader(buffer,channel,true)[1];
      XaCommandReader reader=new PhysicalLogNeoXaCommandReader(buffer);
      for (LogEntry entry; (entry=LogIoUtils.readEntry(buffer,channel,reader)) != null; ) {
        if (entry instanceof LogEntry.Commit) {
          txId=((LogEntry.Commit)entry).getTxId();
        }
      }
    }
  finally {
      if (channel != null) {
        channel.close();
      }
    }
  }
 catch (  IOException e) {
    return -1;
  }
  return txId;
}
