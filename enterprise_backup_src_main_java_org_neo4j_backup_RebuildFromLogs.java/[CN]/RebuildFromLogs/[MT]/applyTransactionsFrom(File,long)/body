{
  PhysicalLogFiles logFiles=new PhysicalLogFiles(sourceDir,FS);
  int startVersion=0;
  ReaderLogVersionBridge versionBridge=new ReaderLogVersionBridge(FS,logFiles);
  PhysicalLogVersionedStoreChannel startingChannel=openForVersion(logFiles,FS,startVersion);
  ReadableVersionableLogChannel channel=new ReadAheadLogChannel(startingChannel,versionBridge,DEFAULT_READ_AHEAD_SIZE);
  try (IOCursor<CommittedTransactionRepresentation> cursor=new PhysicalTransactionCursor<>(channel,new VersionAwareLogEntryReader<>())){
    while (cursor.next()) {
      long txId=cursor.get().getCommitEntry().getTxId();
      TransactionRepresentation transaction=cursor.get().getTransactionRepresentation();
      try (LockGroup locks=new LockGroup();ValidatedIndexUpdates indexUpdates=indexUpdatesValidator.validate(transaction,EXTERNAL)){
        storeApplier.apply(transaction,indexUpdates,locks,txId,EXTERNAL);
      }
       if (upToTxId != BASE_TX_ID && upToTxId == txId) {
        return;
      }
    }
  }
 }
