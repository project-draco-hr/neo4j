{
  LogExtractor extractor=null;
  try {
    extractor=LogExtractor.from(sourceDir.getAbsolutePath());
    for (InMemoryLogBuffer buffer=new InMemoryLogBuffer(); ; buffer.reset()) {
      long txId=extractor.extractNext(buffer);
      if (txId == -1)       break;
      applyTransaction(txId,buffer);
      if (progress != null)       progress.update(false,txId);
    }
  }
  finally {
    if (extractor != null)     extractor.close();
  }
  return this;
}
