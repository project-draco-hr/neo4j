{
  AbstractGraphDatabase graphdb=new EmbeddedGraphDatabase(sourceDir.getAbsolutePath(),Collections.singletonMap(Config.KEEP_LOGICAL_LOGS,"true"));
  try {
    XaDataSource nioneo=getDataSource(graphdb,Config.DEFAULT_DATA_SOURCE_NAME);
    LogExtractor extractor=nioneo.getLogExtractor(2,nioneo.getLastCommittedTxId());
    for (InMemoryLogBuffer buffer=new InMemoryLogBuffer(); ; buffer.reset()) {
      long txId=extractor.extractNext(buffer);
      if (txId == -1)       break;
      applyTransaction(txId,buffer);
    }
  }
  finally {
    graphdb.shutdown();
  }
  return this;
}
