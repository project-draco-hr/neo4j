{
  try {
    long lastClosedTransactionId=db.getDependencyResolver().resolveDependency(TransactionIdStore.class).getLastClosedTransactionId();
    return lastClosedTransactionId;
  }
 catch (  IllegalStateException|UnsatisfiedDependencyException ex) {
    if (!fail) {
      return -1;
    }
 else {
      throw ex;
    }
  }
}
