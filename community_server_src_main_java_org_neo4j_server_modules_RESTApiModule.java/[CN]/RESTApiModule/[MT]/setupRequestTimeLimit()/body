{
  Long limit=config.get(ServerSettings.webserver_limit_execution_time);
  if (limit != null) {
    try {
      Guard guard=database.getGraph().getDependencyResolver().resolveDependency(Guard.class);
      this.requestTimeLimitFilter=new GuardingRequestFilter(guard,limit);
      webServer.addFilter(requestTimeLimitFilter,"/*");
    }
 catch (    IllegalArgumentException e) {
      throw new RuntimeException("Unable to use guard, you have to enable guard in neo4j.properties",e);
    }
  }
}
