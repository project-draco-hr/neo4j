{
  try (InputStream in=fs.openAsInputStream(file)){
    for (long bytes=header.headerRecords() * RECORD_SIZE; bytes != 0; ) {
      bytes-=in.skip(bytes);
    }
    byte[] record=new byte[RECORD_SIZE];
    ByteBuffer buffer=ByteBuffer.wrap(record);
    boolean readNext=true;
    for (int read, offset=0; readNext && (read=in.read(record,offset,record.length - offset)) != -1; ) {
      if (read != record.length) {
        offset=read;
        continue;
      }
      buffer.position(0);
      readNext=visitRecord(buffer,visitor);
      offset=0;
    }
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
