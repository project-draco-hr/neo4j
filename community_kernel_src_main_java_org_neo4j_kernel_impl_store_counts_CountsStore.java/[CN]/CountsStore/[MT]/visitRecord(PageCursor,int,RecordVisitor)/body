{
  CountsKey key;
  long value;
  do {
    page.setOffset(offset);
    int startLabelId=page.getInt();
    int typeId=page.getInt();
    int endLabelId=page.getInt();
    long count=page.getLong();
    if (count < 0) {
      value=-count;
      key=nodeKey(typeId);
    }
 else {
      value=count;
      key=relationshipKey(startLabelId,typeId,endLabelId);
    }
  }
 while (page.shouldRetry());
  visitor.visit(key,value);
}
