{
  int pageId=(record * RECORD_SIZE) / pages.pageSize();
  int offset=(record * RECORD_SIZE) % pages.pageSize();
  if (pageId == cursor.getCurrentPageId() || cursor.next(pageId)) {
    CountsKey key;
    do {
      cursor.setOffset(offset);
      key=readRecord(cursor,count);
    }
 while (cursor.shouldRetry());
    return target.compareTo(key);
  }
 else {
    throw new IllegalStateException("Could not fetch page: " + pageId);
  }
}
