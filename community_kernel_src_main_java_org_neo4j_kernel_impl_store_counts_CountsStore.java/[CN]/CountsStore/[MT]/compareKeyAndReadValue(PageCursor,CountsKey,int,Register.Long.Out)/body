{
  int pageId=(record * RECORD_SIZE) / pages.pageSize();
  int offset=(record * RECORD_SIZE) % pages.pageSize();
  if (pageId == cursor.getCurrentPageId() || cursor.next(pageId)) {
    CountsKey key;
    do {
      cursor.setOffset(offset);
      int startLabelId=cursor.getInt();
      int typeId=cursor.getInt();
      int endLabelId=cursor.getInt();
      long count=cursor.getLong();
      if (count < 0) {
        value.write(-count);
        key=nodeKey(typeId);
      }
 else {
        value.write(count);
        key=relationshipKey(startLabelId,typeId,endLabelId);
      }
    }
 while (cursor.shouldRetry());
    return target.compareTo(key);
  }
 else {
    throw new IllegalStateException("Could not fetch page: " + pageId);
  }
}
