{
  int slaveMachineId=context.machineId();
  Collection<TxIdElement> rolledbackTxs=new ArrayList<TxIdElement>();
  for (  Map.Entry<TxIdElement,Transaction> entry : transactions.entrySet()) {
    if (entry.getKey().machineId == slaveMachineId) {
      System.out.println("Rolling back ongoing tx " + entry);
      Transaction otherTx=suspendOtherAndResumeThis(entry.getKey());
      rollbackThisAndResumeOther(entry.getKey(),otherTx);
      rolledbackTxs.add(entry.getKey());
    }
  }
  for (  TxIdElement element : rolledbackTxs) {
    transactions.remove(element);
  }
}
