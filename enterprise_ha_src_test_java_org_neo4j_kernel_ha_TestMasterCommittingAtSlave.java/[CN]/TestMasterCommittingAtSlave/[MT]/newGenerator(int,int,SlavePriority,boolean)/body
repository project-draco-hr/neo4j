{
  slaves=instantiateSlaves(slaveCount,failingSlaves);
  dataSource=new FakeDataSource();
  broker=new FakeBroker(slaves);
  log=new FakeStringLogger();
  MasterTxIdGenerator result=new MasterTxIdGenerator(broker,replication,priority,log);
  try {
    result.init();
    result.start();
  }
 catch (  Throwable e) {
    throw Exceptions.launderedException(e);
  }
  return result;
}
