{
  if (queue.isEmpty()) {
    return;
  }
  if (batchSizeExceedsSafeZone()) {
    kernelTransactions.blockNewTransactions();
    try {
      markUnsafeTransactionsForTermination();
      queue.empty();
    }
  finally {
      kernelTransactions.unblockNewTransactions();
    }
  }
 else {
    markUnsafeTransactionsForTermination();
    queue.empty();
  }
}
