{
  try {
    IndexWriter writer=new IndexWriter(LuceneDataSource.getDirectory(directory,identifier),type.analyzer,MaxFieldLength.UNLIMITED);
    writer.setRAMBufferSizeMB(determineGoodBufferSize(writer.getRAMBufferSizeMB()));
    return writer;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
