{
  return new Threshold(){
    private Long highest;
    @Override public boolean reached(    File file,    long version,    LogVersionRepository source){
      try {
        long tx=source.getFirstCommittedTxId(version);
        if (highest == null) {
          highest=source.getLastCommittedTxId();
          return false;
        }
        return highest - tx >= maxTransactionCount;
      }
 catch (      RuntimeException e) {
        if (e.getCause() != null && e.getCause() instanceof IllegalLogFormatException) {
          return decidePruneForIllegalLogFormat((IllegalLogFormatException)e.getCause());
        }
 else {
          throw e;
        }
      }
    }
  }
;
}
