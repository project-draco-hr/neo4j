{
  return new Threshold(){
    private Long highest;
    @Override public boolean reached(    File file,    long version,    LogFileInformation source){
      try {
        long tx=source.getFirstCommittedTxId(version);
        if (highest == null) {
          highest=source.getLastCommittedTxId();
        }
        return highest - tx >= maxTransactionCount;
      }
 catch (      IllegalLogFormatException e) {
        return decidePruneForIllegalLogFormat((IllegalLogFormatException)e.getCause());
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
;
}
