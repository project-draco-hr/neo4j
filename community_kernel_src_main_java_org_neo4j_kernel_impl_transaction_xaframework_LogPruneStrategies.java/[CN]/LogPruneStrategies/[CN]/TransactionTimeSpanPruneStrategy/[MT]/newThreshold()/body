{
  return new Threshold(){
    private final long lowerLimit=System.currentTimeMillis() - unit.toMillis(timeToKeep);
    @Override public boolean reached(    File file,    long version,    LogVersionRepository source){
      try {
        return source.getFirstStartRecordTimestamp(version) < lowerLimit;
      }
 catch (      IllegalLogFormatException e) {
        return decidePruneForIllegalLogFormat(e);
      }
catch (      IOException e) {
        throw new RuntimeException(e);
      }
    }
  }
;
}
