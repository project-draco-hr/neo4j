{
  if (source.getHighestLogVersion() == 0)   return;
  long upper=source.getHighestLogVersion() - 1;
  Threshold threshold=newThreshold();
  boolean exceeded=false;
  while (upper >= 0) {
    File file=source.getFileName(upper);
    if (!fileSystem.fileExists(file))     return;
    if (fileSystem.getFileSize(file) > VersionAwareLogEntryReader.LOG_HEADER_SIZE && threshold.reached(file,upper,source)) {
      exceeded=true;
      break;
    }
    upper--;
  }
  if (!exceeded)   return;
  long lower=upper;
  while (fileSystem.fileExists(source.getFileName(lower - 1)))   lower--;
  for (long version=lower; version < upper; version++)   fileSystem.deleteFile(source.getFileName(version));
}
