{
  long currentLogVersion=versionRepo.getCurrentLogVersion();
  if (currentLogVersion == 0) {
    return;
  }
  long upper=currentLogVersion - 1;
  Threshold threshold=newThreshold();
  boolean exceeded=false;
  while (upper >= 0) {
    File file=files.getVersionFileName(upper);
    if (!fileSystem.fileExists(file)) {
      return;
    }
    if (fileSystem.getFileSize(file) > VersionAwareLogEntryReader.LOG_HEADER_SIZE && threshold.reached(file,upper,logFileInformation)) {
      exceeded=true;
      break;
    }
    upper--;
  }
  if (!exceeded) {
    return;
  }
  long lower=upper;
  while (fileSystem.fileExists(files.getVersionFileName(lower - 1))) {
    lower--;
  }
  for (long version=lower; version < upper; version++) {
    fileSystem.deleteFile(files.getVersionFileName(version));
  }
}
