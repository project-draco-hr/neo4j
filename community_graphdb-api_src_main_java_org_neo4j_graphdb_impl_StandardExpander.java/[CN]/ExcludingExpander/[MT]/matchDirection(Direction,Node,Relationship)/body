{
switch (dir) {
case INCOMING:
    return rel.getEndNode().equals(start);
case OUTGOING:
  return rel.getStartNode().equals(start);
case BOTH:
return true;
default :
throw new IllegalArgumentException("Unknown direction: " + dir);
}
}
