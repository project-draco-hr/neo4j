{
  FileSystemAbstraction fileSystem=fs.get();
  File neoStoreDir=new File("/tmp/graph.db/neostore").getAbsoluteFile();
  StoreFactory factory=new StoreFactory(fileSystem,neoStoreDir,pageCache,StringLogger.DEV_NULL,new Monitors());
  NeoStore neoStore=factory.newNeoStore(true);
  neoStore.setCreationTime(3);
  neoStore.setRandomNumber(4);
  neoStore.setCurrentLogVersion(5);
  neoStore.setLastCommittedAndClosedTransactionId(6,0);
  neoStore.setStoreVersion(7);
  neoStore.setGraphNextProp(8);
  neoStore.setLatestConstraintIntroducingTx(9);
  neoStore.flush();
  neoStore.close();
  File file=new File(neoStoreDir,NeoStore.DEFAULT_NAME);
  try (StoreChannel channel=fileSystem.open(file,"rw")){
    byte[] trailer=UTF8.encode(CommonAbstractStore.buildTypeDescriptorAndVersion(neoStore.getTypeDescriptor()));
    channel.truncate(channel.size() - 2 * NeoStore.RECORD_SIZE);
    channel.position(channel.size() - trailer.length);
    channel.write(ByteBuffer.wrap(trailer));
  }
   assertNotEquals(10,neoStore.getUpgradeTransaction()[0]);
  assertNotEquals(11,neoStore.getUpgradeTime());
  NeoStore.setRecord(fileSystem,file,Position.UPGRADE_TRANSACTION_ID,10);
  NeoStore.setRecord(fileSystem,file,Position.UPGRADE_TRANSACTION_CHECKSUM,11);
  NeoStore.setRecord(fileSystem,file,Position.UPGRADE_TIME,12);
  neoStore=factory.newNeoStore(false);
  assertEquals(3,neoStore.getCreationTime());
  assertEquals(4,neoStore.getRandomNumber());
  assertEquals(5,neoStore.getCurrentLogVersion());
  assertEquals(6,neoStore.getLastCommittedTransactionId());
  assertEquals(7,neoStore.getStoreVersion());
  assertEquals(8,neoStore.getGraphNextProp());
  assertEquals(9,neoStore.getLatestConstraintIntroducingTx());
  assertArrayEquals(new long[]{10,11},neoStore.getUpgradeTransaction());
  assertEquals(12,neoStore.getUpgradeTime());
  neoStore.close();
}
