{
  Monitors monitors=new Monitors();
  Config config=new Config(new HashMap<String,String>(),GraphDatabaseSettings.class);
  LifeSupport life=new LifeSupport();
  life.start();
  StoreFactory sf=new StoreFactory(configForStoreDir(config,dir.directory()),new DefaultIdGeneratorFactory(),createPageCache(fs.get(),getClass().getName(),life),fs.get(),StringLogger.DEV_NULL,monitors);
  NeoStore neoStore=sf.newNeoStore(true,false);
  assertEquals(0l,neoStore.getLatestConstraintIntroducingTx());
  neoStore.setLatestConstraintIntroducingTx(10l);
  assertEquals(10l,neoStore.getLatestConstraintIntroducingTx());
  neoStore.flush();
  neoStore.close();
  neoStore=sf.newNeoStore(false,false);
  assertEquals(10l,neoStore.getLatestConstraintIntroducingTx());
  neoStore.close();
  life.shutdown();
}
