{
  if (aggregator == null) {
    throw new IllegalStateException("Builder has been completed.");
  }
  if (!parts.add(part)) {
    throw new IllegalArgumentException(String.format("Part '%s' has already been defined.",part));
  }
  ProgressListener.MultiPartProgressListener progress=new ProgressListener.MultiPartProgressListener(aggregator,part,totalCount);
  aggregator.add(progress);
  return progress;
}
