{
  PrimitiveElement primitiveElement=cowMap.get(getTransaction());
  if (primitiveElement == null)   return null;
  if (primitive instanceof NodeImpl) {
    ArrayMap<Long,CowNodeElement> cowElements=primitiveElement.nodes;
    CowNodeElement element=cowElements.get(primitive.getId());
    if (element != null) {
      if (element.deleted) {
        throw new IllegalStateException("Node[" + primitive.getId() + "] has been deleted in this tx");
      }
      return element.propertyAddMap;
    }
  }
 else   if (primitive instanceof RelationshipImpl) {
    ArrayMap<Long,CowRelElement> cowElements=primitiveElement.relationships;
    CowRelElement element=cowElements.get(primitive.getId());
    if (element != null) {
      if (element.deleted) {
        throw new IllegalStateException("Relationship[" + primitive.getId() + "] has been deleted in this tx");
      }
      return element.propertyAddMap;
    }
  }
 else   if (primitive instanceof GraphProperties) {
    CowGraphElement element=primitiveElement.graph;
    if (element != null)     return element.propertyAddMap;
  }
 else {
    throw new IllegalArgumentException(primitive + " not recognized");
  }
  return null;
}
