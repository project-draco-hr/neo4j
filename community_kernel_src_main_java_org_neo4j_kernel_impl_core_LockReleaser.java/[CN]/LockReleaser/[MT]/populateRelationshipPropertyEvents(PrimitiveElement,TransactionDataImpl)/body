{
  for (  long relId : element.relationships.keySet()) {
    CowRelElement relElement=element.relationships.get(relId);
    RelationshipProxy rel=new RelationshipProxy(relId,nodeManager);
    RelationshipImpl relImpl=nodeManager.getRelForProxy(relId);
    if (relElement.deleted) {
      if (nodeManager.relCreated(relId)) {
        continue;
      }
    }
    if (relElement.propertyAddMap != null && !relElement.deleted) {
      for (      PropertyData data : relElement.propertyAddMap.values()) {
        String key=nodeManager.getKeyForProperty(data.getId());
        Object oldValue=relImpl.getCommittedPropertyValue(nodeManager,key);
        Object newValue=data.getValue();
        result.assignedProperty(rel,key,newValue,oldValue);
      }
    }
    if (relElement.propertyRemoveMap != null) {
      for (      PropertyData data : relElement.propertyRemoveMap.values()) {
        String key=nodeManager.getKeyForProperty(data.getId());
        Object oldValue=data.getValue();
        if (oldValue != null && !relElement.deleted) {
          relImpl.getCommittedPropertyValue(nodeManager,key);
        }
        result.removedProperty(rel,key,oldValue);
      }
    }
  }
}
