{
  if (query instanceof BooleanQuery) {
    BooleanQuery source=(BooleanQuery)query;
    BooleanQuery result=new BooleanQuery();
    for (    BooleanClause clause : source.clauses()) {
      result.add(injectOrphans(clause.getQuery()),clause.getOccur());
    }
    return result;
  }
 else {
    BooleanQuery result=new BooleanQuery();
    result.add(query,Occur.SHOULD);
    result.add(new TermQuery(new Term(ORPHANS_KEY,extractTermField(query))),Occur.SHOULD);
    return result;
  }
}
