{
  if (query instanceof BooleanQuery) {
    BooleanQuery source=(BooleanQuery)query;
    BooleanQuery result=new BooleanQuery();
    for (    BooleanClause clause : source.clauses()) {
      result.add(injectOrphans(clause.getQuery()),clause.getOccur());
    }
    return result;
  }
  String orphanField=extractTermField(query);
  if (orphanField == null) {
    return query;
  }
  BooleanQuery result=new BooleanQuery();
  result.add(query,Occur.SHOULD);
  result.add(new TermQuery(new Term(ORPHANS_KEY,orphanField)),Occur.SHOULD);
  return result;
}
