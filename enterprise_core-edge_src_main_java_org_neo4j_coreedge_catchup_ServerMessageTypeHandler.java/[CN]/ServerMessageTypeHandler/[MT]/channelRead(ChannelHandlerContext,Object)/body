{
  if (protocol.isExpecting(CatchupServerProtocol.State.MESSAGE_TYPE)) {
    RequestMessageType requestMessageType=RequestMessageType.from(((ByteBuf)msg).readByte());
    if (requestMessageType.equals(RequestMessageType.TX_PULL_REQUEST)) {
      protocol.expect(CatchupServerProtocol.State.TX_PULL);
    }
 else     if (requestMessageType.equals(RequestMessageType.STORE)) {
      protocol.expect(CatchupServerProtocol.State.GET_STORE);
    }
 else     if (requestMessageType.equals(RequestMessageType.STORE_ID)) {
      protocol.expect(CatchupServerProtocol.State.GET_STORE_ID);
    }
 else     if (requestMessageType.equals(RequestMessageType.RAFT_STATE)) {
      protocol.expect(CatchupServerProtocol.State.GET_RAFT_STATE);
    }
 else {
      log.warn("No handler found for message type %s",requestMessageType);
    }
    ReferenceCountUtil.release(msg);
  }
 else {
    ctx.fireChannelRead(msg);
  }
}
