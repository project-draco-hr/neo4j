{
  boolean exists=cursor.next();
  id=cursor.getId();
  if (state.nodeIsDeletedInThisTx(id)) {
    try {
      throw new IllegalStateException("Node " + id + " has been deleted");
    }
  finally {
      this.id=0;
    }
  }
  this.nodeIsAddedInThisTx=state.nodeIsAddedInThisTx(id);
  if (exists || nodeIsAddedInThisTx) {
    this.nodeState=state.getNodeState(cursor.getId());
    return true;
  }
 else {
    this.id=-1;
    this.nodeState=null;
    return false;
  }
}
