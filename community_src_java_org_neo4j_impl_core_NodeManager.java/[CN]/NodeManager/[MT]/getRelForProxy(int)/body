{
  RelationshipImpl relationship=relCache.get(relId);
  if (relationship != null) {
    return relationship;
  }
  relationship=new RelationshipImpl(relId,this);
  ReentrantLock loadLock=lockId(relId);
  try {
    if (relCache.get(relId) != null) {
      relationship=relCache.get(relId);
      return relationship;
    }
    RelationshipData data=persistenceManager.loadLightRelationship(relId);
    if (data == null) {
      throw new NotFoundException("Relationship[" + relId + "] not found.");
    }
    int typeId=data.relationshipType();
    RelationshipType type=getRelationshipTypeById(typeId);
    if (type == null) {
      throw new RuntimeException("Relationship[" + data.getId() + "] exist but relationship type["+ typeId+ "] not found.");
    }
    relationship=new RelationshipImpl(relId,data.firstNode(),data.secondNode(),type,false,this);
    relCache.put(relId,relationship);
    return relationship;
  }
  finally {
    loadLock.unlock();
  }
}
