{
  Node node=resource instanceof Node ? (Node)resource : null;
  Relationship relationship=resource instanceof Relationship ? (Relationship)resource : null;
  if (node == null && relationship == null) {
    super.getReadLock(resource);
    return;
  }
  LockResult result=null;
  do {
    result=node != null ? receiver.receive(broker.getMaster().acquireNodeReadLock(broker.getSlaveContext(),getLocalTxId(),node.getId())) : receiver.receive(broker.getMaster().acquireRelationshipReadLock(broker.getSlaveContext(),getLocalTxId(),relationship.getId()));
switch (result.getStatus()) {
case OK_LOCKED:
      super.getReadLock(resource);
    return;
case DEAD_LOCKED:
  throw new DeadlockDetectedException(result.getDeadlockMessage());
}
}
 while (result.getStatus() == LockStatus.NOT_LOCKED);
}
