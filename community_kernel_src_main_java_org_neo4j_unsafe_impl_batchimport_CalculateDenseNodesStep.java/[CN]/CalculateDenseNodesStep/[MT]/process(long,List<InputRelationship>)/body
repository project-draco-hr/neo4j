{
  for (  InputRelationship rel : batch) {
    try {
      nodeRelationshipLink.incrementCount(rel.startNode());
    }
 catch (    ArrayIndexOutOfBoundsException e) {
      throw new RuntimeException("Input relationship " + rel + " refers to missing start node "+ rel.startNode(),e);
    }
    if (!rel.isLoop()) {
      try {
        nodeRelationshipLink.incrementCount(rel.endNode());
      }
 catch (      ArrayIndexOutOfBoundsException e) {
        throw new RuntimeException("Input relationship " + rel + " refers to missing end node "+ rel.endNode(),e);
      }
    }
    highestSeenNodeId=max(highestSeenNodeId,max(rel.startNode(),rel.endNode()));
  }
  return null;
}
