{
  for (  InputRelationship rel : batch) {
    long startNode=idMapper.get(rel.startNode());
    long endNode=idMapper.get(rel.endNode());
    try {
      nodeRelationshipLink.incrementCount(startNode);
    }
 catch (    ArrayIndexOutOfBoundsException e) {
      throw new RuntimeException("Input relationship " + rel + " refers to missing start node "+ rel.startNode(),e);
    }
    if (!rel.isLoop()) {
      try {
        nodeRelationshipLink.incrementCount(endNode);
      }
 catch (      ArrayIndexOutOfBoundsException e) {
        throw new RuntimeException("Input relationship " + rel + " refers to missing end node "+ rel.endNode(),e);
      }
    }
    highestSeenNodeId=max(highestSeenNodeId,max(startNode,endNode));
  }
  return null;
}
