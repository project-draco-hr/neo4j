{
  long[] startAndEndNodeIds=batch.other();
  int index=0;
  for (  InputRelationship rel : batch.first()) {
    long startNode=startAndEndNodeIds[index++];
    long endNode=startAndEndNodeIds[index++];
    ensureNodeFound("start",rel,startNode);
    ensureNodeFound("end",rel,endNode);
    try {
      nodeRelationshipLink.incrementCount(startNode);
    }
 catch (    ArrayIndexOutOfBoundsException e) {
      throw new RuntimeException("Input relationship " + rel + " refers to missing start node "+ rel.startNode(),e);
    }
    if (!rel.isLoop()) {
      try {
        nodeRelationshipLink.incrementCount(endNode);
      }
 catch (      ArrayIndexOutOfBoundsException e) {
        throw new RuntimeException("Input relationship " + rel + " refers to missing end node "+ rel.endNode(),e);
      }
    }
    highestSeenNodeId=max(highestSeenNodeId,max(startNode,endNode));
  }
  return null;
}
