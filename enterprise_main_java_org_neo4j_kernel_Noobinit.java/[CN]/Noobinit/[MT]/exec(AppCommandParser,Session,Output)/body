{
  boolean fail=parser.options().containsKey("fail");
  try {
    RelationshipType type=DynamicRelationshipType.withName("REL_TYPE");
    out.println("getOrCreateSingleOtherNode");
    Node fromNode=getServer().getDb().getReferenceNode();
    fromNode.removeProperty("___locking_property___");
    out.println("Grabbed lock");
    Relationship singleRelationship=fromNode.getSingleRelationship(type,Direction.OUTGOING);
    out.println("Single relationship is " + singleRelationship);
    Node otherNode=null;
    if (singleRelationship != null) {
      otherNode=singleRelationship.getOtherNode(fromNode);
    }
 else {
      otherNode=fromNode.getGraphDatabase().createNode();
      fromNode.createRelationshipTo(otherNode,type);
      out.println("Created new relationship");
    }
    if (fail) {
      throw new Exception("Just failing because you told me to");
    }
    return null;
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw e;
  }
}
