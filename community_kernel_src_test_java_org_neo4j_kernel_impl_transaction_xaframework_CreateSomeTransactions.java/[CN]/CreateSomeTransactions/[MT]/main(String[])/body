{
  String sourceDir=args[0];
  boolean shutdown=Boolean.parseBoolean(args[1]);
  GraphDatabaseAPI db=(GraphDatabaseAPI)new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(sourceDir).setConfig(GraphDatabaseSettings.keep_logical_logs,GraphDatabaseSetting.TRUE).newGraphDatabase();
  BatchTransaction tx=beginBatchTx(db);
  Node node=db.createNode();
  node.setProperty("name","First");
  Node otherNode=db.createNode();
  node.createRelationshipTo(otherNode,MyRelTypes.TEST);
  tx.restart();
  db.getXaDataSourceManager().getNeoStoreDataSource().rotateLogicalLog();
  for (int i=0; i < 5; i++) {
    db.createNode().setProperty("type",i);
    tx.restart();
  }
  tx.finish();
  if (shutdown)   db.shutdown();
 else   System.exit(1);
}
