{
  String sourceDir=args[0];
  boolean shutdown=Boolean.parseBoolean(args[1]);
  AbstractGraphDatabase db=new EmbeddedGraphDatabase(sourceDir,stringMap(KEEP_LOGICAL_LOGS,"true"));
  BatchTransaction tx=beginBatchTx(db);
  Node node=db.createNode();
  node.setProperty("name","First");
  Node otherNode=db.createNode();
  node.createRelationshipTo(otherNode,MyRelTypes.TEST);
  tx.restart();
  db.getConfig().getTxModule().getXaDataSourceManager().getXaDataSource(Config.DEFAULT_DATA_SOURCE_NAME).rotateLogicalLog();
  for (int i=0; i < 5; i++) {
    db.createNode().setProperty("type",i);
    tx.restart();
  }
  tx.finish();
  if (shutdown)   db.shutdown();
 else   System.exit(1);
}
