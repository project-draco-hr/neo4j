{
  Setting<Long> memUse=setting("mySetting",new Settings.DirectMemoryUsage(1024,800),"5%");
  assertThat(memUse.apply(Functions.<String,String>constant(null)),equalTo(51l));
  assertThat(memUse.apply(Functions.<String,String>constant("35M")),equalTo(36700160l));
  assertThat(memUse.apply(Functions.<String,String>constant("85%")),equalTo(800l));
  try {
    memUse.apply(Functions.<String,String>constant("bala%"));
    fail("Should've thrown.");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("Bad value 'bala%' for setting 'mySetting': Invalid memory fraction, expected a value between 0.0% and 100.0%."));
  }
  try {
    memUse.apply(Functions.<String,String>constant("110.14%"));
    fail("Should've thrown.");
  }
 catch (  IllegalArgumentException e) {
    assertThat(e.getMessage(),equalTo("Bad value '110.14%' for setting 'mySetting': Invalid memory fraction, expected a value between 0.0% and 100.0%."));
  }
}
