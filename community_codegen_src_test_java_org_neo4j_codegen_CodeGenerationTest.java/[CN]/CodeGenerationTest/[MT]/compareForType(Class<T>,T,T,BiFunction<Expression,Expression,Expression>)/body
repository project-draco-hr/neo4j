{
  createGenerator();
  ClassHandle handle;
  try (ClassGenerator simple=generateClass("SimpleClass")){
    try (CodeBlock block=simple.generateMethod(boolean.class,"equal",param(clazz,"a"),param(clazz,"b"))){
      block.returns(compare.apply(block.load("a"),block.load("b")));
    }
     handle=simple.handle();
  }
   MethodHandle equal=instanceMethod(handle.newInstance(),"equal",clazz,clazz);
  return (boolean)equal.invoke(lhs,rhs);
}
