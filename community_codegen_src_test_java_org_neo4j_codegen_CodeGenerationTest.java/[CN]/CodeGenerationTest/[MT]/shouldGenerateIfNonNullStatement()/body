{
  ClassHandle handle;
  try (ClassGenerator simple=generateClass("SimpleClass")){
    try (CodeBlock conditional=simple.generateMethod(void.class,"conditional",param(Object.class,"test"),param(Runnable.class,"runner"))){
      try (CodeBlock doStuff=conditional.ifNonNullStatement(conditional.load("test"))){
        doStuff.expression(invoke(doStuff.load("runner"),RUN));
      }
     }
     handle=simple.handle();
  }
   Runnable runner1=mock(Runnable.class);
  Runnable runner2=mock(Runnable.class);
  MethodHandle conditional=instanceMethod(handle.newInstance(),"conditional",Object.class,Runnable.class);
  conditional.invoke(new Object(),runner1);
  conditional.invoke(null,runner2);
  verify(runner1).run();
  verifyZeroInteractions(runner2);
}
