{
  createGenerator();
  ClassHandle handle;
  try (ClassGenerator simple=generateClass("SimpleClass")){
    try (CodeBlock block=simple.generateMethod(clazz,"add",param(clazz,"a"),param(clazz,"b"))){
      if (clazz == int.class) {
        block.returns(addInts(block.load("a"),block.load("b")));
      }
 else       if (clazz == long.class) {
        block.returns(addLongs(block.load("a"),block.load("b")));
      }
 else       if (clazz == double.class) {
        block.returns(addDoubles(block.load("a"),block.load("b")));
      }
 else {
        fail("adding " + clazz.getSimpleName() + " is not supported");
      }
    }
     handle=simple.handle();
  }
   MethodHandle add=instanceMethod(handle.newInstance(),"add",clazz,clazz);
  return (T)add.invoke(lhs,rhs);
}
