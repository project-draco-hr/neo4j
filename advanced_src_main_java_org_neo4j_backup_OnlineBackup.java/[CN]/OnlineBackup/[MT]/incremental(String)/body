{
  if (!directoryContainsDb(targetDirectory)) {
    throw new RuntimeException(targetDirectory + " doesn't contain a database");
  }
  GraphDatabaseService targetDb=startTemporaryDb(targetDirectory);
  try {
    return incremental(targetDb);
  }
  finally {
    targetDb.shutdown();
  }
}
