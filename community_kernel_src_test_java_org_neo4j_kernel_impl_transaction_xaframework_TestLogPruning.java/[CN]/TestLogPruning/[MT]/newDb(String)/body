{
  fs=new EphemeralFileSystemAbstraction();
  GraphDatabaseAPI db=(GraphDatabaseAPI)new ImpermanentGraphDatabase(stringMap(keep_logical_logs.name(),logPruning)){
    @Override protected FileSystemAbstraction createFileSystemAbstraction(){
      return fs;
    }
  }
;
  this.db=db;
  files=new PhysicalLogFiles(new File(db.getStoreDir()),GraphDatabaseSettings.logical_log.getDefaultValue(),fs);
  return db;
}
