{
  int size=1000;
  newDb(size + " size");
  doTransaction();
  rotate();
  long sizeOfOneLog=fs.getFileSize(neoDataSource().getXaContainer().getLogicalLog().getFileName(0));
  int filesNeededToExceedPruneLimit=(int)Math.ceil((double)size / (double)sizeOfOneLog);
  for (int i=1; i < filesNeededToExceedPruneLimit * 2; i++) {
    doTransaction();
    rotate();
    assertEquals(Math.min(i + 1,filesNeededToExceedPruneLimit),logCount());
  }
}
