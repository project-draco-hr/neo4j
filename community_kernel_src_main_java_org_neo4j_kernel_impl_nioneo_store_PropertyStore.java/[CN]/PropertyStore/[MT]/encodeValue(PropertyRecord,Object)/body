{
  if (value instanceof String) {
    String string=(String)value;
    if (ShortString.encode(string,record)) {
      return;
    }
    long stringBlockId=nextStringBlockId();
    record.setSinglePropBlock(stringBlockId);
    int length=string.length();
    char[] chars=new char[length];
    string.getChars(0,length,chars,0);
    Collection<DynamicRecord> valueRecords=allocateStringRecords(stringBlockId,chars);
    for (    DynamicRecord valueRecord : valueRecords) {
      valueRecord.setType(PropertyType.STRING.intValue());
      record.addValueRecord(valueRecord);
    }
    record.setHeader(PropertyType.STRING.getHeader());
  }
 else   if (value instanceof Integer) {
    record.setSinglePropBlock(((Integer)value).intValue());
    record.setHeader(PropertyType.INT.getHeader());
  }
 else   if (value instanceof Boolean) {
    record.setSinglePropBlock((((Boolean)value).booleanValue() ? 1 : 0));
    record.setHeader(PropertyType.BOOL.getHeader());
  }
 else   if (value instanceof Float) {
    record.setSinglePropBlock(Float.floatToRawIntBits(((Float)value).floatValue()));
    record.setHeader(PropertyType.FLOAT.getHeader());
  }
 else   if (value instanceof Long) {
    record.setSinglePropBlock(((Long)value).longValue());
    record.setHeader(PropertyType.LONG.getHeader());
  }
 else   if (value instanceof Double) {
    record.setSinglePropBlock(Double.doubleToRawLongBits(((Double)value).doubleValue()));
    record.setHeader(PropertyType.DOUBLE.getHeader());
  }
 else   if (value instanceof Byte) {
    record.setSinglePropBlock(((Byte)value).byteValue());
    record.setHeader(PropertyType.BYTE.getHeader());
  }
 else   if (value instanceof Character) {
    record.setSinglePropBlock(((Character)value).charValue());
    record.setHeader(PropertyType.CHAR.getHeader());
  }
 else   if (value.getClass().isArray()) {
    if (ShortArray.encode(value,record,DEFAULT_PAYLOAD_SIZE))     return;
    long arrayBlockId=nextArrayBlockId();
    record.setSinglePropBlock(arrayBlockId);
    Collection<DynamicRecord> arrayRecords=allocateArrayRecords(arrayBlockId,value);
    for (    DynamicRecord valueRecord : arrayRecords) {
      valueRecord.setType(PropertyType.ARRAY.intValue());
      record.addValueRecord(valueRecord);
    }
    record.setHeader(PropertyType.ARRAY.getHeader());
  }
 else   if (value instanceof Short) {
    record.setSinglePropBlock(((Short)value).shortValue());
    record.setHeader(PropertyType.SHORT.getHeader());
  }
 else {
    throw new IllegalArgumentException("Unknown property type on: " + value + ", "+ value.getClass());
  }
}
