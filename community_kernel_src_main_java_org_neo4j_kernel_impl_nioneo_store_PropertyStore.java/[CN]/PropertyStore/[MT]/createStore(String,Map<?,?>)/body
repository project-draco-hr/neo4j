{
  IdGeneratorFactory idGeneratorFactory=(IdGeneratorFactory)config.get(IdGeneratorFactory.class);
  createEmptyStore(fileName,VERSION,idGeneratorFactory);
  int stringStoreBlockSize=DEFAULT_DATA_BLOCK_SIZE;
  int arrayStoreBlockSize=DEFAULT_DATA_BLOCK_SIZE;
  try {
    String stringBlockSize=(String)config.get(STRING_BLOCK_SIZE);
    String arrayBlockSize=(String)config.get(ARRAY_BLOCK_SIZE);
    if (stringBlockSize != null) {
      int value=Integer.parseInt(stringBlockSize);
      if (value > 0) {
        stringStoreBlockSize=value;
      }
    }
    if (arrayBlockSize != null) {
      int value=Integer.parseInt(arrayBlockSize);
      if (value > 0) {
        arrayStoreBlockSize=value;
      }
    }
  }
 catch (  Exception e) {
    logger.log(Level.WARNING,"Exception creating store",e);
  }
  DynamicStringStore.createStore(fileName + ".strings",stringStoreBlockSize,idGeneratorFactory,IdType.STRING_BLOCK);
  PropertyIndexStore.createStore(fileName + ".index",idGeneratorFactory);
  DynamicArrayStore.createStore(fileName + ".arrays",arrayStoreBlockSize,idGeneratorFactory);
}
