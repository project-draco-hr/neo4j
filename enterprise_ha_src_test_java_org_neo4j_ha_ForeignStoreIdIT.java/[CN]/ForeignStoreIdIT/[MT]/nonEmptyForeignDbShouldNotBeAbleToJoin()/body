{
  firstInstance=new HighlyAvailableGraphDatabaseFactory().newHighlyAvailableDatabaseBuilder(DIR.directory("1",true).getAbsolutePath()).setConfig(server_id,"1").setConfig(initial_hosts,"127.0.0.1:5001").setConfig(cluster_server,"127.0.0.1:5001").setConfig(ha_server,"127.0.0.1:6001").newGraphDatabase();
  createNodes(firstInstance,3,"first");
  String foreignDbStoreDir=createAnotherStore(DIR.directory("2",true),1);
  foreignInstance=new HighlyAvailableGraphDatabaseFactory().newHighlyAvailableDatabaseBuilder(foreignDbStoreDir).setConfig(server_id,"2").setConfig(initial_hosts,"127.0.0.1:5001").setConfig(cluster_server,"127.0.0.1:5002").setConfig(ha_server,"127.0.0.1:6002").setConfig(state_switch_timeout,"5s").newGraphDatabase();
  try {
    createNode(foreignInstance,"foreigner");
    fail("Shouldn't be able to create a node, since it shouldn't have joined");
  }
 catch (  Exception e) {
  }
}
