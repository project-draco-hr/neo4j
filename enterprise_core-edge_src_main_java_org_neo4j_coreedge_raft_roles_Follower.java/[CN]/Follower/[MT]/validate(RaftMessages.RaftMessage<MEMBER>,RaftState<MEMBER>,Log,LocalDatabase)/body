{
  localDatabase.assertHealthy(IllegalStateException.class);
  Outcome<MEMBER> outcome=new Outcome<>(FOLLOWER,ctx);
  StoreId storeId=localDatabase.storeId();
  if (outcome.getLeader() != null && message.type() != RaftMessages.Type.HEARTBEAT_TIMEOUT && !storeId.theRealEquals(message.storeId())) {
    if (localDatabase.isEmpty()) {
      outcome.markNeedForFreshSnapshot();
      outcome.markUnprocessable();
    }
 else     if (message.type() != RaftMessages.Type.VOTE_REQUEST) {
      throw new MismatchingStoreIdException(message.storeId(),storeId);
    }
 else {
      outcome.markUnprocessable();
    }
  }
  return outcome;
}
