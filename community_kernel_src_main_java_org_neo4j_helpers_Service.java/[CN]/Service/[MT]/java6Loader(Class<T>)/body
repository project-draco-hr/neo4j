{
  try {
    Iterable<T> contextClassLoaderServices=ServiceLoader.load(type);
    Iterable<T> currentClassLoaderServices=ServiceLoader.load(type,Service.class.getClassLoader());
    HashMap<String,T> services=new HashMap<>();
    putAllInstancesToMap(currentClassLoaderServices,services);
    putAllInstancesToMap(contextClassLoaderServices,services);
    return services.values();
  }
 catch (  Exception|LinkageError e) {
    if (printServiceLoaderStackTraces) {
      e.printStackTrace();
    }
    return null;
  }
}
