{
  Map<String,CommitContext> contextMap=commitContextMap(command.getEntityType());
  String indexName=definitions.getIndexName(command.getIndexNameId());
  CommitContext context=contextMap.get(indexName);
  if (context == null) {
    IndexIdentifier identifier=new IndexIdentifier(IndexEntityType.byId(command.getEntityType()),indexName);
    context=new CommitContext(dataSource,identifier,dataSource.getType(identifier,recovery),recovery);
    contextMap.put(indexName,context);
  }
  return context;
}
