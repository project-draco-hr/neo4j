{
  RequestType type=RequestType.values()[buffer.readByte()];
  SlaveContext context=type.includesSlaveContext() ? readSlaveContext(buffer) : null;
  Response<?> response=type.caller.callMaster(realMaster,context,buffer);
  ChannelBuffer targetBuffer=ChannelBuffers.dynamicBuffer();
  type.serializer.write(response.response(),targetBuffer);
  if (type.includesSlaveContext()) {
    writeTransactionStreams(response.transactions(),targetBuffer);
  }
  return targetBuffer;
}
