{
  networkCounterMetrics=new ByteCounterMetrics();
  monitors.addMonitorListener(networkCounterMetrics,MasterServer.class.getName());
  monitors.addMonitorListener(networkCounterMetrics,"logdeserializer");
  diskCounterMetrics=new ByteCounterMetrics();
  monitors.addMonitorListener(diskCounterMetrics,"this used to attach to XaLogicalLog");
  File path=new File(config.get(GraphDatabaseSettings.store_dir),"metrics.txt");
  OutputStream file=fileSystemAbstraction.openAsOutputStream(path,false);
  csv=new CSVFile(file,Iterables.<String,String>iterable("timestamp","diskWritten","diskRead","networkWritten","networkRead","committedTx"));
  executor=Executors.newSingleThreadScheduledExecutor();
  executor.scheduleWithFixedDelay(new Runnable(){
    @Override public void run(){
      try {
        csv.print(System.currentTimeMillis(),diskCounterMetrics.getBytesWritten(),diskCounterMetrics.getBytesRead(),networkCounterMetrics.getBytesWritten(),networkCounterMetrics.getBytesRead());
        System.out.println(config.get(ClusterSettings.server_id) + " bytes written:" + networkCounterMetrics.getBytesWritten());
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
  }
,1,1,TimeUnit.SECONDS);
}
