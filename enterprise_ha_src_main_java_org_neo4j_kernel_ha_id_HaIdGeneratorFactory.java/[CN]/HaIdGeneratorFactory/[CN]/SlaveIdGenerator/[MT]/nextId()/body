{
  long nextId=nextLocalId();
  if (nextId == IdRangeIterator.VALUE_REPRESENTING_NULL) {
    try (Response<IdAllocation> response=master.allocateIds(requestContextFactory.newRequestContext(),idType)){
      IdAllocation allocation=response.response();
      log.info("Received id allocation " + allocation + " from master "+ master+ " for "+ idType);
      nextId=storeLocally(allocation);
    }
   }
  return nextId;
}
