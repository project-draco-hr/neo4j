{
  if (state == IdGeneratorState.SLAVE) {
    long highId=delegate.getHighId();
    delegate.close();
    if (fs.fileExists(fileName)) {
      fs.deleteFile(fileName);
    }
    localFactory.create(fileName,highId,false);
    delegate=localFactory.open(fileName,grabSize,idType,highId);
    log.debug("Instantiated master delegate " + delegate + " of type "+ idType+ " with highid "+ highId);
  }
 else {
    log.debug("Keeps " + delegate);
  }
  state=IdGeneratorState.MASTER;
}
