{
  UriBuilder builder=UriBuilder.fromUri(context.getRequest().getBaseUri());
  ForwardedHost forwardedHost=new ForwardedHost(context.getRequest().getHeaderValue("X-Forwarded-Host"));
  ForwardedProto xForwardedProto=new ForwardedProto(context.getRequest().getHeaderValue("X-Forwarded-Proto"));
  if (forwardedHost.isValid()) {
    builder.host(forwardedHost.getHost()).port(forwardedHost.getPort());
  }
  if (xForwardedProto.isValid()) {
    builder.scheme(xForwardedProto.getScheme());
  }
  return builder.build();
}
