{
  if (record.getFirstNode() == nodeId) {
    return record.getSecondNode() == nodeId ? Direction.BOTH : Direction.OUTGOING;
  }
  if (record.getSecondNode() == nodeId) {
    return Direction.INCOMING;
  }
  throw new InvalidRecordException("Node " + nodeId + " neither start nor end node of "+ record);
}
