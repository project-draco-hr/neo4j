{
  long loopCount=countByFirstPrevPointer(nodeId,group.getFirstLoop());
switch (direction) {
case OUTGOING:
    return countByFirstPrevPointer(nodeId,group.getFirstOut()) + loopCount;
case INCOMING:
  return countByFirstPrevPointer(nodeId,group.getFirstIn()) + loopCount;
case BOTH:
return countByFirstPrevPointer(nodeId,group.getFirstOut()) + countByFirstPrevPointer(nodeId,group.getFirstIn()) + loopCount;
default :
throw new IllegalArgumentException(direction.name());
}
}
