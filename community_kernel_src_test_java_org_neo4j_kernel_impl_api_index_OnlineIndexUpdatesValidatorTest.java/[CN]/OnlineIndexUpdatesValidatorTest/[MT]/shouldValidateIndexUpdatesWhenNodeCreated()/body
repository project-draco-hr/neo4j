{
  IndexUpdatesValidator validator=newIndexUpdatesValidatorWithMockedDependencies();
  NodeCommand createNode1=createNodeWithLabel(1,1);
  NodeCommand createNode2=createNodeWithLabel(2,2);
  PropertyCommand addProperty1ToNode1=addProperty(1,1);
  PropertyCommand addProperty2ToNode1=addProperty(1,2);
  PropertyCommand addProperty1ToNode2=addProperty(2,2);
  TransactionRepresentation tx=new PhysicalTransactionRepresentation(asList(createNode1,addProperty1ToNode1,addProperty2ToNode1,createNode2,addProperty1ToNode2));
  ValidatedIndexUpdates validatedUpdates=validator.validate(tx);
  assertNotSame(ValidatedIndexUpdates.NONE,validatedUpdates);
  LazyIndexUpdates expectedUpdates=new LazyIndexUpdates(nodeStore,propertyStore,propertyLoader,groupedByNodeId(addProperty1ToNode1,addProperty2ToNode1,addProperty1ToNode2),groupedById(createNode1,createNode2));
  verify(indexingService).validate(expectedUpdates,ONLINE);
}
