{
  this.storeDir=storeDir;
  this.config=config;
  config.put(Config.KEEP_LOGICAL_LOGS,"true");
  this.brokerFactory=brokerFactory;
  this.machineId=getMachineIdFromConfig(config);
  this.broker=brokerFactory.create(storeDir,config);
  this.msgLog=StringLogger.getLogger(storeDir + "/messages.log");
  startUp();
}
