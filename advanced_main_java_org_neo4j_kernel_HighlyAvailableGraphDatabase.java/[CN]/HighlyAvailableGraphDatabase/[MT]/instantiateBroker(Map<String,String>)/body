{
  String cls=config.get("ha_broker");
  try {
    return Class.forName(cls).asSubclass(Broker.class).getConstructor(Map.class).newInstance(config);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
