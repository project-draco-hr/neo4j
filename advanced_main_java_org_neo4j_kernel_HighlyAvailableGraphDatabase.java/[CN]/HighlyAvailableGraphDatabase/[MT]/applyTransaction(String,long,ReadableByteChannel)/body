{
  try {
    XaDataSourceManager localDataSourceManager=getConfig().getTxModule().getXaDataSourceManager();
    XaDataSource dataSource=localDataSourceManager.getXaDataSource(datasourceName);
    dataSource.applyCommittedTransaction(txId,stream);
  }
 catch (  IOException e) {
    newMaster(broker.getMaster(),e);
    throw new RuntimeException(e);
  }
}
