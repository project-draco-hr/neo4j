{
  File file=file("file");
  PageSwapperFactory factory=swapperFactory();
  PageSwapper swapper=factory.createPageSwapper(file,4,NO_CALLBACK,true);
  ByteBufferPage output=createPage(4);
  output.putInt(1,0);
  swapper.write(0,output);
  output.putInt(2,0);
  swapper.write(1,output);
  output.putInt(3,0);
  swapper.write(2,output);
  swapper.close();
  swapper=factory.createPageSwapper(file,8,NO_CALLBACK,false);
  ByteBufferPage pageA=createPage(8);
  ByteBufferPage pageB=createPage(8);
  ByteBufferPage pageC=createPage(8);
  pageA.putInt(-1,0);
  pageB.putInt(-1,0);
  pageC.putInt(-1,0);
  assertThat(swapper.read(0,new Page[]{pageA,pageB,pageC},0,3),is(12L));
  assertThat(pageA.getInt(0),is(1));
  assertThat(pageA.getInt(4),is(2));
  assertThat(pageB.getInt(0),is(3));
  assertThat(pageB.getInt(4),is(0));
  assertThat(pageC.getLong(0),is(0L));
}
