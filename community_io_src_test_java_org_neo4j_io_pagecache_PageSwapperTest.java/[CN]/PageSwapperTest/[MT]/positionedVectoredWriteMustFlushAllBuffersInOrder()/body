{
  File file=file("file");
  PageSwapperFactory factory=swapperFactory();
  PageSwapper swapper=factory.createPageSwapper(file,4,NO_CALLBACK,true);
  ByteBufferPage pageA=createPage(4);
  ByteBufferPage pageB=createPage(4);
  ByteBufferPage pageC=createPage(4);
  ByteBufferPage pageD=createPage(4);
  pageA.putInt(2,0);
  pageB.putInt(3,0);
  pageC.putInt(4,0);
  pageD.putInt(5,0);
  swapper.write(1,new Page[]{pageA,pageB,pageC,pageD},0,4);
  ByteBufferPage result=createPage(4);
  swapper.read(0,result);
  assertThat(result.getInt(0),is(0));
  result.putInt(0,0);
  assertThat(swapper.read(1,result),is(4));
  assertThat(result.getInt(0),is(2));
  result.putInt(0,0);
  assertThat(swapper.read(2,result),is(4));
  assertThat(result.getInt(0),is(3));
  result.putInt(0,0);
  assertThat(swapper.read(3,result),is(4));
  assertThat(result.getInt(0),is(4));
  result.putInt(0,0);
  assertThat(swapper.read(4,result),is(4));
  assertThat(result.getInt(0),is(5));
  result.putInt(0,0);
  assertThat(swapper.read(5,result),is(0));
  assertThat(result.getInt(0),is(0));
}
