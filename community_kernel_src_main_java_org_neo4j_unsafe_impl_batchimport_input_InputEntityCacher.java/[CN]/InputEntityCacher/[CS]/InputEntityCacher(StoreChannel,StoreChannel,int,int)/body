{
  this.storeChannel=channel;
  this.headerChannel=header;
  this.previousGroupIds=new int[groupSlots];
  for (int i=0; i < groupSlots; i++) {
    previousGroupIds[i]=Group.GLOBAL.id();
  }
  this.channel=new PositionAwarePhysicalFlushableChannel(new PhysicalLogVersionedStoreChannel(channel,0,(byte)0),bufferSize);
  this.header=new PositionAwarePhysicalFlushableChannel(new PhysicalLogVersionedStoreChannel(header,0,(byte)0),(int)ByteUnit.kibiBytes(8));
}
