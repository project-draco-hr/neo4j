{
  if (record.inUse() && record.isStartRecord()) {
    SchemaRule rule;
    try {
      rule=ruleAccess.loadSingleSchemaRule(record.getId());
    }
 catch (    MalformedSchemaRuleException e) {
      engine.report().malformedSchemaRule();
      return;
    }
    SchemaRule.Kind kind=rule.getKind();
switch (kind) {
case INDEX_RULE:
case CONSTRAINT_INDEX_RULE:
      checkIndexRule((IndexRule)rule,engine,record,records);
    break;
case UNIQUENESS_CONSTRAINT:
  checkUniquenessConstraintRule((UniquePropertyConstraintRule)rule,engine,record,records);
break;
case MANDATORY_NODE_PROPERTY_CONSTRAINT:
checkMandatoryNodePropertyRule((MandatoryNodePropertyConstraintRule)rule,record,records,engine);
break;
case MANDATORY_RELATIONSHIP_PROPERTY_CONSTRAINT:
checkMandatoryRelationshipPropertyRule((MandatoryRelationshipPropertyConstraintRule)rule,record,records,engine);
break;
default :
engine.report().unsupportedSchemaRuleKind(kind);
}
}
}
