{
  if (commandIndex <= state.ordinal()) {
    return Optional.empty();
  }
  if (tokenRequest.id() == LockToken.nextCandidateId(currentToken().id())) {
    state.set(tokenRequest,commandIndex);
    return Optional.of(Result.of(true));
  }
 else {
    return Optional.of(Result.of(false));
  }
}
