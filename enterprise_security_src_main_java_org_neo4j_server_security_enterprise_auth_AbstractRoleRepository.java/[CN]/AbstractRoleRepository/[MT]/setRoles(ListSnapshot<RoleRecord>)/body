{
  for (  RoleRecord role : rolesSnapshot.values) {
    assertValidRoleName(role.name());
  }
synchronized (this) {
    clear();
    this.roles.addAll(rolesSnapshot.values);
    this.lastLoaded.set(rolesSnapshot.timestamp);
    for (    RoleRecord role : roles) {
      rolesByName.put(role.name(),role);
      populateUserMap(role);
    }
  }
}
