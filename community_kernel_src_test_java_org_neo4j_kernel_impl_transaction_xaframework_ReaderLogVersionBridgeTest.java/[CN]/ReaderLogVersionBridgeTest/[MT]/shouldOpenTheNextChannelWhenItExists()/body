{
  final StoreChannel newStoreChannel=mock(StoreChannel.class);
  final ReaderLogVersionBridge bridge=new ReaderLogVersionBridge(fs,logFiles);
  when(channel.getVersion()).thenReturn(version);
  when(logFiles.getVersionFileName(version + 1)).thenReturn(file);
  when(fs.open(file,"r")).thenReturn(newStoreChannel);
  final VersionedStoreChannel result=bridge.next(channel);
  assertEquals(new PhysicalLogVersionedStoreChannel(newStoreChannel,version + 1),result);
  verify(channel,times(1)).close();
}
