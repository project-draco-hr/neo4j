{
  GraphDatabaseAPI graphDb=(GraphDatabaseAPI)new GraphDatabaseFactory().newEmbeddedDatabaseBuilder(directory).setConfig(configuration(true)).newGraphDatabase();
  try {
    generateInitialData(graphDb);
    StoreAccess stores=new StoreAccess(graphDb);
    schemaId=stores.getSchemaStore().getHighId();
    nodeId=stores.getNodeStore().getHighId();
    labelId=(int)stores.getLabelTokenStore().getHighId();
    nodeLabelsId=stores.getNodeDynamicLabelStore().getHighId();
    relId=stores.getRelationshipStore().getHighId();
    relGroupId=stores.getRelationshipGroupStore().getHighId();
    propId=(int)stores.getPropertyStore().getHighId();
    stringPropId=stores.getStringStore().getHighId();
    arrayPropId=stores.getArrayStore().getHighId();
    relTypeId=(int)stores.getRelationshipTypeTokenStore().getHighId();
    propKeyId=(int)stores.getPropertyKeyNameStore().getHighId();
  }
  finally {
    graphDb.shutdown();
  }
}
