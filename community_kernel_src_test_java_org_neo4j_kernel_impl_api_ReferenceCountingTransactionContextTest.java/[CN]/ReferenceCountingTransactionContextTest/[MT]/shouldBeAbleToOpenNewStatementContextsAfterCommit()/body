{
  StatementState before=refCountingContext.newStatementState();
  refCountingContext.commit();
  StatementState after=refCountingContext.newStatementState();
  try {
    refCountingOperations.close(before);
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEqualsStatementClosed(e);
  }
  verify(actualState.refCounting(),times(1)).close();
  verifyZeroInteractions(otherActualState);
  refCountingOperations.close(after);
  verify(otherActualState.refCounting(),times(1)).close();
}
