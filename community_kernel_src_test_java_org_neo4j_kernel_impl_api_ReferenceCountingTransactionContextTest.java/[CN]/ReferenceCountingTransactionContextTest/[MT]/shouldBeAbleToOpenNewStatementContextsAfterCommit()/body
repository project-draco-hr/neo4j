{
  StatementState before=refCountingContext.newStatementState();
  refCountingContext.commit();
  StatementState after=refCountingContext.newStatementState();
  try {
    refCountingOperations.close(before);
    fail("expected exception");
  }
 catch (  IllegalStateException e) {
    assertEqualsStatementClosed(e);
  }
  verify(actualState,times(1)).markAsClosed();
  verifyZeroInteractions(otherActualState);
  refCountingOperations.close(after);
  verify(otherActualState,times(1)).markAsClosed();
}
