{
  Applier applier=mock(Applier.class);
  int batchSize=10;
  TransactionQueue queue=new TransactionQueue(batchSize,applier);
  for (int i=0; i < 9; i++) {
    queue.queue(mock(TransactionToApply.class));
    verifyNoMoreInteractions(applier);
  }
  queue.queue(mock(TransactionToApply.class));
  verify(applier,times(1)).apply(any());
  reset(applier);
  queue.queue(mock(TransactionToApply.class));
  for (int i=0; i < 2; i++) {
    queue.queue(mock(TransactionToApply.class));
    verifyNoMoreInteractions(applier);
  }
  queue.empty();
  verify(applier,times(1)).apply(any());
}
