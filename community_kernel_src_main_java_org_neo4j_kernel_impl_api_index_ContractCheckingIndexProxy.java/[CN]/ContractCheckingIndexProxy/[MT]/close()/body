{
  if (state.compareAndSet(State.INIT,State.CLOSED))   return super.close();
  if (state.compareAndSet(State.CREATING,State.CLOSED))   throw new IllegalStateException("Concurrent close while creating index");
  if (state.compareAndSet(State.CREATED,State.CLOSED)) {
    ensureNoOpenCalls("close");
    return super.close();
  }
  throw new IllegalStateException("IndexContext already closed");
}
