{
  ThresholdConfigParser.ThresholdConfigValue thresholdConfigValue=parse(pruningStrategyConfig);
  String type=thresholdConfigValue.type;
  long value=thresholdConfigValue.value;
switch (type) {
case "size":
    return new SizeBasedLogPruningStrategy(value);
case "txs":
case "entries":
  return new EntryBasedLogPruningStrategy(value,logProvider);
case "hours":
case "days":
throw new IllegalArgumentException("Time based pruning not supported yet for the segmented raft log, got '" + type + "'.");
case "false":
return new NoPruningPruningStrategy();
default :
throw new IllegalArgumentException("Invalid log pruning configuration value '" + value + "'. Invalid type '"+ type+ "', valid are files, size, txs, entries, hours, days.");
}
}
