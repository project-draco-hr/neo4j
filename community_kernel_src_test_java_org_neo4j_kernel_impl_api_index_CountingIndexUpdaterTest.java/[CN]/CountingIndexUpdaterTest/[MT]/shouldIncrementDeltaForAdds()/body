{
  IndexUpdater indexUpdater=mock(IndexUpdater.class);
  IndexSizeVisitor indexSizeVisitor=mock(IndexSizeVisitor.class);
  CountingIndexUpdater countingIndexUpdater=new CountingIndexUpdater(42l,indexUpdater,indexSizeVisitor);
  NodePropertyUpdate update=NodePropertyUpdate.add(1,2,"x",new long[]{3});
  countingIndexUpdater.process(update);
  countingIndexUpdater.close();
  verify(indexUpdater).process(update);
  verify(indexSizeVisitor).incrementIndexSize(eq(42l),eq(1l));
  verify(indexUpdater).close();
  verifyNoMoreInteractions(indexSizeVisitor);
  verifyNoMoreInteractions(indexUpdater);
}
