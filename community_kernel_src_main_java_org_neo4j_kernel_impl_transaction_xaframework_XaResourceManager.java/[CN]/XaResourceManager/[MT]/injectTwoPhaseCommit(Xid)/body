{
  XidStatus status=xidMap.get(xid);
  if (status == null) {
    throw new XAException("Unknown xid[" + xid + "]");
  }
  TransactionStatus txStatus=status.getTransactionStatus();
  txOrderMap.put(xid,nextTxOrder++);
  txStatus.markAsPrepared();
  txStatus.markCommitStarted();
  XaTransaction xaTransaction=txStatus.getTransaction();
  xaTransaction.commit();
  transactionMonitor.injectTwoPhaseCommit(xid);
}
