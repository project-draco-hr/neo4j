{
  if (log.scanIsComplete() && recoveredTxCount == 0) {
    msgLog.debug("XaResourceManager[" + name + "] checkRecoveryComplete "+ xidMap.size()+ " xids");
    tf.recoveryComplete();
    try {
      for (      TransactionInfo recoveredTx : sortByTxId(recoveredTransactions.values())) {
        if (recoveryVerifier != null && !recoveryVerifier.isValid(recoveredTx)) {
          throw new RecoveryVerificationException(recoveredTx.getIdentifier(),recoveredTx.getTxId());
        }
        if (!recoveredTx.isOnePhase()) {
          log.commitTwoPhase(recoveredTx.getIdentifier(),recoveredTx.getTxId(),ForceMode.forced);
        }
        log.doneInternal(recoveredTx.getIdentifier());
      }
      recoveredTransactions.clear();
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
catch (    XAException e) {
      e.printStackTrace();
    }
    msgLog.debug("XaResourceManager[" + name + "] recovery completed.");
  }
}
