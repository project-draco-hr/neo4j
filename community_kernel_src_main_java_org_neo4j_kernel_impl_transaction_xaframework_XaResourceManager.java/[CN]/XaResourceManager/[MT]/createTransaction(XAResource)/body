{
  if (xaResourceMap.get(xaResource) != null) {
    throw new XAException("Resource[" + xaResource + "] already enlisted or suspended");
  }
  XaTransaction xaTx=tf.create(dataSource.getLastCommittedTxId(),transactionManager.getTransactionState());
  xaResourceMap.put(xaResource,new ResourceTransaction(xaTx));
  return xaTx;
}
