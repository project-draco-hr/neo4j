{
  long lastCommittedTxId=dataSource.getLastCommittedTxId();
  if (lastCommittedTxId + 1 == txId) {
    return log.applyTransaction(transaction,filter);
  }
 else   if (lastCommittedTxId + 1 < txId) {
    throw new IOException("Tried to apply transaction with txId=" + txId + " but last committed txId="+ lastCommittedTxId);
  }
 else {
    return false;
  }
}
