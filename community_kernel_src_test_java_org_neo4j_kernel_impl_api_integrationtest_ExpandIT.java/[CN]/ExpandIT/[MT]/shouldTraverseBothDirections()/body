{
  long nodeId=createGraph();
  ReadOperations ops=readOperationsInNewTransaction();
  RelationshipRegister relId=newRelationshipRegister();
  NodeRegister startId=newNodeRegister();
  NeoRegister.RelTypeRegister relType=newRelTypeRegister();
  ObjectRegister<Direction> direction=newObjectRegister();
  NodeRegister neighborId=newNodeRegister();
  Cursor cursor=ops.expand(countDownCursor(1),newNodeRegister(nodeId),newObjectRegister(new int[]{relType1}),newObjectRegister(Direction.BOTH),relId,relType,direction,startId,neighborId);
  assertThat(rows(cursor,relId,relType,direction,startId,neighborId),equalTo(asList(row(0,0,BOTH,0,0),row(1,0,BOTH,0,0),row(2,0,OUTGOING,0,1),row(3,0,OUTGOING,0,1),row(4,0,INCOMING,0,1),row(5,0,INCOMING,0,1),row(6,0,OUTGOING,0,2),row(7,0,OUTGOING,0,2),row(8,0,INCOMING,0,2),row(9,0,INCOMING,0,2))));
  assertFalse("Should not contain any more rows.",cursor.next());
}
