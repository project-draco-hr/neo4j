{
  createGraph();
  DataWriteOperations ops=dataWriteOperationsInNewTransaction();
  long nodeId=ops.nodeCreate();
  ops.relationshipCreate(relType1,nodeId,ops.nodeCreate());
  ops.relationshipDelete(ops.relationshipCreate(relType1,nodeId,ops.nodeCreate()));
  RelationshipRegister relId=newRelationshipRegister();
  NodeRegister startId=newNodeRegister();
  NeoRegister.RelTypeRegister relType=newRelTypeRegister();
  ObjectRegister<Direction> direction=newObjectRegister();
  NodeRegister neighborId=newNodeRegister();
  Cursor cursor=ops.expand(countDownCursor(1),newNodeRegister(nodeId),newObjectRegister(new int[]{relType1}),newObjectRegister(OUTGOING),relId,relType,direction,startId,neighborId);
  assertThat(rows(cursor,relId,relType,direction,startId,neighborId),equalTo(asList(row(12l,relType1,OUTGOING,nodeId,6l))));
  assertFalse("Should not contain any more rows.",cursor.next());
}
