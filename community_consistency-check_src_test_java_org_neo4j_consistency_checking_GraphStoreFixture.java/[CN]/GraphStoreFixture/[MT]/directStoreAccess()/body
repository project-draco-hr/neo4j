{
  if (directStoreAccess == null) {
    DefaultFileSystemAbstraction fileSystem=new DefaultFileSystemAbstraction();
    PageCache pageCache=getPageCache(fileSystem);
    neoStore=new StoreFactory(fileSystem,directory,pageCache,NullLogProvider.getInstance()).openAllNeoStores();
    StoreAccess nativeStores;
    if (keepStatistics) {
      AccessStatistics accessStatistics=new AccessStatistics();
      statistics=new VerboseStatistics(accessStatistics,new DefaultCounts(defaultConsistencyCheckThreadsNumber()),NullLog.getInstance());
      nativeStores=new AccessStatsKeepingStoreAccess(neoStore,accessStatistics);
    }
 else {
      statistics=Statistics.NONE;
      nativeStores=new StoreAccess(neoStore);
    }
    nativeStores.initialize();
    Config config=new Config();
    directStoreAccess=new DirectStoreAccess(nativeStores,new LuceneLabelScanStoreBuilder(directory,nativeStores.getRawNeoStores(),fileSystem,config,FormattedLogProvider.toOutputStream(System.out)).build(),createIndexes(fileSystem,config));
  }
  return directStoreAccess;
}
