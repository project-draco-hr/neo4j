{
  final ClusterTopology clusterTopology=discoveryService.currentTopology();
  if (clusterTopology.coreMembers().size() == 0) {
    throw new CoreServerSelectionException("No core servers available");
  }
  int skippedServers=random.nextInt(clusterTopology.coreMembers().size());
  final Iterator<MemberId> iterator=clusterTopology.coreMembers().iterator();
  MemberId member;
  do {
    member=iterator.next();
  }
 while (skippedServers-- > 0);
  return member;
}
