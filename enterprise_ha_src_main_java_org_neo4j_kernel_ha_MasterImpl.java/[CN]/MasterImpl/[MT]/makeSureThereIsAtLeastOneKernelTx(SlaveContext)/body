{
  Collection<Pair<String,Long>> txs=new ArrayList<Pair<String,Long>>();
  for (  Pair<String,Long> txEntry : context.lastAppliedTransactions()) {
    String resourceName=txEntry.first();
    XaDataSource dataSource=graphDbConfig.getTxModule().getXaDataSourceManager().getXaDataSource(resourceName);
    long startedCopyAtTxId=txEntry.other();
    if (dataSource instanceof NeoStoreXaDataSource) {
      if (startedCopyAtTxId == 1)       return context;
      if (startedCopyAtTxId == dataSource.getLastCommittedTxId())       startedCopyAtTxId--;
    }
    txs.add(Pair.of(resourceName,startedCopyAtTxId));
  }
  return new SlaveContext(context.getSessionId(),context.machineId(),context.getEventIdentifier(),txs.toArray(new Pair[0]));
}
