{
  dataSourceManager.start();
  CoreMember coreMember=findCoreMemberToCopyFrom();
  if (localDatabase.isEmpty()) {
    localDatabase.stop();
    localDatabase.copyStoreFrom(coreMember,storeFetcher);
    localDatabase.start();
  }
 else {
    StoreId localStoreId=localDatabase.storeId();
    StoreId remoteStoreId=storeFetcher.storeId(coreMember);
    if (!localStoreId.equals(remoteStoreId)) {
      throw new IllegalStateException(format("This edge machine cannot join the cluster. " + "The local database is not empty and has a mismatching storeId: expected %s actual %s.",remoteStoreId,localStoreId));
    }
  }
  txPulling.start();
}
