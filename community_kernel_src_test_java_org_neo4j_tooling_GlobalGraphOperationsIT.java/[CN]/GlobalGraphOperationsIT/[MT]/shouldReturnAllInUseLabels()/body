{
  GraphDatabaseService db=dbRule.getGraphDatabaseAPI();
  Label dead=Label.label("dead");
  Label alive=Label.label("alive");
  try (Transaction tx=db.beginTx()){
    db.createNode(alive);
    db.createNode(dead);
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    Node node=Iterators.single(db.findNodes(dead));
    node.delete();
    tx.success();
  }
   try (Transaction ignored=db.beginTx()){
    assertThat(asSet(db.getAllLabels()),equalTo(Collections.singleton(alive)));
  }
 }
