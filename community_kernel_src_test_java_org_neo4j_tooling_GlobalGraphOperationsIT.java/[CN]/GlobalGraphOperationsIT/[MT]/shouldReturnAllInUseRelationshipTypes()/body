{
  GraphDatabaseService db=dbRule.getGraphDatabaseAPI();
  RelationshipType dead=RelationshipType.withName("DEAD");
  RelationshipType alive=RelationshipType.withName("ALIVE");
  long deadId;
  try (Transaction tx=db.beginTx()){
    db.createNode().createRelationshipTo(db.createNode(),alive);
    deadId=db.createNode().createRelationshipTo(db.createNode(),dead).getId();
    tx.success();
  }
   try (Transaction tx=db.beginTx()){
    db.getRelationshipById(deadId).delete();
    tx.success();
  }
   try (Transaction ignored=db.beginTx()){
    Iterable<String> result=map(new Function<RelationshipType,String>(){
      @Override public String apply(      RelationshipType relationshipType){
        return relationshipType.name();
      }
    }
,db.getAllRelationshipTypes());
    assertThat(toSet(result),equalTo(Collections.singleton(alive.name())));
  }
 }
