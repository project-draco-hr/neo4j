{
  RecordingCallback messages=new RecordingCallback();
  SessionStateMachine machine=new SessionStateMachine("<test>",new UsageData(scheduler),db,txBridge,runner,NullLogService.getInstance(),Authentication.NONE);
  machine.run("RETURN 1",null,null,messages);
  assertThat(messages.next(),failedWith(Status.Request.Invalid));
  assertThat(machine.state(),equalTo(SessionStateMachine.State.STOPPED));
}
