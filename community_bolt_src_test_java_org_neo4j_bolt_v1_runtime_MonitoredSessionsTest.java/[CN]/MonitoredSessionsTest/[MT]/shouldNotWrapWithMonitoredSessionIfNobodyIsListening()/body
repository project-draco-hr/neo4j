{
  Sessions innerSessions=mock(Sessions.class);
  Session innerSession=mock(Session.class);
  when(innerSessions.newSession(anyString(),anyBoolean())).thenReturn(innerSession);
  Monitors monitors=new Monitors();
  MonitoredSessions sessions=new MonitoredSessions(monitors,innerSessions,new FakeClock());
  Session session=sessions.newSession("<test>");
  assertEquals(innerSession,session);
  monitors.addMonitorListener(new CountingSessionMonitor());
  assertThat(sessions.newSession("<test>"),instanceOf(MonitoredSession.class));
}
