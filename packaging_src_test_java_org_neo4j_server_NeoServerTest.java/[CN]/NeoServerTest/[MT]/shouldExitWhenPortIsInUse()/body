{
  NeoServer extraneousServerCreatedByTestSetup=NeoServer.getServer_FOR_TESTS_ONLY_KITTENS_DIE_WHEN_YOU_USE_THIS();
  ServerSocket preBoundSocket=new ServerSocket(8697);
  ServerStartupException thrownException=null;
  try {
    NeoServer cheatedServer=ServerTestUtils.initializeServerWithRandomTemporaryDatabaseDirectory(Integer.toString(preBoundSocket.getLocalPort()));
    cheatedServer.start();
  }
 catch (  ServerStartupException e) {
    thrownException=e;
  }
  assertThat(thrownException.getErrorCode(),is(equalTo(NeoServer.WEB_SERVER_STARTUP_ERROR_CODE)));
  preBoundSocket.close();
  extraneousServerCreatedByTestSetup.stop();
}
