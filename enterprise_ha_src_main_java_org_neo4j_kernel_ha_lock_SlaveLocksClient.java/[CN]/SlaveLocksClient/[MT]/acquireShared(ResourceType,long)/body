{
  assertNotStopped();
  Map<Long,AtomicInteger> lockMap=getLockMap(sharedLocks,resourceType);
  long[] newResourceIds=onlyFirstTimeLocks(lockMap,resourceIds);
  if (newResourceIds.length > 0) {
    acquireSharedOnMaster(resourceType,newResourceIds);
    for (    long resourceId : newResourceIds) {
      if (client.trySharedLock(resourceType,resourceId)) {
        lockMap.put(resourceId,new AtomicInteger(1));
      }
 else {
        throw new LocalDeadlockDetectedException(client,localLockManager,resourceType,resourceId,READ);
      }
    }
  }
}
