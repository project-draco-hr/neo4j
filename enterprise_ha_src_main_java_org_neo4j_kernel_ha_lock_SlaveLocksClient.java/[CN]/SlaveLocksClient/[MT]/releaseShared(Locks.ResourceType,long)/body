{
  assertNotStopped();
  Map<Long,AtomicInteger> lockMap=getLockMap(sharedLocks,resourceType);
  AtomicInteger counter=lockMap.get(resourceId);
  if (counter == null) {
    throw new IllegalStateException(this + " cannot release lock it does not hold: SHARED " + resourceType+ "["+ resourceId+ "]");
  }
  if (counter.decrementAndGet() == 0) {
    lockMap.remove(resourceId);
    client.releaseShared(resourceType,resourceId);
  }
}
