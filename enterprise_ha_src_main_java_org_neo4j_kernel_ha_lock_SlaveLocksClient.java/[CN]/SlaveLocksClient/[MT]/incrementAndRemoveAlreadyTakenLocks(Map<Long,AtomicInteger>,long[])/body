{
  ArrayList<Long> untakenIds=new ArrayList<>();
  for (int i=0; i < resourceIds.length; i++) {
    long id=resourceIds[i];
    AtomicInteger counter=takenLocks.get(id);
    if (counter != null) {
      counter.incrementAndGet();
    }
 else {
      untakenIds.add(id);
    }
  }
  long[] untaken=new long[untakenIds.size()];
  for (int i=0; i < untaken.length; i++) {
    long id=untakenIds.get(i);
    untaken[i]=id;
  }
  return untaken;
}
