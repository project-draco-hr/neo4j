{
  NodeImpl node=nodeManager.getNodeForProxy(nodeId,null);
  boolean success=false;
  try {
    ArrayMap<Integer,DefinedProperty> skipMap=state.getOrCreateCowPropertyRemoveMap(node);
    ArrayMap<Integer,DefinedProperty> removedProps=nodeManager.deleteNode(node,state);
    if (removedProps.size() > 0) {
      for (      Integer index : removedProps.keySet()) {
        skipMap.put(index,removedProps.get(index));
      }
    }
    success=true;
  }
  finally {
    if (!success) {
      nodeManager.setRollbackOnly();
    }
  }
}
