{
  Collection<XaDataSource> dataSources=localDataSourceManager.getAllRegisteredDataSources();
  @SuppressWarnings("unchecked") Pair<String,Long>[] txs=new Pair[dataSources.size()];
  int i=0;
  for (  XaDataSource dataSource : dataSources) {
    txs[i++]=new Pair<String,Long>(dataSource.getName(),dataSource.getLastCommittedTxId());
  }
  return new SlaveContext(machineId,txs);
}
