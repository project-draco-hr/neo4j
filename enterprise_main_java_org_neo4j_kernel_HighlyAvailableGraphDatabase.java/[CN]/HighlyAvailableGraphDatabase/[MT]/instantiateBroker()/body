{
  String cls=config.get("ha_broker");
  cls=cls != null ? cls : "some.default.Broker";
  try {
    return Class.forName(cls).asSubclass(Broker.class).getConstructor(Map.class).newInstance(config);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
