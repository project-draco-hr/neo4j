{
  if (depth > 100) {
    throw new RuntimeException("Recursive guard: depth = " + depth);
  }
  if (currentNode == null) {
    return;
  }
  Iterable<Relationship> rels=currentNode.getRelationships();
  for (  Relationship rel : rels) {
    if (!rel.getStartNode().equals(currentNode)) {
      continue;
    }
    Node endNode=rel.getEndNode();
    rel.delete();
    this.deleteNodeTreeRecursively(endNode,depth + 1);
  }
  String msg="Deleting " + currentNode + "\t[";
  String id=(String)currentNode.getProperty("node.test.id");
  msg+=id + "]";
  Iterable<Relationship> allRels=currentNode.getRelationships();
  for (  Relationship rel : allRels) {
    rel.delete();
  }
  currentNode.delete();
}
