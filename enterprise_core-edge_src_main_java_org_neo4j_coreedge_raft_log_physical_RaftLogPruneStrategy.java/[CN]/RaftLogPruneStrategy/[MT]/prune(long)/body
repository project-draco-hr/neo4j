{
  if (upToLogVersion == INITIAL_LOG_VERSION) {
    return;
  }
  threshold.init();
  long upper=upToLogVersion - 1;
  boolean exceeded=false;
  while (upper >= 0) {
    if (!files.versionExists(upper)) {
      return;
    }
    if (files.containsEntries(upper) && threshold.reached(files.getLogFileForVersion(upper),upper,logFileInformation)) {
      exceeded=true;
      break;
    }
    upper--;
  }
  if (!exceeded) {
    return;
  }
  files.pruneUpTo(upper);
}
