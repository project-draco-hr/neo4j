{
  Transaction tx=null;
  try {
    int status=transactionManager.getStatus();
    if (status == Status.STATUS_NO_TRANSACTION) {
      throw new NotInTransactionException("Neo API calls must be done in a transaction.");
    }
    tx=transactionManager.getTransaction();
    NeoConstraintsEvaluator evaluator=evaluators.get(tx);
    if (evaluator == null) {
      evaluator=new NeoConstraintsEvaluator(tx);
      tx.registerSynchronization(evaluator);
      evaluators.put(tx,evaluator);
    }
    return evaluator;
  }
 catch (  SystemException e) {
    throw new RuntimeException(e);
  }
catch (  IllegalStateException e) {
    throw new RuntimeException(e);
  }
catch (  RollbackException e) {
    throw new RuntimeException(e);
  }
}
