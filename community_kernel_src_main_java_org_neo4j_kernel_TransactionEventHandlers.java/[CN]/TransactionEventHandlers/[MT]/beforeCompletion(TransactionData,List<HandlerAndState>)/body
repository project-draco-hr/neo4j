{
  for (  TransactionEventHandler<?> handler : this.transactionEventHandlers) {
    try {
      Object state=handler.beforeCommit(transactionData);
      states.add(new HandlerAndState(handler,state));
    }
 catch (    Throwable t) {
      try {
        txManager.setRollbackOnly();
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      throw new RuntimeException(t);
    }
  }
}
