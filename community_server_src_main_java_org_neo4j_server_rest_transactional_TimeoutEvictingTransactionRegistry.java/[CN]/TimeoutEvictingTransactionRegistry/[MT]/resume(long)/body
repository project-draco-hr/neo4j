{
  TransactionMarker marker=registry.get(id);
  if (null == marker) {
    throw new InvalidTransactionId();
  }
  if (!marker.isSuspended()) {
    throw new InvalidConcurrentTransactionAccess();
  }
  SuspendedTransaction transaction=marker.getTransaction();
  if (registry.replace(id,marker,ActiveTransaction.INSTANCE)) {
    transaction.context.resumeSinceTransactionsAreStillThreadBound();
    return transaction.context;
  }
 else {
    throw new InvalidConcurrentTransactionAccess();
  }
}
