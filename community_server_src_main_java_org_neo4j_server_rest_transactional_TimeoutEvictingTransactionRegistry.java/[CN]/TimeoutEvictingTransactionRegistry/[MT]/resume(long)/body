{
  TransactionMarker marker=registry.get(id);
  if (null == marker) {
    throw new InvalidTransactionIdError(TX_NOT_FOUND_ERR_MSG);
  }
  if (!marker.isSuspended()) {
    throw new ConcurrentTransactionAccessError(TX_CONCURRENT_ACCESS_ERR_MSG);
  }
  SuspendedTransaction transaction=marker.getTransaction();
  if (registry.replace(id,marker,ActiveTransaction.INSTANCE)) {
    transaction.context.resumeSinceTransactionsAreStillThreadBound();
    return transaction.context;
  }
 else {
    throw new ConcurrentTransactionAccessError(TX_CONCURRENT_ACCESS_ERR_MSG);
  }
}
