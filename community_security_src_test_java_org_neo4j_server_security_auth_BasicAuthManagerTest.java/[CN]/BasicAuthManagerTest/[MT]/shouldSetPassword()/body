{
  final InMemoryUserRepository users=new InMemoryUserRepository();
  users.create(new User.Builder("jake",Credential.forPassword("abc123")).withRequiredPasswordChange(true).build());
  final BasicAuthManager manager=new BasicAuthManager(users,mock(PasswordPolicy.class),mock(AuthenticationStrategy.class));
  manager.start();
  manager.setUserPassword("jake","hello, world!");
  User user=manager.getUser("jake");
  assertTrue(user.credentials().matchesPassword("hello, world!"));
  assertThat(users.getUserByName("jake"),equalTo(user));
}
