{
  if (page != null) {
    pagedFile.unpin(this);
  }
  if (nextPageId >= lastPageId && (pf_flags & PF_NO_GROW) != 0) {
    return false;
  }
  if ((pf_flags & PF_SINGLE_PAGE) != 0 && nextPageId > pageId) {
    return false;
  }
  try {
    pagedFile.pin(this,getLockType(pf_flags),nextPageId);
  }
 catch (  IOException e) {
    if (page != null) {
      pagedFile.unpin(this);
    }
    throw e;
  }
  nextPageId++;
  return true;
}
