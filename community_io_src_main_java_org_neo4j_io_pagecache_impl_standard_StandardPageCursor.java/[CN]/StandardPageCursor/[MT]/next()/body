{
  if (page != null) {
    pagedFile.unpin(this);
  }
  if ((pf_flags & PF_SINGLE_PAGE) != 0 && nextPageId > pageId) {
    return false;
  }
  try {
    pagedFile.pin(this,getLockType(pf_flags),nextPageId);
  }
 catch (  IOException e) {
    if (page != null) {
      pagedFile.unpin(this);
    }
    throw e;
  }
  nextPageId++;
  if (nextPageId > lastPageId) {
    if ((pf_flags & PF_NO_GROW) != 0) {
      return false;
    }
 else {
      lastPageId=pagedFile.increaseLastPageIdTo(nextPageId);
    }
  }
  return true;
}
