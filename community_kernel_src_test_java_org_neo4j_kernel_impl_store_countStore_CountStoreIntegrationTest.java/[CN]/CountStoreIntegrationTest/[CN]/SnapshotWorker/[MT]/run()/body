{
  Snapshot snapshot=countStore.snapshot(txId);
  Map<CountsKey,long[]> snapshotMap=snapshot.getMap();
  Map<CountsKey,long[]> expectedMap=intermediateStateTestManager.getIntermediateMap((int)snapshot.getTxId());
  Assert.assertTrue("Counts store snapshot was recorded with transaction ID less than the requested value.",snapshot.getTxId() >= txId);
  Assert.assertEquals("Counts store snapshot has an incorrect number of k/v pairs.",snapshotMap.size(),expectedMap.size());
  compareMaps(expectedMap,snapshotMap);
}
