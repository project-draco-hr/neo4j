{
  String formattedQuery;
  if ("cypher".equals(language) && query.contains("merge")) {
    formattedQuery=uppercaseKeywords(query,keywordsToBreakOn);
    formattedQuery=uppercaseKeywords(formattedQuery,unbreakableKeywords);
  }
 else {
    formattedQuery=breakOnKeywords(query,keywordsToBreakOn);
    formattedQuery=uppercaseKeywords(formattedQuery,unbreakableKeywords);
  }
  String result="[source," + language + "]\n----\n"+ formattedQuery+ (formattedQuery.endsWith("\n") ? "" : "\n")+ "----\n";
  return limitChars(result);
}
