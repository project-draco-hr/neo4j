{
  if (data.ignore)   return;
  Writer fw=null;
  try {
    String name=data.title.replace(" ","-").toLowerCase();
    String filename=name + ".asciidoc";
    File dir=new File(new File(new File("target"),"docs"),section);
    data.description=replaceSnippets(data.description,dir,name);
    fw=AsciiDocGenerator.getFW(dir,filename);
    String longSection=section.replaceAll("\\(|\\)","") + "-" + name.replaceAll("\\(|\\)","");
    if (longSection.indexOf("/") > 0) {
      longSection=longSection.substring(longSection.indexOf("/") + 1);
    }
    line(fw,"[[" + longSection + "]]");
    String firstChar=data.title.substring(0,1).toUpperCase();
    String heading=firstChar + data.title.substring(1);
    line(fw,getAsciidocHeading(heading));
    line(fw,"");
    if (data.description != null && !data.description.isEmpty()) {
      line(fw,data.description);
      line(fw,"");
    }
    if (graph != null) {
      fw.append(AsciiDocGenerator.dumpToSeparateFile(dir,name + ".graph",AsciidocHelper.createGraphVizWithNodeId("Final Graph",graph,title)));
      line(fw,"");
    }
    line(fw,"_Example request_");
    line(fw,"");
    StringBuilder sb=new StringBuilder(512);
    sb.append("* *+").append(data.method).append("+*  +").append(data.uri).append("+\n");
    if (data.requestHeaders != null) {
      for (      Entry<String,String> header : data.requestHeaders.entrySet()) {
        sb.append("* *+").append(header.getKey()).append(":+* +").append(header.getValue()).append("+\n");
      }
    }
    fw.append(AsciiDocGenerator.dumpToSeparateFile(dir,name + ".request",sb.toString()));
    sb=new StringBuilder(2048);
    line(fw,"");
    line(fw,"_Example response_");
    line(fw,"");
    sb.append("* *+").append(data.status).append(":+* +").append(Response.Status.fromStatusCode(data.status)).append("+\n");
    if (data.responseHeaders != null) {
      for (      Entry<String,String> header : data.responseHeaders.entrySet()) {
        sb.append("* *+").append(header.getKey()).append(":+* +").append(header.getValue()).append("+\n");
      }
    }
    writeEntity(sb,data.getPrettifiedEntity());
    fw.append(AsciiDocGenerator.dumpToSeparateFile(dir,name + ".response",sb.toString()));
    line(fw,"");
  }
 catch (  IOException e) {
    e.printStackTrace();
    fail();
  }
 finally {
    if (fw != null) {
      try {
        fw.close();
      }
 catch (      IOException e) {
        e.printStackTrace();
        fail();
      }
    }
  }
}
