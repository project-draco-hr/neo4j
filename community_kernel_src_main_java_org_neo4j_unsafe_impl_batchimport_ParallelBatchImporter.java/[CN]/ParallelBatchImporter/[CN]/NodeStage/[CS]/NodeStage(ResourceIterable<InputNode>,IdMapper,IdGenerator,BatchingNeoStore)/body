{
  super("Nodes",config);
  add(new IteratorBatcherStep<>(control(),"INPUT",config.batchSize(),config.movingAverageSize(),nodes.iterator()));
  NodeStore nodeStore=neoStore.getNodeStore();
  PropertyStore propertyStore=neoStore.getPropertyStore();
  Iterable<Object> allIds=new IterableWrapper<Object,InputNode>(nodes){
    @Override protected Object underlyingObjectToObject(    InputNode object){
      return object.id();
    }
  }
;
  add(new NodeEncoderStep(control(),config,idMapper,idGenerator,neoStore.getLabelRepository(),nodeStore,allIds));
  add(new PropertyEncoderStep<>(control(),config,1,neoStore.getPropertyKeyRepository(),propertyStore));
  add(new EntityStoreUpdaterStep<>(control(),"WRITER",config,nodeStore,propertyStore,writeMonitor,writerFactory));
}
