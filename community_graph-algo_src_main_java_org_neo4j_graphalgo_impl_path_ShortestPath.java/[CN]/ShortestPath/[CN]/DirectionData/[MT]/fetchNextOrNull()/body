{
  while (true) {
    Relationship nextRel=fetchNextRelOrNull();
    if (nextRel == null) {
      return null;
    }
    if (!hitDecider.canVisitRelationship(sharedVisitedRels,nextRel)) {
      continue;
    }
    Node result=nextRel.getOtherNode(this.lastParentTraverserNode);
    LevelData levelData=this.visitedNodes.get(result);
    boolean createdLevelData=false;
    if (levelData == null) {
      levelData=new LevelData(nextRel,this.currentDepth);
      this.visitedNodes.put(result,levelData);
      createdLevelData=true;
    }
    if (this.currentDepth == levelData.depth && !createdLevelData) {
      levelData.addRel(nextRel);
    }
    if (!createdLevelData) {
      continue;
    }
    this.nextNodes.add(result);
    return result;
  }
}
