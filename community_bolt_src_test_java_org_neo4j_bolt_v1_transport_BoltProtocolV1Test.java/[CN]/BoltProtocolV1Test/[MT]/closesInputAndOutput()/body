{
  Channel outputChannel=mock(Channel.class);
  ByteBufAllocator allocator=mock(ByteBufAllocator.class);
  ByteBuf buffer=mock(ByteBuf.class);
  when(outputChannel.alloc()).thenReturn(allocator);
  when(allocator.buffer(anyInt(),anyInt())).thenReturn(buffer);
  BoltStateMachine machine=mock(BoltStateMachine.class);
  BoltProtocolV1 protocol=new BoltProtocolV1(new SynchronousBoltWorker(machine),outputChannel,NullLogService.getInstance());
  protocol.close();
  verify(machine).close();
  verify(buffer).release();
}
