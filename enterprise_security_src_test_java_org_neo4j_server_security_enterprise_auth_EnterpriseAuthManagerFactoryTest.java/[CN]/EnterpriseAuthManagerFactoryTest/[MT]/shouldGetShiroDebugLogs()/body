{
  Config config=mock(Config.class);
  LogProvider mockLogProvider=mock(LogProvider.class);
  Log mockLog=mock(Log.class);
  when(mockLogProvider.getLog(anyString())).thenReturn(mockLog);
  when(mockLog.isDebugEnabled()).thenReturn(true);
  when(config.get(SecuritySettings.internal_authentication_enabled)).thenReturn(false);
  when(config.get(SecuritySettings.internal_authorization_enabled)).thenReturn(false);
  when(config.get(SecuritySettings.ldap_authentication_enabled)).thenReturn(true);
  when(config.get(SecuritySettings.ldap_authorization_enabled)).thenReturn(true);
  when(config.get(SecuritySettings.plugin_authentication_enabled)).thenReturn(false);
  when(config.get(SecuritySettings.plugin_authorization_enabled)).thenReturn(false);
  when(config.get(SecuritySettings.ldap_user_dn_template)).thenReturn("prefix{0}");
  new EnterpriseAuthManagerFactory().newInstance(config,mockLogProvider,null,null);
  verify(mockLog,atLeastOnce()).debug(anyString(),contains("prefix"),anyString());
}
