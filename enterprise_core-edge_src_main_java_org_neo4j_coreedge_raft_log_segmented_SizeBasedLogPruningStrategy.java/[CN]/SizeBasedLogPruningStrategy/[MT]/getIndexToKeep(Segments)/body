{
  long accumulatedSize=0;
  ListIterator<SegmentFile> iterator=segments.getSegmentFileIteratorAtEnd();
  SegmentFile segmentFile=null;
  while (accumulatedSize < bytesToKeep && iterator.hasPrevious()) {
    segmentFile=iterator.previous();
    accumulatedSize+=sizeOf(segmentFile);
  }
  return segmentFile != null ? segmentFile.header().prevIndex() : -1;
}
