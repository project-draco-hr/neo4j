{
  Transaction tx=db.beginTx();
  Node node1=db.createNode();
  Node node2=db.createNode();
  tx.success();
  tx.finish();
  Iterator<Node> allNodes=GlobalGraphOperations.at(db).getAllNodes().iterator();
  allNodes.next();
  tx=db.beginTx();
  Node node3=db.createNode();
  tx.success();
  tx.finish();
  assertEquals(asList(node1,node2,node3),addToCollection(allNodes,new ArrayList<Node>()));
}
