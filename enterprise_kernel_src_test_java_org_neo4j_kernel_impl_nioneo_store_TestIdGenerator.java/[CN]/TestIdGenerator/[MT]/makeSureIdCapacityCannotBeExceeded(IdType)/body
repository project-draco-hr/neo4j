{
  deleteIdGeneratorFile();
  IdGeneratorImpl.createGenerator(idGeneratorFile());
  long maxValue=type.getMaxValue();
  IdGenerator idGenerator=new IdGeneratorImpl(idGeneratorFile(),1,maxValue);
  long id=maxValue - 2;
  idGenerator.setHighId(id);
  assertEquals(id,idGenerator.nextId());
  assertEquals(id + 1,idGenerator.nextId());
  if (maxValue != (long)Math.pow(2,32) - 1) {
    assertEquals(id + 2,idGenerator.nextId());
  }
  try {
    idGenerator.nextId();
    fail("Id capacity shouldn't be able to be exceeded for " + type);
  }
 catch (  StoreFailureException e) {
  }
  idGenerator.close();
}
