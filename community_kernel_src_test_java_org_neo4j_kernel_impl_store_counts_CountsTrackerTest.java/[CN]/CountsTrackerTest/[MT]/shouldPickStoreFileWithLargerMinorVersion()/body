{
  EphemeralFileSystemAbstraction fs=this.fs.get();
  File alphaFile=alphaStoreFile();
  File betaFile=betaStoreFile();
  PageCache pageCache=pageCache();
  createStoreFile(fs,pageCache,alphaFile,BASE_TX_ID + 1);
  createStoreFile(fs,pageCache,betaFile,BASE_TX_ID);
{
    CountsTracker tracker=new CountsTracker(StringLogger.DEV_NULL,fs,pageCache,storeFile());
    assertEquals(alphaFile,tracker.storeFile());
    tracker.incrementNodeCount(1,1l);
    tracker.rotate(BASE_TX_ID + 1);
    assertEquals(betaFile,tracker.storeFile());
    tracker.close();
  }
{
    CountsTracker tracker=new CountsTracker(StringLogger.DEV_NULL,fs,pageCache,storeFile());
    assertEquals(betaFile,tracker.storeFile());
    tracker.close();
  }
}
