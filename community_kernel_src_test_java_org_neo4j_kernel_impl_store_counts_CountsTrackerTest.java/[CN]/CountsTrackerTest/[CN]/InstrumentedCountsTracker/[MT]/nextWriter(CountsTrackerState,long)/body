{
  final CountsStoreWriter writer=(CountsStoreWriter)super.nextWriter(state,lastCommittedTxId);
  return new CountsStore.Writer<CountsKey,DoubleLongRegister>(){
    @Override public SortedKeyValueStore<CountsKey,DoubleLongRegister> openForReading() throws IOException {
      barrier.reached();
      return writer.openForReading();
    }
    @Override public void close() throws IOException {
      writer.close();
    }
    @Override public void visit(    CountsKey key,    DoubleLongRegister valueRegister){
      writer.visit(key,valueRegister);
    }
  }
;
}
