{
  final CountsStoreWriter writer=(CountsStoreWriter)super.nextWriter(state,lastTxId);
  return new CountsStore.Writer<CountsKey,CopyableDoubleLongRegister>(){
    @Override public SortedKeyValueStore<CountsKey,CopyableDoubleLongRegister> openForReading() throws IOException {
      barrier.reached();
      return writer.openForReading();
    }
    @Override public void close() throws IOException {
      writer.close();
    }
    @Override public void visit(    CountsKey key,    CopyableDoubleLongRegister valueRegister){
      writer.visit(key,valueRegister);
    }
  }
;
}
