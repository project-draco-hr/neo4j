{
  String indexProperty="indexProperty";
  GatheringIndexWriter writer=newWriter(indexProperty);
  createIndex(myLabel,indexProperty);
  String otherProperty="otherProperty";
  int value=12;
  int otherValue=17;
  Node node=createNode(map(indexProperty,value,otherProperty,otherValue));
  assertThat(writer.updates.size(),equalTo(0));
  Transaction tx=db.beginTx();
  node.addLabel(myLabel);
  tx.success();
  tx.finish();
  long propertyKey1=ctxProvider.getCtxForReading().propertyKeyGetForName(indexProperty);
  long[] labels=new long[]{ctxProvider.getCtxForReading().labelGetForName(myLabel.name())};
  assertThat(writer.updates,equalTo(asSet(NodePropertyUpdate.add(node.getId(),propertyKey1,value,labels))));
}
