{
  database=new TestGraphDatabaseFactory().setFileSystem(fs).newImpermanentDatabase();
  Node node;
  Label[] labels=new Label[]{label("a"),label("b"),label("c"),label("d"),label("e"),label("f"),label("g"),label("h"),label("i"),label("j"),label("k")};
  try (Transaction tx=database.beginTx()){
    node=database.createNode(labels);
    tx.success();
  }
   try (Transaction tx=database.beginTx()){
    node.setProperty("prop","value");
    tx.success();
  }
   EphemeralFileSystemAbstraction snapshot=fs.snapshot();
  database.shutdown();
  database=new TestGraphDatabaseFactory().setFileSystem(snapshot).newImpermanentDatabase();
  try (Transaction ignored=database.beginTx()){
    node=database.getNodeById(node.getId());
    for (    Label label : labels) {
      assertTrue(node.hasLabel(label));
    }
  }
 }
