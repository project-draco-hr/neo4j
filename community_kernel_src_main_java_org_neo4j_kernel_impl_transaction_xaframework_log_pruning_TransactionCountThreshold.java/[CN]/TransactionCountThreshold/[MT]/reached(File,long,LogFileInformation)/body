{
  try {
    long tx=source.getFirstCommittedTxId(version);
    if (tx == -1) {
      throw new ThisShouldNotHappenError("not really sure","Here we know that the log version exists (checked in AbstractPruneStrategy#prune)");
    }
    if (highest == null) {
      highest=source.getLastCommittedTxId();
    }
    return highest - tx + 1 >= maxTransactionCount;
  }
 catch (  IllegalLogFormatException e) {
    return LogPruneStrategyFactory.decidePruneForIllegalLogFormat((IllegalLogFormatException)e.getCause());
  }
catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
