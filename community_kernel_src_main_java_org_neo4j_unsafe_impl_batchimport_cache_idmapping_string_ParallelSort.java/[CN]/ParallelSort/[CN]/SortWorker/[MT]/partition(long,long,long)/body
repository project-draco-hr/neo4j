{
  long li=leftIndex, ri=rightIndex - 2, pi=pivotIndex;
  long pivot=clearCollision(dataCache.get(tracker.get(pi)));
  tracker.swap(pi,rightIndex - 1,1);
  long left=clearCollision(dataCache.get(tracker.get(li)));
  long right=clearCollision(dataCache.get(tracker.get(ri)));
  while (li < ri) {
    if (comparator.lt(left,pivot)) {
      left=clearCollision(dataCache.get(tracker.get(++li)));
    }
 else     if (comparator.ge(right,pivot)) {
      right=clearCollision(dataCache.get(tracker.get(--ri)));
    }
 else {
      tracker.swap(li,ri,1);
      long temp=left;
      left=right;
      right=temp;
    }
  }
  long partingIndex=ri;
  if (comparator.lt(right,pivot)) {
    partingIndex++;
  }
  tracker.swap(rightIndex - 1,partingIndex,1);
  return partingIndex;
}
