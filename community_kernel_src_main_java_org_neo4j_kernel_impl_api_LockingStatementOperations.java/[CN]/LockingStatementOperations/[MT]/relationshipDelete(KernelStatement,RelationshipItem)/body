{
  try {
    entityReadDelegate.relationshipVisit(state,relationship.id(),new RelationshipVisitor<RuntimeException>(){
      @Override public void visit(      long relId,      int type,      long startNode,      long endNode){
        state.locks().acquireExclusive(ResourceTypes.NODE,startNode);
        state.locks().acquireExclusive(ResourceTypes.NODE,endNode);
      }
    }
);
  }
 catch (  EntityNotFoundException e) {
    throw new IllegalStateException("Unable to delete relationship[" + relationship.id() + "] since it is already deleted.");
  }
  state.locks().acquireExclusive(ResourceTypes.RELATIONSHIP,relationship.id());
  state.assertOpen();
  entityWriteDelegate.relationshipDelete(state,relationship);
}
