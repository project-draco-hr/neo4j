{
  boolean txStateWithChanges=state.hasTxStateWithChanges();
  if (!txStateWithChanges || (txStateWithChanges && !state.txState().relationshipIsAddedInThisTx(relationshipId))) {
    state.locks().acquireExclusive(ResourceTypes.RELATIONSHIP,relationshipId);
  }
}
