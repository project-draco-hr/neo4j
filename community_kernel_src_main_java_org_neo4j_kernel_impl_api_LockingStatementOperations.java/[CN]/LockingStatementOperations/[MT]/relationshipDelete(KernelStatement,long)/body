{
  try {
    entityReadDelegate.relationshipVisit(state,relationshipId,new RelationshipVisitor<RuntimeException>(){
      @Override public void visit(      long relId,      long startNode,      long endNode,      int type){
        state.locks().acquireExclusive(ResourceTypes.NODE,startNode);
        state.locks().acquireExclusive(ResourceTypes.NODE,endNode);
      }
    }
);
  }
 catch (  EntityNotFoundException e) {
    throw new IllegalStateException("Unable to delete relationship[" + relationshipId + "] since it is already deleted.");
  }
  state.locks().acquireExclusive(ResourceTypes.RELATIONSHIP,relationshipId);
  entityWriteDelegate.relationshipDelete(state,relationshipId);
}
