{
  this.bundleDirectory=bundleDirectory;
  Map<String,Object> configMap=new HashMap<String,Object>();
  if (activators != null) {
    List<BundleActivator> list=new ArrayList<BundleActivator>();
    list.addAll(Arrays.asList(activators));
    configMap.put(FelixConstants.SYSTEMBUNDLE_ACTIVATORS_PROP,list);
  }
  configMap.put(Constants.FRAMEWORK_STORAGE,cacheDirectory);
  configMap.put(Constants.FRAMEWORK_SYSTEMPACKAGES_EXTRA,"org.neo4j.server.osgi.services; version=1.0.0" + ", org.osgi.service.log; version=4.2.0");
  osgiFramework=new Felix(configMap);
  File bundleDirectoryAsFile=new File(bundleDirectory);
  if (!bundleDirectoryAsFile.exists()) {
    bundleDirectoryAsFile.mkdirs();
  }
}
