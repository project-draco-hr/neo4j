{
  for (  NodePropertyUpdate update : this.updates) {
    long nodeId=update.getNodeId();
switch (update.getUpdateMode()) {
case ADDED:
      writer.addDocument(documentStructure.newDocumentRepresentingProperty(nodeId,update.getValueAfter()));
    break;
case CHANGED:
  writer.updateDocument(documentStructure.newQueryForChangeOrRemove(nodeId),documentStructure.newDocumentRepresentingProperty(nodeId,update.getValueAfter()));
break;
case REMOVED:
writer.deleteDocuments(documentStructure.newQueryForChangeOrRemove(nodeId));
break;
}
}
}
