{
  Transaction tx=db.beginTx();
  long nodeId=db.createNode().getId();
  String labelName1=label.name(), labelName2=label2.name();
  long labelId1=statement.getOrCreateLabelId(labelName1);
  long labelId2=statement.getOrCreateLabelId(labelName2);
  statement.addLabelToNode(labelId1,nodeId);
  statement.addLabelToNode(labelId2,nodeId);
  tx.success();
  tx.finish();
  Iterable<Long> readLabels=statement.getLabelsForNode(nodeId);
  assertEquals(new HashSet<Long>(asList(labelId1,labelId2)),addToCollection(readLabels,new HashSet<Long>()));
}
