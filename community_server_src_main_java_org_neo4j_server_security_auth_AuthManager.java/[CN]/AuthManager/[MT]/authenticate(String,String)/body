{
  User user=users.findByName(username);
  if (user == null) {
    return AuthenticationResult.FAILURE;
  }
  AuthenticationResult result=authStrategy.authenticate(user,password);
  if (result != AuthenticationResult.SUCCESS) {
    return result;
  }
  if (user.passwordChangeRequired()) {
    return AuthenticationResult.PASSWORD_CHANGE_REQUIRED;
  }
  return AuthenticationResult.SUCCESS;
}
