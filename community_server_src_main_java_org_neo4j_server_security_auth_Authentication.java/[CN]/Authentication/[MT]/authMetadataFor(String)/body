{
  if (name == null) {
    return unknownUser;
  }
  AuthenticationMetadata authMeta=authenticationData.get(name);
  if (authMeta == null) {
    User user=users.findByName(name);
    if (user != null) {
      authMeta=new AuthenticationMetadata(name,maxFailedAttempts,failedAuthCooldownPeriod,clock);
      AuthenticationMetadata preExisting=authenticationData.putIfAbsent(name,authMeta);
      if (preExisting != null) {
        authMeta=preExisting;
      }
    }
 else {
      authMeta=unknownUser;
    }
  }
  return authMeta;
}
