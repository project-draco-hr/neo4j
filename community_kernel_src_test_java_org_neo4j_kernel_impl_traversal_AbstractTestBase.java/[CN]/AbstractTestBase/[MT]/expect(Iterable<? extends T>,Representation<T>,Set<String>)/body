{
  Transaction tx=beginTx();
  Collection<String> encounteredItems=new ArrayList<String>();
  try {
    for (    T item : items) {
      String repr=representation.represent(item);
      assertTrue(repr + " not expected ",expected.remove(repr));
      encounteredItems.add(repr);
    }
    tx.success();
  }
  finally {
    tx.finish();
  }
  if (!expected.isEmpty()) {
    fail("The exepected elements " + expected + " were not returned. These were: "+ encounteredItems);
  }
}
