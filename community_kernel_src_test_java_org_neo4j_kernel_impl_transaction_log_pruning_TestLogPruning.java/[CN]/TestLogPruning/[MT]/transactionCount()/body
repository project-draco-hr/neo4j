{
  return aggregateLogData(new Extractor(){
    @Override public int extract(    File from) throws IOException {
      int counter=0;
      LogVersionBridge bridge=new LogVersionBridge(){
        @Override public LogVersionedStoreChannel next(        LogVersionedStoreChannel channel) throws IOException {
          return channel;
        }
      }
;
      StoreChannel storeChannel=fs.open(from,"r");
      LogVersionedStoreChannel versionedStoreChannel=PhysicalLogFile.openForVersion(files,fs,CURRENT_LOG_VERSION);
      new PhysicalLogVersionedStoreChannel(storeChannel,-1,CURRENT_LOG_VERSION);
      try (ReadableVersionableLogChannel channel=new ReadAheadLogChannel(versionedStoreChannel,bridge,1000)){
        try (PhysicalTransactionCursor<ReadableVersionableLogChannel> physicalTransactionCursor=new PhysicalTransactionCursor<>(channel,new LogEntryReaderFactory().versionable())){
          while (physicalTransactionCursor.next()) {
            counter++;
          }
        }
       }
       return counter;
    }
  }
);
}
