{
  this.rotateEveryNTransactions=rotateEveryNTransactions;
  fs=new EphemeralFileSystemAbstraction();
  GraphDatabaseAPI db=new ImpermanentGraphDatabase(stringMap(keep_logical_logs.name(),logPruning)){
    @Override protected FileSystemAbstraction createFileSystemAbstraction(){
      return fs;
    }
  }
;
  this.db=db;
  files=new PhysicalLogFiles(new File(db.getStoreDir()),PhysicalLogFile.DEFAULT_NAME,fs);
  return db;
}
