{
  this.fs=fs;
  this.life=new LifeSupport();
  logFiles=new PhysicalLogFiles(storeDir,fs);
  logVersionRepository=new ReadOnlyLogVersionRepository(pageCache,storeDir);
  LogFile logFile=life.add(new PhysicalLogFile(fs,logFiles,Long.MAX_VALUE,new ReadOnlyTransactionIdStore(pageCache,storeDir),logVersionRepository,new Monitors().newMonitor(PhysicalLogFile.Monitor.class),new TransactionMetadataCache(10,100)));
  life.start();
  WritableLogChannel channel=logFile.getWriter();
  this.writer=new TransactionLogWriter(new LogEntryWriter(channel,new CommandWriter(channel)));
}
