{
  String[] tokens=configValue.split(" ");
  if (tokens.length == 0) {
    throw new IllegalArgumentException("Invalid log pruning configuration value '" + configValue + "'");
  }
  final String boolOrNumber=tokens[0];
  if (tokens.length == 1) {
switch (boolOrNumber) {
case "true":
      return NO_PRUNING;
case "false":
    final TransactionCountThreshold thresholdToUse=new TransactionCountThreshold(1);
  return new ThresholdBasedPruneStrategy(fileSystem,logFileInformation,files,thresholdToUse);
default :
throw new IllegalArgumentException("Invalid log pruning configuration value '" + configValue + "'. The form is 'all' or '<number><unit> <type>' for example '100k txs' "+ "for the latest 100 000 transactions");
}
}
Threshold thresholdToUse=getThresholdByType(fileSystem,tokens[1],boolOrNumber,configValue);
return new ThresholdBasedPruneStrategy(fileSystem,logFileInformation,files,thresholdToUse);
}
