{
  try {
    ConsensusOutcome outcome=raftMachine.handle(storeIdAwareMessage.message());
    if (outcome.needsFreshSnapshot()) {
      downloadSnapshot(storeIdAwareMessage.message().from());
    }
 else {
      notifyCommitted(outcome.getCommitIndex());
    }
  }
 catch (  Throwable e) {
    raftMachine.stopTimers();
    localDatabase.panic(e);
  }
}
