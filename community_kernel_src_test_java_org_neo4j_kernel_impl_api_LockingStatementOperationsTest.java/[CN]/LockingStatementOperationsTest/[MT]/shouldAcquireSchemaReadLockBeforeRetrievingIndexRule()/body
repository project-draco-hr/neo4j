{
  SchemaReadOperations delegate=mock(SchemaReadOperations.class);
  @SuppressWarnings("unchecked") Iterator<IndexDescriptor> rules=mock(Iterator.class);
  when(delegate.indexesGetAll(state)).thenReturn(rules);
  LockingStatementOperations context=new LockingStatementOperations(null,delegate,null,null);
  Iterator<IndexDescriptor> result=context.indexesGetAll(state);
  assertSame(rules,result);
  InOrder order=inOrder(lockHolder,delegate);
  order.verify(lockHolder).acquireSchemaReadLock();
  order.verify(delegate).indexesGetAll(state);
  verifyNoMoreInteractions(lockHolder,delegate);
}
