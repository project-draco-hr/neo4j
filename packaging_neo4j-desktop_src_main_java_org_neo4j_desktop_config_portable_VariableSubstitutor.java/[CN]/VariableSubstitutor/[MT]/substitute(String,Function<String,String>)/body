{
  if (input.length() == 0) {
    return "";
  }
  StringBuilder result=new StringBuilder();
  Matcher matcher=pattern.matcher(input);
  int cur=0;
  while (matcher.find(cur)) {
    result.append(input.substring(cur,matcher.start()));
    result.append(substitutionFunction.apply(matcher.group(1)));
    cur=matcher.end();
  }
  if (cur < input.length()) {
    result.append(input.substring(cur));
  }
  return result.toString();
}
