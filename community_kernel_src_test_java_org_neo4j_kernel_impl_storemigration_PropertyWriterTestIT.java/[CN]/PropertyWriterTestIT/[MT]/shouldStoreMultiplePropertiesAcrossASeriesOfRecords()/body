{
  final int OneBlockPropertyBlockCount=100;
  PropertyStore propertyStore=newPropertyStore();
  assertEquals(0,propertyStore.getHighId());
  PropertyWriter propertyWriter=new PropertyWriter(propertyStore);
  ArrayList<Pair<Integer,Object>> properties=new ArrayList<Pair<Integer,Object>>();
  for (int i=0; i < OneBlockPropertyBlockCount; i++) {
    properties.add(Pair.of(i,(Object)i));
  }
  long propertyRecordId=propertyWriter.writeProperties(properties);
  assertEquals(OneBlockPropertyBlockCount / PropertyType.getPayloadSizeLongs(),propertyStore.getHighId());
  assertEquals(0,propertyRecordId);
  List<PropertyBlock> propertyBlocks=new ArrayList<PropertyBlock>();
  PropertyRecord propertyRecord=propertyStore.getRecord(0);
  propertyBlocks.addAll(propertyStore.getRecord(propertyRecordId).getPropertyBlocks());
  while (propertyRecord.getNextProp() != Record.NO_NEXT_PROPERTY.intValue()) {
    long currentRecordId=propertyRecord.getId();
    propertyRecord=propertyStore.getRecord(propertyRecord.getNextProp());
    assertEquals(currentRecordId,propertyRecord.getPrevProp());
    propertyBlocks.addAll(propertyStore.getRecord(propertyRecordId).getPropertyBlocks());
  }
  assertEquals(OneBlockPropertyBlockCount,propertyBlocks.size());
  propertyStore.close();
}
