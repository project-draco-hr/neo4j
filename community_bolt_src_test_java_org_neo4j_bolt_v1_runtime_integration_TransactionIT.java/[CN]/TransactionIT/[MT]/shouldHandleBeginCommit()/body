{
  RecordingCallback<StatementMetadata,?> responses=new RecordingCallback<>();
  Session session=env.newSession("<test>");
  session.init("TestClient",emptyMap(),-1,null);
  session.run("BEGIN",emptyMap(),responses);
  session.discardAll(Session.Callbacks.noop());
  session.run("CREATE (n:InTx)",emptyMap(),responses);
  session.discardAll(Session.Callbacks.noop());
  session.run("COMMIT",emptyMap(),responses);
  session.discardAll(Session.Callbacks.noop());
  assertThat(responses.next(),success());
  assertThat(responses.next(),success());
  assertThat(responses.next(),success());
}
