{
  RecordingCallback<StatementMetadata,?> runResponse=new RecordingCallback<>();
  RecordingCallback<RecordStream,Object> pullResponse=new RecordingCallback<>();
  Session session=env.newSession("<test>");
  session.init("TestClient",emptyMap(),-1,null);
  session.run("ROLLBACK",emptyMap(),runResponse);
  session.pullAll(pullResponse);
  assertThat(runResponse.next(),SessionMatchers.failedWith("rollback cannot be done when there is no open transaction in the session."));
  assertThat(pullResponse.next(),SessionMatchers.ignored());
}
