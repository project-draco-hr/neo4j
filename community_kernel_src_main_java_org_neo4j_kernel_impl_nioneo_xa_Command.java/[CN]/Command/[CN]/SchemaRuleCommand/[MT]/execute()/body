{
  for (  DynamicRecord record : records)   store.updateRecord(record);
  if (schemaRule instanceof IndexRule) {
switch (getMode()) {
case UPDATE:
      if (((IndexRule)schemaRule).isConstraintIndex()) {
        try {
          indexes.activateIndex(schemaRule.getId());
        }
 catch (        IndexNotFoundKernelException e) {
          throw new IllegalStateException("Index should have existed.",e);
        }
      }
    break;
case CREATE:
  indexes.createIndex((IndexRule)schemaRule);
break;
case DELETE:
indexes.dropIndex((IndexRule)schemaRule);
break;
default :
throw new IllegalStateException(getMode().name());
}
}
}
