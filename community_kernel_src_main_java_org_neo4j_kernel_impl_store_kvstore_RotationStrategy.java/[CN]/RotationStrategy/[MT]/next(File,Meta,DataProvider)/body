{
  File path=nextFile(file);
  format.beforeRotation(file,path,meta);
  KeyValueStoreFile<Meta> store;
  try {
    store=format.createStore(fs,pages,path,format.keySize(),format.valueSize(),meta,data);
  }
 catch (  Exception e) {
    format.rotationFailed(file,path,meta,e);
    throw e;
  }
  format.rotationSucceeded(file,path,meta);
  return Pair.of(path,store);
}
