{
  File path=nextFile(file);
  monitor.beforeRotation(file,path,headers);
  KeyValueStoreFile store;
  try {
    store=format.createStore(fs,pages,path,format.keySize(),format.valueSize(),headers,data);
  }
 catch (  Exception e) {
    monitor.rotationFailed(file,path,headers,e);
    throw e;
  }
  monitor.rotationSucceeded(file,path,headers);
  return Pair.of(path,store);
}
