{
  KeyValueStoreFile result=null;
  File path=null;
  for (  File candidatePath : candidateFiles()) {
    KeyValueStoreFile file;
    if (fs.fileExists(candidatePath)) {
      try {
        file=format.openStore(fs,pages,candidatePath);
      }
 catch (      Exception e) {
        monitor.failedToOpenStoreFile(candidatePath,e);
        continue;
      }
      if (result == null || format.compareHeaders(result.headers(),file.headers()) < 0) {
        if (result != null) {
          result.close();
        }
        result=file;
        path=candidatePath;
      }
 else {
        file.close();
      }
    }
  }
  return result == null ? null : Pair.of(path,result);
}
