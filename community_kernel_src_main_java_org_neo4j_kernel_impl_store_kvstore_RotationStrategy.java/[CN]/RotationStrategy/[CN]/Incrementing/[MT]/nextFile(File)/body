{
  String name=previous.getName();
  int pos=name.lastIndexOf('.'), next;
  try {
    int number=Integer.parseInt(name.substring(pos + 1));
    if (!base.getParent().equals(previous.getParent()) || !base.getName().equals(name.substring(0,pos))) {
      throw new IllegalStateException("Invalid path: " + previous);
    }
    next=number + 1;
  }
 catch (  NumberFormatException e) {
    throw new IllegalStateException("Invalid path: " + previous,e);
  }
  return new File(base.getParent(),base.getName() + "." + next);
}
