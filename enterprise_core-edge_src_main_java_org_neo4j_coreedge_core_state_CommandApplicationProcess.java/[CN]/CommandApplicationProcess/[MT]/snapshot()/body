{
  applier.sync(false);
  long prevIndex=lastApplied;
  long prevTerm=raftLog.readEntryTerm(prevIndex);
  CoreSnapshot coreSnapshot=new CoreSnapshot(CURRENT_VERSION,prevIndex,prevTerm);
  coreStateMachines.addSnapshots(coreSnapshot);
  sessionTracker.addSnapshots(coreSnapshot);
  return coreSnapshot;
}
