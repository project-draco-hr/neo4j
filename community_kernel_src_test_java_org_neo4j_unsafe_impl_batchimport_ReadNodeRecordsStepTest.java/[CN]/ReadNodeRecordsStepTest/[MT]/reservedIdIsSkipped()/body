{
  long highId=5;
  int batchSize=(int)highId;
  NodeStore store=StoreWithReservedId.newNodeStoreMock(highId);
  when(store.getHighId()).thenReturn(highId);
  ReadNodeRecordsStep step=new ReadNodeRecordsStep(mock(StageControl.class),Configuration.DEFAULT,store);
  Object batch=step.nextBatchOrNull(0,batchSize);
  assertNotNull(batch);
  NodeRecord[] records=(NodeRecord[])batch;
  boolean hasRecordWithReservedId=Stream.of(records).anyMatch(recordWithReservedId());
  assertFalse("Batch contains record with reserved id " + Arrays.toString(records),hasRecordWithReservedId);
}
