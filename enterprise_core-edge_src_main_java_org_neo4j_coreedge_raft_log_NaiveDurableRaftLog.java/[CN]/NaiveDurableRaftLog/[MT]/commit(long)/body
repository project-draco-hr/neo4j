{
  if (commitIndex == appendIndex) {
    return;
  }
  long actualNewCommitIndex=newCommitIndex;
  if (newCommitIndex > appendIndex) {
    actualNewCommitIndex=appendIndex;
  }
  try {
    storeCommitIndex(actualNewCommitIndex);
    commitIndexMonitor.commitIndex(actualNewCommitIndex);
  }
 catch (  IOException e) {
    throw new RaftStorageException("Failed to commit",e);
  }
  while (commitIndex < actualNewCommitIndex) {
    commitIndex++;
    for (    Listener listener : listeners) {
      ReplicatedContent content=readEntryContent(commitIndex);
      listener.onCommitted(content,commitIndex);
    }
  }
}
