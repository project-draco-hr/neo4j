{
  this.marshal=marshal;
  directory.mkdirs();
  try {
    entriesChannel=fileSystem.open(new File(directory,"entries.log"),"rw");
    contentChannel=fileSystem.open(new File(directory,"content.log"),"rw");
    commitChannel=fileSystem.open(new File(directory,"commit.log"),"rw");
    appendIndex=entriesChannel.size() / ENTRY_RECORD_LENGTH - 1;
    contentOffset=contentChannel.size();
    commitIndex=readCommitIndex();
    log=logProvider.getLog(getClass());
    log.info("Raft log created. AppendIndex: %d, commitIndex: %d",appendIndex,commitIndex);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
