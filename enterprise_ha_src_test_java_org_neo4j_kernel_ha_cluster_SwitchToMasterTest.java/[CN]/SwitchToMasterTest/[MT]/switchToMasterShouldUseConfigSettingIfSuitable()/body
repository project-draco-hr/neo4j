{
  Config config=new Config(stringMap(ClusterSettings.server_id.name(),"1",HaSettings.ha_server.name(),"192.168.1.99:6001"));
  URI me=new URI("ha://127.0.0.1");
  MasterServer masterServer=mock(MasterServer.class);
  when(masterServer.getSocketAddress()).thenReturn(new InetSocketAddress("192.168.1.1",6001));
  URI result=SwitchToMaster.getMasterUri(me,masterServer,config);
  assertEquals("Wrong address","ha://192.168.1.99:6001?serverId=1",result.toString());
}
