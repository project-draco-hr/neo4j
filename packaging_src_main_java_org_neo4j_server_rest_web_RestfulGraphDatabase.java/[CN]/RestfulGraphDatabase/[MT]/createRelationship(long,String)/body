{
  final Map<String,Object> data;
  final long endNodeId;
  final String type;
  final Map<String,Object> properties;
  try {
    data=input.readMap(body);
    endNodeId=extractNodeId((String)data.get("to"));
    type=(String)data.get("type");
    properties=(Map<String,Object>)data.get("data");
  }
 catch (  BadInputException e) {
    return output.badRequest(e);
  }
catch (  ClassCastException e) {
    return output.badRequest(e);
  }
  try {
    return output.created(server.createRelationship(startNodeId,endNodeId,type,properties));
  }
 catch (  StartNodeNotFoundException e) {
    return output.notFound(e);
  }
catch (  EndNodeNotFoundException e) {
    return output.badRequest(e);
  }
catch (  StartNodeSameAsEndNodeException e) {
    return output.badRequest(e);
  }
catch (  PropertyValueException e) {
    return output.badRequest(e);
  }
catch (  BadInputException e) {
    return output.badRequest(e);
  }
}
