{
  File dir=TargetDirectory.forTest(getClass()).cleanDirectory("test");
  HighlyAvailableGraphDatabase db1=startDb(1,dir,"127.0.0.1:5001");
  HighlyAvailableGraphDatabase db2=startDb(2,dir,"127.0.0.1:5001");
  Transaction tx=db2.beginTx();
  db2.createNode();
  tx.success();
  tx.finish();
  db2.shutdown();
  tx=db1.beginTx();
  db1.createNode();
  tx.success();
  tx.finish();
  db1.shutdown();
  db2=startDb(2,dir,"127.0.0.1:5002");
  tx=db2.beginTx();
  db2.createNode();
  tx.success();
  tx.finish();
  tx=db2.beginTx();
  db2.createNode();
  tx.success();
  tx.finish();
  db1=startDb(1,dir,"127.0.0.1:5002");
  boolean success=false;
  while (!success) {
    try {
      tx=db1.beginTx();
      db1.createNode();
      tx.success();
      success=true;
    }
 catch (    Exception e) {
      tx.failure();
    }
 finally {
      tx.finish();
    }
  }
  db1.shutdown();
  db2.shutdown();
  System.out.println("-----> Done");
}
