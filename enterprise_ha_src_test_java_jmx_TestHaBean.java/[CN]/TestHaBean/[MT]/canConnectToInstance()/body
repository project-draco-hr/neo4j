{
  Neo4jManager neo4j=new Neo4jManager(database.getDependencyResolver().resolveDependency(JmxKernelExtension.class).getSingleManagementBean(Kernel.class));
  HighAvailability ha=neo4j.getHighAvailabilityBean();
  ClusterMemberInfo[] clusterMembers=ha.getInstancesInCluster();
  assertNotNull(clusterMembers);
  assertEquals(1,clusterMembers.length);
  ClusterMemberInfo clusterMember=clusterMembers[0];
  assertNotNull(clusterMember);
  Pair<Neo4jManager,HighAvailability> proc=clusterMember.connect();
  assertNotNull("could not connect",proc);
  neo4j=proc.first();
  ha=proc.other();
  assertNotNull(neo4j);
  assertNotNull(ha);
  clusterMembers=ha.getInstancesInCluster();
  assertNotNull(clusterMembers);
  assertEquals(1,clusterMembers.length);
  assertEquals(clusterMember.getInstanceId(),clusterMembers[0].getInstanceId());
}
