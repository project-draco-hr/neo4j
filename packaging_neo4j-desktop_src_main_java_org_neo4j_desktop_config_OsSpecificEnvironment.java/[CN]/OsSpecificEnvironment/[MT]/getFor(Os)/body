{
switch (os) {
case WINDOWS:
    return new WindowsEnvironment();
default :
  throw new UnsupportedOperationException(os.name());
}
}
