{
  Direction excluded=exclusion.get(type.name());
  if (excluded == Direction.BOTH) {
    return this;
  }
  Map<String,Direction> newExclusion=new HashMap<String,Direction>(exclusion);
  newExclusion.put(type.name(),Direction.BOTH);
  return new TypeLimitingExpander(expander,newExclusion);
}
