{
  if (shiroSubject.getAuthenticationResult() == AuthenticationResult.PASSWORD_CHANGE_REQUIRED) {
    return AccessMode.Static.CREDENTIALS_EXPIRED.onViolation(msg);
  }
 else {
    return new AuthorizationViolationException(msg);
  }
}
