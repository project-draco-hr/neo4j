{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  JsonGenerator json=new JsonFactory(new Neo4jJsonCodec()).createJsonGenerator(out);
  JsonNode row=serialize(out,json,new RowWriter());
  MatcherAssert.assertThat(row.size(),equalTo(1));
  JsonNode firstCell=row.get(0);
  MatcherAssert.assertThat(firstCell.get("one").get("two").size(),is(2));
  MatcherAssert.assertThat(firstCell.get("one").get("two").get(0).asBoolean(),is(true));
  MatcherAssert.assertThat(firstCell.get("one").get("two").get(1).get("three").asInt(),is(42));
}
