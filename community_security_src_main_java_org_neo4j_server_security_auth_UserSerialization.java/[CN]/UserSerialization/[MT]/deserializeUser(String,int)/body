{
  String[] parts=line.split(userSeparator,-1);
  int offset=0;
  if (parts.length < 3 || parts.length > 4) {
    throw new FormatException(format("wrong number of line fields [line %d]",lineNumber));
  }
  if (parts.length == 4) {
    offset=1;
  }
  return new User.Builder().withName(parts[0]).withGroup(offset > 0 ? parts[1] : BasicAuthManager.DEFAULT_GROUP).withCredentials(deserializeCredentials(parts[1 + offset],lineNumber)).withRequiredPasswordChange(parts[2 + offset].equals("password_change_required")).build();
}
