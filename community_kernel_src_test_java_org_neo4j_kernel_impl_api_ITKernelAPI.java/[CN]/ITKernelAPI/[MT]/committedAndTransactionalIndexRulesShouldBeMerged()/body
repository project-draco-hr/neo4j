{
  long labelId=5, propertyKey=8;
  Transaction tx=db.beginTx();
  StatementContext statement=statementContextProvider.getCtxForWriting();
  statement.addIndexRule(labelId,propertyKey);
  tx.success();
  tx.finish();
  tx=db.beginTx();
  statement=statementContextProvider.getCtxForWriting();
  long propertyKey2=10;
  statement.addIndexRule(labelId,propertyKey2);
  Set<Long> indexRulesInTx=asSet(statement.getIndexRules(labelId));
  tx.success();
  tx.finish();
  assertEquals(asSet(propertyKey,propertyKey2),indexRulesInTx);
}
