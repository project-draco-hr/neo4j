{
  Session session=null;
  String cmd=StringUtils.join(cmds," ");
  try {
    session=startSession();
    Shell.logOutput(vmName + " $ ",cmd);
    Command command=session.exec(cmd);
    String msg=Shell.outputToString(vmName,command.getInputStream()) + Shell.outputToString(vmName,command.getErrorStream());
    Integer x=command.getExitStatus();
    return new Result(x == null ? -1 : 0,msg,cmd);
  }
 catch (  Exception e) {
    throw new ShellException(e);
  }
 finally {
    if (session != null) {
      try {
        session.close();
      }
 catch (      Exception e) {
        throw new ShellException(e);
      }
    }
  }
}
