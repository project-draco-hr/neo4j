{
  StatementContext delegate=mock(StatementContext.class);
  LockHolder lockHolder=mock(LockHolder.class);
  @SuppressWarnings("unchecked") Iterator<IndexRule> rules=mock(Iterator.class);
  when(delegate.getIndexRules()).thenReturn(rules);
  LockingStatementContext context=new LockingStatementContext(delegate,lockHolder);
  Iterator<IndexRule> result=context.getIndexRules();
  assertSame(rules,result);
  InOrder order=inOrder(lockHolder,delegate);
  order.verify(lockHolder).acquireSchemaReadLock();
  order.verify(delegate).getIndexRules();
  verifyNoMoreInteractions(lockHolder,delegate);
}
