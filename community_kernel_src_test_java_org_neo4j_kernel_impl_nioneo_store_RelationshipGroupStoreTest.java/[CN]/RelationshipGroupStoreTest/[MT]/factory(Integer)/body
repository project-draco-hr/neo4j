{
  Map<String,String> customConfig=new HashMap<>();
  if (customThreshold != null) {
    customConfig.put(GraphDatabaseSettings.dense_node_threshold.name(),"" + customThreshold);
  }
  Monitors monitors=new Monitors();
  Config config=configForStoreDir(config(customConfig),directory);
  return new StoreFactory(config,new DefaultIdGeneratorFactory(),pageCacheRule.getPageCache(fs,config),fs,StringLogger.DEV_NULL,monitors);
}
