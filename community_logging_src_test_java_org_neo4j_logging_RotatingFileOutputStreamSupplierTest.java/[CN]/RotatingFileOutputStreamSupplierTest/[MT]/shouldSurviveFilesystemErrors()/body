{
  final RandomAdversary adversary=new RandomAdversary(0.1,0.1,0);
  adversary.setProbabilityFactor(0);
  AdversarialFileSystemAbstraction adversarialFileSystem=new SensibleAdversarialFileSystemAbstraction(adversary,fileSystem);
  RotatingFileOutputStreamSupplier supplier=new RotatingFileOutputStreamSupplier(adversarialFileSystem,logFile,1000,0,9,DIRECT_EXECUTOR);
  adversary.setProbabilityFactor(1);
  writeLines(supplier,10000);
  adversary.setProbabilityFactor(0);
  writeLines(supplier,1000);
  assertThat(fileSystem.fileExists(logFile),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile1),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile2),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile3),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile4),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile5),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile6),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile7),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile8),is(true));
  assertThat(fileSystem.fileExists(archiveLogFile9),is(true));
}
