{
  TransactionContext txCtx=transactionContextForThread.get();
  if (txCtx != null) {
    return contextForTransaction(txCtx);
  }
  throw new NotInTransactionException("You have to start a transaction to perform write operations.");
}
