{
  int directionIndex=directionIndex(direction);
  long field=getField(relGroupIndex,directionIndex);
  long previousId=IdFieldManipulator.getId(field);
  field=IdFieldManipulator.setId(field,relId);
  if (increment) {
    field=IdFieldManipulator.changeCount(field,1);
  }
  setField(relGroupIndex,directionIndex,field);
  return previousId;
}
