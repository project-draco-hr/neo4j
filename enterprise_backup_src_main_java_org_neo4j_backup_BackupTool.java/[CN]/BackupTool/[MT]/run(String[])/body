{
  Args arguments=new Args(args);
  if (!arguments.hasNonNull(TO)) {
    throw new ToolFailureException("Specify target location with " + dash(TO) + " <target-directory>");
  }
  if (arguments.hasNonNull(FROM) && !arguments.has(HOST) && !arguments.has(PORT)) {
    return runBackupWithLegacyArgs(arguments);
  }
 else   if (arguments.hasNonNull(HOST)) {
    return runBackup(arguments);
  }
 else {
    throw new ToolFailureException(NO_SOURCE_SPECIFIED);
  }
}
