{
  systemOut.println("Performing incremental backup from '" + from + "'");
  boolean failedBecauseOfStoreVersionMismatch=false;
  try {
    backupService.doIncrementalBackup(from.getHost(),extractPort(from),to,verify);
  }
 catch (  TransactionFailureException e) {
    if (e.getCause() instanceof UpgradeNotAllowedByConfigurationException) {
      failedBecauseOfStoreVersionMismatch=true;
    }
 else {
      throw new ToolFailureException("TransactionFailureException from existing backup at '" + from + "'"+ ".",e);
    }
  }
catch (  ComException e) {
    throw new ToolFailureException("Couldn't connect to '" + from + "' ",e);
  }
  if (failedBecauseOfStoreVersionMismatch) {
    systemOut.println("The database present in the target directory is of an older version. " + "Backing that up in target and performing a full backup from source");
    try {
      moveExistingDatabase(fs,to);
    }
 catch (    IOException e) {
      throw new ToolFailureException("There was a problem moving the old database out of the way" + " - cannot continue, aborting.",e);
    }
    doBackupFull(from,to,verify,tuningConfiguration);
  }
}
