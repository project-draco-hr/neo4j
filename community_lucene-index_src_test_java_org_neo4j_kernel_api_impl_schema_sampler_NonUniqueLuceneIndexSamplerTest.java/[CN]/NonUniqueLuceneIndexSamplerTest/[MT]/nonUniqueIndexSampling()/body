{
  Terms aTerms=getTerms("a",1);
  Terms idTerms=getTerms("id",2);
  Terms bTerms=getTerms("b",3);
  Map<String,Terms> fieldTermsMap=MapUtil.genericMap("string",aTerms,"id",idTerms,"array",bTerms);
  IndexReaderStub indexReader=new IndexReaderStub(new SamplingFields(fieldTermsMap));
  when(indexSearcher.getIndexReader()).thenReturn(indexReader);
  NonUniqueLuceneIndexSampler luceneIndexSampler=createSampler();
  Register.DoubleLongRegister register=Registers.newDoubleLongRegister();
  long sample=luceneIndexSampler.sampleIndex(register);
  assertEquals(2,register.readFirst());
  assertEquals(4,register.readSecond());
  assertEquals(4,sample);
}
