{
  File storeDir=new File("/tmp/mydb");
  if (storeDir.exists()) {
    FileUtils.deleteRecursively(storeDir);
  }
  final GraphDatabaseService db=new EmbeddedGraphDatabase(storeDir.getAbsolutePath());
  try {
    Callable<int[]> reader=new BulkReaderWorker(db);
    startBackgroundInsert(db);
    long totalReads=0;
    long totalTime=0;
    long iterations=30000;
    while (iterations-- > 0) {
      int[] result=reader.call();
      totalReads+=result[0];
      totalTime+=result[2];
    }
    System.out.println("Did " + totalReads + " in "+ totalTime+ "ms.");
    System.out.println(totalReads / totalTime + "reads/ms");
  }
  finally {
    timer.cancel();
    db.shutdown();
  }
}
