def test_can_create_relationship(self):
    with self.graphdb.transaction:
        source = self.graphdb.node(message='hello')
        target = self.graphdb.node(message='world')
        relationship = source.related_to(target, message='graphy')
        secondrel = target.likes(source, message='buh')
    message = ''
    for rel in source.related_to:
        message += ('%s %s %s' % (rel.start['message'], rel['message'], rel.end['message']))
    self.assertEquals(message, 'hello graphy world')
    self.assertEquals(rel.type.name(), 'related_to')
    self.assertEquals(len(list(source.rels)), 2)
    self.assertEquals(len(list(source.rels.incoming)), 1)
    self.assertEquals(len(list(source.rels.outgoing)), 1)
    self.assertEquals(len(list(source.likes)), 1)
    self.assertEquals(len(list(source.likes.incoming)), 1)
    self.assertEquals(len(list(source.likes.outgoing)), 0)
