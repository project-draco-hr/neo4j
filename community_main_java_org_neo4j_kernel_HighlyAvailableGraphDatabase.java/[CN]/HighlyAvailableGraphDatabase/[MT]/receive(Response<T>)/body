{
  try {
    for (    Pair<String,TransactionStream> streams : response.transactions().getStreams()) {
      String resourceName=streams.first();
      XaDataSource dataSource=localDataSourceManager.getXaDataSource(resourceName);
      for (      ReadableByteChannel channel : streams.other().getChannels()) {
        dataSource.applyCommittedTransaction(channel);
        channel.close();
      }
    }
    return response.response();
  }
 catch (  IOException e) {
    somethingIsWrong(e);
    throw new RuntimeException(e);
  }
}
