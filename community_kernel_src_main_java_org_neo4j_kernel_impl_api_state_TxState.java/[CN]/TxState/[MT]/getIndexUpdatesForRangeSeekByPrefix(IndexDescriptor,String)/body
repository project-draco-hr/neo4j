{
  TreeMap<DefinedProperty,DiffSets<Long>> sortedUpdates=getSortedIndexUpdates(descriptor);
  if (sortedUpdates == null) {
    return null;
  }
  int propertyKeyId=descriptor.getPropertyKeyId();
  DefinedProperty floor=Property.stringProperty(propertyKeyId,prefix);
  DiffSets<Long> diffs=new DiffSets<>();
  for (  Map.Entry<DefinedProperty,DiffSets<Long>> entry : sortedUpdates.tailMap(floor).entrySet()) {
    DefinedProperty key=entry.getKey();
    if (key.propertyKeyId() == propertyKeyId && key.value().toString().startsWith(prefix)) {
      DiffSets<Long> diffSets=entry.getValue();
      diffs.addAll(diffSets.getAdded().iterator());
      diffs.removeAll(diffSets.getRemoved().iterator());
    }
 else {
      break;
    }
  }
  return diffs;
}
