{
  if (relationships().remove(id)) {
    recordRelationshipDeleted(id);
  }
  if (startNodeId == endNodeId) {
    getOrCreateNodeState(startNodeId).removeRelationship(id,type,Direction.BOTH);
  }
 else {
    getOrCreateNodeState(startNodeId).removeRelationship(id,type,Direction.OUTGOING);
    getOrCreateNodeState(endNodeId).removeRelationship(id,type,Direction.INCOMING);
  }
  if (relationshipStatesMap != null) {
    RelationshipStateImpl removed=relationshipStatesMap.remove(id);
    if (removed != null) {
      removed.clear();
    }
  }
  dataChanged();
}
