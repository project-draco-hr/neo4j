{
  int written=0, index=off;
  while (written < len) {
    buffer.clear();
    buffer.put(b,index,Math.min(len - written,buffer.capacity()));
    buffer.flip();
    written+=channel.write(buffer);
  }
}
