{
  if (createStoreIfNotExists) {
    try {
      fileSystemAbstraction.mkdirs(neoStoreFileName.getParentFile());
    }
 catch (    IOException e) {
      throw new UnderlyingStorageException("Could not create store directory: " + neoStoreFileName.getParent(),e);
    }
  }
  return new NeoStores(neoStoreFileName,config,idGeneratorFactory,pageCache,logProvider,fileSystemAbstraction,createStoreIfNotExists,storeTypes);
}
