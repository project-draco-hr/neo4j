{
  stringLogger.info("Creating new db @ " + neoStoreFileName);
  try {
    fileSystemAbstraction.mkdirs(neoStoreFileName.getParentFile());
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException("Unable to create directory " + neoStoreFileName.getParentFile() + " for creating a neo store in",e);
  }
  createEmptyStore(neoStoreFileName,buildTypeDescriptorAndVersion(NeoStore.TYPE_DESCRIPTOR));
  createNodeStore();
  createRelationshipStore();
  createPropertyStore();
  createRelationshipTypeStore();
  createLabelTokenStore();
  createSchemaStore();
  createRelationshipGroupStore(config.get(Configuration.dense_node_threshold));
  NeoStore neoStore=newNeoStore(false);
  for (int i=0; i < NeoStore.META_DATA_RECORD_COUNT; i++) {
    neoStore.nextId();
  }
  neoStore.setCreationTime(storeId.getCreationTime());
  neoStore.setRandomNumber(storeId.getRandomId());
  neoStore.setUpgradeTime(storeId.getCreationTime());
  neoStore.setUpgradeTransaction(BASE_TX_ID,BASE_TX_CHECKSUM);
  neoStore.setCurrentLogVersion(0);
  neoStore.setLastCommittedAndClosedTransactionId(BASE_TX_ID,BASE_TX_CHECKSUM);
  neoStore.setStoreVersion(NeoStore.versionStringToLong(CommonAbstractStore.ALL_STORES_VERSION));
  neoStore.setGraphNextProp(-1);
  neoStore.setLatestConstraintIntroducingTx(0);
  neoStore.flush();
  return neoStore;
}
