{
  for (  NodePropertyUpdate update : updates) {
switch (update.getUpdateMode()) {
case ADDED:
      add(update.getNodeId(),update.getValueAfter());
    break;
case CHANGED:
  remove(update.getNodeId(),update.getValueBefore());
add(update.getNodeId(),update.getValueAfter());
break;
case REMOVED:
remove(update.getNodeId(),update.getValueBefore());
break;
default :
throw new UnsupportedOperationException();
}
}
}
