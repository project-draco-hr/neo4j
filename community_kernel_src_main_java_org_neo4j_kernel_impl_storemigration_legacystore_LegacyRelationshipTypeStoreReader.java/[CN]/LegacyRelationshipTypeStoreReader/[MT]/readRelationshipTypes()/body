{
  FileChannel fileChannel=new RandomAccessFile(fileName,"r").getChannel();
  int recordLength=5;
  int endHeaderSize=UTF8.encode(FROM_VERSION).length;
  long recordCount=(fileChannel.size() - endHeaderSize) / recordLength;
  LinkedList<RelationshipTypeRecord> records=new LinkedList<RelationshipTypeRecord>();
  ByteBuffer buffer=ByteBuffer.allocateDirect(recordLength);
  for (int id=0; id <= recordCount; id++) {
    buffer.position(0);
    fileChannel.read(buffer);
    buffer.flip();
    long inUseByte=buffer.get();
    boolean inUse=inUseByte == Record.IN_USE.byteValue();
    if (inUse) {
      RelationshipTypeRecord record=new RelationshipTypeRecord(id);
      record.setInUse(inUse);
      record.setTypeBlock(buffer.getInt());
      records.add(record);
    }
  }
  fileChannel.close();
  return records;
}
