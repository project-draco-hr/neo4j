{
  if (writer != null) {
    writerStatus.close(writer);
  }
  try {
    DirectorySupport.deleteDirectoryContents(directory=directory == null ? dirFactory.open(dirFile) : directory);
  }
 catch (  AlreadyClosedException e) {
    DirectorySupport.deleteDirectoryContents(directory=dirFactory.open(dirFile));
  }
 finally {
    directory.close();
  }
  failureStorage.clearForIndex(indexId);
}
