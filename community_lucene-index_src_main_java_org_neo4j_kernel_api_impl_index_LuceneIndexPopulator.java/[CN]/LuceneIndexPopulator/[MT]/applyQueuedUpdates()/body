{
  for (  NodePropertyUpdate update : this.updates) {
    long nodeId=update.getNodeId();
switch (update.getUpdateMode()) {
case ADDED:
      writer.addDocument(documentLogic.newDocument(nodeId,update.getValueAfter()));
    break;
case CHANGED:
  writer.updateDocument(documentLogic.newQueryForChangeOrRemove(nodeId,update.getValueBefore()),documentLogic.newDocument(nodeId,update.getValueAfter()));
break;
case REMOVED:
writer.deleteDocuments(documentLogic.newQueryForChangeOrRemove(nodeId,update.getValueBefore()));
break;
}
}
}
