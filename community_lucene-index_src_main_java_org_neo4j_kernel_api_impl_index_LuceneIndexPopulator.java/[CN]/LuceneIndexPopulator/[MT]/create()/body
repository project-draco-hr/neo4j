{
  this.directory=dirFactory.open(dirFile);
  if (archiveOld) {
    String archiveName="archive-" + currentTimeMillis() + ".zip";
    DirectorySupport.archiveAndDeleteDirectoryContents(directory,archiveName);
    if (directory.fileExists(archiveName)) {
      log.info("Created archive of previous (failed) index %s",new File(dirFile,archiveName).getPath());
    }
  }
 else {
    DirectorySupport.deleteDirectoryContents(directory);
  }
  failureStorage.reserveForIndex(indexId);
  writer=indexWriterFactory.create(directory);
}
