{
  this.documentStructure=documentStructure;
  this.indexWriterFactory=indexWriterFactory;
  this.writerStatus=writerStatus;
  this.dirFactory=dirFactory;
  this.dirFile=dirFile;
  this.failureStorage=failureStorage;
  this.indexId=indexId;
  try {
    failureStorage.reserve(indexId);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
