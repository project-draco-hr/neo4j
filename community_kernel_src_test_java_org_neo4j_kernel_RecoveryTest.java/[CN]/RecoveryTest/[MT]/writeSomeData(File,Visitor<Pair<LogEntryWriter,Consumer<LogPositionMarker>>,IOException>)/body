{
  try (LogVersionedStoreChannel versionedStoreChannel=new PhysicalLogVersionedStoreChannel(fs.open(file,"rw"),logVersion,CURRENT_LOG_VERSION);final PhysicalWritableLogChannel writableLogChannel=new PhysicalWritableLogChannel(versionedStoreChannel)){
    LogHeaderWriter.writeLogHeader(writableLogChannel,logVersion,2l);
    Consumer<LogPositionMarker> consumer=new Consumer<LogPositionMarker>(){
      @Override public void accept(      LogPositionMarker marker){
        try {
          writableLogChannel.getCurrentPosition(marker);
        }
 catch (        IOException e) {
          throw new RuntimeException(e);
        }
      }
    }
;
    LogEntryWriter first=new LogEntryWriter(writableLogChannel,NeoCommandHandler.EMPTY);
    visitor.visit(Pair.of(first,consumer));
  }
 }
