{
  try (Transaction transaction=graphDatabaseService.beginTx()){
    graphDatabaseService.index().forNodes(INDEX_NAME).add(graphDatabaseService.getReferenceNode(),INDEX_KEY,INDEX_VALUE);
    graphDatabaseService.getReferenceNode().setProperty(PROPERTY_NAME,PROPERTY_VALUE);
    assertReferenceNodeIsNotIndexedOutsideThisTransaction();
    assertReferenceNodeIsUnchangedOutsideThisTransaction();
    transaction.success();
    assertReferenceNodeIsNotIndexedOutsideThisTransaction();
    assertReferenceNodeIsUnchangedOutsideThisTransaction();
  }
   assertReferenceNodeIsIndexed();
  assertReferenceNodeHasBeenUpdated();
}
