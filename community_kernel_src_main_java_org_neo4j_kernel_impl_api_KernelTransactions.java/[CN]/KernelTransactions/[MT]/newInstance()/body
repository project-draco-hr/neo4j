{
  assertCurrentThreadIsNotBlockingNewTransactions();
  newTransactionsLock.readLock().lock();
  try {
    assertDatabaseIsRunning();
    TransactionId lastCommittedTransaction=neoStores.getMetaDataStore().getLastCommittedTransaction();
    StatementLocks statementLocks=statementLocksFactory.newInstance(locks.newClient());
    return localTxPool.acquire().initialize(lastCommittedTransaction.transactionId(),lastCommittedTransaction.commitTimestamp(),statementLocks);
  }
  finally {
    newTransactionsLock.readLock().unlock();
  }
}
