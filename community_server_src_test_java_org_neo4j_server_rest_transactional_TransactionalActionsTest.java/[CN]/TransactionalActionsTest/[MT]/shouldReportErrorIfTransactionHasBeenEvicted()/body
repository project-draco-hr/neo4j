{
  TransactionalActions actions=new TransactionalActions(mess,engine,registry,logger);
  Map<String,Object> parameters=map();
  long txIdThatDoesNotExist=7331l;
  when(registry.pop(txIdThatDoesNotExist)).thenThrow(new InvalidTransactionIdError("",null));
  TestResultHandler results=new TestResultHandler();
  actions.commit(request(new Statement("My Cypher Query",parameters)),txIdThatDoesNotExist,results);
  assertThat(results.results.size(),equalTo(0));
  assertThat(results.txId,equalTo(txIdThatDoesNotExist));
  assertThat(results.errors.get(0).getErrorCode(),equalTo(INVALID_TRANSACTION_ID));
  verify(registry).pop(txIdThatDoesNotExist);
  verifyNoMoreInteractions(mess,registry,engine,ctx,stmtCtx);
  logger.assertNoLoggingOccurred();
}
