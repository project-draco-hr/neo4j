{
  Clusters clusters=clustersProvider.clusters();
  life=new LifeSupport();
  life.start();
  for (  Clusters.Cluster cluster : clusters.getClusters()) {
    ManagedCluster managedCluster=new ManagedCluster(cluster);
    clusterMap.put(cluster.getName(),managedCluster);
    life.add(managedCluster);
    for (    Predicate<ManagedCluster> availabilityCheck : availabilityChecks) {
      managedCluster.await(availabilityCheck);
    }
    if (initialDatasetCreator != null) {
      initialDatasetCreator.receive(managedCluster.getMaster());
      managedCluster.sync();
    }
  }
}
