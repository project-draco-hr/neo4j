{
  int port;
  for (port=minPort; port <= maxPort; port++) {
    if (except.contains(port)) {
      continue;
    }
    try {
      ServerSocket ss=new ServerSocket();
      ss.setReuseAddress(false);
      ss.bind(new InetSocketAddress(port));
      ss.close();
    }
 catch (    IOException e) {
      except.add(port);
      continue;
    }
    try {
      ServerSocket ss=new ServerSocket();
      ss.setReuseAddress(false);
      ss.bind(new InetSocketAddress(InetAddress.getLoopbackAddress(),port));
      ss.close();
    }
 catch (    IOException e) {
      except.add(port);
      continue;
    }
    try {
      Socket socket=new Socket(InetAddress.getLoopbackAddress(),port);
      socket.close();
      except.add(port);
      continue;
    }
 catch (    IOException ex) {
      return port;
    }
  }
  throw new IOException("No open port could be found");
}
