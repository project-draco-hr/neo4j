{
  File config=target.file("zookeeper" + id + ".cfg");
  File dataDir=target.directory("zk" + id + "data",true);
  try {
    PrintWriter conf=new PrintWriter(config);
    try {
      conf.println("tickTime=2000");
      conf.println("initLimit=10");
      conf.println("syncLimit=5");
      conf.println("dataDir=" + dataDir.getAbsolutePath().replaceAll("\\\\","\\\\\\\\"));
      conf.println("clientPort=" + port);
      for (int j=0; j < keeper.length; j++) {
        conf.println("server." + (j + 1) + "=localhost:"+ (2888 + j)+ ":"+ (3888 + j));
      }
    }
  finally {
      conf.close();
    }
    PrintWriter myid=new PrintWriter(new File(dataDir,"myid"));
    try {
      myid.println(Integer.toString(id));
    }
  finally {
      myid.close();
    }
  }
 catch (  IOException e) {
    throw new IllegalStateException("Could not write ZooKeeper configuration",e);
  }
  return config.getAbsolutePath();
}
