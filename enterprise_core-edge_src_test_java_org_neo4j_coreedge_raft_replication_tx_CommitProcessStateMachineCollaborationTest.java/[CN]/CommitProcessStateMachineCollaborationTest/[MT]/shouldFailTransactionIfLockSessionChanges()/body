{
  int initialLockSessionId=23;
  TransactionToApply transactionToApply=new TransactionToApply(physicalTx(initialLockSessionId));
  int finalLockSessionId=24;
  RecoverTransactionLogState recoverTransactionLogState=mock(RecoverTransactionLogState.class);
  when(recoverTransactionLogState.findLastAppliedIndex()).thenReturn(-1L);
  TransactionCommitProcess localCommitProcess=mock(TransactionCommitProcess.class);
  ReplicatedTransactionStateMachine<RaftTestMember> stateMachine=new ReplicatedTransactionStateMachine<>(localCommitProcess,lockState(finalLockSessionId),NullLogProvider.getInstance(),recoverTransactionLogState);
  DirectReplicator<ReplicatedTransaction> replicator=new DirectReplicator<>(stateMachine);
  ReplicatedTransactionCommitProcess commitProcess=new ReplicatedTransactionCommitProcess(replicator);
  try {
    commitProcess.commit(transactionToApply,NULL,EXTERNAL);
    fail("Should have thrown exception.");
  }
 catch (  TransactionFailureException e) {
  }
}
