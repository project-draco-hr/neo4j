{
  msgLog.logMessage("Copying store from master");
  Response<Void> response=master.first().copyStore(new SlaveContext(0,machineId,0,new Pair[0]),new ToFileStoreWriter(storeDir));
  long highestLogVersion=highestLogVersion();
  if (highestLogVersion > -1)   NeoStore.setVersion(storeDir,highestLogVersion + 1);
  EmbeddedGraphDatabase copiedDb=new EmbeddedGraphDatabase(storeDir,stringMap(new HashMap<String,String>(config),KEEP_LOGICAL_LOGS,"true"));
  try {
    MasterUtil.applyReceivedTransactions(response,copiedDb,MasterUtil.txHandlerForFullCopy());
  }
  finally {
    copiedDb.shutdown();
  }
  msgLog.logMessage("Done copying store from master");
}
