{
  try {
    if (databaseLock.readLock().tryLock(localGraphWait,TimeUnit.SECONDS)) {
      try {
        if (internalGraphDatabase == null)         if (causeOfShutdown != null) {
          throw new RuntimeException("Graph database not started",causeOfShutdown);
        }
 else {
          throw new RuntimeException("Graph database not assigned and no cause of shutdown, " + "maybe not started yet or in the middle of master/slave swap?");
        }
        return internalGraphDatabase;
      }
  finally {
        databaseLock.readLock().unlock();
      }
    }
 else {
      if (causeOfShutdown != null) {
        throw new RuntimeException("Graph database not started",causeOfShutdown);
      }
 else {
        throw new RuntimeException("Graph database not assigned and no cause of shutdown, " + "maybe not started yet or in the middle of master/slave swap?");
      }
    }
  }
 catch (  InterruptedException e) {
    if (causeOfShutdown != null) {
      throw new RuntimeException("Graph database not started",causeOfShutdown);
    }
 else {
      throw new RuntimeException("Graph database not assigned and no cause of shutdown, " + "maybe not started yet or in the middle of master/slave swap?");
    }
  }
}
