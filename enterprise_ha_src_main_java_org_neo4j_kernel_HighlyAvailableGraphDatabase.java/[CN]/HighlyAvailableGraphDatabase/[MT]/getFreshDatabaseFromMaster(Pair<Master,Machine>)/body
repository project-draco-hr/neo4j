{
  master=master != null ? master : broker.getMasterReally(true);
  internalShutdown(false);
  makeWayForNewDb();
  Exception exception=null;
  for (int i=0; i < 60; i++) {
    try {
      copyStoreFromMaster(master);
      return;
    }
 catch (    Exception e) {
      msgLog.logMessage("Problems copying store from master",e);
      sleepWithoutInterruption(1000,"");
      exception=e;
      master=broker.getMasterReally(true);
    }
  }
  throw new RuntimeException("Gave up trying to copy store from master",exception);
}
