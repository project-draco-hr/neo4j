{
  return new ZooKeeperBroker(ConfigProxy.config(config,ZooKeeperBroker.Configuration.class),new ZooClientFactory(){
    @Override public ZooClient newZooClient(){
      return new ZooClient(storeDir,messageLog,storeIdGetter,ConfigProxy.config(config,ZooClient.Configuration.class),slaveOperations,slaveOperations);
    }
  }
);
}
