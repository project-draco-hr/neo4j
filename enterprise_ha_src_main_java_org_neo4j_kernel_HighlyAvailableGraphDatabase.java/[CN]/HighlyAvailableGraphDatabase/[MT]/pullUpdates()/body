{
  try {
    if (masterServer == null) {
      if (broker.getMaster() == null && broker instanceof ZooKeeperBroker) {
        messageLog.logMessage("ZooKeeper broker returned null master");
        newMaster(null,new NullPointerException("master returned from broker"));
      }
 else       if (broker.getMaster().first() == null) {
        newMaster(null,new NullPointerException("master returned from broker"));
      }
      responseReceiver.receive(broker.getMaster().first().pullUpdates(responseReceiver.getSlaveContext(-1)));
    }
  }
 catch (  ZooKeeperException e) {
    newMaster(null,e);
    throw e;
  }
catch (  NoMasterException e) {
    newMaster(null,e);
    throw e;
  }
catch (  ComException e) {
    throw e;
  }
}
