{
  IdGeneratorFactory idGeneratorFactory=mock(IdGeneratorFactory.class);
  IdGenerator idGenerator=mock(IdGenerator.class);
  when(idGenerator.nextId()).thenReturn(1024L);
  when(idGeneratorFactory.get(any(IdType.class))).thenReturn(idGenerator);
  Replicator replicator=new StubReplicator();
  ReplicatedTokenHolder<Token,LabelTokenRecord> tokenHolder=new ReplicatedLabelTokenHolder(replicator,idGeneratorFactory,dependencies);
  tokenHolder.setLastCommittedIndex(-1);
  tokenHolder.start();
  tokenHolder.onReplicated(new ReplicatedTokenRequest(TokenType.LABEL,"Person",ReplicatedTokenRequestSerializer.createCommandBytes(expectedCommands)),0);
  int tokenId=tokenHolder.getOrCreateId("Person");
  assertEquals(EXPECTED_TOKEN_ID,tokenId);
}
