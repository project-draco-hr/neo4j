{
  try {
    boolean hasAlpha=fs.fileExists(alpha), hasBeta=fs.fileExists(beta);
    if (hasAlpha && hasBeta) {
      CountsStore alphaStore=CountsStore.open(pageCache,alpha);
      CountsStore betaStore=CountsStore.open(pageCache,beta);
      long alphaTxId=alphaStore.lastTxId(), betaTxId=betaStore.lastTxId();
      if (alphaTxId > betaTxId) {
        betaStore.close();
        return alphaStore;
      }
 else {
        alphaStore.close();
        return betaStore;
      }
    }
 else     if (hasAlpha) {
      return CountsStore.open(pageCache,alpha);
    }
 else     if (hasBeta) {
      return CountsStore.open(pageCache,beta);
    }
 else {
      throw new IllegalStateException("Storage file not found.");
    }
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
