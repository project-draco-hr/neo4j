{
  try {
    CountsStore alphaStore=openVerifiedCountsStore(fs,pageCache,alpha);
    CountsStore betaStore=openVerifiedCountsStore(fs,pageCache,beta);
    boolean isAlphaCorrupted=alphaStore == null;
    boolean isBetaCorrupted=betaStore == null;
    if (isAlphaCorrupted && isBetaCorrupted) {
      throw new UnderlyingStorageException("Both counts store files are corrupted. Please shut down the database and delete them " + "to have the database recreate the counts store on next startup");
    }
    if (isAlphaCorrupted) {
      return betaStore;
    }
    if (isBetaCorrupted) {
      return alphaStore;
    }
    if (isAlphaStoreMoreRecent(alphaStore,betaStore)) {
      betaStore.close();
      return alphaStore;
    }
 else {
      alphaStore.close();
      return betaStore;
    }
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
