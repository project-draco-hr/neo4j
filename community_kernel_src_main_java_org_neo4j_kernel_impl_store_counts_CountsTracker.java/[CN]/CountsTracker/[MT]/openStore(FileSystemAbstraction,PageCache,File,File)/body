{
  try {
    boolean hasAlpha=fs.fileExists(alpha), hasBeta=fs.fileExists(beta);
    CountsRecordSerializer recordSerializer=new CountsRecordSerializer();
    CountsStoreWriter.Factory writerFactory=new CountsStoreWriter.Factory();
    if (hasAlpha && hasBeta) {
      CountsStore<CountsKey,Register.Long.Out> alphaStore=CountsStore.open(fs,pageCache,alpha,recordSerializer,writerFactory);
      CountsStore<CountsKey,Register.Long.Out> betaStore=CountsStore.open(fs,pageCache,beta,recordSerializer,writerFactory);
      long alphaTxId=alphaStore.lastTxId(), betaTxId=betaStore.lastTxId();
      if (alphaTxId > betaTxId) {
        betaStore.close();
        return alphaStore;
      }
 else {
        alphaStore.close();
        return betaStore;
      }
    }
 else     if (hasAlpha) {
      return CountsStore.open(fs,pageCache,alpha,recordSerializer,writerFactory);
    }
 else     if (hasBeta) {
      return CountsStore.open(fs,pageCache,beta,recordSerializer,writerFactory);
    }
 else {
      throw new IllegalStateException("Storage file not found.");
    }
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
