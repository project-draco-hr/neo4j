{
  long alphaTxId=alphaStore.lastTxId(), betaTxId=betaStore.lastTxId();
  long alphaVersion=alphaStore.minorVersion(), betaVersion=betaStore.minorVersion();
  if (alphaTxId == betaTxId) {
    if (alphaVersion == betaVersion) {
      throw new UnderlyingStorageException("Found two storage files with same tx id and minor version. " + "Please shut down the database and manually delete the counts " + "store files: " + alphaStore.file() + " and "+ betaStore.file()+ " to have the database recreate them on next startup");
    }
    return alphaVersion > betaVersion;
  }
 else {
    return alphaTxId > betaTxId;
  }
}
