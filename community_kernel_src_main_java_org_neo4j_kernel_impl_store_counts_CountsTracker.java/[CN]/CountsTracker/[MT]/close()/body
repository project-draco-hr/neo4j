{
  try {
    if (state.hasChanges()) {
      throw new IllegalStateException("Cannot close with memory-state!");
    }
    state.close();
  }
 catch (  IOException e) {
    throw new UnderlyingStorageException(e);
  }
}
