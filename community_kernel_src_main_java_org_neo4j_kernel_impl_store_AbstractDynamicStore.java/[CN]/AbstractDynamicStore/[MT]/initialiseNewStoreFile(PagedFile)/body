{
  int blockSize=blockSizeFromConfiguration;
  if (blockSize < 1 || blockSize > 0xFFFF) {
    throw new IllegalArgumentException("Illegal block size[" + blockSize + "], limit is 65535");
  }
  blockSize+=BLOCK_HEADER_SIZE;
  try (PageCursor pageCursor=file.io(0,PagedFile.PF_EXCLUSIVE_LOCK)){
    if (pageCursor.next()) {
      do {
        pageCursor.putInt(blockSize);
      }
 while (pageCursor.shouldRetry());
    }
  }
   StoreVersionTrailerUtil.writeTrailer(file,UTF8.encode(getTypeAndVersionDescriptor()),blockSize);
  File idFileName=new File(storageFileName.getPath() + ".id");
  idGeneratorFactory.create(idFileName,0,true);
  IdGenerator idGenerator=idGeneratorFactory.open(idFileName,idType.getGrabSize(),idType,0);
  idGenerator.nextId();
  idGenerator.close();
}
