{
  TokenRegistry<Token> registry=new TokenRegistry<>("Label");
  ReplicatedTokenStateMachine<Token> stateMachine=new ReplicatedTokenStateMachine<>(registry,new Token.Factory(),NullLogProvider.getInstance());
  stateMachine.installCommitProcess(mock(TransactionCommitProcess.class),-1);
  stateMachine.applyCommand(new ReplicatedTokenRequest(LABEL,"Person",commandBytes(tokenCommands(EXPECTED_TOKEN_ID))),1);
  assertEquals(EXPECTED_TOKEN_ID,(int)registry.getId("Person"));
}
