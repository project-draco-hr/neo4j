{
  releaseCurrentLogFile();
  File file=new File(logFileName);
  if (!file.exists()) {
    throw new IOException("Logical log[" + logFileName + "] not found");
  }
  String newName=fileName + ".v" + xaTf.getAndSetNewVersion();
  File newFile=new File(newName);
  boolean renamed=FileUtils.renameFile(file,newFile);
  if (!renamed) {
    throw new IOException("Failed to rename log to: " + newName);
  }
 else {
    try {
      FileChannel channel=new RandomAccessFile(newName,"rw").getChannel();
      FileUtils.truncateFile(channel,endPosition);
    }
 catch (    IOException e) {
      log.log(Level.WARNING,"Failed to truncate log at correct size",e);
    }
  }
}
