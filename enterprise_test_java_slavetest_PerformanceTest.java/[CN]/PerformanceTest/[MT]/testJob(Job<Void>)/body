{
  final boolean noHa=doTest("NO_HA");
  final boolean singleJvm=doTest("SINGLE_JVM");
  if (noHa || singleJvm) {
    SingleJvmTest single=new SingleJvmTest();
    if (noHa) {
      single.initializeDbs(1);
      time("No HA",executeOnMaster(single,job));
      single.shutdownDbs();
    }
    if (singleJvm) {
      single.initializeDbs(1);
      time("Single JVM HA",executeOnSlave(single,job));
      single.shutdownDbs();
    }
  }
  if (doTest("MULTI_JVM")) {
    MultiJvmTest multi=new MultiJvmTest();
    multi.initializeDbs(1);
    time("Multi JVM HA",executeOnSlave(multi,job));
    multi.shutdownDbs();
  }
  if (doTest("FULL_HA")) {
    MultiJvmWithZooKeeperTest multiZoo=new MultiJvmWithZooKeeperTest();
    multiZoo.startZooKeeperCluster();
    multiZoo.initializeDbs(1);
    time("Multi JVM HA with ZooKeeper",executeOnSlave(multiZoo,job));
    multiZoo.shutdownDbs();
    multiZoo.shutdownZooKeeperCluster();
  }
}
