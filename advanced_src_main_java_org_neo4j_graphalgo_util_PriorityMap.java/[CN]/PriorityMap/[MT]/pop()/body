{
  Node<E,P> node=queue.peek();
  if (node == null) {
    return null;
  }
 else   if (node.head.next == null) {
    node=queue.poll();
    map.remove(keyFunction.convert(node.head.entity));
  }
 else {
    node.head=node.head.next;
  }
  return new Entry<E,P>(node);
}
