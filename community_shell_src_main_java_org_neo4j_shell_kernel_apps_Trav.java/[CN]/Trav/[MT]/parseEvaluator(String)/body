{
  scripting=scripting != null ? scripting : new ScriptEngineViaReflection(getServer());
  try {
    evaluator=decorateWithImports(evaluator,STANDARD_EVAL_IMPORTS);
    Object scriptEngine=scripting.getJavascriptEngine();
    Object compiledScript=scripting.compile(scriptEngine,evaluator);
    return new CompiledScriptEvaluator(compiledScript);
  }
 catch (  Exception e) {
    throw ShellException.wrapCause(e);
  }
}
