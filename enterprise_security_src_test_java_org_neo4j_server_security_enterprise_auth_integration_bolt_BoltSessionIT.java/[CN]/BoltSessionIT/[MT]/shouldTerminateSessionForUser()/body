{
  authenticate(user,"Igor","123",null);
  admin.send(TransportTestUtil.chunk(run("CALL dbms.terminateSessionsForUser( 'Igor' ) YIELD username, sessionCount"),pullAll()));
  Map<String,Long> terminationResult=collectSessionResult(admin,1);
  assertTrue(terminationResult.containsKey("Igor"));
  assertTrue(terminationResult.get("Igor") == 1L);
  admin.send(TransportTestUtil.chunk(run("CALL dbms.listSessions() YIELD username, sessionCount"),pullAll()));
  Map<String,Long> listResult=collectSessionResult(admin,1);
  assertTrue(listResult.containsKey("neo4j"));
  assertTrue(listResult.get("neo4j") == 1L);
  user.send(TransportTestUtil.chunk(run("MATCH (n) RETURN n"),pullAll()));
  assertThat(user,eventuallyRecieves(msgFailure(SessionTerminated,SESSION_TERMINATED_MSG)));
}
