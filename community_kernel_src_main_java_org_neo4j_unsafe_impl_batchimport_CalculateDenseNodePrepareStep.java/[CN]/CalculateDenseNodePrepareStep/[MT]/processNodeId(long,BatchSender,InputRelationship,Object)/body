{
  if (nodeId != -1) {
    int startNodeRadix=radixOf(nodeId);
    inProgressBatches[startNodeRadix][cursors[startNodeRadix]++]=nodeId;
    if (cursors[startNodeRadix] == batchSize) {
      sender.send(inProgressBatches[startNodeRadix]);
      inProgressBatches[startNodeRadix]=new long[batchSize];
      cursors[startNodeRadix]=0;
    }
  }
 else {
    badCollector.collectBadRelationship(relationship,inputId);
  }
}
