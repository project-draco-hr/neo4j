{
  long[] batchIds=batch.ids;
  InputRelationship[] input=batch.input;
  for (int i=0, r=0; i < batchIds.length; i++, r++) {
    long startNodeId=batchIds[i++];
    InputRelationship relationship=input[r];
    processNodeId(startNodeId,sender,relationship,relationship.startNode());
    long endNodeId=batchIds[i];
    boolean loop=startNodeId == endNodeId;
    if (!loop) {
      processNodeId(endNodeId,sender,relationship,relationship.endNode());
    }
  }
}
