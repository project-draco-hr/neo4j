{
  startDbs(3,PULL_INTERVAL);
  int master=getCurrentMaster();
  setProperty(master,1);
  awaitPropagation(1);
  CountDownLatch masterAvailable=awaitMemberIsAvailable((master + 1) % dbs.length,HighAvailabilityModeSwitcher.MASTER);
  kill(master);
  masterAvailable.await();
  setProperty(getCurrentMaster(),2);
  CountDownLatch slaveAvailable=awaitMemberIsAvailable(getCurrentMaster(),HighAvailabilityModeSwitcher.SLAVE);
  start(master,PULL_INTERVAL);
  slaveAvailable.await();
  awaitPropagation(2);
}
