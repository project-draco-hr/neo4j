{
  Integer eventIdentifier=null;
  try {
    if (operation == Event.TX_BEGIN) {
      tx.begin();
      eventIdentifier=tx.getEventIdentifier();
    }
 else     if (operation == Event.TX_ROLLBACK) {
      tx.begin();
      eventIdentifier=tx.getEventIdentifier();
      tx.rollback();
    }
 else     if (operation == Event.TX_COMMIT) {
      tx.begin();
      eventIdentifier=tx.getEventIdentifier();
      tx.commit();
    }
 else {
      fail("Unknown operation to test: " + operation);
    }
  }
 catch (  Exception e) {
    fail("Failed executing operation for: " + operation);
  }
  return eventIdentifier;
}
