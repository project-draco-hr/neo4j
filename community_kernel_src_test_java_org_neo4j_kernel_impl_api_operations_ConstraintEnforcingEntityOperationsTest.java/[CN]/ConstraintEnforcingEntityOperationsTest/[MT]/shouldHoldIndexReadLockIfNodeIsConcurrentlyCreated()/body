{
  long expectedNodeId=15;
  when(readOps.nodeGetUniqueFromIndexLookup(state,indexDescriptor,value)).thenReturn(NO_SUCH_NODE).thenReturn(expectedNodeId);
  LockAnswer readLocks=new LockAnswer(), writeLocks=new LockAnswer();
  when(locks.getReleasableIndexEntryReadLock(labelId,propertyKeyId,value)).then(readLocks);
  when(locks.getReleasableIndexEntryWriteLock(labelId,propertyKeyId,value)).then(writeLocks);
  long nodeId=ops.nodeGetUniqueFromIndexLookup(state,indexDescriptor,value);
  assertEquals(expectedNodeId,nodeId);
  assertEquals(1,readLocks.held());
  assertEquals(0,writeLocks.held());
}
