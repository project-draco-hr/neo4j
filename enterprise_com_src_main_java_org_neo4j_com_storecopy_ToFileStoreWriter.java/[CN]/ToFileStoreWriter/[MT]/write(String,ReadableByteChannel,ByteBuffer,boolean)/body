{
  try {
    temporaryBuffer.clear();
    File file=new File(basePath,path);
    file.getParentFile().mkdirs();
    monitor.startReceivingStoreFile(file);
    try (RandomAccessFile randomAccessFile=new RandomAccessFile(file,"rw")){
      long totalWritten=0;
      if (hasData) {
        FileChannel channel=randomAccessFile.getChannel();
        while (data.read(temporaryBuffer) >= 0) {
          temporaryBuffer.flip();
          totalWritten+=temporaryBuffer.limit();
          channel.write(temporaryBuffer);
          temporaryBuffer.clear();
        }
      }
      return totalWritten;
    }
  finally {
      monitor.finishReceivingStoreFile(file);
    }
  }
 catch (  Throwable t) {
    throw new IOException(t);
  }
}
