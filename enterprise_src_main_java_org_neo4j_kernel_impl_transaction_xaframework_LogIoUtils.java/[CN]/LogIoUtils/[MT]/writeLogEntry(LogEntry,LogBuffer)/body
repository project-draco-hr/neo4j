{
  if (entry instanceof LogEntry.Command) {
    writeCommand(buffer,entry.getIdentifier(),((LogEntry.Command)entry).getXaCommand());
  }
 else   if (entry instanceof LogEntry.Start) {
    writeStart(buffer,entry.getIdentifier(),entry.getVersion(),((LogEntry.Start)entry).getXid());
  }
 else   if (entry instanceof LogEntry.Done) {
    writeDone(buffer,entry.getIdentifier());
  }
 else   if (entry instanceof LogEntry.OnePhaseCommit) {
    LogEntry.Commit commit=(LogEntry.Commit)entry;
    writeCommit(false,buffer,commit.getIdentifier(),commit.getTxId(),commit.getMasterId());
  }
 else   if (entry instanceof LogEntry.Prepare) {
    writePrepare(buffer,entry.getIdentifier());
  }
 else   if (entry instanceof LogEntry.TwoPhaseCommit) {
    LogEntry.Commit commit=(LogEntry.Commit)entry;
    writeCommit(true,buffer,commit.getIdentifier(),commit.getTxId(),commit.getMasterId());
  }
}
