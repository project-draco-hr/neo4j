{
  long nodesInDatabaseBeforeTransaction=countNodes();
  Response begin=http.POST("/db/data/transaction");
  assertThat(begin.status(),equalTo(201));
  assertThat(begin.location(),containsString("/db/data/transaction"));
  String commitResource=begin.stringFromContent("commit");
  assertThat(commitResource,equalTo(begin.location() + "/commit"));
  Response commit=http.POST(commitResource,set(map("statement","CREATE n")));
  assertNoErrors((Map<String,Object>)commit.content());
  assertThat(commit.status(),equalTo(200));
  assertThat(countNodes(),equalTo(nodesInDatabaseBeforeTransaction + 1));
}
