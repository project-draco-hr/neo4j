{
  LuceneSchemaIndex luceneIndex=LuceneSchemaIndexBuilder.create().withIndexConfig(config).withSamplingConfig(samplingConfig).withIndexStorage(getIndexStorage(indexId)).build();
  if (config.isUnique()) {
    return new DeferredConstraintVerificationUniqueLuceneIndexPopulator(luceneIndex,descriptor);
  }
 else {
    return new NonUniqueLuceneIndexPopulator(luceneIndex,samplingConfig);
  }
}
