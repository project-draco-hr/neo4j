{
  Config mockConfig=mock(Config.class);
  URI managementUri=new URI("http://absolutedomain/management");
  when(mockConfig.get(ServerInternalSettings.management_api_path)).thenReturn(managementUri);
  URI dataUri=new URI("http://absolutedomain/management");
  when(mockConfig.get(ServerInternalSettings.rest_api_path)).thenReturn(dataUri);
  String baseUri="http://www.example.com";
  DiscoveryService ds=new DiscoveryService(mockConfig,new EntityOutputFormat(new JsonFormat(),new URI(baseUri),null),new SecurityCentral(Clock.SYSTEM_CLOCK,new InMemoryUserRepository()));
  Response response=ds.getDiscoveryDocument("");
  String json=new String((byte[])response.getEntity());
  assertNotNull(json);
  assertThat(json.length(),is(greaterThan(0)));
  assertThat(json,is(not("\"\"")));
  assertThat(json,is(not("null")));
  assertThat(json,containsString("\"management\" : \"" + managementUri + "\""));
  assertThat(json,containsString("\"data\" : \"" + dataUri + "\""));
}
