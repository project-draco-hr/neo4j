{
  while (!halted) {
    long txId=targetTxId;
    if (txId == lastUpdatedTxId) {
      waitForAChange();
      continue;
    }
    try {
      broker.setLastCommittedTxId(txId);
      lastUpdatedTxId=txId;
    }
 catch (    Exception e) {
    }
  }
}
