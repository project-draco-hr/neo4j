{
  long start=clock.currentTimeMillis();
  long timeoutMillis=timeUnit.toMillis(timeout);
  while (timeoutMillis > 0) {
    allAliveAreAvailable(outcome);
    if (!outcome.hasUnavailable()) {
      return;
    }
 else {
      clusterMembers.waitForEvent(timeoutMillis);
      timeoutMillis=timeoutMillis - (clock.currentTimeMillis() - start);
    }
  }
  allAliveAreAvailable(outcome);
}
