{
  if (logIndex == prevIndex) {
    return prevTerm;
  }
 else   if (logIndex < prevIndex || logIndex > appendIndex.get()) {
    return -1;
  }
  RaftLogMetadataCache.RaftLogEntryMetadata metadata=metadataCache.getMetadata(logIndex);
  if (metadata != null) {
    return metadata.getEntryTerm();
  }
  long resultTerm=-1;
  RaftLogEntry raftLogEntry=readLogEntry(logIndex);
  if (raftLogEntry != null) {
    resultTerm=raftLogEntry.term();
  }
  return resultTerm;
}
