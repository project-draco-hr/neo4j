{
  if (appendIndex.get() < index) {
    logRotation.rotateLogFile();
    RaftLogContinuationRecord.write(writer,index,term);
    writer.prepareForFlush().flush();
    prevIndex=index;
    prevTerm=term;
    appendIndex.set(index);
    metadataCache.cacheMetadata(index,term,LogPosition.UNSPECIFIED);
  }
  return appendIndex.get();
}
