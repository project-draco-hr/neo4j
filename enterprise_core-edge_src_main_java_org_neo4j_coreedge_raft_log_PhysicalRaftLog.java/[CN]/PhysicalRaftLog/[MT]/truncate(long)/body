{
  if (fromIndex <= commitIndex) {
    throw new IllegalArgumentException(format("cannot truncate (%d) before the commit index (%d)",fromIndex,commitIndex));
  }
  if (appendIndex.get() < fromIndex) {
    return;
  }
  entryCache.clear();
  long newAppendIndex=fromIndex - 1;
  appendIndex.set(newAppendIndex);
  logRotation.rotateLogFile();
  RaftLogContinuationRecord.write(writer,fromIndex);
  writer.prepareForFlush().flush();
  term=readEntryTerm(newAppendIndex);
}
