{
  File target=TargetDirectory.forTest(StringLoggerTest.class).cleanDirectory("debug");
  StringLogger logger=StringLogger.loggerDirectory(fileSystem,target,DEFAULT_THRESHOLD_FOR_ROTATION,true);
  String firstMessage="First message";
  String secondMessage="Second message";
  String thirdMessage="Third message";
  logger.debug(firstMessage);
  logger.debug(secondMessage,new RuntimeException(thirdMessage));
  logger.close();
  File logFile=new File(target,DEFAULT_NAME);
  assertTrue("Should have contained " + firstMessage,fileContains(logFile,containsString(firstMessage)));
  assertTrue("Should have contained " + secondMessage,fileContains(logFile,containsString(secondMessage)));
  assertTrue("Should have contained " + thirdMessage,fileContains(logFile,containsString(thirdMessage)));
  assertTrue("Should have contained stack trace from " + thirdMessage,fileContains(logFile,allOf(containsString("at "),containsString(testName.getMethodName()))));
}
