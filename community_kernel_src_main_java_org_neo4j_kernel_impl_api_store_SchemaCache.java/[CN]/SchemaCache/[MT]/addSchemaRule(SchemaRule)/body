{
  rulesByIdMap.put(rule.getId(),rule);
  if (rule instanceof PropertyConstraintRule) {
    PropertyConstraint constraint=constraintSemantics.readConstraint((PropertyConstraintRule)rule);
    if (constraint instanceof NodePropertyConstraint) {
      nodeConstraints.add((NodePropertyConstraint)constraint);
    }
 else     if (constraint instanceof RelationshipPropertyConstraint) {
      relationshipConstraints.add((RelationshipPropertyConstraint)constraint);
    }
  }
 else   if (rule instanceof IndexRule) {
    IndexRule indexRule=(IndexRule)rule;
    Map<Integer,CommittedIndexDescriptor> byLabel=indexDescriptors.get(indexRule.getLabel());
    if (byLabel == null) {
      indexDescriptors.put(indexRule.getLabel(),byLabel=new HashMap<>());
    }
    byLabel.put(indexRule.getPropertyKey(),new CommittedIndexDescriptor(indexRule.getLabel(),indexRule.getPropertyKey(),indexRule.getId()));
  }
}
