{
  SchemaRule rule=rulesByIdMap.remove(id);
  if (rule == null) {
    return;
  }
  int labelId=rule.getLabel();
  Map<Long,SchemaRule> rules=rulesByLabelMap.get(labelId);
  if (rules.remove(id) != null && rules.isEmpty()) {
    rulesByLabelMap.remove(labelId);
  }
  if (rule instanceof PropertyConstraintRule) {
    constraints.remove(((PropertyConstraintRule)rule).toConstraint());
  }
 else   if (rule instanceof IndexRule) {
    IndexRule indexRule=(IndexRule)rule;
    Map<Integer,CommittedIndexDescriptor> byLabel=indexDescriptors.get(indexRule.getLabel());
    byLabel.remove(indexRule.getPropertyKey());
    if (byLabel.isEmpty()) {
      indexDescriptors.remove(indexRule.getLabel());
    }
  }
}
