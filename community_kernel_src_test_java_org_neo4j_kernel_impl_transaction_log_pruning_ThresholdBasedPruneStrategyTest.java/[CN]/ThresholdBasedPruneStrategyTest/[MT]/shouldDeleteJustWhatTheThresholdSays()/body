{
  when(threshold.reached(Matchers.<File>any(),Matchers.eq(6L),Matchers.<LogFileInformation>any())).thenReturn(false);
  when(threshold.reached(Matchers.<File>any(),Matchers.eq(5L),Matchers.<LogFileInformation>any())).thenReturn(false);
  when(threshold.reached(Matchers.<File>any(),Matchers.eq(4L),Matchers.<LogFileInformation>any())).thenReturn(false);
  when(threshold.reached(Matchers.<File>any(),Matchers.eq(3L),Matchers.<LogFileInformation>any())).thenReturn(true);
  File fileName1=new File("logical.log.v1");
  File fileName2=new File("logical.log.v2");
  File fileName3=new File("logical.log.v3");
  File fileName4=new File("logical.log.v4");
  File fileName5=new File("logical.log.v5");
  File fileName6=new File("logical.log.v6");
  when(files.getLogFileForVersion(6)).thenReturn(fileName6);
  when(files.getLogFileForVersion(5)).thenReturn(fileName5);
  when(files.getLogFileForVersion(4)).thenReturn(fileName4);
  when(files.getLogFileForVersion(3)).thenReturn(fileName3);
  when(files.getLogFileForVersion(2)).thenReturn(fileName2);
  when(files.getLogFileForVersion(1)).thenReturn(fileName1);
  when(fileSystem.fileExists(fileName6)).thenReturn(true);
  when(fileSystem.fileExists(fileName5)).thenReturn(true);
  when(fileSystem.fileExists(fileName4)).thenReturn(true);
  when(fileSystem.fileExists(fileName3)).thenReturn(true);
  when(fileSystem.fileExists(fileName2)).thenReturn(true);
  when(fileSystem.fileExists(fileName1)).thenReturn(true);
  when(fileSystem.getFileSize(Matchers.<File>any())).thenReturn(LOG_HEADER_SIZE + 1L);
  final ThresholdBasedPruneStrategy strategy=new ThresholdBasedPruneStrategy(fileSystem,logFileInfo,files,threshold);
  strategy.prune(7L);
  verify(threshold,times(1)).init();
  verify(fileSystem,times(1)).deleteFile(fileName1);
  verify(fileSystem,times(1)).deleteFile(fileName2);
  verify(fileSystem,times(1)).deleteFile(fileName3);
}
