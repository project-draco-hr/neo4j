{
  beginClose();
  try {
    doCommit();
    close();
  }
  finally {
    closing=false;
  }
}
