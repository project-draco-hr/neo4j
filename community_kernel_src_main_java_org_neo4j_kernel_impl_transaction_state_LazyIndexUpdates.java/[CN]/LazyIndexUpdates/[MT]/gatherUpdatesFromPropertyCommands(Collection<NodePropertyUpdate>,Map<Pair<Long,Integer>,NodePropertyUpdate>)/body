{
  propCommands.visitEntries(new PrimitiveLongObjectVisitor<List<PropertyCommand>,RuntimeException>(){
    @Override public boolean visited(    long nodeId,    List<PropertyCommand> propertyCommands){
      gatherUpdatesFromPropertyCommandsForNode(nodeId,propertyCommands,updates);
      return false;
    }
  }
);
  for (  NodePropertyUpdate update : updates) {
    if (update.getUpdateMode() == UpdateMode.CHANGED) {
      propertyLookup.put(Pair.of(update.getNodeId(),update.getPropertyKeyId()),update);
    }
  }
}
