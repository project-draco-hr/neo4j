{
  FileSystemAbstraction fs=mock(FileSystemAbstraction.class);
  mockFileSize(fs,"nodestore.db",0);
  mockFileSize(fs,"relationshipstore.db",0);
  mockFileSize(fs,"relationshipgroupstore.db",0);
  mockFileSize(fs,"propertystore.db",0);
  mockFileSize(fs,"propertystore.db.strings",0);
  mockFileSize(fs,"propertystore.db.arrays",0);
  long availableMem=100000;
  long physicalMemory=2 * availableMem;
  long vmMemory=(long)Math.ceil(physicalMemory - (availableMem / 0.85));
  AutoConfigurator autoConf=new AutoConfigurator(fs,storeDir,true,physicalMemory * MiB,vmMemory * MiB,Mockito.mock(ConsoleLogger.class));
  Map<String,String> configuration=autoConf.configure();
  assertMappedMemory(configuration,"12500M","relationshipstore.db");
  assertMappedMemory(configuration," 2916M","nodestore.db");
  assertMappedMemory(configuration,"    1M","relationshipgroupstore.db");
  assertMappedMemory(configuration,"10572M","propertystore.db");
  assertMappedMemory(configuration," 9251M","propertystore.db.strings");
  assertMappedMemory(configuration,"10793M","propertystore.db.arrays");
}
