{
  List<String> nodeIds=asList("a","b","c","d","e","f","a","g");
  Configuration config=Configuration.COMMAS;
  File nodeHeaderFile=nodeHeader(config);
  File nodeData1=nodeData(false,config,nodeIds,lines(0,4));
  File nodeData2=nodeData(false,config,nodeIds,lines(4,nodeIds.size()));
  importTool("--into",dbRule.getStoreDirAbsolutePath(),"--skip-duplicate-nodes","--nodes",nodeHeaderFile.getAbsolutePath() + MULTI_FILE_DELIMITER + nodeData1.getAbsolutePath()+ MULTI_FILE_DELIMITER+ nodeData2.getAbsolutePath());
  GraphDatabaseService db=dbRule.getGraphDatabaseService();
  try (Transaction tx=db.beginTx()){
    Iterator<Node> nodes=GlobalGraphOperations.at(db).getAllNodes().iterator();
    Iterator<String> expectedIds=FilteringIterator.noDuplicates(nodeIds.iterator());
    while (expectedIds.hasNext()) {
      assertTrue(nodes.hasNext());
      assertEquals(expectedIds.next(),nodes.next().getProperty("id"));
    }
    assertFalse(nodes.hasNext());
    tx.success();
  }
  finally {
    db.shutdown();
  }
}
