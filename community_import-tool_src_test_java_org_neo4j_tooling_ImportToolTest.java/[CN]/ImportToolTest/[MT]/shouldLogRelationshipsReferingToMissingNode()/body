{
  List<String> nodeIds=asList("a","b","c");
  Configuration config=Configuration.COMMAS;
  File nodeData=nodeData(true,config,nodeIds,alwaysTrue());
  List<Triplet<String,String,String>> relationships=Arrays.asList(Triplet.of("a","b","TYPE"),Triplet.of("c","bogus","TYPE"),Triplet.of("b","c","KNOWS"),Triplet.of("c","a","KNOWS"),Triplet.of("missing","a","KNOWS"));
  File relationshipData1=relationshipData(true,config,relationships.iterator(),lines(0,2),true);
  File relationshipData2=relationshipData(false,config,relationships.iterator(),lines(2,5),true);
  File bad=file("bad.log");
  ImportTool.main(arguments("--into",dbRule.getStoreDir().getAbsolutePath(),"--nodes",nodeData.getAbsolutePath(),"--bad",bad.getAbsolutePath(),"--bad-tolerance","2","--relationships",relationshipData1.getAbsolutePath() + MULTI_FILE_DELIMITER + relationshipData2.getAbsolutePath()));
  String badContents=FileUtils.readTextFile(bad,Charset.defaultCharset());
  assertTrue("Didn't contain first bad relationship",badContents.contains(relationshipData1.getAbsolutePath() + ":3"));
  assertTrue("Didn't contain second bad relationship",badContents.contains(relationshipData2.getAbsolutePath() + ":3"));
}
