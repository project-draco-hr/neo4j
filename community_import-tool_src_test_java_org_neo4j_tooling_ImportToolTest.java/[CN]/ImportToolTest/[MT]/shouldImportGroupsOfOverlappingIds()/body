{
  List<String> groupOneNodeIds=asList("1","2","3");
  List<String> groupTwoNodeIds=asList("4","5","2");
  List<RelationshipDataLine> rels=asList(relationship("1","4","TYPE"),relationship("2","5","TYPE"),relationship("3","2","TYPE"));
  Configuration config=Configuration.COMMAS;
  String groupOne="Actor";
  String groupTwo="Movie";
  importTool("--into",dbRule.getStoreDir().getAbsolutePath(),"--nodes",nodeHeader(config,groupOne) + MULTI_FILE_DELIMITER + nodeData(false,config,groupOneNodeIds,alwaysTrue()),"--nodes",nodeHeader(config,groupTwo) + MULTI_FILE_DELIMITER + nodeData(false,config,groupTwoNodeIds,alwaysTrue()),"--relationships",relationshipHeader(config,groupOne,groupTwo,true) + MULTI_FILE_DELIMITER + relationshipData(false,config,rels.iterator(),alwaysTrue(),true));
  GraphDatabaseService db=dbRule.getGraphDatabaseService();
  try (Transaction tx=db.beginTx()){
    int nodeCount=0;
    for (    Node node : GlobalGraphOperations.at(db).getAllNodes()) {
      assertTrue(node.hasProperty("name"));
      nodeCount++;
      assertEquals(1,count(node.getRelationships()));
    }
    assertEquals(6,nodeCount);
    tx.success();
  }
 }
