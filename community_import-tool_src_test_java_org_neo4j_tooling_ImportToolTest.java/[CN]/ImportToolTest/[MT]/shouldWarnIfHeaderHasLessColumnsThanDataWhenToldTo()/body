{
  List<String> nodeIds=nodeIds();
  Configuration config=Configuration.TABS;
  File bad=file("bad.log");
  int extraColumns=3;
  executeImportAndCatchOutput("--into",dbRule.getStoreDirAbsolutePath(),"--bad",bad.getAbsolutePath(),"--bad-tolerance",Integer.toString(nodeIds.size() * extraColumns),"--ignore-extra-columns","--delimiter","TAB","--array-delimiter",String.valueOf(config.arrayDelimiter()),"--nodes",nodeHeader(config).getAbsolutePath() + MULTI_FILE_DELIMITER + nodeData(false,config,nodeIds,alwaysTrue(),Charset.defaultCharset(),extraColumns).getAbsolutePath(),"--relationships",relationshipHeader(config).getAbsolutePath() + MULTI_FILE_DELIMITER + relationshipData(false,config,nodeIds,alwaysTrue(),true).getAbsolutePath());
  String badContents=FileUtils.readTextFile(bad,Charset.defaultCharset());
  assertTrue(badContents.contains("Extra column not present in header on line"));
}
