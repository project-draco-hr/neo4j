{
  return new Rotation<Key,RotationState.Rotation<Key>>(state.prepareRotation(version)){
    @Override ProgressiveState<Key> rotate(    boolean force,    RotationStrategy strategy,    RotationTimerFactory timerFactory,    Consumer<Headers.Builder> headers) throws IOException {
      return new Prepared<>(state.rotate(force,strategy,timerFactory,headers));
    }
    @Override void close() throws IOException {
      state.close();
    }
    @Override long rotationVersion(){
      return state.rotationVersion();
    }
  }
;
}
