{
  Label testLabel=DynamicLabel.label("testLabel");
  long nodeId=createNode(testLabel);
  NeoStoreDataSource.BufferedIdMaintenanceController idMaintenanceController=getIdMaintenanceController();
  try (Transaction tx=dbRule.beginTx();ResourceIterator<Node> nodes=dbRule.findNodes(testLabel)){
    while (nodes.hasNext()) {
      nodes.next().delete();
    }
    idMaintenanceController.maintenance();
    Node newNode=dbRule.createNode(testLabel);
    assertNotEquals("Nodes should have different ids.",nodeId,newNode.getId());
    tx.success();
  }
   idMaintenanceController.maintenance();
  assertEquals("New node should have id of a removed node",nodeId,createNode(testLabel));
}
