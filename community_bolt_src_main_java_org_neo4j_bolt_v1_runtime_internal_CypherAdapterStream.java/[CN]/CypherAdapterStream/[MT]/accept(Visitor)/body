{
  delegate.accept(new Result.ResultVisitor<Exception>(){
    @Override public boolean visit(    Result.ResultRow row) throws Exception {
      visitor.visit(currentRecord.reset(row));
      return true;
    }
  }
);
  QueryExecutionType qt=delegate.getQueryExecutionType();
  visitor.addMetadata("type",queryTypeCode(qt.queryType()));
  if (delegate.getQueryStatistics().containsUpdates()) {
    Object stats=queryStats(delegate.getQueryStatistics());
    visitor.addMetadata("stats",stats);
  }
  if (qt.requestedExecutionPlanDescription()) {
    ExecutionPlanDescription rootPlanTreeNode=delegate.getExecutionPlanDescription();
    String metadataFieldName=rootPlanTreeNode.hasProfilerStatistics() ? "profile" : "plan";
    visitor.addMetadata(metadataFieldName,ExecutionPlanConverter.convert(rootPlanTreeNode));
  }
  Iterable<Notification> notifications=delegate.getNotifications();
  if (notifications.iterator().hasNext()) {
    visitor.addMetadata("notifications",NotificationConverter.convert(notifications));
  }
}
