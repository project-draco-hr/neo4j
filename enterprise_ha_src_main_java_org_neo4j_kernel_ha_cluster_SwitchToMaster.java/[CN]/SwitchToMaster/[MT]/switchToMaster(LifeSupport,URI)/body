{
  userLog.info("I am %s, moving to master",myId());
{
    idGeneratorFactory.switchToMaster();
    NeoStoreDataSource neoStoreXaDataSource=dataSourceSupplier.get();
    neoStoreXaDataSource.afterModeSwitch();
    ConversationManager conversationManager=conversationManagerFactory.newInstance();
    Master master=masterFactory.apply(conversationManager);
    MasterServer masterServer=masterServerFactory.apply(master,conversationManager);
    haCommunicationLife.add(master);
    haCommunicationLife.add(masterServer);
    masterDelegateHandler.setDelegate(master);
    haCommunicationLife.start();
    URI masterHaURI=getMasterUri(me,masterServer);
    clusterMemberAvailability.memberIsAvailable(MASTER,masterHaURI,neoStoreXaDataSource.getStoreId());
    userLog.info("I am %s, successfully moved to master",myId());
    slaveFactorySupplier.get().setStoreId(neoStoreXaDataSource.getStoreId());
    return masterHaURI;
  }
}
