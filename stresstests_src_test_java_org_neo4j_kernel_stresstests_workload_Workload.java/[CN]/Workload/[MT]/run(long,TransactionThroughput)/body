{
  for (int i=0; i < threads; i++) {
    executor.submit(worker);
  }
  long now=System.currentTimeMillis();
  long previousReportTime=System.currentTimeMillis();
  long finishLine=runningTimeMillis + now;
  long lastReport=TimeUnit.SECONDS.toMillis(10) + now;
  long previousTransactionCount=0;
  do {
    Thread.sleep(1000);
    now=System.currentTimeMillis();
    if (lastReport <= now) {
      long currentTransactionCount=sync.transactions();
      long diff=currentTransactionCount - previousTransactionCount;
      throughput.report(diff,now - previousReportTime);
      previousReportTime=now;
      previousTransactionCount=currentTransactionCount;
      lastReport=TimeUnit.SECONDS.toMillis(10) + now;
    }
  }
 while (now < finishLine);
  if (lastReport < now) {
    long diff=sync.transactions() - previousTransactionCount;
    throughput.report(diff,now - previousReportTime);
  }
  sync.stopAndWaitWorkers();
}
