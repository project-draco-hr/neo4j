{
  GraphDatabaseService db=new GraphDatabaseFactory().newEmbeddedDatabase(TargetDirectory.forTest(getClass()).makeGraphDbDir().getPath());
  try {
    try (Transaction tx=db.beginTx()){
      Node refNode=db.createNode(referenceNode);
      for (int i=0; i < 10; i++) {
        createDenseNode(db,refNode);
      }
      for (int i=0; i < 10; i++) {
        createSparseNode(db,refNode);
      }
      tx.success();
    }
   }
  finally {
    db.shutdown();
  }
}
