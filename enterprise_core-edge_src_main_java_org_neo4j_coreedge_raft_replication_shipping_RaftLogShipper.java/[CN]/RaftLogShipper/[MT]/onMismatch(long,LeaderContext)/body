{
switch (mode) {
case MISMATCH:
    long logIndex=max(min(lastSentIndex - 1,lastRemoteAppendIndex),0);
  sendSingle(logIndex,leaderContext);
break;
case PIPELINE:
case CATCHUP:
log.info(format("Mismatch in mode %s from follower %s",mode,follower));
mode=Mode.MISMATCH;
sendSingle(lastSentIndex,leaderContext);
break;
}
lastLeaderContext=leaderContext;
}
