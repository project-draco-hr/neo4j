{
  List<HighlyAvailableGraphDatabase> slaves=new ArrayList<HighlyAvailableGraphDatabase>();
  for (int i=0; i < cluster.size() - 1; i++)   slaves.add(cluster.getAnySlave(slaves.toArray(new HighlyAvailableGraphDatabase[0])));
  for (int i=0; i < 10; i++) {
    final RelationshipType relType=DynamicRelationshipType.withName("Rel" + i);
    final CountDownLatch latch=new CountDownLatch(1);
    List<Thread> threads=new ArrayList<Thread>();
    for (    HighlyAvailableGraphDatabase slave : slaves) {
      final GraphDatabaseAPI db=slave;
      Thread thread=new Thread(){
        @Override public void run(){
          try {
            latch.await();
          }
 catch (          InterruptedException e) {
            throw new RuntimeException(e);
          }
          Transaction tx=db.beginTx();
          try {
            db.createNode().createRelationshipTo(db.createNode(),relType);
            tx.success();
          }
  finally {
            tx.finish();
          }
        }
      }
;
      thread.start();
      threads.add(thread);
    }
    latch.countDown();
    for (    Thread thread : threads) {
      thread.join();
    }
    int highestId=0;
    for (    GraphDatabaseAPI db : cluster.getAllMembers()) {
      RelationshipTypeHolder holder=db.getNodeManager().getRelationshipTypeHolder();
      highestId=highestIdOf(holder,highestId);
      Set<String> types=new HashSet<String>();
      for (int j=0; j <= highestId; j++) {
        RelationshipType type=holder.getKeyById(j);
        if (type != null) {
          assertTrue(type.name() + " already existed for " + db,types.add(type.name()));
        }
      }
    }
  }
}
