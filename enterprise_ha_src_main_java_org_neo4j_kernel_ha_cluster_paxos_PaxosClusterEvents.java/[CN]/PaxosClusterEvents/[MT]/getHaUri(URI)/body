{
  try {
    String host=HaSettings.ha_server.getAddress(config.getParams());
    if (host == null) {
      host=clusterUri.getHost();
    }
    return new URI("ha",null,host,HaSettings.ha_server.getPort(config.getParams()),null,"serverId=" + config.get(HaSettings.server_id),null);
  }
 catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
}
