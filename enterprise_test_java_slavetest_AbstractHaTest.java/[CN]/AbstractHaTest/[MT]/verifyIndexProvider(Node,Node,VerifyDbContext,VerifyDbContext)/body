{
  int count=0;
  if (refDb.indexProvider == null || otherDb.indexProvider == null) {
    return count;
  }
  Set<String> otherKeys=new HashSet<String>();
  for (  String key : otherNode.getPropertyKeys()) {
    if (isIndexedWithIndexProvider(otherNode,otherDb,key)) {
      otherKeys.add(key);
    }
  }
  count=otherKeys.size();
  for (  String key : node.getPropertyKeys()) {
    if (otherKeys.remove(key) != isIndexedWithIndexProvider(node,refDb,key)) {
      throw new RuntimeException("Index differs on " + node + ", "+ key);
    }
  }
  if (!otherKeys.isEmpty()) {
    throw new RuntimeException("Other node " + otherNode + " has more indexing: "+ otherKeys);
  }
  return count;
}
