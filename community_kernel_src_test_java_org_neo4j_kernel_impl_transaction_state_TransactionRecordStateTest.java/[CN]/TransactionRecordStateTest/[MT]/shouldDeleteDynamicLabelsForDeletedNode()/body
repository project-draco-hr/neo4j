{
  NeoStore store=newNeoStore();
  NeoCommandHandler applier=new NeoStoreTransactionApplier(store,mock(CacheAccessBackDoor.class),LockService.NO_LOCK_SERVICE,new LockGroup(),1);
  AtomicLong nodeId=new AtomicLong();
  AtomicLong dynamicLabelRecordId=new AtomicLong();
  apply(applier,transaction(nodeWithDynamicLabelRecord(store,nodeId,dynamicLabelRecordId)));
  assertDynamicLabelRecordInUse(store,dynamicLabelRecordId.get(),true);
  apply(applier,transaction(deleteNode(store,nodeId.get())));
  assertDynamicLabelRecordInUse(store,dynamicLabelRecordId.get(),false);
}
