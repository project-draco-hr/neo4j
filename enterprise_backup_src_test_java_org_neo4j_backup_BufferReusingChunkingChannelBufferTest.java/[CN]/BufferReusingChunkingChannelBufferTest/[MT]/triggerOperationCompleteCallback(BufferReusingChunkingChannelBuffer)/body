{
  ChannelBuffer reusedBuffer=spy(ChannelBuffers.dynamicBuffer());
  ChannelFuture channelFuture=mock(ChannelFuture.class);
  when(channelFuture.isDone()).thenReturn(true);
  when(channelFuture.isSuccess()).thenReturn(true);
  buffer.newChannelFutureListener(reusedBuffer).operationComplete(channelFuture);
  return reusedBuffer;
}
