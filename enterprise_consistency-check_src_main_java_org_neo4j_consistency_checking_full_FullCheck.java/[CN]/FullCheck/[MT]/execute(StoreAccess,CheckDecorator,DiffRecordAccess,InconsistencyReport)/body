{
  StoreProcessor processEverything=new StoreProcessor(decorator,new ConsistencyReporter(recordAccess,report));
  ProgressMonitorFactory.MultiPartBuilder progress=progressFactory.multipleParts("Full consistency check");
  List<StoreProcessorTask> tasks=new ArrayList<>(16);
  MultiPassStore.Factory processorFactory=new MultiPassStore.Factory(decorator,totalMappedMemory,store,recordAccess,report);
  tasks.add(new StoreProcessorTask<>(store.getNodeStore(),progress,order,processEverything,processorFactory.createAll(PROPERTIES,RELATIONSHIPS)));
  tasks.add(new StoreProcessorTask<>(store.getRelationshipStore(),progress,order,processEverything,processorFactory.createAll(NODES,PROPERTIES,RELATIONSHIPS)));
  tasks.add(new StoreProcessorTask<>(store.getPropertyStore(),progress,order,processEverything,processorFactory.createAll(PROPERTIES,STRINGS,ARRAYS)));
  tasks.add(new StoreProcessorTask<>(store.getStringStore(),progress,order,processEverything,processorFactory.createAll(STRINGS)));
  tasks.add(new StoreProcessorTask<>(store.getArrayStore(),progress,order,processEverything,processorFactory.createAll(ARRAYS)));
  tasks.add(new StoreProcessorTask<>(store.getSchemaStore(),progress,order,processEverything,processEverything));
  final SchemaRecordCheck schemaCheck=new SchemaRecordCheck((SchemaStore)store.getSchemaStore());
  tasks.add(new SchemaStoreProcessorTask<>(store.getSchemaStore(),"check_rules",schemaCheck,progress,order,processEverything,processEverything));
  tasks.add(new SchemaStoreProcessorTask<>(store.getSchemaStore(),"check_obligations",schemaCheck.forObligationChecking(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getRelationshipTypeTokenStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getPropertyKeyTokenStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getLabelTokenStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getRelationshipTypeNameStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getPropertyKeyNameStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getLabelNameStore(),progress,order,processEverything,processEverything));
  tasks.add(new StoreProcessorTask<>(store.getNodeDynamicLabelStore(),progress,order,processEverything,processEverything));
  order.execute(tasks,progress.build());
}
