{
  applicationProcess.start();
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)100),globalSession,new LocalOperationId(0,0))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)101),globalSession,new LocalOperationId(0,1))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)102),globalSession,new LocalOperationId(0,2))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)101),globalSession,new LocalOperationId(0,1))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)100),globalSession,new LocalOperationId(0,0))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)103),globalSession,new LocalOperationId(0,3))));
  raftLog.append(new RaftLogEntry(0,new DistributedOperation(tx((byte)104),globalSession,new LocalOperationId(0,4))));
  applicationProcess.notifyCommitted(6);
  applier.sync(false);
  InOrder inOrder=inOrder(coreStateMachines,commandDispatcher);
  inOrder.verify(coreStateMachines).commandDispatcher();
  inOrder.verify(commandDispatcher).dispatch(eq(tx((byte)100)),eq(0L),anyCallback());
  inOrder.verify(commandDispatcher).dispatch(eq(tx((byte)101)),eq(1L),anyCallback());
  inOrder.verify(commandDispatcher).dispatch(eq(tx((byte)102)),eq(2L),anyCallback());
  inOrder.verify(commandDispatcher).dispatch(eq(tx((byte)103)),eq(5L),anyCallback());
  inOrder.verify(commandDispatcher).dispatch(eq(tx((byte)104)),eq(6L),anyCallback());
  inOrder.verify(commandDispatcher).close();
  verifyNoMoreInteractions(commandDispatcher);
}
