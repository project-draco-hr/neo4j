{
  while (channel.isConnected() && writeAheadCounter.get() >= MAX_WRITE_AHEAD_CHUNKS) {
    try {
      Thread.sleep(200);
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
    }
  }
  if (!channel.isConnected() || !channel.isOpen()) {
    throw new ComException("Channel has been closed");
  }
}
