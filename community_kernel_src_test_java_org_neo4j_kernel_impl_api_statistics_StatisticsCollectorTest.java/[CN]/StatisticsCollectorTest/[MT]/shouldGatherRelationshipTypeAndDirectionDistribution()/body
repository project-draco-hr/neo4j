{
  double equalityTolerance=0.2d;
  StatisticsCollectedData data=new StatisticsCollectedData(new RollingAverage.Parameters(RollingAverage.Parameters.DEFAULT_WINDOW_SIZE,equalityTolerance));
  StatisticsCollector collector=new StatisticsCollector(generateStore(),data);
  collector.run();
  collector.run();
  assertThat(collector.collectedData().relationshipTypeDistribution(0),closeTo(0.4,equalityTolerance));
  assertThat(collector.collectedData().relationshipTypeDistribution(1),closeTo(0.5,equalityTolerance));
}
