{
  double equalityTolerance=0.2d;
  StatisticsCollectedData data=new StatisticsCollectedData(new RollingAverage.Parameters(RollingAverage.Parameters.DEFAULT_WINDOW_SIZE,equalityTolerance));
  StatisticsCollector collector=new StatisticsCollector(generateStore(),data);
  collector.run();
  collector.run();
  assertThat(collector.collectedData().labelDistribution(0),closeTo(0.2,equalityTolerance));
  assertThat(collector.collectedData().labelDistribution(1),closeTo(0.8,equalityTolerance));
}
