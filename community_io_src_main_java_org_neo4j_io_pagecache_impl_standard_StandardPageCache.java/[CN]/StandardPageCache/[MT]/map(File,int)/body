{
  assertNotClosed();
  if (filePageSize > table.pageSize()) {
    throw new IllegalArgumentException("Cannot map files with a filePageSize (" + filePageSize + ") that is greater than the cachePageSize ("+ table.pageSize()+ ")");
  }
  StandardPagedFile pagedFile=pagedFiles.get(file);
  if (pagedFile == null || !pagedFile.claimReference()) {
    pagedFile=new StandardPagedFile(table,file,swapperFactory,filePageSize,monitor);
    pagedFiles.put(file,pagedFile);
  }
  return pagedFile;
}
