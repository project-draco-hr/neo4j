{
  assertNotClosed();
  if (filePageSize > table.pageSize()) {
    throw new IllegalArgumentException("Cannot map files with a filePageSize (" + filePageSize + ") that is greater than the cachePageSize ("+ table.pageSize()+ ")");
  }
  StandardPagedFile pagedFile=pagedFiles.get(file);
  if (pagedFile == null || !pagedFile.claimReference()) {
    pagedFile=new StandardPagedFile(table,file,swapperFactory,filePageSize,monitor);
    pagedFiles.put(file,pagedFile);
  }
  if (pagedFile.pageSize() != filePageSize) {
    String msg="Cannot map file " + file + " with "+ "filePageSize "+ filePageSize+ " bytes, "+ "because it has already been mapped with a "+ "filePageSize of "+ pagedFile.pageSize()+ " bytes.";
    throw new IllegalArgumentException(msg);
  }
  return pagedFile;
}
