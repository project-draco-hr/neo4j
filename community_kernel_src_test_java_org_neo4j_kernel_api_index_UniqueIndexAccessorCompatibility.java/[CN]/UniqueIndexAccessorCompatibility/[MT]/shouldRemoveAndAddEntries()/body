{
  updateAndCommit(asList(add(1l,"value1")));
  updateAndCommit(asList(add(2l,"value2")));
  updateAndCommit(asList(add(3l,"value3")));
  updateAndCommit(asList(add(4l,"value4")));
  updateAndCommit(asList(remove(1l,"value1")));
  updateAndCommit(asList(remove(2l,"value2")));
  updateAndCommit(asList(remove(3l,"value3")));
  updateAndCommit(asList(add(1l,"value1")));
  updateAndCommit(asList(add(3l,"value3b")));
  assertEquals(asList(1l),getAllNodes("value1"));
  assertEquals(emptyListOf(Long.class),getAllNodes("value2"));
  assertEquals(emptyListOf(Long.class),getAllNodes("value3"));
  assertEquals(asList(3l),getAllNodes("value3b"));
  assertEquals(asList(4l),getAllNodes("value4"));
}
