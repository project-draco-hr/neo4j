{
  try {
    String username=(String)authToken.get(AuthToken.PRINCIPAL);
    String password=(String)authToken.get(AuthToken.CREDENTIALS);
    LdapContext ctx=authenticate(username,password);
    Set<String> roles=authorize(ctx,username);
    return AuthInfo.of(username,roles);
  }
 catch (  NamingException e) {
    throw new AuthenticationException(e.getMessage());
  }
}
