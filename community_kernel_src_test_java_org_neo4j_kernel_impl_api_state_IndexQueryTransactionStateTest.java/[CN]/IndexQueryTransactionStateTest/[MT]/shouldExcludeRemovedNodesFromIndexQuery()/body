{
  when(store.nodesGetFromIndexLookup(state,indexDescriptor,value)).then(answerAsPrimitiveLongIteratorFrom(asList(1l,2l,3l)));
  when(oldTxState.getNodesWithChangedProperty(propertyKeyId,value)).thenReturn(new DiffSets<Long>());
  when(oldTxState.hasChanges()).thenReturn(true);
  txContext.nodeDelete(state,2l);
  PrimitiveLongIterator result=txContext.nodesGetFromIndexLookup(state,indexDescriptor,value);
  assertThat(asSet(result),equalTo(asSet(1l,3l)));
}
