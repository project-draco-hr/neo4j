{
  when(store.nodeGetUniqueFromIndexLookup(state,indexDescriptor,value)).thenReturn(asPrimitiveResourceIterator(1l));
  when(store.nodeHasLabel(statement,1l,labelId)).thenReturn(true);
  DefinedProperty stringProperty=stringProperty(propertyKeyId,value);
  when(store.nodeGetProperty(null,1l,propertyKeyId)).thenReturn(stringProperty);
  when(store.nodeGetAllProperties(same(statement),anyLong())).thenReturn(iterator(stringProperty));
  txContext.nodeRemoveLabel(state,1l,labelId);
  long result=txContext.nodeGetUniqueFromIndexLookup(state,indexDescriptor,value);
  assertNoSuchNode(result);
}
