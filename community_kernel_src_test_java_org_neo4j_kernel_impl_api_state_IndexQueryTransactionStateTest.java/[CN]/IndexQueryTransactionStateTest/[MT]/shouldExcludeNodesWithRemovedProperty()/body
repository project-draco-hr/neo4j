{
  when(store.nodesGetFromIndexLookup(state,indexDescriptor,value)).then(answerAsPrimitiveLongIteratorFrom(asList(2l,3l)));
  when(statement.acquireSingleNodeCursor(1l)).thenReturn(asNodeCursor(1l,PropertyCursor.EMPTY,asLabelCursor(labelId)));
  state.txState().nodeDoReplaceProperty(1l,Property.noNodeProperty(1l,propertyKeyId),Property.intProperty(propertyKeyId,10));
  txContext.nodeAddLabel(state,1l,labelId);
  PrimitiveLongIterator result=txContext.nodesGetFromIndexLookup(state,indexDescriptor,value);
  assertThat(asSet(result),equalTo(asSet(2l,3l)));
}
