{
  super(storeDir);
  if (config == null) {
    throw new IllegalArgumentException("null config, proper configuration required");
  }
  this.startupTime=System.currentTimeMillis();
  this.config=config;
  initializeTxManagerKernelPanicEventHandler();
  this.readTimeout=HaConfig.getClientReadTimeoutFromConfig(config);
  this.slaveUpdateMode=HaConfig.getSlaveUpdateModeFromConfig(config);
  this.machineId=HaConfig.getMachineIdFromConfig(config);
  this.branchedDataPolicy=HaConfig.getBranchedDataPolicyFromConfig(config);
  config.put(Config.KEEP_LOGICAL_LOGS,"true");
  this.brokerFactory=brokerFactory != null ? brokerFactory : defaultBrokerFactory();
  this.broker=this.brokerFactory.create(this,config);
  startUp(HaConfig.getAllowInitFromConfig(config));
}
