{
  try {
    if (masterServer == null) {
      if (broker.getMaster() == null && broker instanceof ZooKeeperBroker) {
        getMessageLog().logMessage("ZooKeeper broker returned null master");
        newMaster(new NullPointerException("master returned from broker"));
      }
 else       if (broker.getMaster().first() == null) {
        newMaster(new NullPointerException("master returned from broker"));
      }
    }
    receive(broker.getMaster().first().pullUpdates(getSlaveContext(-1)));
  }
 catch (  ZooKeeperException e) {
    newMaster(null,e);
    throw e;
  }
catch (  ComException e) {
    newMaster(null,e);
    throw e;
  }
}
