{
  getMessageLog().logMessage("Copying store from master");
  Response<Void> response=master.first().copyStore(new SlaveContext(0,machineId,0,new Pair[0]),new ToFileStoreWriter(getStoreDir()));
  long highestLogVersion=highestLogVersion();
  if (highestLogVersion > -1)   NeoStore.setVersion(getStoreDir(),highestLogVersion + 1);
  EmbeddedGraphDatabase copiedDb=new EmbeddedGraphDatabase(getStoreDir(),stringMap(KEEP_LOGICAL_LOGS,"true"));
  try {
    MasterUtil.applyReceivedTransactions(response,copiedDb,MasterUtil.txHandlerForFullCopy());
  }
  finally {
    copiedDb.shutdown();
  }
  getMessageLog().logMessage("Done copying store from master");
}
