{
  Future<Long> commitFuture;
  try {
    commitFuture=logicalTransactionStore.getAppender().append(tx);
  }
 catch (  IOException e) {
    kernelHealth.panic(e);
    throw new TransactionFailureException(Status.Transaction.CouldNotWriteToLog,e,"Could not write transaction representation to log");
  }
  long transactionId;
  try {
    transactionId=commitFuture.get();
  }
 catch (  InterruptedException|ExecutionException e) {
    throw new TransactionFailureException(Status.Transaction.CouldNotWriteToLog,e,"");
  }
  return transactionId;
}
