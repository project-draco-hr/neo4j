{
  try (ValidatedIndexUpdates indexUpdates=validateIndexUpdates(transaction)){
    long transactionId=appendToLog(transaction,commitEvent);
    applyToStore(transaction,locks,commitEvent,indexUpdates,transactionId);
    return transactionId;
  }
 }
