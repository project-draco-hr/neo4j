{
  Commitment commitment;
  try (LogAppendEvent logAppendEvent=commitEvent.beginLogAppend()){
    commitment=appender.append(transaction,logAppendEvent);
  }
 catch (  Throwable cause) {
    throw new TransactionFailureException(CouldNotWriteToLog,cause,"Could not append transaction representation to log");
  }
  commitEvent.setTransactionId(commitment.transactionId());
  return commitment;
}
