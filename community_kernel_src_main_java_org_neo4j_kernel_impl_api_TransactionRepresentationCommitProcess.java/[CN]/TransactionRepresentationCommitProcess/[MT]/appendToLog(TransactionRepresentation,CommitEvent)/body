{
  long transactionId;
  try (LogAppendEvent logAppendEvent=commitEvent.beginLogAppend()){
    transactionId=logicalTransactionStore.getAppender().append(transaction,logAppendEvent);
  }
 catch (  Throwable e) {
    throw new TransactionFailureException(Status.Transaction.CouldNotWriteToLog,e,"Could not append transaction representation to log");
  }
  commitEvent.setTransactionId(transactionId);
  return transactionId;
}
