{
  long transactionId;
  try (LogAppendEvent logAppendEvent=commitEvent.beginLogAppend()){
    transactionId=appender.append(transaction,logAppendEvent);
  }
 catch (  Throwable cause) {
    throw new TransactionFailureException(CouldNotWriteToLog,cause,"Could not append transaction representation to log");
  }
  commitEvent.setTransactionId(transactionId);
  return transactionId;
}
