{
  try {
    if (!dir.exists()) {
      dir.mkdirs();
    }
    File out=new File(dir,filename);
    if (out.exists()) {
      out.delete();
    }
    if (!out.createNewFile()) {
      throw new RuntimeException("File exists: " + out.getAbsolutePath());
    }
    return new OutputStreamWriter(new FileOutputStream(out,false),"UTF-8");
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new RuntimeException(e);
  }
}
