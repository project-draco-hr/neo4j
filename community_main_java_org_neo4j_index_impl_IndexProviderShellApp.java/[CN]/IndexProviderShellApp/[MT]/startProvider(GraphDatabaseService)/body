{
  if (graphDb instanceof ReadOnlyGraphDatabaseProxy) {
    ReadOnlyGraphDatabaseProxy proxy=(ReadOnlyGraphDatabaseProxy)graphDb;
    return new ReadOnlyIndexProviderProxy(proxy,new LuceneIndexProvider(proxy.getActualGraphDb()));
  }
 else {
    return new LuceneIndexProvider(graphDb);
  }
}
