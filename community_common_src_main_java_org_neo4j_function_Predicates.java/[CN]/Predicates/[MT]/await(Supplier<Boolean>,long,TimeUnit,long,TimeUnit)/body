{
  long deadlineMillis=System.currentTimeMillis() + timeoutUnit.toMillis(timeout);
  long pollIntervalMillis=pollUnit.toMillis(pollInterval);
  do {
    if (condition.get()) {
      return;
    }
    Thread.sleep(pollIntervalMillis);
  }
 while (System.currentTimeMillis() < deadlineMillis);
  throw new TimeoutException("Waited for " + timeout + " "+ timeoutUnit+ ", but "+ condition+ " was not accepted.");
}
