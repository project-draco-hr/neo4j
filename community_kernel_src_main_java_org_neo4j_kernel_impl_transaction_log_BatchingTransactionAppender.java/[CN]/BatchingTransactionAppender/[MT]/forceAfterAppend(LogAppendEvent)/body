{
  ThreadLink threadLink=new ThreadLink(Thread.currentThread());
  threadLink.next=threadLinkHead.getAndSet(threadLink);
  try (LogForceWaitEvent logForceWaitEvent=logAppendEvent.beginLogForceWait()){
    do {
      if (forceLock.tryLock()) {
        try {
          forceLog(logAppendEvent);
        }
  finally {
          forceLock.unlock();
          ThreadLink nextWaiter=threadLinkHead.get();
          nextWaiter.unpark();
        }
      }
 else {
        waitForLogForce();
      }
    }
 while (!threadLink.done);
  }
 }
