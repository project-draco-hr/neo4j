{
  long[] timestamps=new long[3];
  for (int i=0; i < timestamps.length; i++) {
    startDbAndCreateNode();
    timestamps[i]=moveAwayToLookLikeOldBranchedDirectory();
    Thread.sleep(1);
  }
  new HighlyAvailableGraphDatabaseFactory().newHighlyAvailableDatabaseBuilder(dir.getAbsolutePath()).setConfig(HaSettings.server_id,"1").newGraphDatabase().shutdown();
  for (  long timestamp : timestamps) {
    assertFalse("directory branched-" + timestamp + " still exists.",new File(dir,"branched-" + timestamp).exists());
    assertTrue("directory " + timestamp + " is not there",BranchedDataPolicy.getBranchedDataDirectory(dir,timestamp).exists());
  }
}
