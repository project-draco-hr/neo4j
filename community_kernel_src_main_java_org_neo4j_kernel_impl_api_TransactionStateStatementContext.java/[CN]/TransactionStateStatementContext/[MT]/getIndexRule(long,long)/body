{
  Iterable<IndexRule> committedRules;
  try {
    committedRules=option(delegate.getIndexRule(labelId,propertyKey));
  }
 catch (  SchemaRuleNotFoundException e) {
    committedRules=emptyList();
  }
  DiffSets<IndexRule> ruleDiffSet=state.getIndexRuleDiffSetsByLabel(labelId);
  Iterable<IndexRule> rules=ruleDiffSet.apply(committedRules);
  IndexRule single=singleOrNull(rules);
  if (single == null)   throw new SchemaRuleNotFoundException("Index rule for label:" + labelId + " and property:"+ propertyKey+ " not found");
  return single;
}
