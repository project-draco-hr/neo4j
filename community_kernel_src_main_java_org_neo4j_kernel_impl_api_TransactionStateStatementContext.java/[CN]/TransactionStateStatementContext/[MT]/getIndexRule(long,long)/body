{
  Iterable<IndexRule> committedRules;
  try {
    committedRules=option(schemaOperations.getIndexRule(labelId,propertyKey));
  }
 catch (  SchemaRuleNotFoundException e) {
    committedRules=emptyList();
  }
  DiffSets<IndexRule> ruleDiffSet=state.getIndexRuleDiffSetsByLabel(labelId);
  Iterator<IndexRule> rules=ruleDiffSet.apply(committedRules.iterator());
  IndexRule single=singleOrNull(rules);
  if (single == null) {
    throw new SchemaRuleNotFoundException("Index rule for label:" + labelId + " and property:"+ propertyKey+ " not found");
  }
  return single;
}
