{
  unpinCurrentPage();
  long lastPageId=assertPagedFileStillMappedAndGetIdOfLastPage();
  if (nextPageId > lastPageId) {
    if ((pf_flags & PagedFile.PF_NO_GROW) != 0) {
      return false;
    }
 else {
      pagedFile.increaseLastPageIdTo(nextPageId);
    }
  }
  pin(nextPageId,true);
  currentPageId=nextPageId;
  nextPageId++;
  return true;
}
