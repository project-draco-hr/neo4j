{
  assertAuthEnabled();
  ThreadContext.bind(securityManager);
  Subject subject=new Subject.Builder(securityManager).buildSubject();
  ThreadContext.bind(subject);
  UsernamePasswordToken token=new UsernamePasswordToken(username,password);
  try {
    subject.login(token);
  }
 catch (  ExpiredCredentialsException e) {
    return AuthenticationResult.PASSWORD_CHANGE_REQUIRED;
  }
catch (  AuthenticationException e) {
    return AuthenticationResult.FAILURE;
  }
  return AuthenticationResult.SUCCESS;
}
