{
  Map<Long,ReferenceWithKey<Long,E>> softMap=new HashMap<Long,ReferenceWithKey<Long,E>>(entities.size() * 2);
  for (  E entity : entities) {
    Long key=entity.getId();
    ReferenceWithKey<Long,E> ref=referenceFactory.newReference(key,entity,(ReferenceQueue)refQueue);
    softMap.put(key,ref);
  }
  cache.putAll(softMap);
  recordPutAndPollIfNeeded(softMap.size());
}
