{
  String[] hosts=config.getInitialHosts();
  if (hosts.length == 0) {
    logger.logMessage("Creating cluster " + config.getClusterName());
    cluster.create(config.getClusterName());
  }
 else {
    try {
      for (      String host : hosts) {
        if (serverId.toString().endsWith(host)) {
          continue;
        }
        host=resolvePortOnlyHost(host);
        logger.info("Attempting to join " + host);
        Future<ClusterConfiguration> clusterConfig=cluster.join(new URI("cluster://" + host));
        try {
          ClusterConfiguration configuration=clusterConfig.get(10,SECONDS);
          logger.info("Joined cluster:" + configuration);
          return;
        }
 catch (        InterruptedException e) {
          e.printStackTrace();
        }
catch (        ExecutionException e) {
          logger.error("Could not join cluster member " + host);
        }
catch (        TimeoutException e) {
          logger.error("Could not join cluster member (timed out) " + host);
        }
      }
      cluster.create(config.getClusterName());
    }
 catch (    URISyntaxException e) {
      e.printStackTrace();
    }
  }
}
