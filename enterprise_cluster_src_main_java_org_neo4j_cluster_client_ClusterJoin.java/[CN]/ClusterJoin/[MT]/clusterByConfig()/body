{
  List<HostnamePort> hosts=config.getInitialHosts();
  cluster.addClusterListener(new UnknownJoiningMemberWarning(hosts));
  if (hosts == null || hosts.size() == 0) {
    logger.info("No cluster hosts specified. Creating cluster " + config.getClusterName());
    cluster.create(config.getClusterName());
  }
 else {
    try {
      while (true) {
        for (        HostnamePort host : hosts) {
          if (serverId.toString().endsWith(host.toString())) {
            continue;
          }
          String hostString=resolvePortOnlyHost(host);
          logger.debug("Attempting to join " + hostString);
          Future<ClusterConfiguration> clusterConfig=cluster.join(new URI("cluster://" + hostString));
          try {
            logger.debug("Joined cluster:" + clusterConfig.get());
            return;
          }
 catch (          InterruptedException e) {
            e.printStackTrace();
          }
catch (          ExecutionException e) {
            logger.debug("Could not join cluster member " + hostString);
          }
        }
        if (config.isAllowedToCreateCluster()) {
          cluster.create(config.getClusterName());
          break;
        }
      }
    }
 catch (    URISyntaxException e) {
      e.printStackTrace();
    }
  }
}
