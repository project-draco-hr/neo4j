{
switch (commandType) {
case NeoCommandType.NODE_COMMAND:
    return new Command.NodeCommand();
case NeoCommandType.PROP_COMMAND:
  return new Command.PropertyCommand();
case NeoCommandType.PROP_INDEX_COMMAND:
return new Command.PropertyKeyTokenCommand();
case NeoCommandType.REL_COMMAND:
return new Command.RelationshipCommand();
case NeoCommandType.REL_TYPE_COMMAND:
return new Command.RelationshipTypeTokenCommand();
case NeoCommandType.LABEL_KEY_COMMAND:
return new Command.LabelTokenCommand();
case NeoCommandType.NEOSTORE_COMMAND:
return new Command.NeoStoreCommand();
case NeoCommandType.SCHEMA_RULE_COMMAND:
return new Command.SchemaRuleCommand();
case NeoCommandType.REL_GROUP_COMMAND:
return new Command.RelationshipGroupCommand();
case NeoCommandType.INDEX_DEFINE_COMMAND:
return new IndexDefineCommand();
case NeoCommandType.INDEX_ADD_COMMAND:
return new IndexCommand.AddNodeCommand();
case NeoCommandType.INDEX_ADD_RELATIONSHIP_COMMAND:
return new IndexCommand.AddRelationshipCommand();
case NeoCommandType.INDEX_REMOVE_COMMAND:
return new IndexCommand.RemoveCommand();
case NeoCommandType.INDEX_DELETE_COMMAND:
return new IndexCommand.DeleteCommand();
case NeoCommandType.INDEX_CREATE_COMMAND:
return new IndexCommand.CreateCommand();
case NeoCommandType.UPDATE_RELATIONSHIP_COUNTS_COMMAND:
return new RelationshipCountsCommand();
case NeoCommandType.UPDATE_NODE_COUNTS_COMMAND:
return new NodeCountsCommand();
default :
LogPositionMarker position=new LogPositionMarker();
channel.getCurrentPosition(position);
throw new IOException("Unknown command type[" + commandType + "] near "+ position.newPosition());
}
}
