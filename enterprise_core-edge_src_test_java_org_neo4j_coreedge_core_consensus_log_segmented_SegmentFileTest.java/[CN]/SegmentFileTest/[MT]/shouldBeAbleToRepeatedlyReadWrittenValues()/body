{
  try (SegmentFile segment=create(fsRule.get(),fileNames.getForVersion(0),readerPool,0,contentMarshal,logProvider,segmentHeader)){
    segment.write(0,entry1);
    segment.write(1,entry2);
    segment.write(2,entry3);
    segment.flush();
    for (int i=0; i < 3; i++) {
      IOCursor<EntryRecord> cursor=segment.getCursor(0);
      assertTrue(cursor.next());
      assertEquals(entry1,cursor.get().logEntry());
      assertTrue(cursor.next());
      assertEquals(entry2,cursor.get().logEntry());
      assertTrue(cursor.next());
      assertEquals(entry3,cursor.get().logEntry());
      assertFalse(cursor.next());
      cursor.close();
    }
  }
 }
