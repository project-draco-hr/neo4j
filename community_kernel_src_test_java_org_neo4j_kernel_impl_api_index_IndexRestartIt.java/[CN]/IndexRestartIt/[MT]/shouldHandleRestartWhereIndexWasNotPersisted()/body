{
  startDb();
  createIndex();
  stopDb();
  provider.setInitialIndexState(NON_EXISTENT);
  startDb();
  IndexDefinition index=getSingleIndex();
  assertThat(db.schema().getIndexState(index),not(equalTo(Schema.IndexState.FAILED)));
  assertEquals(2,provider.populatorCallCount.get());
}
