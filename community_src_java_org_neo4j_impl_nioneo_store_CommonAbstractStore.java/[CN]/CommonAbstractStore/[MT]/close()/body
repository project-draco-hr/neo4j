{
  if (fileChannel == null) {
    return;
  }
  closeStorage();
  if (windowPool != null) {
    windowPool.close();
    windowPool=null;
  }
  closeIdGenerator();
  fileChannel.position(fileChannel.size());
  ByteBuffer buffer=ByteBuffer.allocate(getTypeAndVersionDescriptor().length());
  buffer.put(getTypeAndVersionDescriptor().getBytes()).flip();
  fileChannel.write(buffer);
  fileChannel.force(false);
  fileLock.release();
  fileChannel.close();
  fileChannel=null;
}
