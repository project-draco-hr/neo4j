{
  BatchInserter inserter=newBatchInserter();
  long theNode=inserter.createNode(properties);
  long anotherNode=inserter.createNode(Collections.EMPTY_MAP);
  long relationship=inserter.createRelationship(theNode,anotherNode,DynamicRelationshipType.withName("foo"),properties);
  inserter.removeNodeProperty(theNode,"key0");
  inserter.removeRelationshipProperty(relationship,"key1");
  for (  String key : properties.keySet()) {
    if (key.equals("key0")) {
      assertFalse(inserter.nodeHasProperty(theNode,key));
      assertTrue(inserter.relationshipHasProperty(relationship,key));
    }
 else     if (key.equals("key1")) {
      assertTrue(inserter.nodeHasProperty(theNode,key));
      assertFalse(inserter.relationshipHasProperty(relationship,key));
    }
 else {
      assertTrue(inserter.nodeHasProperty(theNode,key));
      assertTrue(inserter.relationshipHasProperty(relationship,key));
    }
  }
  inserter.shutdown();
  inserter=newBatchInserter(false);
  for (  String key : properties.keySet()) {
    if (key.equals("key0")) {
      assertFalse(inserter.nodeHasProperty(theNode,key));
      assertTrue(inserter.relationshipHasProperty(relationship,key));
    }
 else     if (key.equals("key1")) {
      assertTrue(inserter.nodeHasProperty(theNode,key));
      assertFalse(inserter.relationshipHasProperty(relationship,key));
    }
 else {
      assertTrue(inserter.nodeHasProperty(theNode,key));
      assertTrue(inserter.relationshipHasProperty(relationship,key));
    }
  }
}
