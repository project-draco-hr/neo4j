{
  if (error == ErrorState.TX_MANAGER_NOT_OK) {
    try {
      int myEpoch=epoch.get();
synchronized (dataSourceManager) {
        if (myEpoch != epoch.get())         return;
        accessGuard.enter();
        try {
          txManager.stop();
          dataSourceManager.stop();
          dataSourceManager.start();
          txManager.start();
          txManager.doRecovery();
          epoch.incrementAndGet();
        }
  finally {
          accessGuard.exit();
        }
      }
    }
 catch (    Throwable t) {
      throw new RuntimeException("error while handling kernel panic for TX_MANAGER_NOT_OK",t);
    }
  }
}
