{
  File logFile=tmpFile();
  TxLog log=new TxLog(logFile,fs,new Monitors());
  writeStartRecords(log,1,0);
  log.force();
  log.close();
  zeroPad(logFile,fs,TxLog.SCAN_WINDOW_SIZE - 2);
  log=new TxLog(logFile,fs,new Monitors());
  writeStartRecords(log,1,1);
  log.force();
  File rotationTarget=tmpFile();
  log.switchToLogFile(rotationTarget);
  assertThat(log.getRecordCount(),is(2));
}
