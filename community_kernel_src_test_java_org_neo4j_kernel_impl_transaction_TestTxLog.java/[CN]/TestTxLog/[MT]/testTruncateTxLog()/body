{
  File file=txFile();
  if (file.exists()) {
    file.delete();
  }
  try {
    TxLog txLog=new TxLog(txFile(),fs,new Monitors());
    byte globalId[]=new byte[64];
    byte branchId[]=new byte[45];
    txLog.txStart(globalId);
    txLog.addBranch(globalId,branchId);
    txLog.markAsCommitting(globalId,ForceMode.unforced);
    txLog.truncate();
    assertEquals(0,getRecordLists(txLog.getDanglingRecords()).length);
    txLog.close();
    txLog=new TxLog(txFile(),new DefaultFileSystemAbstraction(),new Monitors());
    txLog.txStart(globalId);
    txLog.addBranch(globalId,branchId);
    txLog.markAsCommitting(globalId,ForceMode.unforced);
    txLog.close();
    txLog=new TxLog(txFile(),new DefaultFileSystemAbstraction(),new Monitors());
    assertEquals(1,getRecordLists(txLog.getDanglingRecords()).length);
    txLog.truncate();
    assertEquals(0,getRecordLists(txLog.getDanglingRecords()).length);
  }
  finally {
    file=txFile();
    if (file.exists()) {
      file.delete();
    }
  }
}
