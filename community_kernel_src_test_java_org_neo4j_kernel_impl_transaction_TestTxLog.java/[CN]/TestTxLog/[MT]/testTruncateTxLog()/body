{
  File file=new File(txFile());
  if (file.exists()) {
    file.delete();
  }
  try {
    TxLog txLog=new TxLog(txFile(),CommonFactories.defaultFileSystemAbstraction());
    byte globalId[]=new byte[64];
    byte branchId[]=new byte[45];
    txLog.txStart(globalId);
    txLog.addBranch(globalId,branchId);
    txLog.markAsCommitting(globalId,ForceMode.unforced);
    txLog.truncate();
    assertEquals(0,getRecordLists(txLog.getDanglingRecords()).length);
    txLog.close();
    txLog=new TxLog(txFile(),CommonFactories.defaultFileSystemAbstraction());
    txLog.txStart(globalId);
    txLog.addBranch(globalId,branchId);
    txLog.markAsCommitting(globalId,ForceMode.unforced);
    txLog.close();
    txLog=new TxLog(txFile(),CommonFactories.defaultFileSystemAbstraction());
    assertEquals(1,getRecordLists(txLog.getDanglingRecords()).length);
    txLog.truncate();
    assertEquals(0,getRecordLists(txLog.getDanglingRecords()).length);
  }
  finally {
    file=new File(txFile());
    if (file.exists()) {
      file.delete();
    }
  }
}
