{
  long logHeader=transactionMetadataCache.getLogHeader(version);
  if (logHeader != -1) {
    return logHeader + 1;
  }
  if (logFiles.versionExists(version)) {
    long previousVersionLastCommittedTx=logFiles.extractHeader(version).lastCommittedTxId;
    transactionMetadataCache.putHeader(version,previousVersionLastCommittedTx);
    return previousVersionLastCommittedTx + 1;
  }
  return -1;
}
