{
  try {
    log.info("Copying store from %s",from);
    long lastFlushedTxId=storeCopyClient.copyStoreFiles(from,new StreamToDisk(storeDir,fs));
    log.info("Store files streamed up to %d",lastFlushedTxId);
    try (TransactionLogCatchUpWriter writer=transactionLogFactory.create(storeDir,fs,pageCache,logProvider)){
      log.info("Pulling transactions from: %d",lastFlushedTxId - 1);
      long lastPulledTxId=txPullClient.pullTransactions(from,storeId,lastFlushedTxId - 1,writer);
      log.info("Txs streamed up to %d",lastPulledTxId);
    }
   }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
