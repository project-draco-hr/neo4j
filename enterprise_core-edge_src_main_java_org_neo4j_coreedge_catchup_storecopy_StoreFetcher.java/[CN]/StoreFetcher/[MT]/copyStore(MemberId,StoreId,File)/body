{
  try {
    log.info("Copying store from %s",from);
    long lastFlushedTxId=storeCopyClient.copyStoreFiles(from,expectedStoreId,new StreamToDisk(destDir,fs));
    long pullTxIndex=lastFlushedTxId - 1;
    log.info("Store files need to be recovered starting from: %d",pullTxIndex);
    CatchupResult catchupResult=pullTransactions(from,expectedStoreId,destDir,pullTxIndex);
    if (catchupResult != SUCCESS) {
      throw new StreamingTransactionsFailedException("Failed to pull transactions: " + catchupResult);
    }
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
