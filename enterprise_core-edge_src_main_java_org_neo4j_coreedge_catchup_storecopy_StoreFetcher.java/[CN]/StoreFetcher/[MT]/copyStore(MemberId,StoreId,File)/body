{
  try {
    log.info("Copying store from %s",from);
    long lastFlushedTxId=storeCopyClient.copyStoreFiles(from,expectedStoreId,new StreamToDisk(destDir,fs));
    log.info("Store files need to be recovered starting from: %d",lastFlushedTxId);
    CatchupResult catchupResult=pullTransactions(from,expectedStoreId,destDir,lastFlushedTxId);
    if (catchupResult != SUCCESS) {
      throw new StoreCopyFailedException("Failed to pull transactions: " + catchupResult);
    }
  }
 catch (  IOException e) {
    throw new StoreCopyFailedException(e);
  }
}
