{
  OngoingStubbing<Response<Void>> updatePullStubbing=when(master.pullUpdates(any(RequestContext.class)));
  updatePullStubbing.thenThrow(new ComException());
  for (int i=0; i < SlaveUpdatePuller.LOG_CAP + 20; i++) {
    updatePuller.pullUpdates();
  }
  assertThat(logging.countWarningsByType(ComException.class),is(SlaveUpdatePuller.LOG_CAP));
  updatePullStubbing.thenReturn(Response.EMPTY).thenThrow(new ComException());
  updatePuller.pullUpdates();
  updatePuller.pullUpdates();
  assertThat(logging.countWarningsByType(ComException.class),is(SlaveUpdatePuller.LOG_CAP + 1));
}
