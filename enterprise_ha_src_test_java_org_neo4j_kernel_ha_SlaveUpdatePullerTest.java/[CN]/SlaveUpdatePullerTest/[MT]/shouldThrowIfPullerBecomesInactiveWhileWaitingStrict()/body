{
  Condition condition=mock(Condition.class);
  when(condition.evaluate(anyInt(),anyInt())).thenAnswer(new Answer<Boolean>(){
    @Override public Boolean answer(    InvocationOnMock invocation) throws Throwable {
      updatePuller.stop();
      return false;
    }
  }
);
  try {
    updatePuller.pullUpdates(condition,true);
    fail("Should have thrown");
  }
 catch (  IllegalStateException e) {
    verify(condition).evaluate(anyInt(),anyInt());
  }
}
