{
  when(master.pullUpdates(any(RequestContext.class))).thenThrow(OutOfMemoryError.class).thenReturn(Response.EMPTY);
  updatePuller.pullUpdates();
  assertThat(logging.countErrorsByType(OutOfMemoryError.class),is(1));
  updatePuller.pullUpdates();
}
