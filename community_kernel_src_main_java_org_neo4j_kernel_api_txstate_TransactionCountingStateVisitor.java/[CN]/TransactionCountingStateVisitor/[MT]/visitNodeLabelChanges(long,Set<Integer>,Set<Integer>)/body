{
  try (StorageStatement statement=storeLayer.acquireStatement()){
    if (!(added.isEmpty() && removed.isEmpty())) {
      for (      Integer label : added) {
        counts.incrementNodeCount(label,1);
      }
      for (      Integer label : removed) {
        counts.incrementNodeCount(label,-1);
      }
      try (Cursor<NodeItem> node=statement.acquireSingleNodeCursor(id)){
        if (node.next()) {
          try (Cursor<DegreeItem> degrees=node.get().degrees()){
            while (degrees.next()) {
              DegreeItem degree=degrees.get();
              for (              Integer label : added) {
                updateRelationshipsCountsFromDegrees(degree.type(),label,degree.outgoing(),degree.incoming());
              }
              for (              Integer label : removed) {
                updateRelationshipsCountsFromDegrees(degree.type(),label,-degree.outgoing(),-degree.incoming());
              }
            }
          }
         }
      }
     }
  }
   super.visitNodeLabelChanges(id,added,removed);
}
