{
  db=(GraphDatabaseAPI)new TestGraphDatabaseFactory().newImpermanentDatabase();
  DependencyResolver resolver=db.getDependencyResolver();
  IndexingService indexingService=resolver.resolveDependency(IndexingService.class);
  NeoStore neoStore=resolver.resolveDependency(XaDataSourceManager.class).getNeoStoreDataSource().getNeoStore();
  this.statement=new StoreStatementOperations(resolver.resolveDependency(PropertyKeyTokenHolder.class),resolver.resolveDependency(LabelTokenHolder.class),resolver.resolveDependency(RelationshipTypeTokenHolder.class),new SchemaStorage(neoStore.getSchemaStore()),neoStore,resolver.resolveDependency(PersistenceManager.class),indexingService);
  WritableStatementState state=new WritableStatementState();
  state.provide(new IndexReaderFactory.Caching(indexingService));
  this.state=state;
}
