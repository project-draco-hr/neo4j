{
  Transaction tx=db.beginTx();
  long nodeId=db.createNode(label1,label2).getId();
  String labelName1=label1.name(), labelName2=label2.name();
  long labelId1=statement.labelGetForName(state,labelName1);
  long labelId2=statement.labelGetOrCreateForName(state,labelName2);
  tx.success();
  tx.finish();
  PrimitiveLongIterator readLabels=statement.nodeGetLabels(state,nodeId);
  assertEquals(new HashSet<>(asList(labelId1,labelId2)),addToCollection(readLabels,new HashSet<Long>()));
}
