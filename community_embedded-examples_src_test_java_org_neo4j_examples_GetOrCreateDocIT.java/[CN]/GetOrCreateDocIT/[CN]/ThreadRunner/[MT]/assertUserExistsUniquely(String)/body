{
  Transaction transaction=graphdb().beginTx();
  try {
    assertNotNull("User '" + username + "' not created.",graphdb().index().forNodes("users").get("name",username).getSingle());
  }
 catch (  NoSuchElementException e) {
    throw new RuntimeException("User '" + username + "' not created uniquely.",e);
  }
 finally {
    transaction.finish();
  }
}
