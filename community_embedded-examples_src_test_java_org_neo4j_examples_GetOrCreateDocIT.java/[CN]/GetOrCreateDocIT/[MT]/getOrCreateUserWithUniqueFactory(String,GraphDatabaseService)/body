{
  UniqueFactory<Node> factory=new UniqueFactory.UniqueNodeFactory(graphDb,"users"){
    @Override protected void initialize(    Node created,    Map<String,Object> properties){
      created.setProperty("name",properties.get("name"));
    }
  }
;
  Transaction transaction=graphDb.beginTx();
  try {
    Node node=factory.getOrCreate("name",username);
    transaction.success();
    return node;
  }
  finally {
    transaction.finish();
  }
}
