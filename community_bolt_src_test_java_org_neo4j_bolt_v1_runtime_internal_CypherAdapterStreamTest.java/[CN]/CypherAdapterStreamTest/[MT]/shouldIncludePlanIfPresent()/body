{
  QueryStatistics queryStatistics=mock(QueryStatistics.class);
  when(queryStatistics.containsUpdates()).thenReturn(false);
  Result result=mock(Result.class);
  when(result.getQueryExecutionType()).thenReturn(explained(READ_ONLY));
  when(result.getQueryStatistics()).thenReturn(queryStatistics);
  when(result.getExecutionPlanDescription()).thenReturn(plan("Join",map("arg1",1),asList("id1"),plan("Scan",map("arg2",1),asList("id2"))));
  CypherAdapterStream stream=new CypherAdapterStream(result);
  Map<String,Object> meta=metadataOf(stream);
  assertThat(meta.get("plan").toString(),equalTo((Object)map("args",map("arg1",1),"children",asList(map("args",map("arg2",1),"children",asList(),"identifiers",asList("id2"),"operatorType","Scan")),"identifiers",asList("id1"),"operatorType","Join").toString()));
}
