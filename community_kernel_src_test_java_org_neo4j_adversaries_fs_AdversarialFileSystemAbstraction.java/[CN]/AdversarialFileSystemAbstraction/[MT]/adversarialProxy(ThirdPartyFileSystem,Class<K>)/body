{
  InvocationHandler handler=new InvocationHandler(){
    @Override public Object invoke(    Object proxy,    Method method,    Object[] args) throws Throwable {
      adversary.injectFailure((Class<? extends Throwable>[])method.getExceptionTypes());
      return method.invoke(fileSystem,args);
    }
  }
;
  ClassLoader loader=Thread.currentThread().getContextClassLoader();
  return (ThirdPartyFileSystem)Proxy.newProxyInstance(loader,new Class[]{clazz},handler);
}
