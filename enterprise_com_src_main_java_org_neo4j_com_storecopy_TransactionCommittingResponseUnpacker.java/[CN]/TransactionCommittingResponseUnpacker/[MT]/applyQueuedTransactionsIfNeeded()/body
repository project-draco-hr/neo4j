{
  if (transactionQueue.isEmpty()) {
    return;
  }
  if (batchSizeExceedsSafeZone()) {
    kernelTransactions.blockNewTransactions();
    try {
      markUnsafeTransactionsForTermination();
      applyQueuedTransactions();
    }
  finally {
      kernelTransactions.unblockNewTransactions();
    }
  }
 else {
    markUnsafeTransactionsForTermination();
    applyQueuedTransactions();
  }
}
