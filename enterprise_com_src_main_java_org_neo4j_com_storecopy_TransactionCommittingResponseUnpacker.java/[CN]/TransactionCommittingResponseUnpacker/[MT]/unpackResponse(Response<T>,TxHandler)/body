{
  response.accept(new Visitor<CommittedTransactionRepresentation,IOException>(){
    @Override public boolean visit(    CommittedTransactionRepresentation transaction) throws IOException {
synchronized (appender) {
        if (appender.append(transaction)) {
          final long transactionId=transaction.getCommitEntry().getTxId();
          try (LockGroup locks=new LockGroup()){
            storeApplier.apply(transaction.getTransactionRepresentation(),locks,transactionId,true);
            handler.accept(transaction);
          }
  finally {
            transactionIdStore.transactionClosed(transactionId);
          }
        }
      }
      return true;
    }
  }
);
  return response.response();
}
