{
synchronized (logFile) {
    logRotation.rotateLogIfNeeded(LogAppendEvent.NULL);
    try {
      if (transactionQueue.accept(batchCommitter) > 0) {
        appender.force();
        try {
          transactionQueue.accept(batchApplier);
          storeApplier.closeBatch();
        }
  finally {
          transactionQueue.accept(batchCloser);
        }
      }
    }
 catch (    Throwable panic) {
      kernelHealth.panic(panic);
      throw panic;
    }
 finally {
      transactionQueue.clear();
    }
  }
}
