{
  GraphDatabaseAPI graphDatabaseAPI=getServer().getDb();
  QueryExecutionEngine engine=getEngine();
  if (engine.isPeriodicCommit(query)) {
    ThreadToStatementContextBridge manager=graphDatabaseAPI.getDependencyResolver().resolveDependency(ThreadToStatementContextBridge.class);
    KernelTransaction tx=manager.getTopLevelTransactionBoundToThisThread(true);
    manager.unbindTransactionFromCurrentThread();
    try {
      return super.getResult(query,session);
    }
  finally {
      manager.bindTransactionToCurrentThread(tx);
    }
  }
 else {
    return super.getResult(query,session);
  }
}
