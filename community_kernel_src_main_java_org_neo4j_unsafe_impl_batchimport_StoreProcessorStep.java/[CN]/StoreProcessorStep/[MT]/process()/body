{
  highestId=store.getHighestPossibleIdInUse();
  id=reversed ? highestId : 0;
  long tooFar=reversed ? -1 : highestId + 1;
  int stride=reversed ? -1 : 1;
  RECORD heavilyReusedRecord=createReusableRecord();
  for (; id != tooFar; id+=stride) {
    RECORD record=loadRecord(id,heavilyReusedRecord);
    if (record != null && processor.process(record)) {
      store.updateRecord(heavilyReusedRecord);
    }
    itemProcessed();
  }
  processor.done();
}
