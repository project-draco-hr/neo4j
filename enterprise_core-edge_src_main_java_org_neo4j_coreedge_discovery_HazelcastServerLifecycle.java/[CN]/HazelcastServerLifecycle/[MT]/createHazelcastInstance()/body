{
  System.setProperty(GroupProperties.PROP_WAIT_SECONDS_BEFORE_JOIN,"1");
  JoinConfig joinConfig=new JoinConfig();
  joinConfig.getMulticastConfig().setEnabled(false);
  TcpIpConfig tcpIpConfig=joinConfig.getTcpIpConfig();
  tcpIpConfig.setEnabled(true);
  List<AdvertisedSocketAddress> initialMembers=config.get(CoreEdgeClusterSettings.initial_core_cluster_members);
  for (  AdvertisedSocketAddress address : initialMembers) {
    tcpIpConfig.addMember(address.toString());
  }
  log.info("Discovering cluster with initial members: " + initialMembers);
  NetworkConfig networkConfig=new NetworkConfig();
  ListenSocketAddress hazelcastAddress=config.get(CoreEdgeClusterSettings.hazelcast_listen_address);
  networkConfig.setPort(hazelcastAddress.socketAddress().getPort());
  networkConfig.setJoin(joinConfig);
  com.hazelcast.config.Config c=new com.hazelcast.config.Config();
  c.setProperty(GroupProperties.PROP_INITIAL_MIN_CLUSTER_SIZE,String.valueOf(minimumClusterSizeThatCanTolerateOneFaultForExpectedClusterSize()));
  c.setProperty(GroupProperties.PROP_LOGGING_TYPE,"none");
  c.setNetworkConfig(networkConfig);
  c.getGroupConfig().setName(config.get(CoreEdgeClusterSettings.cluster_name));
  MemberAttributeConfig memberAttributeConfig=HazelcastClusterTopology.buildMemberAttributes(myself,config);
  c.setMemberAttributeConfig(memberAttributeConfig);
  return Hazelcast.newHazelcastInstance(c);
}
