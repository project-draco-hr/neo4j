{
  KernelTransactions transactions=newKernelTransactions();
  KernelTransaction a=transactions.newInstance();
  KernelTransaction b=transactions.newInstance();
  KernelTransaction c=transactions.newInstance();
  KernelTransactionsSnapshot snapshot=transactions.get();
  assertFalse(snapshot.allClosed());
  a.close();
  assertFalse(snapshot.allClosed());
  c.close();
  KernelTransaction d=transactions.newInstance();
  assertFalse(snapshot.allClosed());
  b.close();
  assertTrue(snapshot.allClosed());
}
