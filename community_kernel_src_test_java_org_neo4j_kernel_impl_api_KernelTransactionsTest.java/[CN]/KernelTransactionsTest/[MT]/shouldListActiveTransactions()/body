{
  LifeSupport life=new LifeSupport();
  life.start();
  Locks locks=mock(Locks.class);
  when(locks.newClient()).thenReturn(mock(Locks.Client.class));
  KernelTransactions registry=new KernelTransactions(new MockContextSupplier(),mock(NeoStore.class),locks,null,null,null,null,null,null,null,null,TransactionHeaderInformationFactory.DEFAULT,null,null,mock(Provider.class),null,null,new TransactionHooks(),new TransactionMonitorImpl(),life,false);
  KernelTransaction first=registry.newInstance();
  KernelTransaction second=registry.newInstance();
  KernelTransaction third=registry.newInstance();
  first.close();
  assertThat(asUniqueSet(registry.activeTransactions()),equalTo(asSet(second,third)));
}
