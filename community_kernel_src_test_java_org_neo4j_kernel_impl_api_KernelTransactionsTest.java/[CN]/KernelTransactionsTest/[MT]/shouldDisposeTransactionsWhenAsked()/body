{
  KernelTransactions registry=newKernelTransactions();
  registry.disposeAll();
  KernelTransaction first=registry.newInstance(KernelTransaction.Type.implicit);
  KernelTransaction second=registry.newInstance(KernelTransaction.Type.implicit);
  KernelTransaction leftOpen=registry.newInstance(KernelTransaction.Type.implicit);
  first.close();
  second.close();
  registry.disposeAll();
  KernelTransaction postDispose=registry.newInstance(KernelTransaction.Type.implicit);
  assertThat(postDispose,not(equalTo(first)));
  assertThat(postDispose,not(equalTo(second)));
  assertTrue(leftOpen.shouldBeTerminated());
}
