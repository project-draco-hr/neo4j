{
  LifeSupport life=new LifeSupport();
  life.start();
  TransactionIdStore transactionIdStore=mock(TransactionIdStore.class);
  when(transactionIdStore.getLastCommittedTransaction()).thenReturn(new TransactionId(0,0,0));
  Tracers tracers=new Tracers("null",NullLog.getInstance(),new Monitors(),mock(JobScheduler.class));
  StatementLocksFactory statementLocksFactory=new SimpleStatementLocksFactory(locks);
  if (testKernelTransactions) {
    return new TestKernelTransactions(statementLocksFactory,null,null,null,TransactionHeaderInformationFactory.DEFAULT,commitProcess,null,null,new TransactionHooks(),mock(TransactionMonitor.class),life,tracers,storageEngine,new Procedures(),transactionIdStore,Clock.SYSTEM_CLOCK);
  }
  return new KernelTransactions(statementLocksFactory,null,null,null,TransactionHeaderInformationFactory.DEFAULT,commitProcess,null,null,new TransactionHooks(),mock(TransactionMonitor.class),life,tracers,storageEngine,new Procedures(),transactionIdStore,Clock.SYSTEM_CLOCK);
}
