{
  LifeSupport life=new LifeSupport();
  life.start();
  Locks locks=mock(Locks.class);
  when(locks.newClient()).thenReturn(mock(Locks.Client.class));
  MetaDataStore metaDataStore=mock(MetaDataStore.class);
  IntegrityValidator integrityValidator=mock(IntegrityValidator.class);
  NeoStores neoStores=mock(NeoStores.class);
  StoreStatement storeStatement=new StoreStatement(neoStores,new ReentrantLockService());
  StoreReadLayer readLayer=mock(StoreReadLayer.class);
  when(readLayer.acquireStatement()).thenReturn(storeStatement);
  StorageEngine storageEngine=mock(StorageEngine.class);
  when(storageEngine.storeReadLayer()).thenReturn(readLayer);
  when(storageEngine.neoStores()).thenReturn(neoStores);
  when(storageEngine.metaDataStore()).thenReturn(metaDataStore);
  when(storageEngine.integrityValidator()).thenReturn(integrityValidator);
  when(storageEngine.createCommands(any(TransactionState.class),any(LegacyIndexTransactionState.class),any(Locks.Client.class),any(StatementOperationParts.class),any(StoreStatement.class),anyLong())).thenReturn(sillyCommandList());
  Tracers tracers=new Tracers("null",NullLog.getInstance(),mock(Monitors.class),mock(JobScheduler.class));
  return new KernelTransactions(locks,null,null,null,TransactionHeaderInformationFactory.DEFAULT,commitProcess,null,null,new TransactionHooks(),mock(TransactionMonitor.class),life,tracers,storageEngine);
}
