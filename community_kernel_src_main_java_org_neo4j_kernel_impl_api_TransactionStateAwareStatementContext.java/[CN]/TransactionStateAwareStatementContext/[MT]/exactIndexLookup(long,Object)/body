{
  IndexDescriptor idx=delegate.getIndexDescriptor(indexId);
  DiffSets<Long> diff=state.getNodesWithChangedProperty(idx.getPropertyKeyId(),value);
  diff.removeAll(state.getDeletedNodes());
  diff=diff.filterAdded(new HasLabelFilter(idx.getLabelId()));
  HasPropertyFilter hasPropertyFilter=new HasPropertyFilter(idx.getPropertyKeyId(),value);
  Iterable<Long> addedNodesWithLabel=state.getNodesWithLabelAdded(idx.getLabelId());
  diff.addAll(Iterables.filter(hasPropertyFilter,addedNodesWithLabel));
  Iterable<Long> removedNodesWithLabel=state.getNodesWithLabelRemoved(idx.getLabelId());
  diff.removeAll(Iterables.filter(hasPropertyFilter,removedNodesWithLabel));
  return diff.apply(delegate.exactIndexLookup(indexId,value));
}
