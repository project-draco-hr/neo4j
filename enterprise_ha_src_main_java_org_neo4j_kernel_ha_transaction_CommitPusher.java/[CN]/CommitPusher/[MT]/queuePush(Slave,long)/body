{
  PullUpdateFuture pullRequest=new PullUpdateFuture(slave,txId);
  BlockingQueue<PullUpdateFuture> queue=getOrCreateQueue(slave);
  while (!queue.offer(pullRequest)) {
    Thread.yield();
  }
  try {
    pullRequest.get();
  }
 catch (  InterruptedException e) {
    Thread.interrupted();
    throw new RuntimeException(e);
  }
catch (  ExecutionException e) {
    if (e.getCause() instanceof RuntimeException) {
      throw ((RuntimeException)e.getCause());
    }
 else {
      throw new RuntimeException(e.getCause());
    }
  }
}
