{
  StateMachine stateMachine=mock(StateMachine.class);
  InMemoryRaftLog raftLog=new InMemoryRaftLog();
  raftLog.append(new RaftLogEntry(0,ReplicatedInteger.valueOf(0)));
  raftLog.append(new RaftLogEntry(0,ReplicatedInteger.valueOf(1)));
  raftLog.append(new RaftLogEntry(0,ReplicatedInteger.valueOf(2)));
  raftLog.commit(2);
  raftLog.append(new RaftLogEntry(0,ReplicatedInteger.valueOf(3)));
  RaftLogReplay replayer=new RaftLogReplay(stateMachine,raftLog,NullLogProvider.getInstance(),1);
  replayer.start();
  verify(stateMachine).applyCommand(ReplicatedInteger.valueOf(2),2);
}
