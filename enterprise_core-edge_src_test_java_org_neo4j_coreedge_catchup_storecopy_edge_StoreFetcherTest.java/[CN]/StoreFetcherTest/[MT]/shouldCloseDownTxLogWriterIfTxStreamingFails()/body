{
  StoreCopyClient storeCopyClient=mock(StoreCopyClient.class);
  TxPullClient txPullClient=mock(TxPullClient.class);
  TransactionLogCatchUpWriter writer=mock(TransactionLogCatchUpWriter.class);
  StoreFetcher fetcher=new StoreFetcher(NullLogProvider.getInstance(),mock(FileSystemAbstraction.class),null,storeCopyClient,txPullClient,factory(writer));
  doThrow(StoreCopyFailedException.class).when(txPullClient).pullTransactions(any(AdvertisedSocketAddress.class),anyLong(),any(TransactionLogCatchUpWriter.class));
  try {
    fetcher.copyStore(null,null);
  }
 catch (  StoreCopyFailedException e) {
  }
  verify(writer).close();
}
