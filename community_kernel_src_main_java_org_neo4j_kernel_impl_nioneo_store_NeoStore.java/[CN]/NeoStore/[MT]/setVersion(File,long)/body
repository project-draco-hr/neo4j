{
  RandomAccessFile file=null;
  try {
    file=new RandomAccessFile(new File(storeDir,NeoStore.DEFAULT_NAME),"rw");
    FileChannel channel=file.getChannel();
    channel.position(RECORD_SIZE * 2 + 1);
    ByteBuffer buffer=ByteBuffer.allocate(8);
    channel.read(buffer);
    buffer.flip();
    long previous=buffer.getLong();
    channel.position(RECORD_SIZE * 2 + 1);
    buffer.clear();
    buffer.putLong(version).flip();
    channel.write(buffer);
    return previous;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      if (file != null)       file.close();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
