{
  RandomAccessFile file=null;
  try {
    file=new RandomAccessFile(new File(storeDir),"rw");
    FileChannel channel=file.getChannel();
    if (recordPosition > 3 && channel.size() < RECORD_SIZE * 5) {
      return -1;
    }
    channel.position(RECORD_SIZE * recordPosition + 1);
    ByteBuffer buffer=ByteBuffer.allocate(8);
    channel.read(buffer);
    buffer.flip();
    long previous=buffer.getLong();
    return previous;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
 finally {
    try {
      if (file != null)       file.close();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
