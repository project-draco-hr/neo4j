{
  try {
    fixture.apply(inconsistentTransaction);
    fail("should have thrown error");
  }
 catch (  ConsistencyCheckingError expected) {
    int count=expected.getInconsistencyCountForRecordType(recordType);
    assertEquals("Unexpected number of inconsistencies",expectedCount,count);
    int total=expected.getTotalInconsistencyCount();
    String summary=expected.getMessage().replace("\n","\n\t");
    assertTrue("Expected failures for " + recordType + ", got "+ summary,count > 0);
    assertEquals("Didn't expect failures for any other type than " + recordType + ", got "+ summary,count,total);
  }
}
