{
  MasterClientResolver resolver=new MasterClientResolver(StringLogger.SYSTEM,0,0,0);
  resolver.getFor(4,2);
  MasterClient currentClient=resolver.instantiate("",0,null);
  assertEquals("wrong version returned for version 4",MasterClient18.class,currentClient.getClass());
  currentClient.shutdown();
  resolver.getFor(3,2);
  currentClient=resolver.instantiate("",0,null);
  assertEquals("wrong version returned for version 4",MasterClient17.class,currentClient.getClass());
  currentClient.shutdown();
  resolver.enableDowngradeBarrier();
  resolver.getFor(2,2);
  currentClient=resolver.instantiate("",0,null);
  assertEquals("wrong version returned for version 4",MasterClient17.class,currentClient.getClass());
  currentClient.shutdown();
}
