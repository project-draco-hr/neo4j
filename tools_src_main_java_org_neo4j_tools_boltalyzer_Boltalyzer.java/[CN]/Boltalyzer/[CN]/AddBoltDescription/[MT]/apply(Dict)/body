{
  try {
    if (packet.get(dstPort) == serverPort) {
      AnalyzedSession sess=sessions.session(packet.get(connectionKey));
      packet.put(description,sess.describeClientPayload(packet.get(payload)));
      packet.put(session,sess);
      packet.put(logicalSource,"Client");
    }
 else {
      AnalyzedSession sess=sessions.session(packet.get(connectionKey));
      packet.put(description,sess.describeServerPayload(packet.get(payload)));
      packet.put(session,sess);
      packet.put(logicalSource,"Server");
    }
    return packet;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
