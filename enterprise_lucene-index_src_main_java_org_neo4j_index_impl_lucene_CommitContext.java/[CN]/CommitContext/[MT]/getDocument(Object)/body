{
  long id=entityId instanceof Long ? (Long)entityId : ((RelationshipId)entityId).id;
  DocumentContext context=documents.get(id);
  if (context == null) {
    Document document=LuceneDataSource.findDocument(indexType,searcher,id);
    context=document == null ? new DocumentContext(identifier.entityType.newDocument(entityId),false,id) : new DocumentContext(document,true,id);
    documents.put(id,context);
  }
  return context;
}
