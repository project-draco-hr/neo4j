{
  try {
    IndexWriterConfig writerConfig=new IndexWriterConfig(LUCENE_VERSION,type.analyzer);
    writerConfig.setRAMBufferSizeMB(determineGoodBufferSize(writerConfig.getRAMBufferSizeMB()));
    IndexWriter writer=new IndexWriter(getDirectory(directory,identifier),writerConfig);
    return writer;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
