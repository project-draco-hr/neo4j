{
  VersionFiles versionFiles=mock(VersionFiles.class);
  when(versionFiles.filesInVersionOrder()).thenReturn(asList(new File("v2 "),new File("v3 ")));
  HeaderReader headerReader=mock(HeaderReader.class);
  when(headerReader.readHeader(new File("v2 "))).thenReturn(new Header(2,9,0));
  when(headerReader.readHeader(new File("v3 "))).thenReturn(new Header(3,19,0));
  EntryReader entryReader=mock(EntryReader.class);
  when(entryReader.readEntriesInVersion(3)).thenReturn(cursor());
  Recovery recovery=new Recovery(versionFiles,headerReader,entryReader);
  Recovery.LogState state=recovery.recover();
  assertEquals(9,state.prevIndex);
  assertEquals(0,state.prevTerm);
  assertEquals(19,state.appendIndex);
  assertEquals(3,state.currentVersion);
  assertEquals(2,state.ranges.lowestVersion());
  assertEquals(3,state.ranges.highestVersion());
}
