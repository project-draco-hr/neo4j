{
  if (expected.getClass().isArray()) {
    assertNotNull(actual);
    assertTrue("is array",actual.getClass().isArray());
    int length=Array.getLength(expected);
    if (expected instanceof Object[]) {
      if (expected instanceof String[]) {
        assertEquals(expected.getClass(),actual.getClass());
      }
 else {
        assertTrue("can only compare boxed arrays of non-zero length",length > 0);
      }
    }
 else {
      assertEquals("component type",expected.getClass(),actual.getClass());
    }
    assertEquals("array length",length,Array.getLength(actual));
    for (int i=0; i < length; i++) {
      assertEquals(Array.get(expected,i),Array.get(actual,i));
    }
  }
 else {
    assertEquals(expected,actual);
  }
}
