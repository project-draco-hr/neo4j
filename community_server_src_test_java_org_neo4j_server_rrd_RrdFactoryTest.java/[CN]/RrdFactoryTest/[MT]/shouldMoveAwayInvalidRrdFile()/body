{
  File rrdDir=new File(directory.directory(),ServerInternalSettings.rrd_store.getDefaultValue());
  assertTrue(rrdDir.mkdirs());
  String rrdFilePath=new File(rrdDir,"rrd-test").getAbsolutePath();
  addProperty(Configurator.RRDB_LOCATION_PROPERTY_KEY,rrdFilePath);
  TestableRrdFactory factory=createRrdFactory();
  createInvalidRrdFile(rrdFilePath);
  RrdDbWrapper rrdDbAndSampler=factory.createRrdDbAndSampler(db,new NullJobScheduler());
  assertSubdirectoryExists("rrd-test-invalid",factory.directoryUsed);
  rrdDbAndSampler.close();
}
