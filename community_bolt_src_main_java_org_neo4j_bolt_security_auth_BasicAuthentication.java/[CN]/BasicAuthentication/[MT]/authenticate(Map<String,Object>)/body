{
  if (!SCHEME.equals(authToken.get(SCHEME_KEY))) {
    throw new AuthenticationException(Status.Security.Unauthorized,"Missing username and password");
  }
  if (authToken.containsKey(NEW_CREDENTIALS)) {
    return update(authToken);
  }
 else {
    return doAuthenticate(authToken);
  }
}
