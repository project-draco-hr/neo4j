{
switch (authManager.authenticate(user,password)) {
case SUCCESS:
case PASSWORD_CHANGE_REQUIRED:
    try {
      authManager.setPassword(user,newPassword);
    }
 catch (    IOException e) {
      throw new AuthenticationException(Status.Security.AuthenticationFailed,e.getMessage(),e);
    }
  break;
default :
throw new AuthenticationException(Status.Security.AuthenticationFailed);
}
}
