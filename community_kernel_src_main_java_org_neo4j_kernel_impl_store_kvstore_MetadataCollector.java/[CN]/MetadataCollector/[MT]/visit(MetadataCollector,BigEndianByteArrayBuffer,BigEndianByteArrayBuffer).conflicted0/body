{
  if (key.allZeroes()) {
    if (value.allZeroes()) {
      collector.state=done;
      return false;
    }
    if (collector.header > collector.headerFields.length) {
      throw new IllegalStateException("Too many header fields, expected only " + collector.headerFields.length);
    }
    int header=collector.header - 1;
    collector.header++;
    collector.readHeader(header,value);
    return true;
  }
 else {
    if (collector.headerFields.length >= collector.header) {
      throw new IllegalStateException("Expected " + collector.headerFields.length + " header fields, only "+ (collector.header - 1)+ " seen.");
    }
    return (collector.state=reading_data).visit(collector,key,value);
  }
}
