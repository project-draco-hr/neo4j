{
  IdType idType=IdType.ACTUAL;
  Iterable<DataFactory<InputNode>> data=dataIterable(data("123,one\n" + "456,two"));
  Groups groups=new Groups();
  Group group=groups.getOrCreate("MyGroup");
  Input input=new CsvInput(data,header(entry(null,Type.ID,group.name(),idType.extractor(extractors)),entry("name",Type.PROPERTY,extractors.string())),null,null,idType,COMMAS,silentBadCollector(0));
  Iterator<InputNode> nodes=input.nodes().iterator();
  assertNode(nodes.next(),group,123L,properties("name","one"),labels());
  assertNode(nodes.next(),group,456L,properties("name","two"),labels());
  assertFalse(nodes.hasNext());
}
