{
  DataFactory<InputNode> group1=data("id:ID,name,kills:int,health:int\n" + "1,Jim,10,100\n" + "2,Abathur,0,200\n");
  DataFactory<InputNode> group2=data("id:ID,type\n" + "3,zergling\n" + "4,csv\n");
  Iterable<DataFactory<InputNode>> data=dataIterable(group1,group2);
  Input input=new CsvInput(data,defaultFormatNodeFileHeader(),null,null,IdType.STRING,Configuration.COMMAS);
  ResourceIterator<InputNode> nodes=input.nodes().iterator();
  assertNode(nodes.next(),"1",properties("name","Jim","kills",10,"health",100),labels());
  assertNode(nodes.next(),"2",properties("name","Abathur","kills",0,"health",200),labels());
  assertNode(nodes.next(),"3",properties("type","zergling"),labels());
  assertNode(nodes.next(),"4",properties("type","csv"),labels());
  assertFalse(nodes.hasNext());
}
