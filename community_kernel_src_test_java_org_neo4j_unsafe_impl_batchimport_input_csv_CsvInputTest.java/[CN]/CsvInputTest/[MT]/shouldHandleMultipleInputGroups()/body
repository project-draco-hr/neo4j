{
  DataFactory group1=data("id:ID,name,kills:int,health:int\n" + "1,Jim,10,100\n" + "2,Abathur,0,200\n");
  DataFactory group2=data("id:ID,type\n" + "3,zergling\n" + "4,csv\n");
  Input input=new CsvInput(dataIterable(group1,group2),defaultFormatNodeFileHeader(),null,null,IdType.STRING,Configuration.COMMAS);
  ResourceIterator<InputNode> nodes=input.nodes().iterator();
  assertNode(nodes.next(),"1",properties("name","Jim","kills",10,"health",100),NO_LABELS);
  assertNode(nodes.next(),"2",properties("name","Abathur","kills",0,"health",200),NO_LABELS);
  assertNode(nodes.next(),"3",properties("type","zergling"),NO_LABELS);
  assertNode(nodes.next(),"4",properties("type","csv"),NO_LABELS);
  assertFalse(nodes.hasNext());
}
