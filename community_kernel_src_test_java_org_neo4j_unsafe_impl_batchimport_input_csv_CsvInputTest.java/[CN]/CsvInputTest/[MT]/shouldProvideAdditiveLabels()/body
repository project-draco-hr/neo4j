{
  String[] addedLabels={"Two","AddTwo"};
  DataFactory<InputNode> data=data(":ID,name,:LABEL\n" + "0,First,\n" + "1,Second,One\n"+ "2,Third,One;Two",additiveLabels(addedLabels));
  Iterable<DataFactory<InputNode>> dataIterable=dataIterable(data);
  Input input=new CsvInput(dataIterable,defaultFormatNodeFileHeader(),null,null,IdType.ACTUAL,Configuration.COMMAS);
  try (ResourceIterator<InputNode> nodes=input.nodes().iterator()){
    assertNode(nodes.next(),0L,properties("name","First"),labels(addedLabels));
    assertNode(nodes.next(),1L,properties("name","Second"),labels(union(new String[]{"One"},addedLabels)));
    assertNode(nodes.next(),2L,properties("name","Third"),labels(union(new String[]{"One"},addedLabels)));
    assertFalse(nodes.hasNext());
  }
 }
