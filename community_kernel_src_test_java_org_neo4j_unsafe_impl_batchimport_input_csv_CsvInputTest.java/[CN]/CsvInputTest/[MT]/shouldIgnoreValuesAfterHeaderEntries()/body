{
  Iterable<DataFactory<InputNode>> data=dataIterable(data("1,zergling,bubble,bobble\n" + "2,scv,pun,intended"));
  Input input=new CsvInput(data,header(entry(null,Type.ID,extractors.long_()),entry("name",Type.PROPERTY,extractors.string())),null,null,IdType.ACTUAL,config(COMMAS),silentBadCollector(4),getRuntime().availableProcessors());
  try (ResourceIterator<InputNode> nodes=input.nodes().iterator()){
    assertNode(nodes.next(),1L,new Object[]{"name","zergling"},labels());
    assertNode(nodes.next(),2L,new Object[]{"name","scv"},labels());
    assertFalse(nodes.hasNext());
  }
 }
