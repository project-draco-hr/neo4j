{
  IdType idType=IdType.ACTUAL;
  Iterable<DataFactory<InputRelationship>> data=dataIterable(data("123,TYPE,234\n" + "345,TYPE,456"));
  Groups groups=new Groups();
  Group startNodeGroup=groups.getOrCreate("StartGroup");
  Group endNodeGroup=groups.getOrCreate("EndGroup");
  Input input=new CsvInput(null,null,data,header(entry(null,Type.START_ID,startNodeGroup.name(),idType.extractor(extractors)),entry(null,Type.TYPE,extractors.string()),entry(null,Type.END_ID,endNodeGroup.name(),idType.extractor(extractors))),idType,config(COMMAS),silentBadCollector(0),getRuntime().availableProcessors());
  Iterator<InputRelationship> relationships=input.relationships().iterator();
  assertRelationship(relationships.next(),startNodeGroup,123L,endNodeGroup,234L,"TYPE",properties());
  assertRelationship(relationships.next(),startNodeGroup,345L,endNodeGroup,456L,"TYPE",properties());
  assertFalse(relationships.hasNext());
}
