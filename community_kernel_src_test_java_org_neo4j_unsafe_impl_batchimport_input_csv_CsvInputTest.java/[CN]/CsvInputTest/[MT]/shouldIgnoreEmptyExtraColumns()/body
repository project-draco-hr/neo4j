{
  Iterable<DataFactory<InputNode>> data=DataFactories.nodeData(CsvInputTest.<InputNode>data(":ID,one\n" + "1,test,\n" + "2,test,,additional"));
  Collector collector=mock(Collector.class);
  Input input=new CsvInput(data,defaultFormatNodeFileHeader(),null,null,IdType.INTEGER,COMMAS,collector,getRuntime().availableProcessors());
  try (InputIterator<InputNode> nodes=input.nodes().iterator()){
    assertNode(nodes.next(),1L,properties("one","test"),labels());
    assertNode(nodes.next(),2L,properties("one","test"),labels());
    assertFalse(nodes.hasNext());
  }
   verify(collector,times(1)).collectExtraColumns(anyString(),eq(1l),eq((String)null));
  verify(collector,times(1)).collectExtraColumns(anyString(),eq(2l),eq((String)null));
  verify(collector,times(1)).collectExtraColumns(anyString(),eq(2l),eq("additional"));
}
