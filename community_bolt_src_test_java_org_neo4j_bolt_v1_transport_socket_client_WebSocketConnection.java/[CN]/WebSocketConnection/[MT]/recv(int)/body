{
  int remaining=length;
  byte[] target=new byte[remaining];
  while (remaining > 0) {
    waitForReceivedData(length,remaining,target);
    for (int i=0; i < Math.min(remaining,currentReceiveBuffer.length - currentReceiveIndex); i++) {
      target[length - remaining]=currentReceiveBuffer[currentReceiveIndex++];
      remaining--;
    }
  }
  return target;
}
