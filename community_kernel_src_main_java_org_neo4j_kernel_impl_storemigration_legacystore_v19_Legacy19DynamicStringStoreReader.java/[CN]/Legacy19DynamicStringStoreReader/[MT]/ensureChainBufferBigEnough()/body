{
  if (chainBuffer.remaining() < blockSize) {
    byte[] extendedBuffer=new byte[chainBuffer.capacity() * 2];
    System.arraycopy(chainBuffer.array(),0,extendedBuffer,0,chainBuffer.capacity());
    chainBuffer=ByteBuffer.wrap(extendedBuffer);
  }
}
